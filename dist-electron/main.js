"use strict";var Xs=Object.defineProperty;var Vs=(o,e,n)=>e in o?Xs(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n;var Z=(o,e,n)=>(Vs(o,typeof e!="symbol"?e+"":e,n),n);const re=require("electron"),Q=require("path"),tt=require("util"),Be=require("events"),rt=require("child_process"),$e=require("os"),ae=require("fs"),zs=require("stream"),wt=require("http"),Et=require("https"),Ws=require("ws"),An=require("assert"),Hs=require("zlib"),_n=require("url"),Nn=require("tty"),Ae=require("crypto"),Gs=require("querystring"),Ks=require("string_decoder"),Ys=require("timers");function Js(o){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(o){for(const n in o)if(n!=="default"){const i=Object.getOwnPropertyDescriptor(o,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>o[n]})}}return e.default=o,Object.freeze(e)}const Lt=Js(ae);function Qs(){re.ipcMain.handle("show-save-dialog",async(o,e)=>await re.dialog.showSaveDialog({title:e.title||"保存文件",defaultPath:e.defaultPath||re.app.getPath("documents"),filters:e.filters||[{name:"MP4 Videos",extensions:["mp4"]},{name:"All Files",extensions:["*"]}]})),re.ipcMain.handle("select-directory",async()=>{const o=await re.dialog.showOpenDialog({properties:["openDirectory"],title:"选择保存目录",defaultPath:re.app.getPath("documents")});return!o.canceled&&o.filePaths.length>0?o.filePaths[0]:null})}var ee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bt(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function Zs(o){if(o.__esModule)return o;var e=o.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(i){var a=Object.getOwnPropertyDescriptor(o,i);Object.defineProperty(n,i,a.get?a:{enumerable:!0,get:function(){return o[i]}})}),n}var Qo={exports:{}},Mt,Kn;function ea(){if(Kn)return Mt;Kn=1,Mt=i,i.sync=a;var o=ae;function e(t,r){var s=r.pathExt!==void 0?r.pathExt:process.env.PATHEXT;if(!s||(s=s.split(";"),s.indexOf("")!==-1))return!0;for(var u=0;u<s.length;u++){var f=s[u].toLowerCase();if(f&&t.substr(-f.length).toLowerCase()===f)return!0}return!1}function n(t,r,s){return!t.isSymbolicLink()&&!t.isFile()?!1:e(r,s)}function i(t,r,s){o.stat(t,function(u,f){s(u,u?!1:n(f,t,r))})}function a(t,r){return n(o.statSync(t),t,r)}return Mt}var Rt,Yn;function ta(){if(Yn)return Rt;Yn=1,Rt=e,e.sync=n;var o=ae;function e(t,r,s){o.stat(t,function(u,f){s(u,u?!1:i(f,r))})}function n(t,r){return i(o.statSync(t),r)}function i(t,r){return t.isFile()&&a(t,r)}function a(t,r){var s=t.mode,u=t.uid,f=t.gid,c=r.uid!==void 0?r.uid:process.getuid&&process.getuid(),h=r.gid!==void 0?r.gid:process.getgid&&process.getgid(),l=parseInt("100",8),g=parseInt("010",8),y=parseInt("001",8),b=l|g,O=s&y||s&g&&f===h||s&l&&u===c||s&b&&c===0;return O}return Rt}var yt;process.platform==="win32"||ee.TESTING_WINDOWS?yt=ea():yt=ta();var ra=In;In.sync=na;function In(o,e,n){if(typeof e=="function"&&(n=e,e={}),!n){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(i,a){In(o,e||{},function(t,r){t?a(t):i(r)})})}yt(o,e||{},function(i,a){i&&(i.code==="EACCES"||e&&e.ignoreErrors)&&(i=null,a=!1),n(i,a)})}function na(o,e){try{return yt.sync(o,e||{})}catch(n){if(e&&e.ignoreErrors||n.code==="EACCES")return!1;throw n}}var ia=ns;ns.sync=sa;var vn=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Zo=Q,oa=vn?";":":",es=ra;function ts(o){var e=new Error("not found: "+o);return e.code="ENOENT",e}function rs(o,e){var n=e.colon||oa,i=e.path||process.env.PATH||"",a=[""];i=i.split(n);var t="";return vn&&(i.unshift(process.cwd()),t=e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM",a=t.split(n),o.indexOf(".")!==-1&&a[0]!==""&&a.unshift("")),(o.match(/\//)||vn&&o.match(/\\/))&&(i=[""]),{env:i,ext:a,extExe:t}}function ns(o,e,n){typeof e=="function"&&(n=e,e={});var i=rs(o,e),a=i.env,t=i.ext,r=i.extExe,s=[];(function u(f,c){if(f===c)return e.all&&s.length?n(null,s):n(ts(o));var h=a[f];h.charAt(0)==='"'&&h.slice(-1)==='"'&&(h=h.slice(1,-1));var l=Zo.join(h,o);!h&&/^\.[\\\/]/.test(o)&&(l=o.slice(0,2)+l),function g(y,b){if(y===b)return u(f+1,c);var O=t[y];es(l+O,{pathExt:r},function(x,v){if(!x&&v)if(e.all)s.push(l+O);else return n(null,l+O);return g(y+1,b)})}(0,t.length)})(0,a.length)}function sa(o,e){e=e||{};for(var n=rs(o,e),i=n.env,a=n.ext,t=n.extExe,r=[],s=0,u=i.length;s<u;s++){var f=i[s];f.charAt(0)==='"'&&f.slice(-1)==='"'&&(f=f.slice(1,-1));var c=Zo.join(f,o);!f&&/^\.[\\\/]/.test(o)&&(c=o.slice(0,2)+c);for(var h=0,l=a.length;h<l;h++){var g=c+a[h],y;try{if(y=es.sync(g,{pathExt:t}),y)if(e.all)r.push(g);else return g}catch{}}}if(e.all&&r.length)return r;if(e.nothrow)return null;throw ts(o)}rt.exec;var aa=$e.platform().match(/win(32|64)/),ua=ia,Jn=/\r\n|\r|\n/g,He=/^\[?(.*?)\]?$/,Qn=/[,]/,ot={};function ca(o){var e={};o=o.replace(/=\s+/g,"=").trim();for(var n=o.split(" "),i=0;i<n.length;i++){var a=n[i].split("=",2),t=a[0],r=a[1];if(typeof r>"u")return null;e[t]=r}return e}var Zn=Qo.exports={isWindows:aa,streamRegexp:He,copy:function(o,e){Object.keys(o).forEach(function(n){e[n]=o[n]})},args:function(){var o=[],e=function(){arguments.length===1&&Array.isArray(arguments[0])?o=o.concat(arguments[0]):o=o.concat([].slice.call(arguments))};return e.clear=function(){o=[]},e.get=function(){return o},e.find=function(n,i){var a=o.indexOf(n);if(a!==-1)return o.slice(a+1,a+1+(i||0))},e.remove=function(n,i){var a=o.indexOf(n);a!==-1&&o.splice(a,(i||0)+1)},e.clone=function(){var n=Zn.args();return n(o),n},e},makeFilterStrings:function(o){return o.map(function(e){if(typeof e=="string")return e;var n="";return Array.isArray(e.inputs)?n+=e.inputs.map(function(i){return i.replace(He,"[$1]")}).join(""):typeof e.inputs=="string"&&(n+=e.inputs.replace(He,"[$1]")),n+=e.filter,e.options&&(typeof e.options=="string"||typeof e.options=="number"?n+="="+e.options:Array.isArray(e.options)?n+="="+e.options.map(function(i){return typeof i=="string"&&i.match(Qn)?"'"+i+"'":i}).join(":"):Object.keys(e.options).length&&(n+="="+Object.keys(e.options).map(function(i){var a=e.options[i];return typeof a=="string"&&a.match(Qn)&&(a="'"+a+"'"),i+"="+a}).join(":"))),Array.isArray(e.outputs)?n+=e.outputs.map(function(i){return i.replace(He,"[$1]")}).join(""):typeof e.outputs=="string"&&(n+=e.outputs.replace(He,"[$1]")),n})},which:function(o,e){if(o in ot)return e(null,ot[o]);ua(o,function(n,i){if(n)return e(null,ot[o]="");e(null,ot[o]=i)})},timemarkToSeconds:function(o){if(typeof o=="number")return o;if(o.indexOf(":")===-1&&o.indexOf(".")>=0)return Number(o);var e=o.split(":"),n=Number(e.pop());return e.length&&(n+=Number(e.pop())*60),e.length&&(n+=Number(e.pop())*3600),n},extractCodecData:function(o,e,n){var i=/Input #[0-9]+, ([^ ]+),/,a=/Duration\: ([^,]+)/,t=/Audio\: (.*)/,r=/Video\: (.*)/;"inputStack"in n||(n.inputStack=[],n.inputIndex=-1,n.inInput=!1);var s=n.inputStack,u=n.inputIndex,f=n.inInput,c,h,l,g;if(c=e.match(i))f=n.inInput=!0,u=n.inputIndex=n.inputIndex+1,s[u]={format:c[1],audio:"",video:"",duration:""};else if(f&&(h=e.match(a)))s[u].duration=h[1];else if(f&&(l=e.match(t)))l=l[1].split(", "),s[u].audio=l[0],s[u].audio_details=l;else if(f&&(g=e.match(r)))g=g[1].split(", "),s[u].video=g[0],s[u].video_details=g;else if(/Output #\d+/.test(e))f=n.inInput=!1;else if(/Stream mapping:|Press (\[q\]|ctrl-c) to stop/.test(e))return o.emit.apply(o,["codecData"].concat(s)),!0;return!1},extractProgress:function(o,e){var n=ca(e);if(n){var i={frames:parseInt(n.frame,10),currentFps:parseInt(n.fps,10),currentKbps:n.bitrate?parseFloat(n.bitrate.replace("kbits/s","")):0,targetSize:parseInt(n.size||n.Lsize,10),timemark:n.time};if(o._ffprobeData&&o._ffprobeData.format&&o._ffprobeData.format.duration){var a=Number(o._ffprobeData.format.duration);isNaN(a)||(i.percent=Zn.timemarkToSeconds(i.timemark)/a*100)}o.emit("progress",i)}},extractError:function(o){return o.split(Jn).reduce(function(e,n){return n.charAt(0)===" "||n.charAt(0)==="["?[]:(e.push(n),e)},[]).join(`
`)},linesRing:function(o){var e=[],n=[],i=null,a=!1,t=o-1;function r(s){e.forEach(function(u){u(s)})}return{callback:function(s){n.forEach(function(u){s(u)}),e.push(s)},append:function(s){if(!a&&(s instanceof Buffer&&(s=""+s),!(!s||s.length===0))){var u=s.split(Jn);u.length===1?i!==null?i=i+u.shift():i=u.shift():(i!==null&&(i=i+u.shift(),r(i),n.push(i)),i=u.pop(),u.forEach(function(f){r(f),n.push(f)}),t>-1&&n.length>t&&n.splice(0,n.length-t))}},get:function(){return i!==null?n.concat([i]).join(`
`):n.join(`
`)},close:function(){a||(i!==null&&(r(i),n.push(i),t>-1&&n.length>t&&n.shift(),i=null),a=!0)}}}},Se=Qo.exports,jt,ei;function la(){if(ei)return jt;ei=1;var o=Se;return jt=function(e){e.mergeAdd=e.addInput=e.input=function(n){var i=!1,a=!1;if(typeof n!="string"){if(!("readable"in n)||!n.readable)throw new Error("Invalid input");var t=this._inputs.some(function(s){return s.isStream});if(t)throw new Error("Only one input stream is supported");a=!0,n.pause()}else{var r=n.match(/^([a-z]{2,}):/i);i=!r||r[0]==="file"}return this._inputs.push(this._currentInput={source:n,isFile:i,isStream:a,options:o.args()}),this},e.withInputFormat=e.inputFormat=e.fromFormat=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-f",n),this},e.withInputFps=e.withInputFPS=e.withFpsInput=e.withFPSInput=e.inputFPS=e.inputFps=e.fpsInput=e.FPSInput=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-r",n),this},e.nativeFramerate=e.withNativeFramerate=e.native=function(){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-re"),this},e.setStartTime=e.seekInput=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-ss",n),this},e.loop=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-loop","1"),typeof n<"u"&&this.duration(n),this}},jt}var qt,ti;function fa(){if(ti)return qt;ti=1;var o=Se;return qt=function(e){e.withNoAudio=e.noAudio=function(){return this._currentOutput.audio.clear(),this._currentOutput.audioFilters.clear(),this._currentOutput.audio("-an"),this},e.withAudioCodec=e.audioCodec=function(n){return this._currentOutput.audio("-acodec",n),this},e.withAudioBitrate=e.audioBitrate=function(n){return this._currentOutput.audio("-b:a",(""+n).replace(/k?$/,"k")),this},e.withAudioChannels=e.audioChannels=function(n){return this._currentOutput.audio("-ac",n),this},e.withAudioFrequency=e.audioFrequency=function(n){return this._currentOutput.audio("-ar",n),this},e.withAudioQuality=e.audioQuality=function(n){return this._currentOutput.audio("-aq",n),this},e.withAudioFilter=e.withAudioFilters=e.audioFilter=e.audioFilters=function(n){return arguments.length>1&&(n=[].slice.call(arguments)),Array.isArray(n)||(n=[n]),this._currentOutput.audioFilters(o.makeFilterStrings(n)),this}},qt}var $t,ri;function pa(){if(ri)return $t;ri=1;var o=Se;return $t=function(e){e.withNoVideo=e.noVideo=function(){return this._currentOutput.video.clear(),this._currentOutput.videoFilters.clear(),this._currentOutput.video("-vn"),this},e.withVideoCodec=e.videoCodec=function(n){return this._currentOutput.video("-vcodec",n),this},e.withVideoBitrate=e.videoBitrate=function(n,i){return n=(""+n).replace(/k?$/,"k"),this._currentOutput.video("-b:v",n),i&&this._currentOutput.video("-maxrate",n,"-minrate",n,"-bufsize","3M"),this},e.withVideoFilter=e.withVideoFilters=e.videoFilter=e.videoFilters=function(n){return arguments.length>1&&(n=[].slice.call(arguments)),Array.isArray(n)||(n=[n]),this._currentOutput.videoFilters(o.makeFilterStrings(n)),this},e.withOutputFps=e.withOutputFPS=e.withFpsOutput=e.withFPSOutput=e.withFps=e.withFPS=e.outputFPS=e.outputFps=e.fpsOutput=e.FPSOutput=e.fps=e.FPS=function(n){return this._currentOutput.video("-r",n),this},e.takeFrames=e.withFrames=e.frames=function(n){return this._currentOutput.video("-vframes",n),this}},$t}var kt,ni;function ha(){if(ni)return kt;ni=1;function o(n,i,a,t){return[{filter:"scale",options:{w:"if(gt(a,"+a+"),"+n+",trunc("+i+"*a/2)*2)",h:"if(lt(a,"+a+"),"+i+",trunc("+n+"/a/2)*2)"}},{filter:"pad",options:{w:n,h:i,x:"if(gt(a,"+a+"),0,("+n+"-iw)/2)",y:"if(lt(a,"+a+"),0,("+i+"-ih)/2)",color:t}}]}function e(n,i,a){var t=n.sizeData=n.sizeData||{};if(t[i]=a,!("size"in t))return[];var r=t.size.match(/([0-9]+)x([0-9]+)/),s=t.size.match(/([0-9]+)x\?/),u=t.size.match(/\?x([0-9]+)/),f=t.size.match(/\b([0-9]{1,3})%/),c,h,l;if(f){var g=Number(f[1])/100;return[{filter:"scale",options:{w:"trunc(iw*"+g+"/2)*2",h:"trunc(ih*"+g+"/2)*2"}}]}else{if(r)return c=Math.round(Number(r[1])/2)*2,h=Math.round(Number(r[2])/2)*2,l=c/h,t.pad?o(c,h,l,t.pad):[{filter:"scale",options:{w:c,h}}];if(s||u)return"aspect"in t?(c=s?s[1]:Math.round(Number(u[1])*t.aspect),h=u?u[1]:Math.round(Number(s[1])/t.aspect),c=Math.round(c/2)*2,h=Math.round(h/2)*2,t.pad?o(c,h,t.aspect,t.pad):[{filter:"scale",options:{w:c,h}}]):s?[{filter:"scale",options:{w:Math.round(Number(s[1])/2)*2,h:"trunc(ow/a/2)*2"}}]:[{filter:"scale",options:{w:"trunc(oh*a/2)*2",h:Math.round(Number(u[1])/2)*2}}];throw new Error("Invalid size specified: "+t.size)}}return kt=function(n){n.keepPixelAspect=n.keepDisplayAspect=n.keepDisplayAspectRatio=n.keepDAR=function(){return this.videoFilters([{filter:"scale",options:{w:"if(gt(sar,1),iw*sar,iw)",h:"if(lt(sar,1),ih/sar,ih)"}},{filter:"setsar",options:"1"}])},n.withSize=n.setSize=n.size=function(i){var a=e(this._currentOutput,"size",i);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(a),this},n.withAspect=n.withAspectRatio=n.setAspect=n.setAspectRatio=n.aspect=n.aspectRatio=function(i){var a=Number(i);if(isNaN(a)){var t=i.match(/^(\d+):(\d+)$/);if(t)a=Number(t[1])/Number(t[2]);else throw new Error("Invalid aspect ratio: "+i)}var r=e(this._currentOutput,"aspect",a);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(r),this},n.applyAutopadding=n.applyAutoPadding=n.applyAutopad=n.applyAutoPad=n.withAutopadding=n.withAutoPadding=n.withAutopad=n.withAutoPad=n.autoPad=n.autopad=function(i,a){typeof i=="string"&&(a=i,i=!0),typeof i>"u"&&(i=!0);var t=e(this._currentOutput,"pad",i?a||"black":!1);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(t),this}},kt}var Bt,ii;function da(){if(ii)return Bt;ii=1;var o=Se;return Bt=function(e){e.addOutput=e.output=function(n,i){var a=!1;if(!n&&this._currentOutput)throw new Error("Invalid output");if(n&&typeof n!="string"){if(!("writable"in n)||!n.writable)throw new Error("Invalid output")}else if(typeof n=="string"){var t=n.match(/^([a-z]{2,}):/i);a=!t||t[0]==="file"}if(n&&!("target"in this._currentOutput))this._currentOutput.target=n,this._currentOutput.isFile=a,this._currentOutput.pipeopts=i||{};else{if(n&&typeof n!="string"){var r=this._outputs.some(function(u){return typeof u.target!="string"});if(r)throw new Error("Only one output stream is supported")}this._outputs.push(this._currentOutput={target:n,isFile:a,flags:{},pipeopts:i||{}});var s=this;["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(u){s._currentOutput[u]=o.args()}),n||delete this._currentOutput.target}return this},e.seekOutput=e.seek=function(n){return this._currentOutput.options("-ss",n),this},e.withDuration=e.setDuration=e.duration=function(n){return this._currentOutput.options("-t",n),this},e.toFormat=e.withOutputFormat=e.outputFormat=e.format=function(n){return this._currentOutput.options("-f",n),this},e.map=function(n){return this._currentOutput.options("-map",n.replace(o.streamRegexp,"[$1]")),this},e.updateFlvMetadata=e.flvmeta=function(){return this._currentOutput.flags.flvmeta=!0,this}},Bt}var Ut,oi;function ma(){if(oi)return Ut;oi=1;var o=Se;return Ut=function(e){e.addInputOption=e.addInputOptions=e.withInputOption=e.withInputOptions=e.inputOption=e.inputOptions=function(n){if(!this._currentInput)throw new Error("No input specified");var i=!0;return arguments.length>1&&(n=[].slice.call(arguments),i=!1),Array.isArray(n)||(n=[n]),this._currentInput.options(n.reduce(function(a,t){var r=String(t).split(" ");return i&&r.length===2?a.push(r[0],r[1]):a.push(t),a},[])),this},e.addOutputOption=e.addOutputOptions=e.addOption=e.addOptions=e.withOutputOption=e.withOutputOptions=e.withOption=e.withOptions=e.outputOption=e.outputOptions=function(n){var i=!0;return arguments.length>1&&(n=[].slice.call(arguments),i=!1),Array.isArray(n)||(n=[n]),this._currentOutput.options(n.reduce(function(a,t){var r=String(t).split(" ");return i&&r.length===2?a.push(r[0],r[1]):a.push(t),a},[])),this},e.filterGraph=e.complexFilter=function(n,i){if(this._complexFilters.clear(),Array.isArray(n)||(n=[n]),this._complexFilters("-filter_complex",o.makeFilterStrings(n).join(";")),Array.isArray(i)){var a=this;i.forEach(function(t){a._complexFilters("-map",t.replace(o.streamRegexp,"[$1]"))})}else typeof i=="string"&&this._complexFilters("-map",i.replace(o.streamRegexp,"[$1]"));return this}},Ut}function ga(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Xt,si;function ya(){if(si)return Xt;si=1;var o=Q;return Xt=function(e){e.usingPreset=e.preset=function(n){if(typeof n=="function")n(this);else try{var i=o.join(this.options.presets,n),a=ga(i);if(typeof a.load=="function")a.load(this);else throw new Error("preset "+i+" has no load() function")}catch(t){throw new Error("preset "+i+" could not be loaded: "+t.message)}return this}},Xt}var Vt={exports:{}},ai;function xn(){return ai||(ai=1,function(o){(function(){var e={},n,i;n=this,n!=null&&(i=n.async),e.noConflict=function(){return n.async=i,e};function a(w){var _=!1;return function(){if(_)throw new Error("Callback was already called.");_=!0,w.apply(n,arguments)}}var t=function(w,_){if(w.forEach)return w.forEach(_);for(var T=0;T<w.length;T+=1)_(w[T],T,w)},r=function(w,_){if(w.map)return w.map(_);var T=[];return t(w,function(p,C,F){T.push(_(p,C,F))}),T},s=function(w,_,T){return w.reduce?w.reduce(_,T):(t(w,function(p,C,F){T=_(T,p,C,F)}),T)},u=function(w){if(Object.keys)return Object.keys(w);var _=[];for(var T in w)w.hasOwnProperty(T)&&_.push(T);return _};typeof process>"u"||!process.nextTick?typeof setImmediate=="function"?(e.nextTick=function(w){setImmediate(w)},e.setImmediate=e.nextTick):(e.nextTick=function(w){setTimeout(w,0)},e.setImmediate=e.nextTick):(e.nextTick=process.nextTick,typeof setImmediate<"u"?e.setImmediate=function(w){setImmediate(w)}:e.setImmediate=e.nextTick),e.each=function(w,_,T){if(T=T||function(){},!w.length)return T();var p=0;t(w,function(C){_(C,a(function(F){F?(T(F),T=function(){}):(p+=1,p>=w.length&&T(null))}))})},e.forEach=e.each,e.eachSeries=function(w,_,T){if(T=T||function(){},!w.length)return T();var p=0,C=function(){_(w[p],function(F){F?(T(F),T=function(){}):(p+=1,p>=w.length?T(null):C())})};C()},e.forEachSeries=e.eachSeries,e.eachLimit=function(w,_,T,p){var C=f(_);C.apply(null,[w,T,p])},e.forEachLimit=e.eachLimit;var f=function(w){return function(_,T,p){if(p=p||function(){},!_.length||w<=0)return p();var C=0,F=0,M=0;(function U(){if(C>=_.length)return p();for(;M<w&&F<_.length;)F+=1,M+=1,T(_[F-1],function(W){W?(p(W),p=function(){}):(C+=1,M-=1,C>=_.length?p():U())})})()}},c=function(w){return function(){var _=Array.prototype.slice.call(arguments);return w.apply(null,[e.each].concat(_))}},h=function(w,_){return function(){var T=Array.prototype.slice.call(arguments);return _.apply(null,[f(w)].concat(T))}},l=function(w){return function(){var _=Array.prototype.slice.call(arguments);return w.apply(null,[e.eachSeries].concat(_))}},g=function(w,_,T,p){var C=[];_=r(_,function(F,M){return{index:M,value:F}}),w(_,function(F,M){T(F.value,function(U,W){C[F.index]=W,M(U)})},function(F){p(F,C)})};e.map=c(g),e.mapSeries=l(g),e.mapLimit=function(w,_,T,p){return y(_)(w,T,p)};var y=function(w){return h(w,g)};e.reduce=function(w,_,T,p){e.eachSeries(w,function(C,F){T(_,C,function(M,U){_=U,F(M)})},function(C){p(C,_)})},e.inject=e.reduce,e.foldl=e.reduce,e.reduceRight=function(w,_,T,p){var C=r(w,function(F){return F}).reverse();e.reduce(C,_,T,p)},e.foldr=e.reduceRight;var b=function(w,_,T,p){var C=[];_=r(_,function(F,M){return{index:M,value:F}}),w(_,function(F,M){T(F.value,function(U){U&&C.push(F),M()})},function(F){p(r(C.sort(function(M,U){return M.index-U.index}),function(M){return M.value}))})};e.filter=c(b),e.filterSeries=l(b),e.select=e.filter,e.selectSeries=e.filterSeries;var O=function(w,_,T,p){var C=[];_=r(_,function(F,M){return{index:M,value:F}}),w(_,function(F,M){T(F.value,function(U){U||C.push(F),M()})},function(F){p(r(C.sort(function(M,U){return M.index-U.index}),function(M){return M.value}))})};e.reject=c(O),e.rejectSeries=l(O);var x=function(w,_,T,p){w(_,function(C,F){T(C,function(M){M?(p(C),p=function(){}):F()})},function(C){p()})};e.detect=c(x),e.detectSeries=l(x),e.some=function(w,_,T){e.each(w,function(p,C){_(p,function(F){F&&(T(!0),T=function(){}),C()})},function(p){T(!1)})},e.any=e.some,e.every=function(w,_,T){e.each(w,function(p,C){_(p,function(F){F||(T(!1),T=function(){}),C()})},function(p){T(!0)})},e.all=e.every,e.sortBy=function(w,_,T){e.map(w,function(p,C){_(p,function(F,M){F?C(F):C(null,{value:p,criteria:M})})},function(p,C){if(p)return T(p);var F=function(M,U){var W=M.criteria,H=U.criteria;return W<H?-1:W>H?1:0};T(null,r(C.sort(F),function(M){return M.value}))})},e.auto=function(w,_){_=_||function(){};var T=u(w);if(!T.length)return _(null);var p={},C=[],F=function(W){C.unshift(W)},M=function(W){for(var H=0;H<C.length;H+=1)if(C[H]===W){C.splice(H,1);return}},U=function(){t(C.slice(0),function(W){W()})};F(function(){u(p).length===T.length&&(_(null,p),_=function(){})}),t(T,function(W){var H=w[W]instanceof Function?[w[W]]:w[W],J=function(he){var fe=Array.prototype.slice.call(arguments,1);if(fe.length<=1&&(fe=fe[0]),he){var Ee={};t(u(p),function(Le){Ee[Le]=p[Le]}),Ee[W]=fe,_(he,Ee),_=function(){}}else p[W]=fe,e.setImmediate(U)},Y=H.slice(0,Math.abs(H.length-1))||[],Te=function(){return s(Y,function(he,fe){return he&&p.hasOwnProperty(fe)},!0)&&!p.hasOwnProperty(W)};if(Te())H[H.length-1](J,p);else{var Oe=function(){Te()&&(M(Oe),H[H.length-1](J,p))};F(Oe)}})},e.waterfall=function(w,_){if(_=_||function(){},w.constructor!==Array){var T=new Error("First argument to waterfall must be an array of functions");return _(T)}if(!w.length)return _();var p=function(C){return function(F){if(F)_.apply(null,arguments),_=function(){};else{var M=Array.prototype.slice.call(arguments,1),U=C.next();U?M.push(p(U)):M.push(_),e.setImmediate(function(){C.apply(null,M)})}}};p(e.iterator(w))()};var v=function(w,_,T){if(T=T||function(){},_.constructor===Array)w.map(_,function(C,F){C&&C(function(M){var U=Array.prototype.slice.call(arguments,1);U.length<=1&&(U=U[0]),F.call(null,M,U)})},T);else{var p={};w.each(u(_),function(C,F){_[C](function(M){var U=Array.prototype.slice.call(arguments,1);U.length<=1&&(U=U[0]),p[C]=U,F(M)})},function(C){T(C,p)})}};e.parallel=function(w,_){v({map:e.map,each:e.each},w,_)},e.parallelLimit=function(w,_,T){v({map:y(_),each:f(_)},w,T)},e.series=function(w,_){if(_=_||function(){},w.constructor===Array)e.mapSeries(w,function(p,C){p&&p(function(F){var M=Array.prototype.slice.call(arguments,1);M.length<=1&&(M=M[0]),C.call(null,F,M)})},_);else{var T={};e.eachSeries(u(w),function(p,C){w[p](function(F){var M=Array.prototype.slice.call(arguments,1);M.length<=1&&(M=M[0]),T[p]=M,C(F)})},function(p){_(p,T)})}},e.iterator=function(w){var _=function(T){var p=function(){return w.length&&w[T].apply(null,arguments),p.next()};return p.next=function(){return T<w.length-1?_(T+1):null},p};return _(0)},e.apply=function(w){var _=Array.prototype.slice.call(arguments,1);return function(){return w.apply(null,_.concat(Array.prototype.slice.call(arguments)))}};var m=function(w,_,T,p){var C=[];w(_,function(F,M){T(F,function(U,W){C=C.concat(W||[]),M(U)})},function(F){p(F,C)})};e.concat=c(m),e.concatSeries=l(m),e.whilst=function(w,_,T){w()?_(function(p){if(p)return T(p);e.whilst(w,_,T)}):T()},e.doWhilst=function(w,_,T){w(function(p){if(p)return T(p);_()?e.doWhilst(w,_,T):T()})},e.until=function(w,_,T){w()?T():_(function(p){if(p)return T(p);e.until(w,_,T)})},e.doUntil=function(w,_,T){w(function(p){if(p)return T(p);_()?T():e.doUntil(w,_,T)})},e.queue=function(w,_){_===void 0&&(_=1);function T(F,M,U,W){M.constructor!==Array&&(M=[M]),t(M,function(H){var J={data:H,callback:typeof W=="function"?W:null};U?F.tasks.unshift(J):F.tasks.push(J),F.saturated&&F.tasks.length===_&&F.saturated(),e.setImmediate(F.process)})}var p=0,C={tasks:[],concurrency:_,saturated:null,empty:null,drain:null,push:function(F,M){T(C,F,!1,M)},unshift:function(F,M){T(C,F,!0,M)},process:function(){if(p<C.concurrency&&C.tasks.length){var F=C.tasks.shift();C.empty&&C.tasks.length===0&&C.empty(),p+=1;var M=function(){p-=1,F.callback&&F.callback.apply(F,arguments),C.drain&&C.tasks.length+p===0&&C.drain(),C.process()},U=a(M);w(F.data,U)}},length:function(){return C.tasks.length},running:function(){return p}};return C},e.cargo=function(w,_){var T=!1,p=[],C={tasks:p,payload:_,saturated:null,empty:null,drain:null,push:function(F,M){F.constructor!==Array&&(F=[F]),t(F,function(U){p.push({data:U,callback:typeof M=="function"?M:null}),C.saturated&&p.length===_&&C.saturated()}),e.setImmediate(C.process)},process:function F(){if(!T){if(p.length===0){C.drain&&C.drain();return}var M=typeof _=="number"?p.splice(0,_):p.splice(0),U=r(M,function(W){return W.data});C.empty&&C.empty(),T=!0,w(U,function(){T=!1;var W=arguments;t(M,function(H){H.callback&&H.callback.apply(null,W)}),F()})}},length:function(){return p.length},running:function(){return T}};return C};var D=function(w){return function(_){var T=Array.prototype.slice.call(arguments,1);_.apply(null,T.concat([function(p){var C=Array.prototype.slice.call(arguments,1);typeof console<"u"&&(p?console.error&&console.error(p):console[w]&&t(C,function(F){console[w](F)}))}]))}};e.log=D("log"),e.dir=D("dir"),e.memoize=function(w,_){var T={},p={};_=_||function(F){return F};var C=function(){var F=Array.prototype.slice.call(arguments),M=F.pop(),U=_.apply(null,F);U in T?M.apply(null,T[U]):U in p?p[U].push(M):(p[U]=[M],w.apply(null,F.concat([function(){T[U]=arguments;var W=p[U];delete p[U];for(var H=0,J=W.length;H<J;H++)W[H].apply(null,arguments)}])))};return C.memo=T,C.unmemoized=w,C},e.unmemoize=function(w){return function(){return(w.unmemoized||w).apply(null,arguments)}},e.times=function(w,_,T){for(var p=[],C=0;C<w;C++)p.push(C);return e.map(p,_,T)},e.timesSeries=function(w,_,T){for(var p=[],C=0;C<w;C++)p.push(C);return e.mapSeries(p,_,T)},e.compose=function(){var w=Array.prototype.reverse.call(arguments);return function(){var _=this,T=Array.prototype.slice.call(arguments),p=T.pop();e.reduce(w,T,function(C,F,M){F.apply(_,C.concat([function(){var U=arguments[0],W=Array.prototype.slice.call(arguments,1);M(U,W)}]))},function(C,F){p.apply(_,[C].concat(F))})}};var A=function(w,_){var T=function(){var C=this,F=Array.prototype.slice.call(arguments),M=F.pop();return w(_,function(U,W){U.apply(C,F.concat([W]))},M)};if(arguments.length>2){var p=Array.prototype.slice.call(arguments,2);return T.apply(this,p)}else return T};e.applyEach=c(A),e.applyEachSeries=l(A),e.forever=function(w,_){function T(p){if(p){if(_)return _(p);throw p}w(T)}T()},o.exports?o.exports=e:n.async=e})()}(Vt)),Vt.exports}var zt,ui;function va(){if(ui)return zt;ui=1;var o=rt.spawn,e=xn(),n=Se;function i(a){a._inputs[0].isStream||a.ffprobe(0,function(r,s){a._ffprobeData=s})}return zt=function(a){a._spawnFfmpeg=function(t,r,s,u){typeof r=="function"&&(u=s,s=r,r={}),typeof u>"u"&&(u=s,s=function(){});var f="stdoutLines"in r?r.stdoutLines:this.options.stdoutLines;this._getFfmpegPath(function(c,h){if(c)return u(c);if(!h||h.length===0)return u(new Error("Cannot find ffmpeg"));r.niceness&&r.niceness!==0&&!n.isWindows&&(t.unshift("-n",r.niceness,h),h="nice");var l=n.linesRing(f),g=!1,y=n.linesRing(f),b=!1,O=o(h,t,r);O.stderr&&O.stderr.setEncoding("utf8"),O.on("error",function(D){u(D)});var x=null;function v(D){D&&(x=D),m&&(g||!r.captureStdout)&&b&&u(x,l,y)}var m=!1;O.on("exit",function(D,A){m=!0,A?v(new Error("ffmpeg was killed with signal "+A)):D?v(new Error("ffmpeg exited with code "+D)):v()}),r.captureStdout&&(O.stdout.on("data",function(D){l.append(D)}),O.stdout.on("close",function(){l.close(),g=!0,v()})),O.stderr.on("data",function(D){y.append(D)}),O.stderr.on("close",function(){y.close(),b=!0,v()}),s(O,l,y)})},a._getArguments=function(){var t=this._complexFilters.get(),r=this._outputs.some(function(s){return s.isFile});return[].concat(this._inputs.reduce(function(s,u){var f=typeof u.source=="string"?u.source:"pipe:0";return s.concat(u.options.get(),["-i",f])},[]),this._global.get(),r?["-y"]:[],t,this._outputs.reduce(function(s,u){var f=n.makeFilterStrings(u.sizeFilters.get()),c=u.audioFilters.get(),h=u.videoFilters.get().concat(f),l;return u.target?typeof u.target=="string"?l=[u.target]:l=["pipe:1"]:l=[],s.concat(u.audio.get(),c.length?["-filter:a",c.join(",")]:[],u.video.get(),h.length?["-filter:v",h.join(",")]:[],u.options.get(),l)},[]))},a._prepare=function(t,r){var s=this;e.waterfall([function(u){s._checkCapabilities(u)},function(u){if(!r)return u();s.ffprobe(0,function(f,c){f||(s._ffprobeData=c),u()})},function(u){var f=s._outputs.some(function(c){return c.flags.flvmeta&&!c.isFile&&(s.logger.warn("Updating flv metadata is only supported for files"),c.flags.flvmeta=!1),c.flags.flvmeta});f?s._getFlvtoolPath(function(c){u(c)}):u()},function(u){var f;try{f=s._getArguments()}catch(c){return u(c)}u(null,f)},function(u,f){s.availableEncoders(function(c,h){for(var l=0;l<u.length;l++)(u[l]==="-acodec"||u[l]==="-vcodec")&&(l++,u[l]in h&&h[u[l]].experimental&&(u.splice(l+1,0,"-strict","experimental"),l+=2));f(null,u)})}],t),r||(this.listeners("progress").length>0?i(this):this.once("newListener",function(u){u==="progress"&&i(this)}))},a.exec=a.execute=a.run=function(){var t=this,r=this._outputs.some(function(h){return"target"in h});if(!r)throw new Error("No output specified");var s=this._outputs.filter(function(h){return typeof h.target!="string"})[0],u=this._inputs.filter(function(h){return typeof h.source!="string"})[0],f=!1;function c(h,l,g){f||(f=!0,h?t.emit("error",h,l,g):t.emit("end",l,g))}return t._prepare(function(h,l){if(h)return c(h);t._spawnFfmpeg(l,{captureStdout:!s,niceness:t.options.niceness,cwd:t.options.cwd,windowsHide:!0},function(y,b,O){if(t.ffmpegProc=y,t.emit("start","ffmpeg "+l.join(" ")),u&&(u.source.on("error",function(m){var D=new Error("Input stream error: "+m.message);D.inputStreamError=m,c(D),y.kill()}),u.source.resume(),u.source.pipe(y.stdin),y.stdin.on("error",function(){})),t.options.timeout&&(t.processTimer=setTimeout(function(){var m="process ran into a timeout ("+t.options.timeout+"s)";c(new Error(m),b.get(),O.get()),y.kill()},t.options.timeout*1e3)),s&&(y.stdout.pipe(s.target,s.pipeopts),s.target.on("close",function(){t.logger.debug("Output stream closed, scheduling kill for ffmpeg process"),setTimeout(function(){c(new Error("Output stream closed")),y.kill()},20)}),s.target.on("error",function(m){t.logger.debug("Output stream error, killing ffmpeg process");var D=new Error("Output stream error: "+m.message);D.outputStreamError=m,c(D,b.get(),O.get()),y.kill("SIGKILL")})),O){if(t.listeners("stderr").length&&O.callback(function(m){t.emit("stderr",m)}),t.listeners("codecData").length){var x=!1,v={};O.callback(function(m){x||(x=n.extractCodecData(t,m,v))})}t.listeners("progress").length&&O.callback(function(m){n.extractProgress(t,m)})}},function(y,b,O){if(clearTimeout(t.processTimer),delete t.ffmpegProc,y)y.message.match(/ffmpeg exited with code/)&&(y.message+=": "+n.extractError(O.get())),c(y,b.get(),O.get());else{var x=t._outputs.filter(function(v){return v.flags.flvmeta});x.length?t._getFlvtoolPath(function(v,m){if(v)return c(v);e.each(x,function(D,A){o(m,["-U",D.target],{windowsHide:!0}).on("error",function(w){A(new Error("Error running "+m+" on "+D.target+": "+w.message))}).on("exit",function(w,_){w!==0||_?A(new Error(m+" "+(_?"received signal "+_:"exited with code "+w))+" when running on "+D.target):A()})},function(D){D?c(D):c(null,b.get(),O.get())})}):c(null,b.get(),O.get())}})}),this},a.renice=function(t){if(!n.isWindows&&(t=t||0,(t<-20||t>20)&&this.logger.warn("Invalid niceness value: "+t+", must be between -20 and 20"),t=Math.min(20,Math.max(-20,t)),this.options.niceness=t,this.ffmpegProc)){var r=this.logger,s=this.ffmpegProc.pid,u=o("renice",[t,"-p",s],{windowsHide:!0});u.on("error",function(f){r.warn("could not renice process "+s+": "+f.message)}),u.on("exit",function(f,c){c?r.warn("could not renice process "+s+": renice was killed by signal "+c):f?r.warn("could not renice process "+s+": renice exited with "+f):r.info("successfully reniced process "+s+" to "+t+" niceness")})}return this},a.kill=function(t){return this.ffmpegProc?this.ffmpegProc.kill(t||"SIGKILL"):this.logger.warn("No running ffmpeg process, cannot send signal"),this}},zt}var Wt,ci;function wa(){if(ci)return Wt;ci=1;var o=ae,e=Q,n=xn(),i=Se,a=/^\s*([D ])([E ])([VAS])([S ])([D ])([T ]) ([^ ]+) +(.*)$/,t=/^\s*([D\.])([E\.])([VAS])([I\.])([L\.])([S\.]) ([^ ]+) +(.*)$/,r=/\(encoders:([^\)]+)\)/,s=/\(decoders:([^\)]+)\)/,u=/^\s*([VAS\.])([F\.])([S\.])([X\.])([B\.])([D\.]) ([^ ]+) +(.*)$/,f=/^\s*([D ])([E ])\s+([^ ]+)\s+(.*)$/,c=/\r\n|\r|\n/,h=/^(?: [T\.][S\.][C\.] )?([^ ]+) +(AA?|VV?|\|)->(AA?|VV?|\|) +(.*)$/,l={};return Wt=function(g){g.setFfmpegPath=function(y){return l.ffmpegPath=y,this},g.setFfprobePath=function(y){return l.ffprobePath=y,this},g.setFlvtoolPath=function(y){return l.flvtoolPath=y,this},g._forgetPaths=function(){delete l.ffmpegPath,delete l.ffprobePath,delete l.flvtoolPath},g._getFfmpegPath=function(y){if("ffmpegPath"in l)return y(null,l.ffmpegPath);n.waterfall([function(b){process.env.FFMPEG_PATH?o.exists(process.env.FFMPEG_PATH,function(O){O?b(null,process.env.FFMPEG_PATH):b(null,"")}):b(null,"")},function(b,O){if(b.length)return O(null,b);i.which("ffmpeg",function(x,v){O(x,v)})}],function(b,O){b?y(b):y(null,l.ffmpegPath=O||"")})},g._getFfprobePath=function(y){var b=this;if("ffprobePath"in l)return y(null,l.ffprobePath);n.waterfall([function(O){process.env.FFPROBE_PATH?o.exists(process.env.FFPROBE_PATH,function(x){O(null,x?process.env.FFPROBE_PATH:"")}):O(null,"")},function(O,x){if(O.length)return x(null,O);i.which("ffprobe",function(v,m){x(v,m)})},function(O,x){if(O.length)return x(null,O);b._getFfmpegPath(function(v,m){if(v)x(v);else if(m.length){var D=i.isWindows?"ffprobe.exe":"ffprobe",A=e.join(e.dirname(m),D);o.exists(A,function(w){x(null,w?A:"")})}else x(null,"")})}],function(O,x){O?y(O):y(null,l.ffprobePath=x||"")})},g._getFlvtoolPath=function(y){if("flvtoolPath"in l)return y(null,l.flvtoolPath);n.waterfall([function(b){process.env.FLVMETA_PATH?o.exists(process.env.FLVMETA_PATH,function(O){b(null,O?process.env.FLVMETA_PATH:"")}):b(null,"")},function(b,O){if(b.length)return O(null,b);process.env.FLVTOOL2_PATH?o.exists(process.env.FLVTOOL2_PATH,function(x){O(null,x?process.env.FLVTOOL2_PATH:"")}):O(null,"")},function(b,O){if(b.length)return O(null,b);i.which("flvmeta",function(x,v){O(x,v)})},function(b,O){if(b.length)return O(null,b);i.which("flvtool2",function(x,v){O(x,v)})}],function(b,O){b?y(b):y(null,l.flvtoolPath=O||"")})},g.availableFilters=g.getAvailableFilters=function(y){if("filters"in l)return y(null,l.filters);this._spawnFfmpeg(["-filters"],{captureStdout:!0,stdoutLines:0},function(b,O){if(b)return y(b);var x=O.get(),v=x.split(`
`),m={},D={A:"audio",V:"video","|":"none"};v.forEach(function(A){var w=A.match(h);w&&(m[w[1]]={description:w[4],input:D[w[2].charAt(0)],multipleInputs:w[2].length>1,output:D[w[3].charAt(0)],multipleOutputs:w[3].length>1})}),y(null,l.filters=m)})},g.availableCodecs=g.getAvailableCodecs=function(y){if("codecs"in l)return y(null,l.codecs);this._spawnFfmpeg(["-codecs"],{captureStdout:!0,stdoutLines:0},function(b,O){if(b)return y(b);var x=O.get(),v=x.split(c),m={};v.forEach(function(D){var A=D.match(a);if(A&&A[7]!=="="&&(m[A[7]]={type:{V:"video",A:"audio",S:"subtitle"}[A[3]],description:A[8],canDecode:A[1]==="D",canEncode:A[2]==="E",drawHorizBand:A[4]==="S",directRendering:A[5]==="D",weirdFrameTruncation:A[6]==="T"}),A=D.match(t),A&&A[7]!=="="){var w=m[A[7]]={type:{V:"video",A:"audio",S:"subtitle"}[A[3]],description:A[8],canDecode:A[1]==="D",canEncode:A[2]==="E",intraFrameOnly:A[4]==="I",isLossy:A[5]==="L",isLossless:A[6]==="S"},_=w.description.match(r);_=_?_[1].trim().split(" "):[];var T=w.description.match(s);if(T=T?T[1].trim().split(" "):[],_.length||T.length){var p={};i.copy(w,p),delete p.canEncode,delete p.canDecode,_.forEach(function(C){m[C]={},i.copy(p,m[C]),m[C].canEncode=!0}),T.forEach(function(C){C in m||(m[C]={},i.copy(p,m[C])),m[C].canDecode=!0})}}}),y(null,l.codecs=m)})},g.availableEncoders=g.getAvailableEncoders=function(y){if("encoders"in l)return y(null,l.encoders);this._spawnFfmpeg(["-encoders"],{captureStdout:!0,stdoutLines:0},function(b,O){if(b)return y(b);var x=O.get(),v=x.split(c),m={};v.forEach(function(D){var A=D.match(u);A&&A[7]!=="="&&(m[A[7]]={type:{V:"video",A:"audio",S:"subtitle"}[A[1]],description:A[8],frameMT:A[2]==="F",sliceMT:A[3]==="S",experimental:A[4]==="X",drawHorizBand:A[5]==="B",directRendering:A[6]==="D"})}),y(null,l.encoders=m)})},g.availableFormats=g.getAvailableFormats=function(y){if("formats"in l)return y(null,l.formats);this._spawnFfmpeg(["-formats"],{captureStdout:!0,stdoutLines:0},function(b,O){if(b)return y(b);var x=O.get(),v=x.split(c),m={};v.forEach(function(D){var A=D.match(f);A&&A[3].split(",").forEach(function(w){w in m||(m[w]={description:A[4],canDemux:!1,canMux:!1}),A[1]==="D"&&(m[w].canDemux=!0),A[2]==="E"&&(m[w].canMux=!0)})}),y(null,l.formats=m)})},g._checkCapabilities=function(y){var b=this;n.waterfall([function(O){b.availableFormats(O)},function(O,x){var v;if(v=b._outputs.reduce(function(m,D){var A=D.options.find("-f",1);return A&&(!(A[0]in O)||!O[A[0]].canMux)&&m.push(A),m},[]),v.length===1)return x(new Error("Output format "+v[0]+" is not available"));if(v.length>1)return x(new Error("Output formats "+v.join(", ")+" are not available"));if(v=b._inputs.reduce(function(m,D){var A=D.options.find("-f",1);return A&&(!(A[0]in O)||!O[A[0]].canDemux)&&m.push(A[0]),m},[]),v.length===1)return x(new Error("Input format "+v[0]+" is not available"));if(v.length>1)return x(new Error("Input formats "+v.join(", ")+" are not available"));x()},function(O){b.availableEncoders(O)},function(O,x){var v;if(v=b._outputs.reduce(function(m,D){var A=D.audio.find("-acodec",1);return A&&A[0]!=="copy"&&(!(A[0]in O)||O[A[0]].type!=="audio")&&m.push(A[0]),m},[]),v.length===1)return x(new Error("Audio codec "+v[0]+" is not available"));if(v.length>1)return x(new Error("Audio codecs "+v.join(", ")+" are not available"));if(v=b._outputs.reduce(function(m,D){var A=D.video.find("-vcodec",1);return A&&A[0]!=="copy"&&(!(A[0]in O)||O[A[0]].type!=="video")&&m.push(A[0]),m},[]),v.length===1)return x(new Error("Video codec "+v[0]+" is not available"));if(v.length>1)return x(new Error("Video codecs "+v.join(", ")+" are not available"));x()}],y)}},Wt}var Ht,li;function Ea(){if(li)return Ht;li=1;var o=rt.spawn;function e(a){return a.match(/^TAG:/)}function n(a){return a.match(/^DISPOSITION:/)}function i(a){var t=a.split(/\r\n|\r|\n/);t=t.filter(function(h){return h.length>0});var r={streams:[],format:{},chapters:[]};function s(h){for(var l={},g=t.shift();typeof g<"u";){if(g.toLowerCase()=="[/"+h+"]")return l;if(g.match(/^\[/)){g=t.shift();continue}var y=g.match(/^([^=]+)=(.*)$/);y&&(!y[1].match(/^TAG:/)&&y[2].match(/^[0-9]+(\.[0-9]+)?$/)?l[y[1]]=Number(y[2]):l[y[1]]=y[2]),g=t.shift()}return l}for(var u=t.shift();typeof u<"u";){if(u.match(/^\[stream/i)){var f=s("stream");r.streams.push(f)}else if(u.match(/^\[chapter/i)){var c=s("chapter");r.chapters.push(c)}else u.toLowerCase()==="[format]"&&(r.format=s("format"));u=t.shift()}return r}return Ht=function(a){a.ffprobe=function(){var t,r=null,s=[],u,u=arguments[arguments.length-1],f=!1;function c(h,l){f||(f=!0,u(h,l))}switch(arguments.length){case 3:r=arguments[0],s=arguments[1];break;case 2:typeof arguments[0]=="number"?r=arguments[0]:Array.isArray(arguments[0])&&(s=arguments[0]);break}if(r===null){if(!this._currentInput)return c(new Error("No input specified"));t=this._currentInput}else if(t=this._inputs[r],!t)return c(new Error("Invalid input index"));this._getFfprobePath(function(h,l){if(h)return c(h);if(!l)return c(new Error("Cannot find ffprobe"));var g="",y=!1,b="",O=!1,x=t.isStream?"pipe:0":t.source,v=o(l,["-show_streams","-show_format"].concat(s,x),{windowsHide:!0});t.isStream&&(v.stdin.on("error",function(w){["ECONNRESET","EPIPE","EOF"].indexOf(w.code)>=0||c(w)}),v.stdin.on("close",function(){t.source.pause(),t.source.unpipe(v.stdin)}),t.source.pipe(v.stdin)),v.on("error",u);var m=null;function D(w){if(w&&(m=w),A&&y&&O){if(m)return b&&(m.message+=`
`+b),c(m);var _=i(g);[_.format].concat(_.streams).forEach(function(T){if(T){var p=Object.keys(T).filter(e);p.length&&(T.tags=T.tags||{},p.forEach(function(F){T.tags[F.substr(4)]=T[F],delete T[F]}));var C=Object.keys(T).filter(n);C.length&&(T.disposition=T.disposition||{},C.forEach(function(F){T.disposition[F.substr(12)]=T[F],delete T[F]}))}}),c(null,_)}}var A=!1;v.on("exit",function(w,_){A=!0,w?D(new Error("ffprobe exited with code "+w)):_?D(new Error("ffprobe was killed with signal "+_)):D()}),v.stdout.on("data",function(w){g+=w}),v.stdout.on("close",function(){y=!0,D()}),v.stderr.on("data",function(w){b+=w}),v.stderr.on("close",function(){O=!0,D()})})}},Ht}var Gt,fi;function ba(){if(fi)return Gt;fi=1;var o=ae,e=Q,n=zs.PassThrough,i=xn(),a=Se;return Gt=function(r){r.saveToFile=r.save=function(s){return this.output(s).run(),this},r.writeToStream=r.pipe=r.stream=function(s,u){if(s&&!("writable"in s)&&(u=s,s=void 0),!s){if(process.version.match(/v0\.8\./))throw new Error("PassThrough stream is not supported on node v0.8");s=new n}return this.output(s,u).run(),s},r.takeScreenshots=r.thumbnail=r.thumbnails=r.screenshot=r.screenshots=function(s,u){var f=this,c=this._currentInput.source;if(s=s||{count:1},typeof s=="number"&&(s={count:s}),"folder"in s||(s.folder=u||"."),"timestamps"in s&&(s.timemarks=s.timestamps),!("timemarks"in s)){if(!s.count)throw new Error("Cannot take screenshots: neither a count nor a timemark list are specified");var h=100/(1+s.count);s.timemarks=[];for(var l=0;l<s.count;l++)s.timemarks.push(h*(l+1)+"%")}if("size"in s){var g=s.size.match(/^(\d+)x(\d+)$/),y=s.size.match(/^(\d+)x\?$/),b=s.size.match(/^\?x(\d+)$/),O=s.size.match(/^(\d+)%$/);if(!g&&!y&&!b&&!O)throw new Error("Invalid size parameter: "+s.size)}var x;function v(m){x?m(null,x):f.ffprobe(function(D,A){x=A,m(D,A)})}return i.waterfall([function(D){if(s.timemarks.some(function(A){return(""+A).match(/^[\d.]+%$/)})){if(typeof c!="string")return D(new Error("Cannot compute screenshot timemarks with an input stream, please specify fixed timemarks"));v(function(A,w){if(A)D(A);else{var _=w.streams.reduce(function(p,C){return C.codec_type==="video"&&C.width*C.height>p.width*p.height?C:p},{width:0,height:0});if(_.width===0)return D(new Error("No video stream in input, cannot take screenshots"));var T=Number(_.duration);if(isNaN(T)&&(T=Number(w.format.duration)),isNaN(T))return D(new Error("Could not get input duration, please specify fixed timemarks"));s.timemarks=s.timemarks.map(function(p){return(""+p).match(/^([\d.]+)%$/)?T*parseFloat(p)/100:p}),D()}})}else D()},function(D){s.timemarks=s.timemarks.map(function(A){return a.timemarkToSeconds(A)}).sort(function(A,w){return A-w}),D()},function(D){var A=s.filename||"tn.png";if(A.indexOf(".")===-1&&(A+=".png"),s.timemarks.length>1&&!A.match(/%(s|0*i)/)){var w=e.extname(A);A=e.join(e.dirname(A),e.basename(A,w)+"_%i"+w)}D(null,A)},function(D,A){if(D.match(/%[bf]/)){if(typeof c!="string")return A(new Error("Cannot replace %f or %b when using an input stream"));D=D.replace(/%f/g,e.basename(c)).replace(/%b/g,e.basename(c,e.extname(c)))}A(null,D)},function(D,A){if(D.match(/%[whr]/)){if(g)return A(null,D,g[1],g[2]);v(function(w,_){if(w)return A(new Error("Could not determine video resolution to replace %w, %h or %r"));var T=_.streams.reduce(function(F,M){return M.codec_type==="video"&&M.width*M.height>F.width*F.height?M:F},{width:0,height:0});if(T.width===0)return A(new Error("No video stream in input, cannot replace %w, %h or %r"));var p=T.width,C=T.height;y?(C=C*Number(y[1])/p,p=Number(y[1])):b?(p=p*Number(b[1])/C,C=Number(b[1])):O&&(p=p*Number(O[1])/100,C=C*Number(O[1])/100),A(null,D,Math.round(p/2)*2,Math.round(C/2)*2)})}else A(null,D,-1,-1)},function(D,A,w,_){D=D.replace(/%r/g,"%wx%h").replace(/%w/g,A).replace(/%h/g,w),_(null,D)},function(D,A){var w=s.timemarks.map(function(_,T){return D.replace(/%s/g,a.timemarkToSeconds(_)).replace(/%(0*)i/g,function(p,C){var F=""+(T+1);return C.substr(0,Math.max(0,C.length+1-F.length))+F})});f.emit("filenames",w),A(null,w)},function(D,A){o.exists(s.folder,function(w){w?A(null,D):o.mkdir(s.folder,function(_){_?A(_):A(null,D)})})}],function(D,A){if(D)return f.emit("error",D);var w=s.timemarks.length,_,T=[_={filter:"split",options:w,outputs:[]}];if("size"in s){f.size(s.size);var p=f._currentOutput.sizeFilters.get().map(function(U,W){return W>0&&(U.inputs="size"+(W-1)),U.outputs="size"+W,U});_.inputs="size"+(p.length-1),T=p.concat(T),f._currentOutput.sizeFilters.clear()}for(var C=0,F=0;F<w;F++){var M="screen"+F;_.outputs.push(M),F===0&&(C=s.timemarks[F],f.seekInput(C)),f.output(e.join(s.folder,A[F])).frames(1).map(M),F>0&&f.seek(s.timemarks[F]-C)}f.complexFilter(T),f.run()}),this},r.mergeToFile=r.concatenate=r.concat=function(s,u){var f=this._inputs.filter(function(h){return!h.isStream})[0],c=this;return this.ffprobe(this._inputs.indexOf(f),function(h,l){if(h)return c.emit("error",h);var g=l.streams.some(function(b){return b.codec_type==="audio"}),y=l.streams.some(function(b){return b.codec_type==="video"});c.output(s,u).complexFilter({filter:"concat",options:{n:c._inputs.length,v:y?1:0,a:g?1:0}}).run()}),this}},Gt}var Ta=Q,Oa=tt,is=Be.EventEmitter,wn=Se;function te(o,e){if(!(this instanceof te))return new te(o,e);is.call(this),typeof o=="object"&&!("readable"in o)?e=o:(e=e||{},e.source=o),this._inputs=[],e.source&&this.input(e.source),this._outputs=[],this.output();var n=this;["_global","_complexFilters"].forEach(function(i){n[i]=wn.args()}),e.stdoutLines="stdoutLines"in e?e.stdoutLines:100,e.presets=e.presets||e.preset||Ta.join(__dirname,"presets"),e.niceness=e.niceness||e.priority||0,this.options=e,this.logger=e.logger||{debug:function(){},info:function(){},warn:function(){},error:function(){}}}Oa.inherits(te,is);var Ca=te;te.prototype.clone=function(){var o=new te,e=this;return o.options=this.options,o.logger=this.logger,o._inputs=this._inputs.map(function(n){return{source:n.source,options:n.options.clone()}}),"target"in this._outputs[0]?(o._outputs=[],o.output()):(o._outputs=[o._currentOutput={flags:{}}],["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(n){o._currentOutput[n]=e._currentOutput[n].clone()}),this._currentOutput.sizeData&&(o._currentOutput.sizeData={},wn.copy(this._currentOutput.sizeData,o._currentOutput.sizeData)),wn.copy(this._currentOutput.flags,o._currentOutput.flags)),["_global","_complexFilters"].forEach(function(n){o[n]=e[n].clone()}),o};la()(te.prototype);fa()(te.prototype);pa()(te.prototype);ha()(te.prototype);da()(te.prototype);ma()(te.prototype);ya()(te.prototype);va()(te.prototype);wa()(te.prototype);te.setFfmpegPath=function(o){new te().setFfmpegPath(o)};te.setFfprobePath=function(o){new te().setFfprobePath(o)};te.setFlvtoolPath=function(o){new te().setFlvtoolPath(o)};te.availableFilters=te.getAvailableFilters=function(o){new te().availableFilters(o)};te.availableCodecs=te.getAvailableCodecs=function(o){new te().availableCodecs(o)};te.availableFormats=te.getAvailableFormats=function(o){new te().availableFormats(o)};te.availableEncoders=te.getAvailableEncoders=function(o){new te().availableEncoders(o)};Ea()(te.prototype);te.ffprobe=function(o){var e=new te(o);e.ffprobe.apply(e,Array.prototype.slice.call(arguments,1))};ba()(te.prototype);var os=Ca;const Ze=bt(os);var mt={exports:{}},Kt={exports:{}},pi;function ss(){return pi||(pi=1,function(o){let e={};try{e=require("electron")}catch{}e.ipcRenderer&&n(e),o.exports=n;function n({contextBridge:i,ipcRenderer:a}){if(!a)return;a.on("__ELECTRON_LOG_IPC__",(r,s)=>{window.postMessage({cmd:"message",...s})}),a.invoke("__ELECTRON_LOG__",{cmd:"getOptions"}).catch(r=>console.error(new Error(`electron-log isn't initialized in the main process. Please call log.initialize() before. ${r.message}`)));const t={sendToMain(r){try{a.send("__ELECTRON_LOG__",r)}catch(s){console.error("electronLog.sendToMain ",s,"data:",r),a.send("__ELECTRON_LOG__",{cmd:"errorHandler",error:{message:s==null?void 0:s.message,stack:s==null?void 0:s.stack},errorName:"sendToMain"})}},log(...r){t.sendToMain({data:r,level:"info"})}};for(const r of["error","warn","info","verbose","debug","silly"])t[r]=(...s)=>t.sendToMain({data:s,level:r});if(i&&process.contextIsolated)try{i.exposeInMainWorld("__electronLog",t)}catch{}typeof window=="object"?window.__electronLog=t:__electronLog=t}}(Kt)),Kt.exports}var Yt={exports:{}},Jt,hi;function Da(){if(hi)return Jt;hi=1,Jt=o;function o(e){return Object.defineProperties(n,{defaultLabel:{value:"",writable:!0},labelPadding:{value:!0,writable:!0},maxLabelLength:{value:0,writable:!0},labelLength:{get(){switch(typeof n.labelPadding){case"boolean":return n.labelPadding?n.maxLabelLength:0;case"number":return n.labelPadding;default:return 0}}}});function n(i){n.maxLabelLength=Math.max(n.maxLabelLength,i.length);const a={};for(const t of e.levels)a[t]=(...r)=>e.logData(r,{level:t,scope:i});return a.log=a.info,a}}return Jt}var Qt,di;function Aa(){if(di)return Qt;di=1;class o{constructor({processMessage:n}){this.processMessage=n,this.buffer=[],this.enabled=!1,this.begin=this.begin.bind(this),this.commit=this.commit.bind(this),this.reject=this.reject.bind(this)}addMessage(n){this.buffer.push(n)}begin(){this.enabled=[]}commit(){this.enabled=!1,this.buffer.forEach(n=>this.processMessage(n)),this.buffer=[]}reject(){this.enabled=!1,this.buffer=[]}}return Qt=o,Qt}var Zt,mi;function as(){if(mi)return Zt;mi=1;const o=Da(),e=Aa(),i=class i{constructor({allowUnknownLevel:t=!1,dependencies:r={},errorHandler:s,eventLogger:u,initializeFn:f,isDev:c=!1,levels:h=["error","warn","info","verbose","debug","silly"],logId:l,transportFactories:g={},variables:y}={}){Z(this,"dependencies",{});Z(this,"errorHandler",null);Z(this,"eventLogger",null);Z(this,"functions",{});Z(this,"hooks",[]);Z(this,"isDev",!1);Z(this,"levels",null);Z(this,"logId",null);Z(this,"scope",null);Z(this,"transports",{});Z(this,"variables",{});this.addLevel=this.addLevel.bind(this),this.create=this.create.bind(this),this.initialize=this.initialize.bind(this),this.logData=this.logData.bind(this),this.processMessage=this.processMessage.bind(this),this.allowUnknownLevel=t,this.buffering=new e(this),this.dependencies=r,this.initializeFn=f,this.isDev=c,this.levels=h,this.logId=l,this.scope=o(this),this.transportFactories=g,this.variables=y||{};for(const b of this.levels)this.addLevel(b,!1);this.log=this.info,this.functions.log=this.log,this.errorHandler=s,s==null||s.setOptions({...r,logFn:this.error}),this.eventLogger=u,u==null||u.setOptions({...r,logger:this});for(const[b,O]of Object.entries(g))this.transports[b]=O(this,r);i.instances[l]=this}static getInstance({logId:t}){return this.instances[t]||this.instances.default}addLevel(t,r=this.levels.length){r!==!1&&this.levels.splice(r,0,t),this[t]=(...s)=>this.logData(s,{level:t}),this.functions[t]=this[t]}catchErrors(t){return this.processMessage({data:["log.catchErrors is deprecated. Use log.errorHandler instead"],level:"warn"},{transports:["console"]}),this.errorHandler.startCatching(t)}create(t){return typeof t=="string"&&(t={logId:t}),new i({dependencies:this.dependencies,errorHandler:this.errorHandler,initializeFn:this.initializeFn,isDev:this.isDev,transportFactories:this.transportFactories,variables:{...this.variables},...t})}compareLevels(t,r,s=this.levels){const u=s.indexOf(t),f=s.indexOf(r);return f===-1||u===-1?!0:f<=u}initialize(t={}){this.initializeFn({logger:this,...this.dependencies,...t})}logData(t,r={}){this.buffering.enabled?this.buffering.addMessage({data:t,date:new Date,...r}):this.processMessage({data:t,...r})}processMessage(t,{transports:r=this.transports}={}){if(t.cmd==="errorHandler"){this.errorHandler.handle(t.error,{errorName:t.errorName,processType:"renderer",showDialog:!!t.showDialog});return}let s=t.level;this.allowUnknownLevel||(s=this.levels.includes(t.level)?t.level:"info");const u={date:new Date,logId:this.logId,...t,level:s,variables:{...this.variables,...t.variables}};for(const[f,c]of this.transportEntries(r))if(!(typeof c!="function"||c.level===!1)&&this.compareLevels(c.level,t.level))try{const h=this.hooks.reduce((l,g)=>l&&g(l,c,f),u);h&&c({...h,data:[...h.data]})}catch(h){this.processInternalErrorFn(h)}}processInternalErrorFn(t){}transportEntries(t=this.transports){return(Array.isArray(t)?t:Object.entries(t)).map(s=>{switch(typeof s){case"string":return this.transports[s]?[s,this.transports[s]]:null;case"function":return[s.name,s];default:return Array.isArray(s)?s:null}}).filter(Boolean)}};Z(i,"instances",{});let n=i;return Zt=n,Zt}var er,gi;function _a(){if(gi)return er;gi=1;const o=console.error;class e{constructor({logFn:i=null}={}){Z(this,"logFn",null);Z(this,"onError",null);Z(this,"showDialog",!1);Z(this,"preventDefault",!0);this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.startCatching=this.startCatching.bind(this),this.logFn=i}handle(i,{logFn:a=this.logFn,errorName:t="",onError:r=this.onError,showDialog:s=this.showDialog}={}){try{(r==null?void 0:r({error:i,errorName:t,processType:"renderer"}))!==!1&&a({error:i,errorName:t,showDialog:s})}catch{o(i)}}setOptions({logFn:i,onError:a,preventDefault:t,showDialog:r}){typeof i=="function"&&(this.logFn=i),typeof a=="function"&&(this.onError=a),typeof t=="boolean"&&(this.preventDefault=t),typeof r=="boolean"&&(this.showDialog=r)}startCatching({onError:i,showDialog:a}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:i,showDialog:a}),window.addEventListener("error",t=>{var r;this.preventDefault&&((r=t.preventDefault)==null||r.call(t)),this.handleError(t.error||t)}),window.addEventListener("unhandledrejection",t=>{var r;this.preventDefault&&((r=t.preventDefault)==null||r.call(t)),this.handleRejection(t.reason||t)}))}handleError(i){this.handle(i,{errorName:"Unhandled"})}handleRejection(i){const a=i instanceof Error?i:new Error(JSON.stringify(i));this.handle(a,{errorName:"Unhandled rejection"})}}return er=e,er}var tr,yi;function Ue(){if(yi)return tr;yi=1,tr={transform:o};function o({logger:e,message:n,transport:i,initialData:a=(n==null?void 0:n.data)||[],transforms:t=i==null?void 0:i.transforms}){return t.reduce((r,s)=>typeof s=="function"?s({data:r,logger:e,message:n,transport:i}):r,a)}return tr}var rr,vi;function Na(){if(vi)return rr;vi=1;const{transform:o}=Ue();rr=n;const e={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};function n(a){return Object.assign(t,{format:"{h}:{i}:{s}.{ms}{scope} › {text}",transforms:[i],writeFn({message:{level:r,data:s}}){const u=e[r]||e.info;setTimeout(()=>u(...s))}});function t(r){t.writeFn({message:{...r,data:o({logger:a,message:r,transport:t})}})}}function i({data:a=[],logger:t={},message:r={},transport:s={}}){if(typeof s.format=="function")return s.format({data:a,level:(r==null?void 0:r.level)||"info",logger:t,message:r,transport:s});if(typeof s.format!="string")return a;a.unshift(s.format),typeof a[1]=="string"&&a[1].match(/%[1cdfiOos]/)&&(a=[`${a[0]} ${a[1]}`,...a.slice(2)]);const u=r.date||new Date;return a[0]=a[0].replace(/\{(\w+)}/g,(f,c)=>{var h,l;switch(c){case"level":return r.level;case"logId":return r.logId;case"scope":{const g=r.scope||((h=t.scope)==null?void 0:h.defaultLabel);return g?` (${g})`:""}case"text":return"";case"y":return u.getFullYear().toString(10);case"m":return(u.getMonth()+1).toString(10).padStart(2,"0");case"d":return u.getDate().toString(10).padStart(2,"0");case"h":return u.getHours().toString(10).padStart(2,"0");case"i":return u.getMinutes().toString(10).padStart(2,"0");case"s":return u.getSeconds().toString(10).padStart(2,"0");case"ms":return u.getMilliseconds().toString(10).padStart(3,"0");case"iso":return u.toISOString();default:return((l=r.variables)==null?void 0:l[c])||f}}).trim(),a}return rr}var nr,wi;function Ia(){if(wi)return nr;wi=1;const{transform:o}=Ue();nr=n;const e=new Set([Promise,WeakMap,WeakSet]);function n(t){return Object.assign(r,{depth:5,transforms:[a]});function r(s){if(!window.__electronLog){t.processMessage({data:["electron-log: logger isn't initialized in the main process"],level:"error"},{transports:["console"]});return}try{const u=o({initialData:s,logger:t,message:s,transport:r});__electronLog.sendToMain(u)}catch(u){t.transports.console({data:["electronLog.transports.ipc",u,"data:",s.data],level:"error"})}}}function i(t){return Object(t)!==t}function a({data:t,depth:r,seen:s=new WeakSet,transport:u={}}={}){const f=r||u.depth||5;return s.has(t)?"[Circular]":f<1?i(t)?t:Array.isArray(t)?"[Array]":`[${typeof t}]`:["function","symbol"].includes(typeof t)?t.toString():i(t)?t:e.has(t.constructor)?`[${t.constructor.name}]`:Array.isArray(t)?t.map(c=>a({data:c,depth:f-1,seen:s})):t instanceof Date?t.toISOString():t instanceof Error?t.stack:t instanceof Map?new Map(Array.from(t).map(([c,h])=>[a({data:c,depth:f-1,seen:s}),a({data:h,depth:f-1,seen:s})])):t instanceof Set?new Set(Array.from(t).map(c=>a({data:c,depth:f-1,seen:s}))):(s.add(t),Object.fromEntries(Object.entries(t).map(([c,h])=>[c,a({data:h,depth:f-1,seen:s})])))}return nr}var Ei;function xa(){return Ei||(Ei=1,function(o){const e=as(),n=_a(),i=Na(),a=Ia();o.exports=t(),o.exports.Logger=e,o.exports.default=o.exports;function t(){const r=new e({allowUnknownLevel:!0,errorHandler:new n,initializeFn:()=>{},logId:"default",transportFactories:{console:i,ipc:a},variables:{processType:"renderer"}});return r.errorHandler.setOptions({logFn({error:s,errorName:u,showDialog:f}){r.transports.console({data:[u,s].filter(Boolean),level:"error"}),r.transports.ipc({cmd:"errorHandler",error:{cause:s==null?void 0:s.cause,code:s==null?void 0:s.code,name:s==null?void 0:s.name,message:s==null?void 0:s.message,stack:s==null?void 0:s.stack},errorName:u,logId:r.logId,showDialog:f})}}),typeof window=="object"&&window.addEventListener("message",s=>{const{cmd:u,logId:f,...c}=s.data||{},h=e.getInstance({logId:f});u==="message"&&h.processMessage(c,{transports:["console"]})}),new Proxy(r,{get(s,u){return typeof s[u]<"u"?s[u]:(...f)=>r.logData(f,{level:u})}})}}(Yt)),Yt.exports}var ir,bi;function Fa(){if(bi)return ir;bi=1;const o=ae,e=Q;ir={findAndReadPackageJson:n,tryReadJsonAt:i};function n(){return i(r())||i(t())||i(process.resourcesPath,"app.asar")||i(process.resourcesPath,"app")||i(process.cwd())||{name:void 0,version:void 0}}function i(...s){if(s[0])try{const u=e.join(...s),f=a("package.json",u);if(!f)return;const c=JSON.parse(o.readFileSync(f,"utf8")),h=(c==null?void 0:c.productName)||(c==null?void 0:c.name);return!h||h.toLowerCase()==="electron"?void 0:h?{name:h,version:c==null?void 0:c.version}:void 0}catch{return}}function a(s,u){let f=u;for(;;){const c=e.parse(f),h=c.root,l=c.dir;if(o.existsSync(e.join(f,s)))return e.resolve(e.join(f,s));if(f===h)return null;f=l}}function t(){const s=process.argv.filter(f=>f.indexOf("--user-data-dir=")===0);return s.length===0||typeof s[0]!="string"?null:s[0].replace("--user-data-dir=","")}function r(){var s;try{return(s=require.main)==null?void 0:s.filename}catch{return}}return ir}var or,Ti;function us(){if(Ti)return or;Ti=1;const o=rt,e=$e,n=Q,i=Fa();class a{constructor(){Z(this,"appName");Z(this,"appPackageJson");Z(this,"platform",process.platform)}getAppLogPath(r=this.getAppName()){return this.platform==="darwin"?n.join(this.getSystemPathHome(),"Library/Logs",r):n.join(this.getAppUserDataPath(r),"logs")}getAppName(){var s;const r=this.appName||((s=this.getAppPackageJson())==null?void 0:s.name);if(!r)throw new Error("electron-log can't determine the app name. It tried these methods:\n1. Use `electron.app.name`\n2. Use productName or name from the nearest package.json`\nYou can also set it through log.transports.file.setAppName()");return r}getAppPackageJson(){return typeof this.appPackageJson!="object"&&(this.appPackageJson=i.findAndReadPackageJson()),this.appPackageJson}getAppUserDataPath(r=this.getAppName()){return r?n.join(this.getSystemPathAppData(),r):void 0}getAppVersion(){var r;return(r=this.getAppPackageJson())==null?void 0:r.version}getElectronLogPath(){return this.getAppLogPath()}getMacOsVersion(){const r=Number(e.release().split(".")[0]);return r<=19?`10.${r-4}`:r-9}getOsVersion(){let r=e.type().replace("_"," "),s=e.release();return r==="Darwin"&&(r="macOS",s=this.getMacOsVersion()),`${r} ${s}`}getPathVariables(){const r=this.getAppName(),s=this.getAppVersion(),u=this;return{appData:this.getSystemPathAppData(),appName:r,appVersion:s,get electronDefaultDir(){return u.getElectronLogPath()},home:this.getSystemPathHome(),libraryDefaultDir:this.getAppLogPath(r),libraryTemplate:this.getAppLogPath("{appName}"),temp:this.getSystemPathTemp(),userData:this.getAppUserDataPath(r)}}getSystemPathAppData(){const r=this.getSystemPathHome();switch(this.platform){case"darwin":return n.join(r,"Library/Application Support");case"win32":return process.env.APPDATA||n.join(r,"AppData/Roaming");default:return process.env.XDG_CONFIG_HOME||n.join(r,".config")}}getSystemPathHome(){var r;return((r=e.homedir)==null?void 0:r.call(e))||process.env.HOME}getSystemPathTemp(){return e.tmpdir()}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:void 0,os:this.getOsVersion()}}isDev(){return process.env.NODE_ENV==="development"||process.env.ELECTRON_IS_DEV==="1"}isElectron(){return!!process.versions.electron}onAppEvent(r,s){}onAppReady(r){r()}onEveryWebContentsEvent(r,s){}onIpc(r,s){}onIpcInvoke(r,s){}openUrl(r,s=console.error){const f={darwin:"open",win32:"start",linux:"xdg-open"}[process.platform]||"xdg-open";o.exec(`${f} ${r}`,{},c=>{c&&s(c)})}setAppName(r){this.appName=r}setPlatform(r){this.platform=r}setPreloadFileForSessions({filePath:r,includeFutureSession:s=!0,getSessions:u=()=>[]}){}sendIpc(r,s){}showErrorBox(r,s){}}return or=a,or}var sr,Oi;function Sa(){if(Oi)return sr;Oi=1;const o=Q,e=us();class n extends e{constructor({electron:t}={}){super();Z(this,"electron");this.electron=t}getAppName(){var r,s;let t;try{t=this.appName||((r=this.electron.app)==null?void 0:r.name)||((s=this.electron.app)==null?void 0:s.getName())}catch{}return t||super.getAppName()}getAppUserDataPath(t){return this.getPath("userData")||super.getAppUserDataPath(t)}getAppVersion(){var r;let t;try{t=(r=this.electron.app)==null?void 0:r.getVersion()}catch{}return t||super.getAppVersion()}getElectronLogPath(){return this.getPath("logs")||super.getElectronLogPath()}getPath(t){var r;try{return(r=this.electron.app)==null?void 0:r.getPath(t)}catch{return}}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:`Electron ${process.versions.electron}`,os:this.getOsVersion()}}getSystemPathAppData(){return this.getPath("appData")||super.getSystemPathAppData()}isDev(){var t;return((t=this.electron.app)==null?void 0:t.isPackaged)!==void 0?!this.electron.app.isPackaged:typeof process.execPath=="string"?o.basename(process.execPath).toLowerCase().startsWith("electron"):super.isDev()}onAppEvent(t,r){var s;return(s=this.electron.app)==null||s.on(t,r),()=>{var u;(u=this.electron.app)==null||u.off(t,r)}}onAppReady(t){var r,s,u;(r=this.electron.app)!=null&&r.isReady()?t():(s=this.electron.app)!=null&&s.once?(u=this.electron.app)==null||u.once("ready",t):t()}onEveryWebContentsEvent(t,r){var u,f,c;return(f=(u=this.electron.webContents)==null?void 0:u.getAllWebContents())==null||f.forEach(h=>{h.on(t,r)}),(c=this.electron.app)==null||c.on("web-contents-created",s),()=>{var h,l;(h=this.electron.webContents)==null||h.getAllWebContents().forEach(g=>{g.off(t,r)}),(l=this.electron.app)==null||l.off("web-contents-created",s)};function s(h,l){l.on(t,r)}}onIpc(t,r){var s;(s=this.electron.ipcMain)==null||s.on(t,r)}onIpcInvoke(t,r){var s,u;(u=(s=this.electron.ipcMain)==null?void 0:s.handle)==null||u.call(s,t,r)}openUrl(t,r=console.error){var s;(s=this.electron.shell)==null||s.openExternal(t).catch(r)}setPreloadFileForSessions({filePath:t,includeFutureSession:r=!0,getSessions:s=()=>{var u;return[(u=this.electron.session)==null?void 0:u.defaultSession]}}){for(const f of s().filter(Boolean))u(f);r&&this.onAppEvent("session-created",f=>{u(f)});function u(f){typeof f.registerPreloadScript=="function"?f.registerPreloadScript({filePath:t,id:"electron-log-preload",type:"frame"}):f.setPreloads([...f.getPreloads(),t])}}sendIpc(t,r){var s,u;(u=(s=this.electron.BrowserWindow)==null?void 0:s.getAllWindows())==null||u.forEach(f=>{var c,h;((c=f.webContents)==null?void 0:c.isDestroyed())===!1&&((h=f.webContents)==null?void 0:h.isCrashed())===!1&&f.webContents.send(t,r)})}showErrorBox(t,r){var s;(s=this.electron.dialog)==null||s.showErrorBox(t,r)}}return sr=n,sr}var ar,Ci;function Pa(){if(Ci)return ar;Ci=1;const o=ae,e=$e,n=Q,i=ss();ar={initialize({externalApi:r,getSessions:s,includeFutureSession:u,logger:f,preload:c=!0,spyRendererConsole:h=!1}){r.onAppReady(()=>{try{c&&a({externalApi:r,getSessions:s,includeFutureSession:u,preloadOption:c}),h&&t({externalApi:r,logger:f})}catch(l){f.warn(l)}})}};function a({externalApi:r,getSessions:s,includeFutureSession:u,preloadOption:f}){let c=typeof f=="string"?f:void 0;try{c=n.resolve(__dirname,"../renderer/electron-log-preload.js")}catch{}if(!c||!o.existsSync(c)){c=n.join(r.getAppUserDataPath()||e.tmpdir(),"electron-log-preload.js");const h=`
      try {
        (${i.toString()})(require('electron'));
      } catch(e) {
        console.error(e);
      }
    `;o.writeFileSync(c,h,"utf8")}r.setPreloadFileForSessions({filePath:c,includeFutureSession:u,getSessions:s})}function t({externalApi:r,logger:s}){const u=["debug","info","warn","error"];r.onEveryWebContentsEvent("console-message",(f,c,h)=>{s.processMessage({data:[h],level:u[c],variables:{processType:"renderer"}})})}return ar}var ur,Di;function La(){if(Di)return ur;Di=1;class o{constructor({externalApi:i,logFn:a=void 0,onError:t=void 0,showDialog:r=void 0}={}){Z(this,"externalApi");Z(this,"isActive",!1);Z(this,"logFn");Z(this,"onError");Z(this,"showDialog",!0);this.createIssue=this.createIssue.bind(this),this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.setOptions({externalApi:i,logFn:a,onError:t,showDialog:r}),this.startCatching=this.startCatching.bind(this),this.stopCatching=this.stopCatching.bind(this)}handle(i,{logFn:a=this.logFn,onError:t=this.onError,processType:r="browser",showDialog:s=this.showDialog,errorName:u=""}={}){var f;i=e(i);try{if(typeof t=="function"){const c=((f=this.externalApi)==null?void 0:f.getVersions())||{},h=this.createIssue;if(t({createIssue:h,error:i,errorName:u,processType:r,versions:c})===!1)return}u?a(u,i):a(i),s&&!u.includes("rejection")&&this.externalApi&&this.externalApi.showErrorBox(`A JavaScript error occurred in the ${r} process`,i.stack)}catch{console.error(i)}}setOptions({externalApi:i,logFn:a,onError:t,showDialog:r}){typeof i=="object"&&(this.externalApi=i),typeof a=="function"&&(this.logFn=a),typeof t=="function"&&(this.onError=t),typeof r=="boolean"&&(this.showDialog=r)}startCatching({onError:i,showDialog:a}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:i,showDialog:a}),process.on("uncaughtException",this.handleError),process.on("unhandledRejection",this.handleRejection))}stopCatching(){this.isActive=!1,process.removeListener("uncaughtException",this.handleError),process.removeListener("unhandledRejection",this.handleRejection)}createIssue(i,a){var t;(t=this.externalApi)==null||t.openUrl(`${i}?${new URLSearchParams(a).toString()}`)}handleError(i){this.handle(i,{errorName:"Unhandled"})}handleRejection(i){const a=i instanceof Error?i:new Error(JSON.stringify(i));this.handle(a,{errorName:"Unhandled rejection"})}}function e(n){if(n instanceof Error)return n;if(n&&typeof n=="object"){if(n.message)return Object.assign(new Error(n.message),n);try{return new Error(JSON.stringify(n))}catch(i){return new Error(`Couldn't normalize error ${String(n)}: ${i}`)}}return new Error(`Can't normalize error ${String(n)}`)}return ur=o,ur}var cr,Ai;function Ma(){if(Ai)return cr;Ai=1;class o{constructor(n={}){Z(this,"disposers",[]);Z(this,"format","{eventSource}#{eventName}:");Z(this,"formatters",{app:{"certificate-error":({args:n})=>this.arrayToObject(n.slice(1,4),["url","error","certificate"]),"child-process-gone":({args:n})=>n.length===1?n[0]:n,"render-process-gone":({args:[n,i]})=>i&&typeof i=="object"?{...i,...this.getWebContentsDetails(n)}:[]},webContents:{"console-message":({args:[n,i,a,t]})=>{if(!(n<3))return{message:i,source:`${t}:${a}`}},"did-fail-load":({args:n})=>this.arrayToObject(n,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"did-fail-provisional-load":({args:n})=>this.arrayToObject(n,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"plugin-crashed":({args:n})=>this.arrayToObject(n,["name","version"]),"preload-error":({args:n})=>this.arrayToObject(n,["preloadPath","error"])}});Z(this,"events",{app:{"certificate-error":!0,"child-process-gone":!0,"render-process-gone":!0},webContents:{"did-fail-load":!0,"did-fail-provisional-load":!0,"plugin-crashed":!0,"preload-error":!0,unresponsive:!0}});Z(this,"externalApi");Z(this,"level","error");Z(this,"scope","");this.setOptions(n)}setOptions({events:n,externalApi:i,level:a,logger:t,format:r,formatters:s,scope:u}){typeof n=="object"&&(this.events=n),typeof i=="object"&&(this.externalApi=i),typeof a=="string"&&(this.level=a),typeof t=="object"&&(this.logger=t),(typeof r=="string"||typeof r=="function")&&(this.format=r),typeof s=="object"&&(this.formatters=s),typeof u=="string"&&(this.scope=u)}startLogging(n={}){this.setOptions(n),this.disposeListeners();for(const i of this.getEventNames(this.events.app))this.disposers.push(this.externalApi.onAppEvent(i,(...a)=>{this.handleEvent({eventSource:"app",eventName:i,handlerArgs:a})}));for(const i of this.getEventNames(this.events.webContents))this.disposers.push(this.externalApi.onEveryWebContentsEvent(i,(...a)=>{this.handleEvent({eventSource:"webContents",eventName:i,handlerArgs:a})}))}stopLogging(){this.disposeListeners()}arrayToObject(n,i){const a={};return i.forEach((t,r)=>{a[t]=n[r]}),n.length>i.length&&(a.unknownArgs=n.slice(i.length)),a}disposeListeners(){this.disposers.forEach(n=>n()),this.disposers=[]}formatEventLog({eventName:n,eventSource:i,handlerArgs:a}){var h;const[t,...r]=a;if(typeof this.format=="function")return this.format({args:r,event:t,eventName:n,eventSource:i});const s=(h=this.formatters[i])==null?void 0:h[n];let u=r;if(typeof s=="function"&&(u=s({args:r,event:t,eventName:n,eventSource:i})),!u)return;const f={};return Array.isArray(u)?f.args=u:typeof u=="object"&&Object.assign(f,u),i==="webContents"&&Object.assign(f,this.getWebContentsDetails(t==null?void 0:t.sender)),[this.format.replace("{eventSource}",i==="app"?"App":"WebContents").replace("{eventName}",n),f]}getEventNames(n){return!n||typeof n!="object"?[]:Object.entries(n).filter(([i,a])=>a).map(([i])=>i)}getWebContentsDetails(n){if(!(n!=null&&n.loadURL))return{};try{return{webContents:{id:n.id,url:n.getURL()}}}catch{return{}}}handleEvent({eventName:n,eventSource:i,handlerArgs:a}){var r;const t=this.formatEventLog({eventName:n,eventSource:i,handlerArgs:a});if(t){const s=this.scope?this.logger.scope(this.scope):this.logger;(r=s==null?void 0:s[this.level])==null||r.call(s,...t)}}}return cr=o,cr}var lr,_i;function cs(){if(_i)return lr;_i=1;const{transform:o}=Ue();lr={concatFirstStringElements:e,formatScope:i,formatText:t,formatVariables:a,timeZoneFromOffset:n,format({message:r,logger:s,transport:u,data:f=r==null?void 0:r.data}){switch(typeof u.format){case"string":return o({message:r,logger:s,transforms:[a,i,t],transport:u,initialData:[u.format,...f]});case"function":return u.format({data:f,level:(r==null?void 0:r.level)||"info",logger:s,message:r,transport:u});default:return f}}};function e({data:r}){return typeof r[0]!="string"||typeof r[1]!="string"||r[0].match(/%[1cdfiOos]/)?r:[`${r[0]} ${r[1]}`,...r.slice(2)]}function n(r){const s=Math.abs(r),u=r>0?"-":"+",f=Math.floor(s/60).toString().padStart(2,"0"),c=(s%60).toString().padStart(2,"0");return`${u}${f}:${c}`}function i({data:r,logger:s,message:u}){const{defaultLabel:f,labelLength:c}=(s==null?void 0:s.scope)||{},h=r[0];let l=u.scope;l||(l=f);let g;return l===""?g=c>0?"".padEnd(c+3):"":typeof l=="string"?g=` (${l})`.padEnd(c+3):g="",r[0]=h.replace("{scope}",g),r}function a({data:r,message:s}){let u=r[0];if(typeof u!="string")return r;u=u.replace("{level}]",`${s.level}]`.padEnd(6," "));const f=s.date||new Date;return r[0]=u.replace(/\{(\w+)}/g,(c,h)=>{var l;switch(h){case"level":return s.level||"info";case"logId":return s.logId;case"y":return f.getFullYear().toString(10);case"m":return(f.getMonth()+1).toString(10).padStart(2,"0");case"d":return f.getDate().toString(10).padStart(2,"0");case"h":return f.getHours().toString(10).padStart(2,"0");case"i":return f.getMinutes().toString(10).padStart(2,"0");case"s":return f.getSeconds().toString(10).padStart(2,"0");case"ms":return f.getMilliseconds().toString(10).padStart(3,"0");case"z":return n(f.getTimezoneOffset());case"iso":return f.toISOString();default:return((l=s.variables)==null?void 0:l[h])||c}}).trim(),r}function t({data:r}){const s=r[0];if(typeof s!="string")return r;if(s.lastIndexOf("{text}")===s.length-6)return r[0]=s.replace(/\s?{text}/,""),r[0]===""&&r.shift(),r;const f=s.split("{text}");let c=[];return f[0]!==""&&c.push(f[0]),c=c.concat(r.slice(1)),f[1]!==""&&c.push(f[1]),c}return lr}var fr={exports:{}},Ni;function Tt(){return Ni||(Ni=1,function(o){const e=tt;o.exports={serialize:i,maxDepth({data:a,transport:t,depth:r=(t==null?void 0:t.depth)??6}){if(!a)return a;if(r<1)return Array.isArray(a)?"[array]":typeof a=="object"&&a?"[object]":a;if(Array.isArray(a))return a.map(u=>o.exports.maxDepth({data:u,depth:r-1}));if(typeof a!="object"||a&&typeof a.toISOString=="function")return a;if(a===null)return null;if(a instanceof Error)return a;const s={};for(const u in a)Object.prototype.hasOwnProperty.call(a,u)&&(s[u]=o.exports.maxDepth({data:a[u],depth:r-1}));return s},toJSON({data:a}){return JSON.parse(JSON.stringify(a,n()))},toString({data:a,transport:t}){const r=(t==null?void 0:t.inspectOptions)||{},s=a.map(u=>{if(u!==void 0)try{const f=JSON.stringify(u,n(),"  ");return f===void 0?void 0:JSON.parse(f)}catch{return u}});return e.formatWithOptions(r,...s)}};function n(a={}){const t=new WeakSet;return function(r,s){if(typeof s=="object"&&s!==null){if(t.has(s))return;t.add(s)}return i(r,s,a)}}function i(a,t,r={}){const s=(r==null?void 0:r.serializeMapAndSet)!==!1;return t instanceof Error?t.stack:t&&(typeof t=="function"?`[function] ${t.toString()}`:t instanceof Date?t.toISOString():s&&t instanceof Map&&Object.fromEntries?Object.fromEntries(t):s&&t instanceof Set&&Array.from?Array.from(t):t)}}(fr)),fr.exports}var pr,Ii;function Fn(){if(Ii)return pr;Ii=1,pr={transformStyles:i,applyAnsiStyles({data:a}){return i(a,e,n)},removeStyles({data:a}){return i(a,()=>"")}};const o={unset:"\x1B[0m",black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"};function e(a){const t=a.replace(/color:\s*(\w+).*/,"$1").toLowerCase();return o[t]||""}function n(a){return a+o.unset}function i(a,t,r){const s={};return a.reduce((u,f,c,h)=>{if(s[c])return u;if(typeof f=="string"){let l=c,g=!1;f=f.replace(/%[1cdfiOos]/g,y=>{if(l+=1,y!=="%c")return y;const b=h[l];return typeof b=="string"?(s[l]=!0,g=!0,t(b,f)):y}),g&&r&&(f=r(f))}return u.push(f),u},[])}return pr}var hr,xi;function Ra(){if(xi)return hr;xi=1;const{concatFirstStringElements:o,format:e}=cs(),{maxDepth:n,toJSON:i}=Tt(),{applyAnsiStyles:a,removeStyles:t}=Fn(),{transform:r}=Ue(),s={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};hr=c;const f=`%c{h}:{i}:{s}.{ms}{scope}%c ${process.platform==="win32"?">":"›"} {text}`;Object.assign(c,{DEFAULT_FORMAT:f});function c(b){return Object.assign(O,{format:f,level:"silly",transforms:[h,e,g,o,n,i],useStyles:process.env.FORCE_STYLES,writeFn({message:x}){(s[x.level]||s.info)(...x.data)}});function O(x){const v=r({logger:b,message:x,transport:O});O.writeFn({message:{...x,data:v}})}}function h({data:b,message:O,transport:x}){return x.format!==f?b:[`color:${y(O.level)}`,"color:unset",...b]}function l(b,O){if(typeof b=="boolean")return b;const v=O==="error"||O==="warn"?process.stderr:process.stdout;return v&&v.isTTY}function g(b){const{message:O,transport:x}=b;return(l(x.useStyles,O.level)?a:t)(b)}function y(b){const O={error:"red",warn:"yellow",info:"cyan",default:"unset"};return O[b]||O.default}return hr}var dr,Fi;function ls(){if(Fi)return dr;Fi=1;const o=Be,e=ae,n=$e;class i extends o{constructor({path:s,writeOptions:u={encoding:"utf8",flag:"a",mode:438},writeAsync:f=!1}){super();Z(this,"asyncWriteQueue",[]);Z(this,"bytesWritten",0);Z(this,"hasActiveAsyncWriting",!1);Z(this,"path",null);Z(this,"initialSize");Z(this,"writeOptions",null);Z(this,"writeAsync",!1);this.path=s,this.writeOptions=u,this.writeAsync=f}get size(){return this.getSize()}clear(){try{return e.writeFileSync(this.path,"",{mode:this.writeOptions.mode,flag:"w"}),this.reset(),!0}catch(s){return s.code==="ENOENT"?!0:(this.emit("error",s,this),!1)}}crop(s){try{const u=a(this.path,s||4096);this.clear(),this.writeLine(`[log cropped]${n.EOL}${u}`)}catch(u){this.emit("error",new Error(`Couldn't crop file ${this.path}. ${u.message}`),this)}}getSize(){if(this.initialSize===void 0)try{const s=e.statSync(this.path);this.initialSize=s.size}catch{this.initialSize=0}return this.initialSize+this.bytesWritten}increaseBytesWrittenCounter(s){this.bytesWritten+=Buffer.byteLength(s,this.writeOptions.encoding)}isNull(){return!1}nextAsyncWrite(){const s=this;if(this.hasActiveAsyncWriting||this.asyncWriteQueue.length===0)return;const u=this.asyncWriteQueue.join("");this.asyncWriteQueue=[],this.hasActiveAsyncWriting=!0,e.writeFile(this.path,u,this.writeOptions,f=>{s.hasActiveAsyncWriting=!1,f?s.emit("error",new Error(`Couldn't write to ${s.path}. ${f.message}`),this):s.increaseBytesWrittenCounter(u),s.nextAsyncWrite()})}reset(){this.initialSize=void 0,this.bytesWritten=0}toString(){return this.path}writeLine(s){if(s+=n.EOL,this.writeAsync){this.asyncWriteQueue.push(s),this.nextAsyncWrite();return}try{e.writeFileSync(this.path,s,this.writeOptions),this.increaseBytesWrittenCounter(s)}catch(u){this.emit("error",new Error(`Couldn't write to ${this.path}. ${u.message}`),this)}}}dr=i;function a(t,r){const s=Buffer.alloc(r),u=e.statSync(t),f=Math.min(u.size,r),c=Math.max(0,u.size-r),h=e.openSync(t,"r"),l=e.readSync(h,s,0,f,c);return e.closeSync(h),s.toString("utf8",0,l)}return dr}var mr,Si;function ja(){if(Si)return mr;Si=1;const o=ls();class e extends o{clear(){}crop(){}getSize(){return 0}isNull(){return!0}writeLine(){}}return mr=e,mr}var gr,Pi;function qa(){if(Pi)return gr;Pi=1;const o=Be,e=ae,n=Q,i=ls(),a=ja();class t extends o{constructor(){super();Z(this,"store",{});this.emitError=this.emitError.bind(this)}provide({filePath:u,writeOptions:f={},writeAsync:c=!1}){let h;try{if(u=n.resolve(u),this.store[u])return this.store[u];h=this.createFile({filePath:u,writeOptions:f,writeAsync:c})}catch(l){h=new a({path:u}),this.emitError(l,h)}return h.on("error",this.emitError),this.store[u]=h,h}createFile({filePath:u,writeOptions:f,writeAsync:c}){return this.testFileWriting({filePath:u,writeOptions:f}),new i({path:u,writeOptions:f,writeAsync:c})}emitError(u,f){this.emit("error",u,f)}testFileWriting({filePath:u,writeOptions:f}){e.mkdirSync(n.dirname(u),{recursive:!0}),e.writeFileSync(u,"",{flag:"a",mode:f.mode})}}return gr=t,gr}var yr,Li;function $a(){if(Li)return yr;Li=1;const o=ae,e=$e,n=Q,i=qa(),{transform:a}=Ue(),{removeStyles:t}=Fn(),{format:r,concatFirstStringElements:s}=cs(),{toString:u}=Tt();yr=c;const f=new i;function c(l,{registry:g=f,externalApi:y}={}){let b;return g.listenerCount("error")<1&&g.on("error",(A,w)=>{v(`Can't write to ${w}`,A)}),Object.assign(O,{fileName:h(l.variables.processType),format:"[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}]{scope} {text}",getFile:m,inspectOptions:{depth:5},level:"silly",maxSize:1024**2,readAllLogs:D,sync:!0,transforms:[t,r,s,u],writeOptions:{flag:"a",mode:438,encoding:"utf8"},archiveLogFn(A){const w=A.toString(),_=n.parse(w);try{o.renameSync(w,n.join(_.dir,`${_.name}.old${_.ext}`))}catch(T){v("Could not rotate log",T);const p=Math.round(O.maxSize/4);A.crop(Math.min(p,256*1024))}},resolvePathFn(A){return n.join(A.libraryDefaultDir,A.fileName)},setAppName(A){l.dependencies.externalApi.setAppName(A)}});function O(A){const w=m(A);O.maxSize>0&&w.size>O.maxSize&&(O.archiveLogFn(w),w.reset());const T=a({logger:l,message:A,transport:O});w.writeLine(T)}function x(){b||(b=Object.create(Object.prototype,{...Object.getOwnPropertyDescriptors(y.getPathVariables()),fileName:{get(){return O.fileName},enumerable:!0}}),typeof O.archiveLog=="function"&&(O.archiveLogFn=O.archiveLog,v("archiveLog is deprecated. Use archiveLogFn instead")),typeof O.resolvePath=="function"&&(O.resolvePathFn=O.resolvePath,v("resolvePath is deprecated. Use resolvePathFn instead")))}function v(A,w=null,_="error"){const T=[`electron-log.transports.file: ${A}`];w&&T.push(w),l.transports.console({data:T,date:new Date,level:_})}function m(A){x();const w=O.resolvePathFn(b,A);return g.provide({filePath:w,writeAsync:!O.sync,writeOptions:O.writeOptions})}function D({fileFilter:A=w=>w.endsWith(".log")}={}){x();const w=n.dirname(O.resolvePathFn(b));return o.existsSync(w)?o.readdirSync(w).map(_=>n.join(w,_)).filter(A).map(_=>{try{return{path:_,lines:o.readFileSync(_,"utf8").split(e.EOL)}}catch{return null}}).filter(Boolean):[]}}function h(l=process.type){switch(l){case"renderer":return"renderer.log";case"worker":return"worker.log";default:return"main.log"}}return yr}var vr,Mi;function ka(){if(Mi)return vr;Mi=1;const{maxDepth:o,toJSON:e}=Tt(),{transform:n}=Ue();vr=i;function i(a,{externalApi:t}){return Object.assign(r,{depth:3,eventId:"__ELECTRON_LOG_IPC__",level:a.isDev?"silly":!1,transforms:[e,o]}),t!=null&&t.isElectron()?r:void 0;function r(s){var u;((u=s==null?void 0:s.variables)==null?void 0:u.processType)!=="renderer"&&(t==null||t.sendIpc(r.eventId,{...s,data:n({logger:a,message:s,transport:r})}))}}return vr}var wr,Ri;function Ba(){if(Ri)return wr;Ri=1;const o=wt,e=Et,{transform:n}=Ue(),{removeStyles:i}=Fn(),{toJSON:a,maxDepth:t}=Tt();wr=r;function r(s){return Object.assign(u,{client:{name:"electron-application"},depth:6,level:!1,requestOptions:{},transforms:[i,a,t],makeBodyFn({message:f}){return JSON.stringify({client:u.client,data:f.data,date:f.date.getTime(),level:f.level,scope:f.scope,variables:f.variables})},processErrorFn({error:f}){s.processMessage({data:[`electron-log: can't POST ${u.url}`,f],level:"warn"},{transports:["console","file"]})},sendRequestFn({serverUrl:f,requestOptions:c,body:h}){const g=(f.startsWith("https:")?e:o).request(f,{method:"POST",...c,headers:{"Content-Type":"application/json","Content-Length":h.length,...c.headers}});return g.write(h),g.end(),g}});function u(f){if(!u.url)return;const c=u.makeBodyFn({logger:s,message:{...f,data:n({logger:s,message:f,transport:u})},transport:u}),h=u.sendRequestFn({serverUrl:u.url,requestOptions:u.requestOptions,body:Buffer.from(c,"utf8")});h.on("error",l=>u.processErrorFn({error:l,logger:s,message:f,request:h,transport:u}))}}return wr}var Er,ji;function fs(){if(ji)return Er;ji=1;const o=as(),e=La(),n=Ma(),i=Ra(),a=$a(),t=ka(),r=Ba();Er=s;function s({dependencies:u,initializeFn:f}){var h;const c=new o({dependencies:u,errorHandler:new e,eventLogger:new n,initializeFn:f,isDev:(h=u.externalApi)==null?void 0:h.isDev(),logId:"default",transportFactories:{console:i,file:a,ipc:t,remote:r},variables:{processType:"main"}});return c.default=c,c.Logger=o,c.processInternalErrorFn=l=>{c.transports.console.writeFn({message:{data:["Unhandled electron-log error",l],level:"error"}})},c}return Er}var br,qi;function Ua(){if(qi)return br;qi=1;const o=re,e=Sa(),{initialize:n}=Pa(),i=fs(),a=new e({electron:o}),t=i({dependencies:{externalApi:a},initializeFn:n});br=t,a.onIpc("__ELECTRON_LOG__",(s,u)=>{u.scope&&t.Logger.getInstance(u).scope(u.scope);const f=new Date(u.date);r({...u,date:f.getTime()?f:new Date})}),a.onIpcInvoke("__ELECTRON_LOG__",(s,{cmd:u="",logId:f})=>{switch(u){case"getOptions":return{levels:t.Logger.getInstance({logId:f}).levels,logId:f};default:return r({data:[`Unknown cmd '${u}'`],level:"error"}),{}}});function r(s){var u;(u=t.Logger.getInstance(s))==null||u.processMessage(s)}return br}var Tr,$i;function Xa(){if($i)return Tr;$i=1;const o=us(),e=fs(),n=new o;return Tr=e({dependencies:{externalApi:n}}),Tr}const Va=typeof process>"u"||process.type==="renderer"||process.type==="worker",za=typeof process=="object"&&process.type==="browser";Va?(ss(),mt.exports=xa()):za?mt.exports=Ua():mt.exports=Xa();var Wa=mt.exports;const oe=bt(Wa),ki=require("iconv-lite");function Ha(o){try{const e=ki.decode(Buffer.from(o,"binary"),"gbk");return/[^\u0000-\uFFFF]/.test(e)?o.split(Q.sep).map(n=>{try{return ki.decode(Buffer.from(n,"binary"),"gbk")}catch{return n}}).join(Q.sep):e}catch{return o}}async function Bi(o){const e=Ha(o),n=Q.normalize(e);if(console.log(n),!ae.existsSync(n)){if(o!==n&&ae.existsSync(o))return o;throw new Error(`文件不存在: ${n}
原始路径: ${o}`)}return n}function En(o){return Buffer.from(o,"base64").toString("utf-8")}function gt(o){switch(Q.extname(o).toLowerCase()){case".mp4":return"video/mp4";case".webm":return"video/webm";case".mov":return"video/quicktime";case".avi":return"video/x-msvideo";case".mkv":return"video/x-matroska";case".mp3":return"audio/mpeg";case".wav":return"audio/wav";case".ogg":return"audio/ogg";case".aac":return"audio/aac";case".flac":return"audio/flac";case".jpg":case".jpeg":return"image/jpeg";case".png":return"image/png";default:return"application/octet-stream"}}function Ui(o){return new ReadableStream({start(e){o.on("data",n=>{e.enqueue(n)}),o.on("end",()=>{e.close()}),o.on("error",n=>{e.error(n)})},cancel(){o.destroy()}})}function Ga(){try{let o,e;if(re.app.isPackaged){const n=Q.join(process.resourcesPath,"app.asar.unpacked","bin");o=Q.join(n,process.platform==="win32"?"ffmpeg.exe":"ffmpeg"),e=Q.join(n,process.platform==="win32"?"ffprobe.exe":"ffprobe")}else{const n=require("ffmpeg-static"),i=require("ffprobe-static");o=n,e=i.path}return console.log("FFmpeg路径:",o),console.log("FFprobe路径:",e),Ze.setFfmpegPath(o),Ze.setFfprobePath(e),{ffmpegPath:o,ffprobePath:e}}catch(o){throw console.error("FFmpeg初始化失败:",o),new Error(`视频处理引擎初始化失败: ${o.message}`)}}function Ka(){re.ipcMain.handle("merge-media",async(o,e)=>{const{videoPaths:n,audioPaths:i,outputPath:a,audioVolumes:t=[]}=e,r=[...await Promise.all(n.map(Bi)),...await Promise.all(i.map(Bi))];return new Promise((s,u)=>{const f=Ze();r.forEach(b=>f.input(b));const c=[],h=n.map((b,O)=>`[${O}:v]scale=1280:720,setsar=1[v${O}]`);c.push(h.join(";"));const l=n.map((b,O)=>`[v${O}]`).join("");c.push(`${l}concat=n=${n.length}:v=1:a=0[vout]`);const g=i.map((b,O)=>`[${O+n.length}:a]aformat=sample_fmts=fltp[a${O}]`);c.push(g.join(";"));const y=i.map((b,O)=>`[a${O}]`).join("");c.push(`${y}amix=inputs=${i.length}:duration=longest[aout]`),oe.log(c.join(";")),f.complexFilter(c.join(";")).outputOptions(["-map [vout]","-map [aout]","-c:v libx264","-preset fast","-crf 22","-c:a aac","-b:a 192k","-shortest"]).save(a).on("progress",b=>{const O=b.percent?Math.min(100,b.percent):0;o.sender.send("merge-progress",O)}).on("end",()=>s(a)).on("error",(b,O,x)=>{console.error("FFmpeg Error:",b.message),console.error("FFmpeg Stderr:",x),u(b)})})})}function Ya(){re.ipcMain.handle("open-file",async(o,e)=>{const{shell:n}=require("electron");await n.openPath(e)})}var st,Ja=new Uint8Array(16);function ps(){if(!st&&(st=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!st))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return st(Ja)}const Qa=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ot(o){return typeof o=="string"&&Qa.test(o)}var de=[];for(var Or=0;Or<256;++Or)de.push((Or+256).toString(16).substr(1));function Ct(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(de[o[e+0]]+de[o[e+1]]+de[o[e+2]]+de[o[e+3]]+"-"+de[o[e+4]]+de[o[e+5]]+"-"+de[o[e+6]]+de[o[e+7]]+"-"+de[o[e+8]]+de[o[e+9]]+"-"+de[o[e+10]]+de[o[e+11]]+de[o[e+12]]+de[o[e+13]]+de[o[e+14]]+de[o[e+15]]).toLowerCase();if(!Ot(n))throw TypeError("Stringified UUID is invalid");return n}var Xi,Cr,Dr=0,Ar=0;function Za(o,e,n){var i=e&&n||0,a=e||new Array(16);o=o||{};var t=o.node||Xi,r=o.clockseq!==void 0?o.clockseq:Cr;if(t==null||r==null){var s=o.random||(o.rng||ps)();t==null&&(t=Xi=[s[0]|1,s[1],s[2],s[3],s[4],s[5]]),r==null&&(r=Cr=(s[6]<<8|s[7])&16383)}var u=o.msecs!==void 0?o.msecs:Date.now(),f=o.nsecs!==void 0?o.nsecs:Ar+1,c=u-Dr+(f-Ar)/1e4;if(c<0&&o.clockseq===void 0&&(r=r+1&16383),(c<0||u>Dr)&&o.nsecs===void 0&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Dr=u,Ar=f,Cr=r,u+=122192928e5;var h=((u&268435455)*1e4+f)%4294967296;a[i++]=h>>>24&255,a[i++]=h>>>16&255,a[i++]=h>>>8&255,a[i++]=h&255;var l=u/4294967296*1e4&268435455;a[i++]=l>>>8&255,a[i++]=l&255,a[i++]=l>>>24&15|16,a[i++]=l>>>16&255,a[i++]=r>>>8|128,a[i++]=r&255;for(var g=0;g<6;++g)a[i+g]=t[g];return e||Ct(a)}function hs(o){if(!Ot(o))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(o.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(o.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(o.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(o.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(o.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}function eu(o){o=unescape(encodeURIComponent(o));for(var e=[],n=0;n<o.length;++n)e.push(o.charCodeAt(n));return e}var tu="6ba7b810-9dad-11d1-80b4-00c04fd430c8",ru="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ds(o,e,n){function i(a,t,r,s){if(typeof a=="string"&&(a=eu(a)),typeof t=="string"&&(t=hs(t)),t.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+a.length);if(u.set(t),u.set(a,t.length),u=n(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,r){s=s||0;for(var f=0;f<16;++f)r[s+f]=u[f];return r}return Ct(u)}try{i.name=o}catch{}return i.DNS=tu,i.URL=ru,i}function nu(o){if(typeof o=="string"){var e=unescape(encodeURIComponent(o));o=new Uint8Array(e.length);for(var n=0;n<e.length;++n)o[n]=e.charCodeAt(n)}return iu(ou(su(o),o.length*8))}function iu(o){for(var e=[],n=o.length*32,i="0123456789abcdef",a=0;a<n;a+=8){var t=o[a>>5]>>>a%32&255,r=parseInt(i.charAt(t>>>4&15)+i.charAt(t&15),16);e.push(r)}return e}function ms(o){return(o+64>>>9<<4)+14+1}function ou(o,e){o[e>>5]|=128<<e%32,o[ms(e)-1]=e;for(var n=1732584193,i=-271733879,a=-1732584194,t=271733878,r=0;r<o.length;r+=16){var s=n,u=i,f=a,c=t;n=ge(n,i,a,t,o[r],7,-680876936),t=ge(t,n,i,a,o[r+1],12,-389564586),a=ge(a,t,n,i,o[r+2],17,606105819),i=ge(i,a,t,n,o[r+3],22,-1044525330),n=ge(n,i,a,t,o[r+4],7,-176418897),t=ge(t,n,i,a,o[r+5],12,1200080426),a=ge(a,t,n,i,o[r+6],17,-1473231341),i=ge(i,a,t,n,o[r+7],22,-45705983),n=ge(n,i,a,t,o[r+8],7,1770035416),t=ge(t,n,i,a,o[r+9],12,-1958414417),a=ge(a,t,n,i,o[r+10],17,-42063),i=ge(i,a,t,n,o[r+11],22,-1990404162),n=ge(n,i,a,t,o[r+12],7,1804603682),t=ge(t,n,i,a,o[r+13],12,-40341101),a=ge(a,t,n,i,o[r+14],17,-1502002290),i=ge(i,a,t,n,o[r+15],22,1236535329),n=ye(n,i,a,t,o[r+1],5,-165796510),t=ye(t,n,i,a,o[r+6],9,-1069501632),a=ye(a,t,n,i,o[r+11],14,643717713),i=ye(i,a,t,n,o[r],20,-373897302),n=ye(n,i,a,t,o[r+5],5,-701558691),t=ye(t,n,i,a,o[r+10],9,38016083),a=ye(a,t,n,i,o[r+15],14,-660478335),i=ye(i,a,t,n,o[r+4],20,-405537848),n=ye(n,i,a,t,o[r+9],5,568446438),t=ye(t,n,i,a,o[r+14],9,-1019803690),a=ye(a,t,n,i,o[r+3],14,-187363961),i=ye(i,a,t,n,o[r+8],20,1163531501),n=ye(n,i,a,t,o[r+13],5,-1444681467),t=ye(t,n,i,a,o[r+2],9,-51403784),a=ye(a,t,n,i,o[r+7],14,1735328473),i=ye(i,a,t,n,o[r+12],20,-1926607734),n=ve(n,i,a,t,o[r+5],4,-378558),t=ve(t,n,i,a,o[r+8],11,-2022574463),a=ve(a,t,n,i,o[r+11],16,1839030562),i=ve(i,a,t,n,o[r+14],23,-35309556),n=ve(n,i,a,t,o[r+1],4,-1530992060),t=ve(t,n,i,a,o[r+4],11,1272893353),a=ve(a,t,n,i,o[r+7],16,-155497632),i=ve(i,a,t,n,o[r+10],23,-1094730640),n=ve(n,i,a,t,o[r+13],4,681279174),t=ve(t,n,i,a,o[r],11,-358537222),a=ve(a,t,n,i,o[r+3],16,-722521979),i=ve(i,a,t,n,o[r+6],23,76029189),n=ve(n,i,a,t,o[r+9],4,-640364487),t=ve(t,n,i,a,o[r+12],11,-421815835),a=ve(a,t,n,i,o[r+15],16,530742520),i=ve(i,a,t,n,o[r+2],23,-995338651),n=we(n,i,a,t,o[r],6,-198630844),t=we(t,n,i,a,o[r+7],10,1126891415),a=we(a,t,n,i,o[r+14],15,-1416354905),i=we(i,a,t,n,o[r+5],21,-57434055),n=we(n,i,a,t,o[r+12],6,1700485571),t=we(t,n,i,a,o[r+3],10,-1894986606),a=we(a,t,n,i,o[r+10],15,-1051523),i=we(i,a,t,n,o[r+1],21,-2054922799),n=we(n,i,a,t,o[r+8],6,1873313359),t=we(t,n,i,a,o[r+15],10,-30611744),a=we(a,t,n,i,o[r+6],15,-1560198380),i=we(i,a,t,n,o[r+13],21,1309151649),n=we(n,i,a,t,o[r+4],6,-145523070),t=we(t,n,i,a,o[r+11],10,-1120210379),a=we(a,t,n,i,o[r+2],15,718787259),i=we(i,a,t,n,o[r+9],21,-343485551),n=qe(n,s),i=qe(i,u),a=qe(a,f),t=qe(t,c)}return[n,i,a,t]}function su(o){if(o.length===0)return[];for(var e=o.length*8,n=new Uint32Array(ms(e)),i=0;i<e;i+=8)n[i>>5]|=(o[i/8]&255)<<i%32;return n}function qe(o,e){var n=(o&65535)+(e&65535),i=(o>>16)+(e>>16)+(n>>16);return i<<16|n&65535}function au(o,e){return o<<e|o>>>32-e}function Dt(o,e,n,i,a,t){return qe(au(qe(qe(e,o),qe(i,t)),a),n)}function ge(o,e,n,i,a,t,r){return Dt(e&n|~e&i,o,e,a,t,r)}function ye(o,e,n,i,a,t,r){return Dt(e&i|n&~i,o,e,a,t,r)}function ve(o,e,n,i,a,t,r){return Dt(e^n^i,o,e,a,t,r)}function we(o,e,n,i,a,t,r){return Dt(n^(e|~i),o,e,a,t,r)}var uu=ds("v3",48,nu);const cu=uu;function lu(o,e,n){o=o||{};var i=o.random||(o.rng||ps)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(var a=0;a<16;++a)e[n+a]=i[a];return e}return Ct(i)}function fu(o,e,n,i){switch(o){case 0:return e&n^~e&i;case 1:return e^n^i;case 2:return e&n^e&i^n&i;case 3:return e^n^i}}function _r(o,e){return o<<e|o>>>32-e}function pu(o){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof o=="string"){var i=unescape(encodeURIComponent(o));o=[];for(var a=0;a<i.length;++a)o.push(i.charCodeAt(a))}else Array.isArray(o)||(o=Array.prototype.slice.call(o));o.push(128);for(var t=o.length/4+2,r=Math.ceil(t/16),s=new Array(r),u=0;u<r;++u){for(var f=new Uint32Array(16),c=0;c<16;++c)f[c]=o[u*64+c*4]<<24|o[u*64+c*4+1]<<16|o[u*64+c*4+2]<<8|o[u*64+c*4+3];s[u]=f}s[r-1][14]=(o.length-1)*8/Math.pow(2,32),s[r-1][14]=Math.floor(s[r-1][14]),s[r-1][15]=(o.length-1)*8&4294967295;for(var h=0;h<r;++h){for(var l=new Uint32Array(80),g=0;g<16;++g)l[g]=s[h][g];for(var y=16;y<80;++y)l[y]=_r(l[y-3]^l[y-8]^l[y-14]^l[y-16],1);for(var b=n[0],O=n[1],x=n[2],v=n[3],m=n[4],D=0;D<80;++D){var A=Math.floor(D/20),w=_r(b,5)+fu(A,O,x,v)+m+e[A]+l[D]>>>0;m=v,v=x,x=_r(O,30)>>>0,O=b,b=w}n[0]=n[0]+b>>>0,n[1]=n[1]+O>>>0,n[2]=n[2]+x>>>0,n[3]=n[3]+v>>>0,n[4]=n[4]+m>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var hu=ds("v5",80,pu);const du=hu,mu="00000000-0000-0000-0000-000000000000";function gu(o){if(!Ot(o))throw TypeError("Invalid UUID");return parseInt(o.substr(14,1),16)}const yu=Object.freeze(Object.defineProperty({__proto__:null,NIL:mu,parse:hs,stringify:Ct,v1:Za,v3:cu,v4:lu,v5:du,validate:Ot,version:gu},Symbol.toStringTag,{value:"Module"})),vu=Zs(yu),wu=Ws,at=An,{v1:al,v4:Eu}=vu;let bu=class{constructor(e){at(e,'must pass "config"'),at(e.url,'must pass "url"'),at(e.appkey,'must pass "appkey"'),at(e.token,"must first get token from cache or getToken interface"),this._config=e}start(e,n){if(typeof e!="function")throw new Error("expect function onmessage");if(typeof n!="function")throw new Error("expect function onclose");return this._ws=new wu(this._config.url,{headers:{"X-NLS-Token":this._config.token},perMessageDeflate:!1}),this._ws.on("message",(i,a)=>{e(i,a)}),this._ws.on("close",()=>{n()}),new Promise((i,a)=>{this._ws.on("open",()=>{i()}),this._ws.on("error",t=>{a(t)})})}send(e,n){this._ws!=null&&this._ws.send(e,{binary:n})}setPing(e,n){this._ping=setInterval(()=>{this._ws.ping(n)},e)}clearPing(){this._ping&&clearInterval(this._ping)}shutdown(){this._ws!=null&&(this._ping!=null&&clearInterval(this._ping),this._ws.terminate())}uuid(){return Eu().split("-").join("")}defaultContext(){return{sdk:{name:"nls-nodejs-sdk",version:"0.0.1",language:"nodejs"}}}};var Tu=bu;Be.EventEmitter;Be.EventEmitter;const Ou=Tu,Cu=Be.EventEmitter;class Du{constructor(e,n=!1){this._event=new Cu,this._config=e,n?this._namespace="SpeechLongSynthesizer":this._namespace="SpeechSynthesizer"}defaultStartParams(e){return{voice:e,format:"wav",sample_rate:16e3,volume:50,speech_rate:0,pitch_rate:0,enable_subtitle:!1}}on(e,n){this._event.on(e,n)}async start(e,n,i){this._client=new Ou(this._config),this._taskid=this._client.uuid();let a={header:{message_id:this._client.uuid(),task_id:this._taskid,namespace:this._namespace,name:"StartSynthesis",appkey:this._config.appkey},payload:e,context:this._client.defaultContext()};return new Promise(async(t,r)=>{try{await this._client.start((s,u)=>{if(u)this._event.emit("data",s);else{let f=s.toString(),c=JSON.parse(f);c.header.name==="MetaInfo"?this._event.emit("meta",f):c.header.name==="SynthesisCompleted"?(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("completed",f),t(f)):c.header.name==="TaskFailed"&&(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("TaskFailed",f),this._event.emit("failed",f),r(f))}},()=>{this._event.emit("closed")}),n&&(i||(i=6e3),this._client.setPing(i)),this._client.send(JSON.stringify(a),!1)}catch(s){r(s)}})}shutdown(){this._client!=null&&this._client.shutdown()}}var Au=Du;const _u=bt(Au),vt={accessKeyId:"LTAI5tFCh5eoiNZX4n2wEy7Y",accessKeySecret:"XWYRzwspo5z4Ukuo8lKxZX4pUSgQ86",appkey:"JbBUqMYRUt0DrMcK",endpoint:"https://nls-gateway.aliyuncs.com",regionId:"cn-shanghai",ttsUrl:"wss://nls-gateway-cn-shanghai.aliyuncs.com/ws/v1"};var At={exports:{}},ze={},bn={exports:{}},ut={exports:{}},Nr,Vi;function gs(){if(Vi)return Nr;Vi=1;var o=1e3,e=o*60,n=e*60,i=n*24,a=i*7,t=i*365.25;Nr=function(c,h){h=h||{};var l=typeof c;if(l==="string"&&c.length>0)return r(c);if(l==="number"&&isFinite(c))return h.long?u(c):s(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function r(c){if(c=String(c),!(c.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(h){var l=parseFloat(h[1]),g=(h[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return l*t;case"weeks":case"week":case"w":return l*a;case"days":case"day":case"d":return l*i;case"hours":case"hour":case"hrs":case"hr":case"h":return l*n;case"minutes":case"minute":case"mins":case"min":case"m":return l*e;case"seconds":case"second":case"secs":case"sec":case"s":return l*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}function s(c){var h=Math.abs(c);return h>=i?Math.round(c/i)+"d":h>=n?Math.round(c/n)+"h":h>=e?Math.round(c/e)+"m":h>=o?Math.round(c/o)+"s":c+"ms"}function u(c){var h=Math.abs(c);return h>=i?f(c,h,i,"day"):h>=n?f(c,h,n,"hour"):h>=e?f(c,h,e,"minute"):h>=o?f(c,h,o,"second"):c+" ms"}function f(c,h,l,g){var y=h>=l*1.5;return Math.round(c/l)+" "+g+(y?"s":"")}return Nr}var Ir,zi;function ys(){if(zi)return Ir;zi=1;function o(e){i.debug=i,i.default=i,i.coerce=f,i.disable=s,i.enable=t,i.enabled=u,i.humanize=gs(),i.destroy=c,Object.keys(e).forEach(h=>{i[h]=e[h]}),i.names=[],i.skips=[],i.formatters={};function n(h){let l=0;for(let g=0;g<h.length;g++)l=(l<<5)-l+h.charCodeAt(g),l|=0;return i.colors[Math.abs(l)%i.colors.length]}i.selectColor=n;function i(h){let l,g=null,y,b;function O(...x){if(!O.enabled)return;const v=O,m=Number(new Date),D=m-(l||m);v.diff=D,v.prev=l,v.curr=m,l=m,x[0]=i.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let A=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(_,T)=>{if(_==="%%")return"%";A++;const p=i.formatters[T];if(typeof p=="function"){const C=x[A];_=p.call(v,C),x.splice(A,1),A--}return _}),i.formatArgs.call(v,x),(v.log||i.log).apply(v,x)}return O.namespace=h,O.useColors=i.useColors(),O.color=i.selectColor(h),O.extend=a,O.destroy=i.destroy,Object.defineProperty(O,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(y!==i.namespaces&&(y=i.namespaces,b=i.enabled(h)),b),set:x=>{g=x}}),typeof i.init=="function"&&i.init(O),O}function a(h,l){const g=i(this.namespace+(typeof l>"u"?":":l)+h);return g.log=this.log,g}function t(h){i.save(h),i.namespaces=h,i.names=[],i.skips=[];const l=(typeof h=="string"?h:"").trim().replace(" ",",").split(",").filter(Boolean);for(const g of l)g[0]==="-"?i.skips.push(g.slice(1)):i.names.push(g)}function r(h,l){let g=0,y=0,b=-1,O=0;for(;g<h.length;)if(y<l.length&&(l[y]===h[g]||l[y]==="*"))l[y]==="*"?(b=y,O=g,y++):(g++,y++);else if(b!==-1)y=b+1,O++,g=O;else return!1;for(;y<l.length&&l[y]==="*";)y++;return y===l.length}function s(){const h=[...i.names,...i.skips.map(l=>"-"+l)].join(",");return i.enable(""),h}function u(h){for(const l of i.skips)if(r(h,l))return!1;for(const l of i.names)if(r(h,l))return!0;return!1}function f(h){return h instanceof Error?h.stack||h.message:h}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return i.enable(i.load()),i}return Ir=o,Ir}var Wi;function Nu(){return Wi||(Wi=1,function(o,e){e.formatArgs=i,e.save=a,e.load=t,e.useColors=n,e.storage=r(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let u;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(u=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(u[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;u.splice(1,0,f,"color: inherit");let c=0,h=0;u[0].replace(/%[a-zA-Z%]/g,l=>{l!=="%%"&&(c++,l==="%c"&&(h=c))}),u.splice(h,0,f)}e.log=console.debug||console.log||(()=>{});function a(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function t(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=process.env.DEBUG),u}function r(){try{return localStorage}catch{}}o.exports=ys()(e);const{formatters:s}=o.exports;s.j=function(u){try{return JSON.stringify(u)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}(ut,ut.exports)),ut.exports}var ct={exports:{}},xr,Hi;function Iu(){return Hi||(Hi=1,xr=(o,e=process.argv)=>{const n=o.startsWith("-")?"":o.length===1?"-":"--",i=e.indexOf(n+o),a=e.indexOf("--");return i!==-1&&(a===-1||i<a)}),xr}var Fr,Gi;function vs(){if(Gi)return Fr;Gi=1;const o=$e,e=Nn,n=Iu(),{env:i}=process;let a;n("no-color")||n("no-colors")||n("color=false")||n("color=never")?a=0:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(a=1),"FORCE_COLOR"in i&&(i.FORCE_COLOR==="true"?a=1:i.FORCE_COLOR==="false"?a=0:a=i.FORCE_COLOR.length===0?1:Math.min(parseInt(i.FORCE_COLOR,10),3));function t(u){return u===0?!1:{level:u,hasBasic:!0,has256:u>=2,has16m:u>=3}}function r(u,f){if(a===0)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(u&&!f&&a===void 0)return 0;const c=a||0;if(i.TERM==="dumb")return c;if(process.platform==="win32"){const h=o.release().split(".");return Number(h[0])>=10&&Number(h[2])>=10586?Number(h[2])>=14931?3:2:1}if("CI"in i)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(h=>h in i)||i.CI_NAME==="codeship"?1:c;if("TEAMCITY_VERSION"in i)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(i.TEAMCITY_VERSION)?1:0;if(i.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in i){const h=parseInt((i.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(i.TERM_PROGRAM){case"iTerm.app":return h>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(i.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(i.TERM)||"COLORTERM"in i?1:c}function s(u){const f=r(u,u&&u.isTTY);return t(f)}return Fr={supportsColor:s,stdout:t(r(!0,e.isatty(1))),stderr:t(r(!0,e.isatty(2)))},Fr}var Ki;function xu(){return Ki||(Ki=1,function(o,e){const n=Nn,i=tt;e.init=c,e.log=s,e.formatArgs=t,e.save=u,e.load=f,e.useColors=a,e.destroy=i.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),e.colors=[6,2,3,4,5,1];try{const l=vs();l&&(l.stderr||l).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(l=>/^debug_/i.test(l)).reduce((l,g)=>{const y=g.substring(6).toLowerCase().replace(/_([a-z])/g,(O,x)=>x.toUpperCase());let b=process.env[g];return/^(yes|on|true|enabled)$/i.test(b)?b=!0:/^(no|off|false|disabled)$/i.test(b)?b=!1:b==="null"?b=null:b=Number(b),l[y]=b,l},{});function a(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:n.isatty(process.stderr.fd)}function t(l){const{namespace:g,useColors:y}=this;if(y){const b=this.color,O="\x1B[3"+(b<8?b:"8;5;"+b),x=`  ${O};1m${g} \x1B[0m`;l[0]=x+l[0].split(`
`).join(`
`+x),l.push(O+"m+"+o.exports.humanize(this.diff)+"\x1B[0m")}else l[0]=r()+g+" "+l[0]}function r(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function s(...l){return process.stderr.write(i.formatWithOptions(e.inspectOpts,...l)+`
`)}function u(l){l?process.env.DEBUG=l:delete process.env.DEBUG}function f(){return process.env.DEBUG}function c(l){l.inspectOpts={};const g=Object.keys(e.inspectOpts);for(let y=0;y<g.length;y++)l.inspectOpts[g[y]]=e.inspectOpts[g[y]]}o.exports=ys()(e);const{formatters:h}=o.exports;h.o=function(l){return this.inspectOpts.colors=this.useColors,i.inspect(l,this.inspectOpts).split(`
`).map(g=>g.trim()).join(" ")},h.O=function(l){return this.inspectOpts.colors=this.useColors,i.inspect(l,this.inspectOpts)}}(ct,ct.exports)),ct.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?bn.exports=Nu():bn.exports=xu();var ws=bn.exports;const Yi=Hs,Es=wt,bs=Et,Fu=_n.parse,Su=_n.format,Ie=ws("httpx:body"),lt=ws("httpx:header"),Pu=new Es.Agent({keepAlive:!0}),Lu=new bs.Agent({keepAlive:!0}),Sr=3e3,Re=Symbol("TIMER::READ_TIMER"),Tn=Symbol("TIMER::READ_TIME_OUT"),Ts=Symbol("TIMER::READ_TIMER_START_AT");function Os(o){switch(o.headers["content-encoding"]){case"gzip":return o.pipe(Yi.createGunzip());case"deflate":return o.pipe(Yi.createInflate());default:return o}}var Ji=function(o,e,n){return o.name=e+o.name,o.message=`${n}. ${o.message}`,o};const Ge=function(o){return o!==null&&!isNaN(o)};ze.request=function(o,e){e||(e={});const n=typeof o=="string"?Fu(o):o;let i,a;Ge(e.readTimeout)||Ge(e.connectTimeout)?(i=Ge(e.readTimeout)?Number(e.readTimeout):Sr,a=Ge(e.connectTimeout)?Number(e.connectTimeout):Sr):Ge(e.timeout)?i=a=Number(e.timeout):i=a=Sr;const t=n.protocol==="https:",r=(e.method||"GET").toUpperCase(),s=t?Lu:Pu,u=e.agent||s;var f={host:n.hostname||"localhost",path:n.path||"/",method:r,port:n.port||(n.protocol==="https:"?443:80),agent:u,headers:e.headers||{},key:e.key||"",cert:e.cert||"",ca:e.ca||"",timeout:a};t&&typeof e.rejectUnauthorized<"u"&&(f.rejectUnauthorized=e.rejectUnauthorized),e.compression&&(f.headers["accept-encoding"]="gzip,deflate");const c=t?bs:Es;return typeof e.beforeRequest=="function"&&(f=e.beforeRequest(f)),new Promise((h,l)=>{const g=c.request(f),y=e.data;var b=m=>{lt.enabled&&(m.req._header.split(`\r
`).forEach(A=>{lt("> %s",A)}),lt("< HTTP/%s %s %s",m.httpVersion,m.statusCode,m.statusMessage),Object.keys(m.headers).forEach(A=>{lt("< %s: %s",A,m.headers[A])})),h(m)},O=m=>{m.message+=`${r} ${Su(n)} failed.`,g.socket&&g.socket[Re]&&clearTimeout(g.socket[Re]),l(m)},x=m=>{g.abort(),O(m)};const v=function(m){const D=setTimeout(()=>{m[Re]&&(clearTimeout(m[Re]),m[Re]=null);var A=new Error,w=`ReadTimeout(${i})`;x(Ji(A,"RequestTimeout",w))},i);m[Tn]=i,m[Re]=D,m[Ts]=Date.now(),D.unref()};!y||typeof y=="string"||y instanceof Buffer?(Ie.enabled&&Ie(y?typeof y=="string"?y:`Buffer <ignored>, Buffer length: ${y.length}`:"<no request body>"),g.end(y)):typeof y.pipe=="function"&&(y.pipe(g),Ie.enabled&&Ie("<request body is a stream>"),y.once("error",m=>{x(Ji(m,"HttpX","Stream occor error"))})),g.on("timeout",()=>{var m=new Error;m.name="RequestTimeoutError",m.message=`ConnectTimeout: Connect ${o} failed.`,g.destroy(),l(m)}),g.on("response",b),g.on("error",O),g.once("socket",function(m){m.readyState==="opening"?m.once("connect",function(){v(m)}):v(m)})})};ze.read=function(o,e){const n=Os(o);return new Promise((i,a)=>{const t=o.socket||o.client,r=()=>{const O=o.req;var x=new Error;return x.name="RequestTimeoutError",x.message=`ReadTimeout: ${t[Tn]}. ${O.method} ${O.path} failed.`,x};let s;const u=t[Re];if(!u){a(r());return}const f=t[Tn]-(Date.now()-t[Ts]);if(clearTimeout(u),f<=0){a(r());return}s=setTimeout(function(){a(r())},f);var c,h,l,g=function(){n.removeListener("error",c),n.removeListener("data",h),n.removeListener("end",l),s&&clearTimeout(s)};const y=[];var b=0;h=function(O){y.push(O),b+=O.length},c=function(O){g(),a(O)},l=function(){g();var O=Buffer.concat(y,b);if(Ie(""),e){const x=O.toString(e);return Ie(x),i(x)}Ie.enabled&&Ie(O.toString()),i(O)},n.on("error",c),n.on("data",h),n.on("end",l)})};function Mu(o){return new Promise((e,n)=>{var i,a,t,r=function(){o.removeListener("error",t),o.removeListener("end",a),o.removeListener("readable",i)};i=function(){r(),e(!1)},a=function(){r(),e(!0)},t=function(s){r(),n(s)},o.once("readable",i),o.once("end",a),o.once("error",t)})}class Cs{constructor(e,n,i,a){this.id=e,this.event=n,this.data=i,this.retry=a}}ze.Event=Cs;const Qi="data:",Zi="event:",eo="id:",to="retry:";function Ru(o){for(let e=0;e<o.length;e++){const n=o.charAt(e);if(n<"0"||n>"9")return!1}return o.length>0}function ju(o,e){const n=o+e;let i=0;const a=[];for(let r=0;r<n.length-1;r++){const s=n[r],u=n[r+1];if(s===`
`&&u===`
`){const c=n.substring(i,r).split(`
`),h=new Cs;c.forEach(l=>{if(l.startsWith(Qi))h.data=l.substring(Qi.length).trim();else if(l.startsWith(Zi))h.event=l.substring(Zi.length).trim();else if(l.startsWith(eo))h.id=l.substring(eo.length).trim();else if(l.startsWith(to)){const g=l.substring(to.length).trim();Ru(g)&&(h.retry=parseInt(g,10))}else l.startsWith(":")}),a.push(h),i=r+2}}const t=n.substring(i);return[a,t]}ze.readAsSSE=async function*(o){const e=Os(o),n=o.socket||o.client;clearTimeout(n[Re]);let i="";for(;;){if(await Mu(e))return;let t;for(;(t=e.read())!==null;){const[r,s]=ju(i,t.toString());if(i=s,r&&r.length>0)for(const u of r)yield u}}};var Sn={};(function(o){const e=ae,n=$e,i=Ae;o.loadJSONSync=function(a){var t=e.readFileSync(a,"utf8");t.charCodeAt(0)===65279&&(t=t.slice(1));try{return JSON.parse(t)}catch(r){throw r.message=a+": "+r.message,r}},o.encode=function(a,t){return typeof a!="string"&&(a=""+a),new Buffer(a,t)},o.makeHasher=function(a){return function(t,r){var s=i.createHash(a);return s.update(t),s.digest(r)}},o.createHash=o.makeHasher,o.md5=o.makeHasher("md5"),o.createHmac=function(a){return function(t,r,s){return i.createHmac(a,r).update(t).digest(s)}},o.sha1=o.createHmac("sha1"),o.random=function(a,t){return Math.floor(a+Math.random()*(t-a))},o.makeNonce=function(){var a=0,t;const r=n.hostname(),s=process.pid;return function(){var u=Math.floor(Math.random()*1e12);u===t?a++:a=0,t=u;var f=`${r}${s}${u}${a}`;return o.md5(f,"hex")}}(),o.pad2=function(a){return a<10?"0"+a:""+a},o.pad3=function(a){return a<10?"00"+a:a<100?"0"+a:""+a},o.getYYYYMMDD=function(a){var t=a.getFullYear(),r=o.pad2(a.getMonth()+1),s=o.pad2(a.getDate());return""+t+r+s},o.sleep=function(a){return new Promise(t=>{setTimeout(t,a)})},o.getIPv4=function(){for(var a=n.networkInterfaces(),t=Object.keys(a),r=0;r<t.length;r++)for(var s=t[r],u=a[s],f=0;f<u.length;f++){var c=u[f];if(!c.internal&&c.family==="IPv4")return c.address}return""},o.getMac=function(){for(var a=n.networkInterfaces(),t=Object.keys(a),r=0;r<t.length;r++)for(var s=t[r],u=a[s],f=0;f<u.length;f++){var c=u[f];if(!c.internal&&c.family==="IPv4")return c.mac}return"00:00:00:00:00:00"}})(Sn);var _t={exports:{}},Ds={exports:{}},As={exports:{}};(function(o){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,t=Math.floor,r="[BigNumber Error] ",s=r+"Number primitive has more than 15 significant digits: ",u=1e14,f=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],l=1e7,g=1e9;function y(w){var _,T,p,C=z.prototype={constructor:z,toString:null,valueOf:null},F=new z(1),M=20,U=4,W=-7,H=21,J=-1e7,Y=1e7,Te=!1,Oe=1,he=0,fe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Ee="0123456789abcdefghijklmnopqrstuvwxyz",Le=!0;function z(d,I){var S,q,L,R,B,P,j,k,$=this;if(!($ instanceof z))return new z(d,I);if(I==null){if(d&&d._isBigNumber===!0){$.s=d.s,!d.c||d.e>Y?$.c=$.e=null:d.e<J?$.c=[$.e=0]:($.e=d.e,$.c=d.c.slice());return}if((P=typeof d=="number")&&d*0==0){if($.s=1/d<0?(d=-d,-1):1,d===~~d){for(R=0,B=d;B>=10;B/=10,R++);R>Y?$.c=$.e=null:($.e=R,$.c=[d]);return}k=String(d)}else{if(!i.test(k=String(d)))return p($,k,P);$.s=k.charCodeAt(0)==45?(k=k.slice(1),-1):1}(R=k.indexOf("."))>-1&&(k=k.replace(".","")),(B=k.search(/e/i))>0?(R<0&&(R=B),R+=+k.slice(B+1),k=k.substring(0,B)):R<0&&(R=k.length)}else{if(v(I,2,Ee.length,"Base"),I==10&&Le)return $=new z(d),E($,M+$.e+1,U);if(k=String(d),P=typeof d=="number"){if(d*0!=0)return p($,k,P,I);if($.s=1/d<0?(k=k.slice(1),-1):1,z.DEBUG&&k.replace(/^0\.0*|\./,"").length>15)throw Error(s+d)}else $.s=k.charCodeAt(0)===45?(k=k.slice(1),-1):1;for(S=Ee.slice(0,I),R=B=0,j=k.length;B<j;B++)if(S.indexOf(q=k.charAt(B))<0){if(q=="."){if(B>R){R=j;continue}}else if(!L&&(k==k.toUpperCase()&&(k=k.toLowerCase())||k==k.toLowerCase()&&(k=k.toUpperCase()))){L=!0,B=-1,R=0;continue}return p($,String(d),P,I)}P=!1,k=T(k,I,10,$.s),(R=k.indexOf("."))>-1?k=k.replace(".",""):R=k.length}for(B=0;k.charCodeAt(B)===48;B++);for(j=k.length;k.charCodeAt(--j)===48;);if(k=k.slice(B,++j)){if(j-=B,P&&z.DEBUG&&j>15&&(d>c||d!==t(d)))throw Error(s+$.s*d);if((R=R-B-1)>Y)$.c=$.e=null;else if(R<J)$.c=[$.e=0];else{if($.e=R,$.c=[],B=(R+1)%f,R<0&&(B+=f),B<j){for(B&&$.c.push(+k.slice(0,B)),j-=f;B<j;)$.c.push(+k.slice(B,B+=f));B=f-(k=k.slice(B)).length}else B-=j;for(;B--;k+="0");$.c.push(+k)}}else $.c=[$.e=0]}z.clone=y,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(d){var I,S;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(I="DECIMAL_PLACES")&&(S=d[I],v(S,0,g,I),M=S),d.hasOwnProperty(I="ROUNDING_MODE")&&(S=d[I],v(S,0,8,I),U=S),d.hasOwnProperty(I="EXPONENTIAL_AT")&&(S=d[I],S&&S.pop?(v(S[0],-g,0,I),v(S[1],0,g,I),W=S[0],H=S[1]):(v(S,-g,g,I),W=-(H=S<0?-S:S))),d.hasOwnProperty(I="RANGE"))if(S=d[I],S&&S.pop)v(S[0],-g,-1,I),v(S[1],1,g,I),J=S[0],Y=S[1];else if(v(S,-g,g,I),S)J=-(Y=S<0?-S:S);else throw Error(r+I+" cannot be zero: "+S);if(d.hasOwnProperty(I="CRYPTO"))if(S=d[I],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Te=S;else throw Te=!S,Error(r+"crypto unavailable");else Te=S;else throw Error(r+I+" not true or false: "+S);if(d.hasOwnProperty(I="MODULO_MODE")&&(S=d[I],v(S,0,9,I),Oe=S),d.hasOwnProperty(I="POW_PRECISION")&&(S=d[I],v(S,0,g,I),he=S),d.hasOwnProperty(I="FORMAT"))if(S=d[I],typeof S=="object")fe=S;else throw Error(r+I+" not an object: "+S);if(d.hasOwnProperty(I="ALPHABET"))if(S=d[I],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))Le=S.slice(0,10)=="0123456789",Ee=S;else throw Error(r+I+" invalid: "+S)}else throw Error(r+"Object expected: "+d);return{DECIMAL_PLACES:M,ROUNDING_MODE:U,EXPONENTIAL_AT:[W,H],RANGE:[J,Y],CRYPTO:Te,MODULO_MODE:Oe,POW_PRECISION:he,FORMAT:fe,ALPHABET:Ee}},z.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!z.DEBUG)return!0;var I,S,q=d.c,L=d.e,R=d.s;e:if({}.toString.call(q)=="[object Array]"){if((R===1||R===-1)&&L>=-g&&L<=g&&L===t(L)){if(q[0]===0){if(L===0&&q.length===1)return!0;break e}if(I=(L+1)%f,I<1&&(I+=f),String(q[0]).length==I){for(I=0;I<q.length;I++)if(S=q[I],S<0||S>=u||S!==t(S))break e;if(S!==0)return!0}}}else if(q===null&&L===null&&(R===null||R===1||R===-1))return!0;throw Error(r+"Invalid BigNumber: "+d)},z.maximum=z.max=function(){return nt(arguments,-1)},z.minimum=z.min=function(){return nt(arguments,1)},z.random=function(){var d=9007199254740992,I=Math.random()*d&2097151?function(){return t(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var q,L,R,B,P,j=0,k=[],$=new z(F);if(S==null?S=M:v(S,0,g),B=a(S/f),Te)if(crypto.getRandomValues){for(q=crypto.getRandomValues(new Uint32Array(B*=2));j<B;)P=q[j]*131072+(q[j+1]>>>11),P>=9e15?(L=crypto.getRandomValues(new Uint32Array(2)),q[j]=L[0],q[j+1]=L[1]):(k.push(P%1e14),j+=2);j=B/2}else if(crypto.randomBytes){for(q=crypto.randomBytes(B*=7);j<B;)P=(q[j]&31)*281474976710656+q[j+1]*1099511627776+q[j+2]*4294967296+q[j+3]*16777216+(q[j+4]<<16)+(q[j+5]<<8)+q[j+6],P>=9e15?crypto.randomBytes(7).copy(q,j):(k.push(P%1e14),j+=7);j=B/7}else throw Te=!1,Error(r+"crypto unavailable");if(!Te)for(;j<B;)P=I(),P<9e15&&(k[j++]=P%1e14);for(B=k[--j],S%=f,B&&S&&(P=h[f-S],k[j]=t(B/P)*P);k[j]===0;k.pop(),j--);if(j<0)k=[R=0];else{for(R=-1;k[0]===0;k.splice(0,1),R-=f);for(j=1,P=k[0];P>=10;P/=10,j++);j<f&&(R-=f-j)}return $.e=R,$.c=k,$}}(),z.sum=function(){for(var d=1,I=arguments,S=new z(I[0]);d<I.length;)S=S.plus(I[d++]);return S},T=function(){var d="0123456789";function I(S,q,L,R){for(var B,P=[0],j,k=0,$=S.length;k<$;){for(j=P.length;j--;P[j]*=q);for(P[0]+=R.indexOf(S.charAt(k++)),B=0;B<P.length;B++)P[B]>L-1&&(P[B+1]==null&&(P[B+1]=0),P[B+1]+=P[B]/L|0,P[B]%=L)}return P.reverse()}return function(S,q,L,R,B){var P,j,k,$,V,G,K,ie,ue=S.indexOf("."),pe=M,ne=U;for(ue>=0&&($=he,he=0,S=S.replace(".",""),ie=new z(q),G=ie.pow(S.length-ue),he=$,ie.c=I(A(O(G.c),G.e,"0"),10,L,d),ie.e=ie.c.length),K=I(S,q,L,B?(P=Ee,d):(P=d,Ee)),k=$=K.length;K[--$]==0;K.pop());if(!K[0])return P.charAt(0);if(ue<0?--k:(G.c=K,G.e=k,G.s=R,G=_(G,ie,pe,ne,L),K=G.c,V=G.r,k=G.e),j=k+pe+1,ue=K[j],$=L/2,V=V||j<0||K[j+1]!=null,V=ne<4?(ue!=null||V)&&(ne==0||ne==(G.s<0?3:2)):ue>$||ue==$&&(ne==4||V||ne==6&&K[j-1]&1||ne==(G.s<0?8:7)),j<1||!K[0])S=V?A(P.charAt(1),-pe,P.charAt(0)):P.charAt(0);else{if(K.length=j,V)for(--L;++K[--j]>L;)K[j]=0,j||(++k,K=[1].concat(K));for($=K.length;!K[--$];);for(ue=0,S="";ue<=$;S+=P.charAt(K[ue++]));S=A(S,k,P.charAt(0))}return S}}(),_=function(){function d(q,L,R){var B,P,j,k,$=0,V=q.length,G=L%l,K=L/l|0;for(q=q.slice();V--;)j=q[V]%l,k=q[V]/l|0,B=K*j+k*G,P=G*j+B%l*l+$,$=(P/R|0)+(B/l|0)+K*k,q[V]=P%R;return $&&(q=[$].concat(q)),q}function I(q,L,R,B){var P,j;if(R!=B)j=R>B?1:-1;else for(P=j=0;P<R;P++)if(q[P]!=L[P]){j=q[P]>L[P]?1:-1;break}return j}function S(q,L,R,B){for(var P=0;R--;)q[R]-=P,P=q[R]<L[R]?1:0,q[R]=P*B+q[R]-L[R];for(;!q[0]&&q.length>1;q.splice(0,1));}return function(q,L,R,B,P){var j,k,$,V,G,K,ie,ue,pe,ne,se,me,it,St,Pt,_e,We,Ce=q.s==L.s?1:-1,be=q.c,ce=L.c;if(!be||!be[0]||!ce||!ce[0])return new z(!q.s||!L.s||(be?ce&&be[0]==ce[0]:!ce)?NaN:be&&be[0]==0||!ce?Ce*0:Ce/0);for(ue=new z(Ce),pe=ue.c=[],k=q.e-L.e,Ce=R+k+1,P||(P=u,k=b(q.e/f)-b(L.e/f),Ce=Ce/f|0),$=0;ce[$]==(be[$]||0);$++);if(ce[$]>(be[$]||0)&&k--,Ce<0)pe.push(1),V=!0;else{for(St=be.length,_e=ce.length,$=0,Ce+=2,G=t(P/(ce[0]+1)),G>1&&(ce=d(ce,G,P),be=d(be,G,P),_e=ce.length,St=be.length),it=_e,ne=be.slice(0,_e),se=ne.length;se<_e;ne[se++]=0);We=ce.slice(),We=[0].concat(We),Pt=ce[0],ce[1]>=P/2&&Pt++;do{if(G=0,j=I(ce,ne,_e,se),j<0){if(me=ne[0],_e!=se&&(me=me*P+(ne[1]||0)),G=t(me/Pt),G>1)for(G>=P&&(G=P-1),K=d(ce,G,P),ie=K.length,se=ne.length;I(K,ne,ie,se)==1;)G--,S(K,_e<ie?We:ce,ie,P),ie=K.length,j=1;else G==0&&(j=G=1),K=ce.slice(),ie=K.length;if(ie<se&&(K=[0].concat(K)),S(ne,K,se,P),se=ne.length,j==-1)for(;I(ce,ne,_e,se)<1;)G++,S(ne,_e<se?We:ce,se,P),se=ne.length}else j===0&&(G++,ne=[0]);pe[$++]=G,ne[0]?ne[se++]=be[it]||0:(ne=[be[it]],se=1)}while((it++<St||ne[0]!=null)&&Ce--);V=ne[0]!=null,pe[0]||pe.splice(0,1)}if(P==u){for($=1,Ce=pe[0];Ce>=10;Ce/=10,$++);E(ue,R+(ue.e=$+k*f-1)+1,B,V)}else ue.e=k,ue.r=+V;return ue}}();function Xe(d,I,S,q){var L,R,B,P,j;if(S==null?S=U:v(S,0,8),!d.c)return d.toString();if(L=d.c[0],B=d.e,I==null)j=O(d.c),j=q==1||q==2&&(B<=W||B>=H)?D(j,B):A(j,B,"0");else if(d=E(new z(d),I,S),R=d.e,j=O(d.c),P=j.length,q==1||q==2&&(I<=R||R<=W)){for(;P<I;j+="0",P++);j=D(j,R)}else if(I-=B,j=A(j,R,"0"),R+1>P){if(--I>0)for(j+=".";I--;j+="0");}else if(I+=R-P,I>0)for(R+1==P&&(j+=".");I--;j+="0");return d.s<0&&L?"-"+j:j}function nt(d,I){for(var S,q,L=1,R=new z(d[0]);L<d.length;L++)q=new z(d[L]),(!q.s||(S=x(R,q))===I||S===0&&R.s===I)&&(R=q);return R}function N(d,I,S){for(var q=1,L=I.length;!I[--L];I.pop());for(L=I[0];L>=10;L/=10,q++);return(S=q+S*f-1)>Y?d.c=d.e=null:S<J?d.c=[d.e=0]:(d.e=S,d.c=I),d}p=function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,I=/^([^.]+)\.$/,S=/^\.([^.]+)$/,q=/^-?(Infinity|NaN)$/,L=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,B,P,j){var k,$=P?B:B.replace(L,"");if(q.test($))R.s=isNaN($)?null:$<0?-1:1;else{if(!P&&($=$.replace(d,function(V,G,K){return k=(K=K.toLowerCase())=="x"?16:K=="b"?2:8,!j||j==k?G:V}),j&&(k=j,$=$.replace(I,"$1").replace(S,"0.$1")),B!=$))return new z($,k);if(z.DEBUG)throw Error(r+"Not a"+(j?" base "+j:"")+" number: "+B);R.s=null}R.c=R.e=null}}();function E(d,I,S,q){var L,R,B,P,j,k,$,V=d.c,G=h;if(V){e:{for(L=1,P=V[0];P>=10;P/=10,L++);if(R=I-L,R<0)R+=f,B=I,j=V[k=0],$=t(j/G[L-B-1]%10);else if(k=a((R+1)/f),k>=V.length)if(q){for(;V.length<=k;V.push(0));j=$=0,L=1,R%=f,B=R-f+1}else break e;else{for(j=P=V[k],L=1;P>=10;P/=10,L++);R%=f,B=R-f+L,$=B<0?0:t(j/G[L-B-1]%10)}if(q=q||I<0||V[k+1]!=null||(B<0?j:j%G[L-B-1]),q=S<4?($||q)&&(S==0||S==(d.s<0?3:2)):$>5||$==5&&(S==4||q||S==6&&(R>0?B>0?j/G[L-B]:0:V[k-1])%10&1||S==(d.s<0?8:7)),I<1||!V[0])return V.length=0,q?(I-=d.e+1,V[0]=G[(f-I%f)%f],d.e=-I||0):V[0]=d.e=0,d;if(R==0?(V.length=k,P=1,k--):(V.length=k+1,P=G[f-R],V[k]=B>0?t(j/G[L-B]%G[B])*P:0),q)for(;;)if(k==0){for(R=1,B=V[0];B>=10;B/=10,R++);for(B=V[0]+=P,P=1;B>=10;B/=10,P++);R!=P&&(d.e++,V[0]==u&&(V[0]=1));break}else{if(V[k]+=P,V[k]!=u)break;V[k--]=0,P=1}for(R=V.length;V[--R]===0;V.pop());}d.e>Y?d.c=d.e=null:d.e<J&&(d.c=[d.e=0])}return d}function X(d){var I,S=d.e;return S===null?d.toString():(I=O(d.c),I=S<=W||S>=H?D(I,S):A(I,S,"0"),d.s<0?"-"+I:I)}return C.absoluteValue=C.abs=function(){var d=new z(this);return d.s<0&&(d.s=1),d},C.comparedTo=function(d,I){return x(this,new z(d,I))},C.decimalPlaces=C.dp=function(d,I){var S,q,L,R=this;if(d!=null)return v(d,0,g),I==null?I=U:v(I,0,8),E(new z(R),d+R.e+1,I);if(!(S=R.c))return null;if(q=((L=S.length-1)-b(this.e/f))*f,L=S[L])for(;L%10==0;L/=10,q--);return q<0&&(q=0),q},C.dividedBy=C.div=function(d,I){return _(this,new z(d,I),M,U)},C.dividedToIntegerBy=C.idiv=function(d,I){return _(this,new z(d,I),0,1)},C.exponentiatedBy=C.pow=function(d,I){var S,q,L,R,B,P,j,k,$,V=this;if(d=new z(d),d.c&&!d.isInteger())throw Error(r+"Exponent not an integer: "+X(d));if(I!=null&&(I=new z(I)),P=d.e>14,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!d.c||!d.c[0])return $=new z(Math.pow(+X(V),P?d.s*(2-m(d)):+X(d))),I?$.mod(I):$;if(j=d.s<0,I){if(I.c?!I.c[0]:!I.s)return new z(NaN);q=!j&&V.isInteger()&&I.isInteger(),q&&(V=V.mod(I))}else{if(d.e>9&&(V.e>0||V.e<-1||(V.e==0?V.c[0]>1||P&&V.c[1]>=24e7:V.c[0]<8e13||P&&V.c[0]<=9999975e7)))return R=V.s<0&&m(d)?-0:0,V.e>-1&&(R=1/R),new z(j?1/R:R);he&&(R=a(he/f+2))}for(P?(S=new z(.5),j&&(d.s=1),k=m(d)):(L=Math.abs(+X(d)),k=L%2),$=new z(F);;){if(k){if($=$.times(V),!$.c)break;R?$.c.length>R&&($.c.length=R):q&&($=$.mod(I))}if(L){if(L=t(L/2),L===0)break;k=L%2}else if(d=d.times(S),E(d,d.e+1,1),d.e>14)k=m(d);else{if(L=+X(d),L===0)break;k=L%2}V=V.times(V),R?V.c&&V.c.length>R&&(V.c.length=R):q&&(V=V.mod(I))}return q?$:(j&&($=F.div($)),I?$.mod(I):R?E($,he,U,B):$)},C.integerValue=function(d){var I=new z(this);return d==null?d=U:v(d,0,8),E(I,I.e+1,d)},C.isEqualTo=C.eq=function(d,I){return x(this,new z(d,I))===0},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(d,I){return x(this,new z(d,I))>0},C.isGreaterThanOrEqualTo=C.gte=function(d,I){return(I=x(this,new z(d,I)))===1||I===0},C.isInteger=function(){return!!this.c&&b(this.e/f)>this.c.length-2},C.isLessThan=C.lt=function(d,I){return x(this,new z(d,I))<0},C.isLessThanOrEqualTo=C.lte=function(d,I){return(I=x(this,new z(d,I)))===-1||I===0},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&this.c[0]==0},C.minus=function(d,I){var S,q,L,R,B=this,P=B.s;if(d=new z(d,I),I=d.s,!P||!I)return new z(NaN);if(P!=I)return d.s=-I,B.plus(d);var j=B.e/f,k=d.e/f,$=B.c,V=d.c;if(!j||!k){if(!$||!V)return $?(d.s=-I,d):new z(V?B:NaN);if(!$[0]||!V[0])return V[0]?(d.s=-I,d):new z($[0]?B:U==3?-0:0)}if(j=b(j),k=b(k),$=$.slice(),P=j-k){for((R=P<0)?(P=-P,L=$):(k=j,L=V),L.reverse(),I=P;I--;L.push(0));L.reverse()}else for(q=(R=(P=$.length)<(I=V.length))?P:I,P=I=0;I<q;I++)if($[I]!=V[I]){R=$[I]<V[I];break}if(R&&(L=$,$=V,V=L,d.s=-d.s),I=(q=V.length)-(S=$.length),I>0)for(;I--;$[S++]=0);for(I=u-1;q>P;){if($[--q]<V[q]){for(S=q;S&&!$[--S];$[S]=I);--$[S],$[q]+=u}$[q]-=V[q]}for(;$[0]==0;$.splice(0,1),--k);return $[0]?N(d,$,k):(d.s=U==3?-1:1,d.c=[d.e=0],d)},C.modulo=C.mod=function(d,I){var S,q,L=this;return d=new z(d,I),!L.c||!d.s||d.c&&!d.c[0]?new z(NaN):!d.c||L.c&&!L.c[0]?new z(L):(Oe==9?(q=d.s,d.s=1,S=_(L,d,0,3),d.s=q,S.s*=q):S=_(L,d,0,Oe),d=L.minus(S.times(d)),!d.c[0]&&Oe==1&&(d.s=L.s),d)},C.multipliedBy=C.times=function(d,I){var S,q,L,R,B,P,j,k,$,V,G,K,ie,ue,pe,ne=this,se=ne.c,me=(d=new z(d,I)).c;if(!se||!me||!se[0]||!me[0])return!ne.s||!d.s||se&&!se[0]&&!me||me&&!me[0]&&!se?d.c=d.e=d.s=null:(d.s*=ne.s,!se||!me?d.c=d.e=null:(d.c=[0],d.e=0)),d;for(q=b(ne.e/f)+b(d.e/f),d.s*=ne.s,j=se.length,V=me.length,j<V&&(ie=se,se=me,me=ie,L=j,j=V,V=L),L=j+V,ie=[];L--;ie.push(0));for(ue=u,pe=l,L=V;--L>=0;){for(S=0,G=me[L]%pe,K=me[L]/pe|0,B=j,R=L+B;R>L;)k=se[--B]%pe,$=se[B]/pe|0,P=K*k+$*G,k=G*k+P%pe*pe+ie[R]+S,S=(k/ue|0)+(P/pe|0)+K*$,ie[R--]=k%ue;ie[R]=S}return S?++q:ie.splice(0,1),N(d,ie,q)},C.negated=function(){var d=new z(this);return d.s=-d.s||null,d},C.plus=function(d,I){var S,q=this,L=q.s;if(d=new z(d,I),I=d.s,!L||!I)return new z(NaN);if(L!=I)return d.s=-I,q.minus(d);var R=q.e/f,B=d.e/f,P=q.c,j=d.c;if(!R||!B){if(!P||!j)return new z(L/0);if(!P[0]||!j[0])return j[0]?d:new z(P[0]?q:L*0)}if(R=b(R),B=b(B),P=P.slice(),L=R-B){for(L>0?(B=R,S=j):(L=-L,S=P),S.reverse();L--;S.push(0));S.reverse()}for(L=P.length,I=j.length,L-I<0&&(S=j,j=P,P=S,I=L),L=0;I;)L=(P[--I]=P[I]+j[I]+L)/u|0,P[I]=u===P[I]?0:P[I]%u;return L&&(P=[L].concat(P),++B),N(d,P,B)},C.precision=C.sd=function(d,I){var S,q,L,R=this;if(d!=null&&d!==!!d)return v(d,1,g),I==null?I=U:v(I,0,8),E(new z(R),d,I);if(!(S=R.c))return null;if(L=S.length-1,q=L*f+1,L=S[L]){for(;L%10==0;L/=10,q--);for(L=S[0];L>=10;L/=10,q++);}return d&&R.e+1>q&&(q=R.e+1),q},C.shiftedBy=function(d){return v(d,-c,c),this.times("1e"+d)},C.squareRoot=C.sqrt=function(){var d,I,S,q,L,R=this,B=R.c,P=R.s,j=R.e,k=M+4,$=new z("0.5");if(P!==1||!B||!B[0])return new z(!P||P<0&&(!B||B[0])?NaN:B?R:1/0);if(P=Math.sqrt(+X(R)),P==0||P==1/0?(I=O(B),(I.length+j)%2==0&&(I+="0"),P=Math.sqrt(+I),j=b((j+1)/2)-(j<0||j%2),P==1/0?I="5e"+j:(I=P.toExponential(),I=I.slice(0,I.indexOf("e")+1)+j),S=new z(I)):S=new z(P+""),S.c[0]){for(j=S.e,P=j+k,P<3&&(P=0);;)if(L=S,S=$.times(L.plus(_(R,L,k,1))),O(L.c).slice(0,P)===(I=O(S.c)).slice(0,P))if(S.e<j&&--P,I=I.slice(P-3,P+1),I=="9999"||!q&&I=="4999"){if(!q&&(E(L,L.e+M+2,0),L.times(L).eq(R))){S=L;break}k+=4,P+=4,q=1}else{(!+I||!+I.slice(1)&&I.charAt(0)=="5")&&(E(S,S.e+M+2,1),d=!S.times(S).eq(R));break}}return E(S,S.e+M+1,U,d)},C.toExponential=function(d,I){return d!=null&&(v(d,0,g),d++),Xe(this,d,I,1)},C.toFixed=function(d,I){return d!=null&&(v(d,0,g),d=d+this.e+1),Xe(this,d,I)},C.toFormat=function(d,I,S){var q,L=this;if(S==null)d!=null&&I&&typeof I=="object"?(S=I,I=null):d&&typeof d=="object"?(S=d,d=I=null):S=fe;else if(typeof S!="object")throw Error(r+"Argument not an object: "+S);if(q=L.toFixed(d,I),L.c){var R,B=q.split("."),P=+S.groupSize,j=+S.secondaryGroupSize,k=S.groupSeparator||"",$=B[0],V=B[1],G=L.s<0,K=G?$.slice(1):$,ie=K.length;if(j&&(R=P,P=j,j=R,ie-=R),P>0&&ie>0){for(R=ie%P||P,$=K.substr(0,R);R<ie;R+=P)$+=k+K.substr(R,P);j>0&&($+=k+K.slice(R)),G&&($="-"+$)}q=V?$+(S.decimalSeparator||"")+((j=+S.fractionGroupSize)?V.replace(new RegExp("\\d{"+j+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):V):$}return(S.prefix||"")+q+(S.suffix||"")},C.toFraction=function(d){var I,S,q,L,R,B,P,j,k,$,V,G,K=this,ie=K.c;if(d!=null&&(P=new z(d),!P.isInteger()&&(P.c||P.s!==1)||P.lt(F)))throw Error(r+"Argument "+(P.isInteger()?"out of range: ":"not an integer: ")+X(P));if(!ie)return new z(K);for(I=new z(F),k=S=new z(F),q=j=new z(F),G=O(ie),R=I.e=G.length-K.e-1,I.c[0]=h[(B=R%f)<0?f+B:B],d=!d||P.comparedTo(I)>0?R>0?I:k:P,B=Y,Y=1/0,P=new z(G),j.c[0]=0;$=_(P,I,0,1),L=S.plus($.times(q)),L.comparedTo(d)!=1;)S=q,q=L,k=j.plus($.times(L=k)),j=L,I=P.minus($.times(L=I)),P=L;return L=_(d.minus(S),q,0,1),j=j.plus(L.times(k)),S=S.plus(L.times(q)),j.s=k.s=K.s,R=R*2,V=_(k,q,R,U).minus(K).abs().comparedTo(_(j,S,R,U).minus(K).abs())<1?[k,q]:[j,S],Y=B,V},C.toNumber=function(){return+X(this)},C.toPrecision=function(d,I){return d!=null&&v(d,1,g),Xe(this,d,I,2)},C.toString=function(d){var I,S=this,q=S.s,L=S.e;return L===null?q?(I="Infinity",q<0&&(I="-"+I)):I="NaN":(d==null?I=L<=W||L>=H?D(O(S.c),L):A(O(S.c),L,"0"):d===10&&Le?(S=E(new z(S),M+L+1,U),I=A(O(S.c),S.e,"0")):(v(d,2,Ee.length,"Base"),I=T(A(O(S.c),L,"0"),10,d,q,!0)),q<0&&S.c[0]&&(I="-"+I)),I},C.valueOf=C.toJSON=function(){return X(this)},C._isBigNumber=!0,w!=null&&z.set(w),z}function b(w){var _=w|0;return w>0||w===_?_:_-1}function O(w){for(var _,T,p=1,C=w.length,F=w[0]+"";p<C;){for(_=w[p++]+"",T=f-_.length;T--;_="0"+_);F+=_}for(C=F.length;F.charCodeAt(--C)===48;);return F.slice(0,C+1||1)}function x(w,_){var T,p,C=w.c,F=_.c,M=w.s,U=_.s,W=w.e,H=_.e;if(!M||!U)return null;if(T=C&&!C[0],p=F&&!F[0],T||p)return T?p?0:-U:M;if(M!=U)return M;if(T=M<0,p=W==H,!C||!F)return p?0:!C^T?1:-1;if(!p)return W>H^T?1:-1;for(U=(W=C.length)<(H=F.length)?W:H,M=0;M<U;M++)if(C[M]!=F[M])return C[M]>F[M]^T?1:-1;return W==H?0:W>H^T?1:-1}function v(w,_,T,p){if(w<_||w>T||w!==t(w))throw Error(r+(p||"Argument")+(typeof w=="number"?w<_||w>T?" out of range: ":" not an integer: ":" not a primitive number: ")+String(w))}function m(w){var _=w.c.length-1;return b(w.e/f)==_&&w.c[_]%2!=0}function D(w,_){return(w.length>1?w.charAt(0)+"."+w.slice(1):w)+(_<0?"e":"e+")+_}function A(w,_,T){var p,C;if(_<0){for(C=T+".";++_;C+=T);w=C+w}else if(p=w.length,++_>p){for(C=T,_-=p;--_;C+=T);w+=C}else _<p&&(w=w.slice(0,_)+"."+w.slice(_));return w}n=y(),n.default=n.BigNumber=n,o.exports?o.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(ee)})(As);var _s=As.exports;(function(o){var e=_s,n=o.exports;(function(){var i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,t,r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},s;function u(c){return i.lastIndex=0,i.test(c)?'"'+c.replace(i,function(h){var l=r[h];return typeof l=="string"?l:"\\u"+("0000"+h.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+c+'"'}function f(c,h){var l,g,y,b,O=a,x,v=h[c],m=v!=null&&(v instanceof e||e.isBigNumber(v));switch(v&&typeof v=="object"&&typeof v.toJSON=="function"&&(v=v.toJSON(c)),typeof s=="function"&&(v=s.call(h,c,v)),typeof v){case"string":return m?v:u(v);case"number":return isFinite(v)?String(v):"null";case"boolean":case"null":case"bigint":return String(v);case"object":if(!v)return"null";if(a+=t,x=[],Object.prototype.toString.apply(v)==="[object Array]"){for(b=v.length,l=0;l<b;l+=1)x[l]=f(l,v)||"null";return y=x.length===0?"[]":a?`[
`+a+x.join(`,
`+a)+`
`+O+"]":"["+x.join(",")+"]",a=O,y}if(s&&typeof s=="object")for(b=s.length,l=0;l<b;l+=1)typeof s[l]=="string"&&(g=s[l],y=f(g,v),y&&x.push(u(g)+(a?": ":":")+y));else Object.keys(v).forEach(function(D){var A=f(D,v);A&&x.push(u(D)+(a?": ":":")+A)});return y=x.length===0?"{}":a?`{
`+a+x.join(`,
`+a)+`
`+O+"}":"{"+x.join(",")+"}",a=O,y}}typeof n.stringify!="function"&&(n.stringify=function(c,h,l){var g;if(a="",t="",typeof l=="number")for(g=0;g<l;g+=1)t+=" ";else typeof l=="string"&&(t=l);if(s=h,h&&typeof h!="function"&&(typeof h!="object"||typeof h.length!="number"))throw new Error("JSON.stringify");return f("",{"":c})})})()})(Ds);var qu=Ds.exports,ft=null;const $u=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,ku=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;var Bu=function(o){var e={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(o!=null){if(o.strict===!0&&(e.strict=!0),o.storeAsString===!0&&(e.storeAsString=!0),e.alwaysParseAsBig=o.alwaysParseAsBig===!0?o.alwaysParseAsBig:!1,e.useNativeBigInt=o.useNativeBigInt===!0?o.useNativeBigInt:!1,typeof o.constructorAction<"u")if(o.constructorAction==="error"||o.constructorAction==="ignore"||o.constructorAction==="preserve")e.constructorAction=o.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${o.constructorAction}`);if(typeof o.protoAction<"u")if(o.protoAction==="error"||o.protoAction==="ignore"||o.protoAction==="preserve")e.protoAction=o.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${o.protoAction}`)}var n,i,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},t,r=function(b){throw{name:"SyntaxError",message:b,at:n,text:t}},s=function(b){return b&&b!==i&&r("Expected '"+b+"' instead of '"+i+"'"),i=t.charAt(n),n+=1,i},u=function(){var b,O="";for(i==="-"&&(O="-",s("-"));i>="0"&&i<="9";)O+=i,s();if(i===".")for(O+=".";s()&&i>="0"&&i<="9";)O+=i;if(i==="e"||i==="E")for(O+=i,s(),(i==="-"||i==="+")&&(O+=i,s());i>="0"&&i<="9";)O+=i,s();if(b=+O,!isFinite(b))r("Bad number");else return ft==null&&(ft=_s),O.length>15?e.storeAsString?O:e.useNativeBigInt?BigInt(O):new ft(O):e.alwaysParseAsBig?e.useNativeBigInt?BigInt(b):new ft(b):b},f=function(){var b,O,x="",v;if(i==='"')for(var m=n;s();){if(i==='"')return n-1>m&&(x+=t.substring(m,n-1)),s(),x;if(i==="\\"){if(n-1>m&&(x+=t.substring(m,n-1)),s(),i==="u"){for(v=0,O=0;O<4&&(b=parseInt(s(),16),!!isFinite(b));O+=1)v=v*16+b;x+=String.fromCharCode(v)}else if(typeof a[i]=="string")x+=a[i];else break;m=n}}r("Bad string")},c=function(){for(;i&&i<=" ";)s()},h=function(){switch(i){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}r("Unexpected '"+i+"'")},l,g=function(){var b=[];if(i==="["){if(s("["),c(),i==="]")return s("]"),b;for(;i;){if(b.push(l()),c(),i==="]")return s("]"),b;s(","),c()}}r("Bad array")},y=function(){var b,O=Object.create(null);if(i==="{"){if(s("{"),c(),i==="}")return s("}"),O;for(;i;){if(b=f(),c(),s(":"),e.strict===!0&&Object.hasOwnProperty.call(O,b)&&r('Duplicate key "'+b+'"'),$u.test(b)===!0?e.protoAction==="error"?r("Object contains forbidden prototype property"):e.protoAction==="ignore"?l():O[b]=l():ku.test(b)===!0?e.constructorAction==="error"?r("Object contains forbidden constructor property"):e.constructorAction==="ignore"?l():O[b]=l():O[b]=l(),c(),i==="}")return s("}"),O;s(","),c()}}r("Bad object")};return l=function(){switch(c(),i){case"{":return y();case"[":return g();case'"':return f();case"-":return u();default:return i>="0"&&i<="9"?u():h()}},function(b,O){var x;return t=b+"",n=0,i=" ",x=l(),c(),i&&r("Syntax error"),typeof O=="function"?function v(m,D){var A,w=m[D];return w&&typeof w=="object"&&Object.keys(w).forEach(function(_){A=v(w,_),A!==void 0?w[_]=A:delete w[_]}),O.call(m,D,w)}({"":x},""):x}},Uu=Bu,Ns=qu.stringify,Is=Uu;_t.exports=function(o){return{parse:Is(o),stringify:Ns}};_t.exports.parse=Is();_t.exports.stringify=Ns;var xs=_t.exports,Nt={};const Xu="@alicloud/pop-core",Vu="1.8.0",zu="AliCloud POP SDK core",Wu="index.js",Hu="lib/rpc.d.ts",Gu={lint:"eslint --fix lib test",test:"mocha -R spec test/*.test.js","test-cov":"nyc -r=html -r=text -r=lcov mocha -t 3000 -R spec test/*.test.js","test-integration":"mocha -R spec test/*.integration.js",ci:"npm run lint && npm run test-cov"},Ku=["Aliyun","AliCloud","OpenAPI","POP","SDK","Core"],Yu="Jackson Tian",Ju="MIT",Qu={debug:"^3.1.0",httpx:"^2.1.2","json-bigint":"^1.0.0",kitx:"^1.2.1",xml2js:"^0.5.0"},Zu=["lib","index.js"],ec={eslint:"^6.6.0","expect.js":"^0.3.1",mocha:"^4",muk:"^0.5.3",nyc:"^12.0.2",rewire:"^4.0.1"},tc={test:"test"},rc={node:">=8.0.0"},nc={type:"git",url:"git+https://github.com/aliyun/openapi-core-nodejs-sdk.git"},ic={url:"https://github.com/aliyun/openapi-core-nodejs-sdk/issues"},oc="https://github.com/aliyun/openapi-core-nodejs-sdk#readme",sc={name:Xu,version:Vu,description:zu,main:Wu,types:Hu,scripts:Gu,keywords:Ku,author:Yu,license:Ju,dependencies:Qu,files:Zu,devDependencies:ec,directories:tc,engines:rc,repository:nc,bugs:ic,homepage:oc},ro=$e,On=sc;Nt.DEFAULT_UA=`AlibabaCloud (${ro.platform()}; ${ro.arch()}) Node.js/${process.version} Core/${On.version}`;Nt.DEFAULT_CLIENT=`Node.js(${process.version}), ${On.name}: ${On.version}`;const Ke=An,no=ze,je=Sn,ac=xs,io=Nt;function Fs(o){return o.slice(0,1).toUpperCase()+o.slice(1)}function uc(o){for(var e=Object.keys(o),n={},i=0;i<e.length;i++){var a=e[i];n[Fs(a)]=o[a]}return n}function oo(){var o=new Date,e=o.getUTCFullYear(),n=je.pad2(o.getUTCMonth()+1),i=je.pad2(o.getUTCDate()),a=je.pad2(o.getUTCHours()),t=je.pad2(o.getUTCMinutes()),r=je.pad2(o.getUTCSeconds());return`${e}-${n}-${i}T${a}:${t}:${r}Z`}function Qe(o){var e=encodeURIComponent(o);return e.replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function Cn(o,e,n){for(var i=0;i<n.length;i++){var a=n[i];if(Array.isArray(a))Cn(o,`${e}.${i+1}`,a);else if(a&&typeof a=="object"){const r=Object.keys(a);for(var t=0;t<r.length;t++)Array.isArray(a[r[t]])?Cn(o,`${e}.${i+1}.${r[t]}`,a[r[t]]):o[`${e}.${i+1}.${r[t]}`]=a[r[t]]}else o[`${e}.${i+1}`]=a}}function cc(o){var e={},n=Object.keys(o);for(let t=0;t<n.length;t++){var i=n[t],a=o[i];Array.isArray(a)?Cn(e,i,a):e[i]=a}return e}function lc(o){var e=[],n=cc(o),i=Object.keys(n).sort();for(let r=0;r<i.length;r++){var a=i[r],t=n[a];e.push([Qe(a),Qe(t)])}return e}function Pr(o){for(var e=[],n=0;n<o.length;n++){var[i,a]=o[n];e.push(i+"="+a)}return e.join("&")}let fc=class{constructor(e,n){if(Ke(e,'must pass "config"'),Ke(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Ke(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else{Ke(e.accessKeyId,'must pass "config.accessKeyId"');var i=e.secretAccessKey||e.accessKeySecret;Ke(i,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=i,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:i,securityToken:e.securityToken})}}if(e.endpoint.endsWith("/")&&(e.endpoint=e.endpoint.slice(0,-1)),this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.verbose=n===!0,this.codes=new Set([200,"200","OK","Success","success"]),e.codes)for(var a of e.codes)this.codes.add(a);this.opts=e.opts||{};var t=this.endpoint.startsWith("https://")?Et:wt;this.keepAliveAgent=new t.Agent({keepAlive:!0,keepAliveMsecs:3e3})}async request(e,n={},i={}){const a=await this.credentialsProvider.getCredentials();i=Object.assign({headers:{"x-sdk-client":io.DEFAULT_CLIENT,"user-agent":io.DEFAULT_UA,"x-acs-action":e,"x-acs-version":this.apiVersion}},this.opts,i),i.formatAction!==!1&&(e=Fs(e)),i.formatParams!==!1&&(n=uc(n));const t={Format:"JSON",Timestamp:oo(),Version:this.apiVersion};a&&a.accessKeyId&&a.accessKeySecret&&(t.SignatureMethod="HMAC-SHA1",t.SignatureVersion="1.0",t.SignatureNonce=je.makeNonce(),t.AccessKeyId=a.accessKeyId,a.securityToken&&(t.SecurityToken=a.securityToken)),n=Object.assign({Action:e},t,n);const r=(i.method||"GET").toUpperCase(),s=lc(n);if(a&&a.accessKeyId&&a.accessKeySecret){const g=Pr(s),y=`${r}&${Qe("/")}&${Qe(g)}`,b=a.accessKeySecret+"&",O=je.sha1(y,b,"base64");s.push(["Signature",Qe(O)])}const u=i.method==="POST"?`${this.endpoint}/`:`${this.endpoint}/?${Pr(s)}`,f={url:u,request:null,response:null};i&&!i.agent&&(i.agent=this.keepAliveAgent),i.method==="POST"&&(i.headers=i.headers||{},i.headers["content-type"]="application/x-www-form-urlencoded",i.data=Pr(s));const c=await no.request(u,i);f.request={headers:c.req.getHeaders?c.req.getHeaders():c.req._headers},f.response={statusCode:c.statusCode,headers:c.headers};const h=await no.read(c),l=ac.parse(h);if(l.Code&&!this.codes.has(l.Code)){const g=new Error(`${l.Message}, URL: ${u}`);throw g.name=l.Code+"Error",g.data=l,g.code=l.Code,g.url=u,g.entry=f,g}return this.verbose?[l,f]:l}_buildParams(){const e={Format:"JSON",SignatureMethod:"HMAC-SHA1",SignatureNonce:je.makeNonce(),SignatureVersion:"1.0",Timestamp:oo(),AccessKeyId:this.accessKeyId,Version:this.apiVersion};return this.securityToken&&(e.SecurityToken=this.securityToken),e}};var Ss=fc,Me={},Lr={},so;function Pn(){return so||(so=1,(function(){Lr.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(ee)),Lr}var Mr={},xe={},Fe={},ao;function Pe(){return ao||(ao=1,(function(){var o,e,n,i,a,t,r,s=[].slice,u={}.hasOwnProperty;o=function(){var f,c,h,l,g,y;if(y=arguments[0],g=2<=arguments.length?s.call(arguments,1):[],a(Object.assign))Object.assign.apply(null,arguments);else for(f=0,h=g.length;f<h;f++)if(l=g[f],l!=null)for(c in l)u.call(l,c)&&(y[c]=l[c]);return y},a=function(f){return!!f&&Object.prototype.toString.call(f)==="[object Function]"},t=function(f){var c;return!!f&&((c=typeof f)=="function"||c==="object")},n=function(f){return a(Array.isArray)?Array.isArray(f):Object.prototype.toString.call(f)==="[object Array]"},i=function(f){var c;if(n(f))return!f.length;for(c in f)if(u.call(f,c))return!1;return!0},r=function(f){var c,h;return t(f)&&(h=Object.getPrototypeOf(f))&&(c=h.constructor)&&typeof c=="function"&&c instanceof c&&Function.prototype.toString.call(c)===Function.prototype.toString.call(Object)},e=function(f){return a(f.valueOf)?f.valueOf():f},Fe.assign=o,Fe.isFunction=a,Fe.isObject=t,Fe.isArray=n,Fe.isEmpty=i,Fe.isPlainObject=r,Fe.getValue=e}).call(ee)),Fe}var Rr={exports:{}},uo;function Ps(){return uo||(uo=1,(function(){Rr.exports=function(){function o(){}return o.prototype.hasFeature=function(e,n){return!0},o.prototype.createDocumentType=function(e,n,i){throw new Error("This DOM method is not implemented.")},o.prototype.createDocument=function(e,n,i){throw new Error("This DOM method is not implemented.")},o.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},o.prototype.getFeature=function(e,n){throw new Error("This DOM method is not implemented.")},o}()}).call(ee)),Rr.exports}var jr={exports:{}},qr={exports:{}},$r={exports:{}},co;function pc(){return co||(co=1,(function(){$r.exports=function(){function o(){}return o.prototype.handleError=function(e){throw new Error(e)},o}()}).call(ee)),$r.exports}var kr={exports:{}},lo;function hc(){return lo||(lo=1,(function(){kr.exports=function(){function o(e){this.arr=e||[]}return Object.defineProperty(o.prototype,"length",{get:function(){return this.arr.length}}),o.prototype.item=function(e){return this.arr[e]||null},o.prototype.contains=function(e){return this.arr.indexOf(e)!==-1},o}()}).call(ee)),kr.exports}var fo;function dc(){return fo||(fo=1,(function(){var o,e;o=pc(),e=hc(),qr.exports=function(){function n(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new o,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(n.prototype,"parameterNames",{get:function(){return new e(Object.keys(this.defaultParams))}}),n.prototype.getParameter=function(i){return this.params.hasOwnProperty(i)?this.params[i]:null},n.prototype.canSetParameter=function(i,a){return!0},n.prototype.setParameter=function(i,a){return a!=null?this.params[i]=a:delete this.params[i]},n}()}).call(ee)),qr.exports}var Br={exports:{}},Ur={exports:{}},Xr={exports:{}},po;function le(){return po||(po=1,(function(){Xr.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(ee)),Xr.exports}var Vr={exports:{}},ho;function Ls(){return ho||(ho=1,(function(){var o;o=le(),De(),Vr.exports=function(){function e(n,i,a){if(this.parent=n,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),i==null)throw new Error("Missing attribute name. "+this.debugInfo(i));this.name=this.stringify.name(i),this.value=this.stringify.attValue(a),this.type=o.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(n){return this.value=n||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(n){return this.options.writer.attribute(this,this.options.writer.filterOptions(n))},e.prototype.debugInfo=function(n){return n=n||this.name,n==null?"parent: <"+this.parent.name+">":"attribute: {"+n+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(n){return!(n.namespaceURI!==this.namespaceURI||n.prefix!==this.prefix||n.localName!==this.localName||n.value!==this.value)},e}()}).call(ee)),Vr.exports}var zr={exports:{}},mo;function Ln(){return mo||(mo=1,(function(){zr.exports=function(){function o(e){this.nodes=e}return Object.defineProperty(o.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),o.prototype.clone=function(){return this.nodes=null},o.prototype.getNamedItem=function(e){return this.nodes[e]},o.prototype.setNamedItem=function(e){var n;return n=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,n||null},o.prototype.removeNamedItem=function(e){var n;return n=this.nodes[e],delete this.nodes[e],n||null},o.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},o.prototype.getNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},o.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},o.prototype.removeNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},o}()}).call(ee)),zr.exports}var go;function Mn(){return go||(go=1,(function(){var o,e,n,i,a,t,r,s,u=function(c,h){for(var l in h)f.call(h,l)&&(c[l]=h[l]);function g(){this.constructor=c}return g.prototype=h.prototype,c.prototype=new g,c.__super__=h.prototype,c},f={}.hasOwnProperty;s=Pe(),r=s.isObject,t=s.isFunction,a=s.getValue,i=De(),o=le(),e=Ls(),n=Ln(),Ur.exports=function(c){u(h,c);function h(l,g,y){var b,O,x,v;if(h.__super__.constructor.call(this,l),g==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(g),this.type=o.Element,this.attribs={},this.schemaTypeInfo=null,y!=null&&this.attribute(y),l.type===o.Document&&(this.isRoot=!0,this.documentObject=l,l.rootObject=this,l.children)){for(v=l.children,O=0,x=v.length;O<x;O++)if(b=v[O],b.type===o.DocType){b.name=this.name;break}}}return Object.defineProperty(h.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(h.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(h.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(h.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(h.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new n(this.attribs)),this.attributeMap}}),h.prototype.clone=function(){var l,g,y,b;y=Object.create(this),y.isRoot&&(y.documentObject=null),y.attribs={},b=this.attribs;for(g in b)f.call(b,g)&&(l=b[g],y.attribs[g]=l.clone());return y.children=[],this.children.forEach(function(O){var x;return x=O.clone(),x.parent=y,y.children.push(x)}),y},h.prototype.attribute=function(l,g){var y,b;if(l!=null&&(l=a(l)),r(l))for(y in l)f.call(l,y)&&(b=l[y],this.attribute(y,b));else t(g)&&(g=g.apply()),this.options.keepNullAttributes&&g==null?this.attribs[l]=new e(this,l,""):g!=null&&(this.attribs[l]=new e(this,l,g));return this},h.prototype.removeAttribute=function(l){var g,y,b;if(l==null)throw new Error("Missing attribute name. "+this.debugInfo());if(l=a(l),Array.isArray(l))for(y=0,b=l.length;y<b;y++)g=l[y],delete this.attribs[g];else delete this.attribs[l];return this},h.prototype.toString=function(l){return this.options.writer.element(this,this.options.writer.filterOptions(l))},h.prototype.att=function(l,g){return this.attribute(l,g)},h.prototype.a=function(l,g){return this.attribute(l,g)},h.prototype.getAttribute=function(l){return this.attribs.hasOwnProperty(l)?this.attribs[l].value:null},h.prototype.setAttribute=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNode=function(l){return this.attribs.hasOwnProperty(l)?this.attribs[l]:null},h.prototype.setAttributeNode=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.removeAttributeNode=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagName=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNS=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setAttributeNS=function(l,g,y){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.removeAttributeNS=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNodeNS=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setAttributeNodeNS=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagNameNS=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.hasAttribute=function(l){return this.attribs.hasOwnProperty(l)},h.prototype.hasAttributeNS=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setIdAttribute=function(l,g){return this.attribs.hasOwnProperty(l)?this.attribs[l].isId:g},h.prototype.setIdAttributeNS=function(l,g,y){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setIdAttributeNode=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagName=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagNameNS=function(l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByClassName=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.isEqualNode=function(l){var g,y,b;if(!h.__super__.isEqualNode.apply(this,arguments).isEqualNode(l)||l.namespaceURI!==this.namespaceURI||l.prefix!==this.prefix||l.localName!==this.localName||l.attribs.length!==this.attribs.length)return!1;for(g=y=0,b=this.attribs.length-1;0<=b?y<=b:y>=b;g=0<=b?++y:--y)if(!this.attribs[g].isEqualNode(l.attribs[g]))return!1;return!0},h}(i)}).call(ee)),Ur.exports}var Wr={exports:{}},Hr={exports:{}},yo;function It(){return yo||(yo=1,(function(){var o,e=function(i,a){for(var t in a)n.call(a,t)&&(i[t]=a[t]);function r(){this.constructor=i}return r.prototype=a.prototype,i.prototype=new r,i.__super__=a.prototype,i},n={}.hasOwnProperty;o=De(),Hr.exports=function(i){e(a,i);function a(t){a.__super__.constructor.call(this,t),this.value=""}return Object.defineProperty(a.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(a.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(a.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),a.prototype.clone=function(){return Object.create(this)},a.prototype.substringData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.insertData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.deleteData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.replaceData=function(t,r,s){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.isEqualNode=function(t){return!(!a.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)||t.data!==this.data)},a}(o)}).call(ee)),Hr.exports}var vo;function Rn(){return vo||(vo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),Wr.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=o.CData,this.value=this.stringify.cdata(s)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.cdata(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Wr.exports}var Gr={exports:{}},wo;function jn(){return wo||(wo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),Gr.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=o.Comment,this.value=this.stringify.comment(s)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.comment(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Gr.exports}var Kr={exports:{}},Eo;function qn(){return Eo||(Eo=1,(function(){var o,e,n,i=function(t,r){for(var s in r)a.call(r,s)&&(t[s]=r[s]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;n=Pe().isObject,e=De(),o=le(),Kr.exports=function(t){i(r,t);function r(s,u,f,c){var h;r.__super__.constructor.call(this,s),n(u)&&(h=u,u=h.version,f=h.encoding,c=h.standalone),u||(u="1.0"),this.type=o.Declaration,this.version=this.stringify.xmlVersion(u),f!=null&&(this.encoding=this.stringify.xmlEncoding(f)),c!=null&&(this.standalone=this.stringify.xmlStandalone(c))}return r.prototype.toString=function(s){return this.options.writer.declaration(this,this.options.writer.filterOptions(s))},r}(e)}).call(ee)),Kr.exports}var Yr={exports:{}},Jr={exports:{}},bo;function $n(){return bo||(bo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=De(),o=le(),Jr.exports=function(a){n(t,a);function t(r,s,u,f,c,h){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(u==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(s));if(!f)throw new Error("Missing DTD attribute type. "+this.debugInfo(s));if(!c)throw new Error("Missing DTD attribute default. "+this.debugInfo(s));if(c.indexOf("#")!==0&&(c="#"+c),!c.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(s));if(h&&!c.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(s));this.elementName=this.stringify.name(s),this.type=o.AttributeDeclaration,this.attributeName=this.stringify.name(u),this.attributeType=this.stringify.dtdAttType(f),h&&(this.defaultValue=this.stringify.dtdAttDefault(h)),this.defaultValueType=c}return t.prototype.toString=function(r){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Jr.exports}var Qr={exports:{}},To;function kn(){return To||(To=1,(function(){var o,e,n,i=function(t,r){for(var s in r)a.call(r,s)&&(t[s]=r[s]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;n=Pe().isObject,e=De(),o=le(),Qr.exports=function(t){i(r,t);function r(s,u,f,c){if(r.__super__.constructor.call(this,s),f==null)throw new Error("Missing DTD entity name. "+this.debugInfo(f));if(c==null)throw new Error("Missing DTD entity value. "+this.debugInfo(f));if(this.pe=!!u,this.name=this.stringify.name(f),this.type=o.EntityDeclaration,!n(c))this.value=this.stringify.dtdEntityValue(c),this.internal=!0;else{if(!c.pubID&&!c.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(f));if(c.pubID&&!c.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(f));if(this.internal=!1,c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID)),c.nData!=null&&(this.nData=this.stringify.dtdNData(c.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(f))}}return Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(s){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(s))},r}(e)}).call(ee)),Qr.exports}var Zr={exports:{}},Oo;function Bn(){return Oo||(Oo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=De(),o=le(),Zr.exports=function(a){n(t,a);function t(r,s,u){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());u||(u="(#PCDATA)"),Array.isArray(u)&&(u="("+u.join(",")+")"),this.name=this.stringify.name(s),this.type=o.ElementDeclaration,this.value=this.stringify.dtdElementValue(u)}return t.prototype.toString=function(r){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Zr.exports}var en={exports:{}},Co;function Un(){return Co||(Co=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=De(),o=le(),en.exports=function(a){n(t,a);function t(r,s,u){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing DTD notation name. "+this.debugInfo(s));if(!u.pubID&&!u.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(s));this.name=this.stringify.name(s),this.type=o.NotationDeclaration,u.pubID!=null&&(this.pubID=this.stringify.dtdPubID(u.pubID)),u.sysID!=null&&(this.sysID=this.stringify.dtdSysID(u.sysID))}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),t.prototype.toString=function(r){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),en.exports}var Do;function Xn(){return Do||(Do=1,(function(){var o,e,n,i,a,t,r,s,u=function(c,h){for(var l in h)f.call(h,l)&&(c[l]=h[l]);function g(){this.constructor=c}return g.prototype=h.prototype,c.prototype=new g,c.__super__=h.prototype,c},f={}.hasOwnProperty;s=Pe().isObject,r=De(),o=le(),e=$n(),i=kn(),n=Bn(),a=Un(),t=Ln(),Yr.exports=function(c){u(h,c);function h(l,g,y){var b,O,x,v,m,D;if(h.__super__.constructor.call(this,l),this.type=o.DocType,l.children){for(v=l.children,O=0,x=v.length;O<x;O++)if(b=v[O],b.type===o.Element){this.name=b.name;break}}this.documentObject=l,s(g)&&(m=g,g=m.pubID,y=m.sysID),y==null&&(D=[g,y],y=D[0],g=D[1]),g!=null&&(this.pubID=this.stringify.dtdPubID(g)),y!=null&&(this.sysID=this.stringify.dtdSysID(y))}return Object.defineProperty(h.prototype,"entities",{get:function(){var l,g,y,b,O;for(b={},O=this.children,g=0,y=O.length;g<y;g++)l=O[g],l.type===o.EntityDeclaration&&!l.pe&&(b[l.name]=l);return new t(b)}}),Object.defineProperty(h.prototype,"notations",{get:function(){var l,g,y,b,O;for(b={},O=this.children,g=0,y=O.length;g<y;g++)l=O[g],l.type===o.NotationDeclaration&&(b[l.name]=l);return new t(b)}}),Object.defineProperty(h.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(h.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(h.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),h.prototype.element=function(l,g){var y;return y=new n(this,l,g),this.children.push(y),this},h.prototype.attList=function(l,g,y,b,O){var x;return x=new e(this,l,g,y,b,O),this.children.push(x),this},h.prototype.entity=function(l,g){var y;return y=new i(this,!1,l,g),this.children.push(y),this},h.prototype.pEntity=function(l,g){var y;return y=new i(this,!0,l,g),this.children.push(y),this},h.prototype.notation=function(l,g){var y;return y=new a(this,l,g),this.children.push(y),this},h.prototype.toString=function(l){return this.options.writer.docType(this,this.options.writer.filterOptions(l))},h.prototype.ele=function(l,g){return this.element(l,g)},h.prototype.att=function(l,g,y,b,O){return this.attList(l,g,y,b,O)},h.prototype.ent=function(l,g){return this.entity(l,g)},h.prototype.pent=function(l,g){return this.pEntity(l,g)},h.prototype.not=function(l,g){return this.notation(l,g)},h.prototype.up=function(){return this.root()||this.documentObject},h.prototype.isEqualNode=function(l){return!(!h.__super__.isEqualNode.apply(this,arguments).isEqualNode(l)||l.name!==this.name||l.publicId!==this.publicId||l.systemId!==this.systemId)},h}(r)}).call(ee)),Yr.exports}var tn={exports:{}},Ao;function Vn(){return Ao||(Ao=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=De(),tn.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=o.Raw,this.value=this.stringify.raw(s)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.raw(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),tn.exports}var rn={exports:{}},_o;function zn(){return _o||(_o=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),rn.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=o.Text,this.value=this.stringify.text(s)}return Object.defineProperty(t.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"wholeText",{get:function(){var r,s,u;for(u="",s=this.previousSibling;s;)u=s.data+u,s=s.previousSibling;for(u+=this.data,r=this.nextSibling;r;)u=u+r.data,r=r.nextSibling;return u}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.text(this,this.options.writer.filterOptions(r))},t.prototype.splitText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceWholeText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t}(e)}).call(ee)),rn.exports}var nn={exports:{}},No;function Wn(){return No||(No=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),nn.exports=function(a){n(t,a);function t(r,s,u){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=o.ProcessingInstruction,this.target=this.stringify.insTarget(s),this.name=this.target,u&&(this.value=this.stringify.insValue(u))}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(r))},t.prototype.isEqualNode=function(r){return!(!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(r)||r.target!==this.target)},t}(e)}).call(ee)),nn.exports}var on={exports:{}},Io;function Ms(){return Io||(Io=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=De(),o=le(),on.exports=function(a){n(t,a);function t(r){t.__super__.constructor.call(this,r),this.type=o.Dummy}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return""},t}(e)}).call(ee)),on.exports}var sn={exports:{}},xo;function mc(){return xo||(xo=1,(function(){sn.exports=function(){function o(e){this.nodes=e}return Object.defineProperty(o.prototype,"length",{get:function(){return this.nodes.length||0}}),o.prototype.clone=function(){return this.nodes=null},o.prototype.item=function(e){return this.nodes[e]||null},o}()}).call(ee)),sn.exports}var an={exports:{}},Fo;function gc(){return Fo||(Fo=1,(function(){an.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(ee)),an.exports}var So;function De(){return So||(So=1,(function(){var o,e,n,i,a,t,r,s,u,f,c,h,l,g,y,b,O,x={}.hasOwnProperty;O=Pe(),b=O.isObject,y=O.isFunction,g=O.isEmpty,l=O.getValue,s=null,n=null,i=null,a=null,t=null,c=null,h=null,f=null,r=null,e=null,u=null,o=null,Br.exports=function(){function v(m){this.parent=m,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,s||(s=Mn(),n=Rn(),i=jn(),a=qn(),t=Xn(),c=Vn(),h=zn(),f=Wn(),r=Ms(),e=le(),u=mc(),Ln(),o=gc())}return Object.defineProperty(v.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(v.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(v.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(v.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(v.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(v.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(v.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(v.prototype,"previousSibling",{get:function(){var m;return m=this.parent.children.indexOf(this),this.parent.children[m-1]||null}}),Object.defineProperty(v.prototype,"nextSibling",{get:function(){var m;return m=this.parent.children.indexOf(this),this.parent.children[m+1]||null}}),Object.defineProperty(v.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(v.prototype,"textContent",{get:function(){var m,D,A,w,_;if(this.nodeType===e.Element||this.nodeType===e.DocumentFragment){for(_="",w=this.children,D=0,A=w.length;D<A;D++)m=w[D],m.textContent&&(_+=m.textContent);return _}else return null},set:function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),v.prototype.setParent=function(m){var D,A,w,_,T;for(this.parent=m,m&&(this.options=m.options,this.stringify=m.stringify),_=this.children,T=[],A=0,w=_.length;A<w;A++)D=_[A],T.push(D.setParent(this));return T},v.prototype.element=function(m,D,A){var w,_,T,p,C,F,M,U,W,H,J;if(F=null,D===null&&A==null&&(W=[{},null],D=W[0],A=W[1]),D==null&&(D={}),D=l(D),b(D)||(H=[D,A],A=H[0],D=H[1]),m!=null&&(m=l(m)),Array.isArray(m))for(T=0,M=m.length;T<M;T++)_=m[T],F=this.element(_);else if(y(m))F=this.element(m.apply());else if(b(m)){for(C in m)if(x.call(m,C))if(J=m[C],y(J)&&(J=J.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&C.indexOf(this.stringify.convertAttKey)===0)F=this.attribute(C.substr(this.stringify.convertAttKey.length),J);else if(!this.options.separateArrayItems&&Array.isArray(J)&&g(J))F=this.dummy();else if(b(J)&&g(J))F=this.element(C);else if(!this.options.keepNullNodes&&J==null)F=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(J))for(p=0,U=J.length;p<U;p++)_=J[p],w={},w[C]=_,F=this.element(w);else b(J)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&C.indexOf(this.stringify.convertTextKey)===0?F=this.element(J):(F=this.element(C),F.element(J)):F=this.element(C,J)}else!this.options.keepNullNodes&&A===null?F=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&m.indexOf(this.stringify.convertTextKey)===0?F=this.text(A):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&m.indexOf(this.stringify.convertCDataKey)===0?F=this.cdata(A):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&m.indexOf(this.stringify.convertCommentKey)===0?F=this.comment(A):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&m.indexOf(this.stringify.convertRawKey)===0?F=this.raw(A):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&m.indexOf(this.stringify.convertPIKey)===0?F=this.instruction(m.substr(this.stringify.convertPIKey.length),A):F=this.node(m,D,A);if(F==null)throw new Error("Could not create any elements with: "+m+". "+this.debugInfo());return F},v.prototype.insertBefore=function(m,D,A){var w,_,T,p,C;if(m!=null&&m.type)return T=m,p=D,T.setParent(this),p?(_=children.indexOf(p),C=children.splice(_),children.push(T),Array.prototype.push.apply(children,C)):children.push(T),T;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(m));return _=this.parent.children.indexOf(this),C=this.parent.children.splice(_),w=this.parent.element(m,D,A),Array.prototype.push.apply(this.parent.children,C),w},v.prototype.insertAfter=function(m,D,A){var w,_,T;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(m));return _=this.parent.children.indexOf(this),T=this.parent.children.splice(_+1),w=this.parent.element(m,D,A),Array.prototype.push.apply(this.parent.children,T),w},v.prototype.remove=function(){var m;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return m=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[m,m-m+1].concat([])),this.parent},v.prototype.node=function(m,D,A){var w,_;return m!=null&&(m=l(m)),D||(D={}),D=l(D),b(D)||(_=[D,A],A=_[0],D=_[1]),w=new s(this,m,D),A!=null&&w.text(A),this.children.push(w),w},v.prototype.text=function(m){var D;return b(m)&&this.element(m),D=new h(this,m),this.children.push(D),this},v.prototype.cdata=function(m){var D;return D=new n(this,m),this.children.push(D),this},v.prototype.comment=function(m){var D;return D=new i(this,m),this.children.push(D),this},v.prototype.commentBefore=function(m){var D,A;return D=this.parent.children.indexOf(this),A=this.parent.children.splice(D),this.parent.comment(m),Array.prototype.push.apply(this.parent.children,A),this},v.prototype.commentAfter=function(m){var D,A;return D=this.parent.children.indexOf(this),A=this.parent.children.splice(D+1),this.parent.comment(m),Array.prototype.push.apply(this.parent.children,A),this},v.prototype.raw=function(m){var D;return D=new c(this,m),this.children.push(D),this},v.prototype.dummy=function(){var m;return m=new r(this),m},v.prototype.instruction=function(m,D){var A,w,_,T,p;if(m!=null&&(m=l(m)),D!=null&&(D=l(D)),Array.isArray(m))for(T=0,p=m.length;T<p;T++)A=m[T],this.instruction(A);else if(b(m))for(A in m)x.call(m,A)&&(w=m[A],this.instruction(A,w));else y(D)&&(D=D.apply()),_=new f(this,m,D),this.children.push(_);return this},v.prototype.instructionBefore=function(m,D){var A,w;return A=this.parent.children.indexOf(this),w=this.parent.children.splice(A),this.parent.instruction(m,D),Array.prototype.push.apply(this.parent.children,w),this},v.prototype.instructionAfter=function(m,D){var A,w;return A=this.parent.children.indexOf(this),w=this.parent.children.splice(A+1),this.parent.instruction(m,D),Array.prototype.push.apply(this.parent.children,w),this},v.prototype.declaration=function(m,D,A){var w,_;return w=this.document(),_=new a(w,m,D,A),w.children.length===0?w.children.unshift(_):w.children[0].type===e.Declaration?w.children[0]=_:w.children.unshift(_),w.root()||w},v.prototype.dtd=function(m,D){var A,w,_,T,p,C,F,M,U,W;for(w=this.document(),_=new t(w,m,D),U=w.children,T=p=0,F=U.length;p<F;T=++p)if(A=U[T],A.type===e.DocType)return w.children[T]=_,_;for(W=w.children,T=C=0,M=W.length;C<M;T=++C)if(A=W[T],A.isRoot)return w.children.splice(T,0,_),_;return w.children.push(_),_},v.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},v.prototype.root=function(){var m;for(m=this;m;){if(m.type===e.Document)return m.rootObject;if(m.isRoot)return m;m=m.parent}},v.prototype.document=function(){var m;for(m=this;m;){if(m.type===e.Document)return m;m=m.parent}},v.prototype.end=function(m){return this.document().end(m)},v.prototype.prev=function(){var m;if(m=this.parent.children.indexOf(this),m<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[m-1]},v.prototype.next=function(){var m;if(m=this.parent.children.indexOf(this),m===-1||m===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[m+1]},v.prototype.importDocument=function(m){var D;return D=m.root().clone(),D.parent=this,D.isRoot=!1,this.children.push(D),this},v.prototype.debugInfo=function(m){var D,A;return m=m||this.name,m==null&&!((D=this.parent)!=null&&D.name)?"":m==null?"parent: <"+this.parent.name+">":(A=this.parent)!=null&&A.name?"node: <"+m+">, parent: <"+this.parent.name+">":"node: <"+m+">"},v.prototype.ele=function(m,D,A){return this.element(m,D,A)},v.prototype.nod=function(m,D,A){return this.node(m,D,A)},v.prototype.txt=function(m){return this.text(m)},v.prototype.dat=function(m){return this.cdata(m)},v.prototype.com=function(m){return this.comment(m)},v.prototype.ins=function(m,D){return this.instruction(m,D)},v.prototype.doc=function(){return this.document()},v.prototype.dec=function(m,D,A){return this.declaration(m,D,A)},v.prototype.e=function(m,D,A){return this.element(m,D,A)},v.prototype.n=function(m,D,A){return this.node(m,D,A)},v.prototype.t=function(m){return this.text(m)},v.prototype.d=function(m){return this.cdata(m)},v.prototype.c=function(m){return this.comment(m)},v.prototype.r=function(m){return this.raw(m)},v.prototype.i=function(m,D){return this.instruction(m,D)},v.prototype.u=function(){return this.up()},v.prototype.importXMLBuilder=function(m){return this.importDocument(m)},v.prototype.replaceChild=function(m,D){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.removeChild=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.appendChild=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.hasChildNodes=function(){return this.children.length!==0},v.prototype.cloneNode=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isSupported=function(m,D){return!0},v.prototype.hasAttributes=function(){return this.attribs.length!==0},v.prototype.compareDocumentPosition=function(m){var D,A;return D=this,D===m?0:this.document()!==m.document()?(A=o.Disconnected|o.ImplementationSpecific,Math.random()<.5?A|=o.Preceding:A|=o.Following,A):D.isAncestor(m)?o.Contains|o.Preceding:D.isDescendant(m)?o.Contains|o.Following:D.isPreceding(m)?o.Preceding:o.Following},v.prototype.isSameNode=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.lookupPrefix=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isDefaultNamespace=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.lookupNamespaceURI=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isEqualNode=function(m){var D,A,w;if(m.nodeType!==this.nodeType||m.children.length!==this.children.length)return!1;for(D=A=0,w=this.children.length-1;0<=w?A<=w:A>=w;D=0<=w?++A:--A)if(!this.children[D].isEqualNode(m.children[D]))return!1;return!0},v.prototype.getFeature=function(m,D){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setUserData=function(m,D,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getUserData=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.contains=function(m){return m?m===this||this.isDescendant(m):!1},v.prototype.isDescendant=function(m){var D,A,w,_,T;for(T=this.children,w=0,_=T.length;w<_;w++)if(D=T[w],m===D||(A=D.isDescendant(m),A))return!0;return!1},v.prototype.isAncestor=function(m){return m.isDescendant(this)},v.prototype.isPreceding=function(m){var D,A;return D=this.treePosition(m),A=this.treePosition(this),D===-1||A===-1?!1:D<A},v.prototype.isFollowing=function(m){var D,A;return D=this.treePosition(m),A=this.treePosition(this),D===-1||A===-1?!1:D>A},v.prototype.treePosition=function(m){var D,A;return A=0,D=!1,this.foreachTreeNode(this.document(),function(w){if(A++,!D&&w===m)return D=!0}),D?A:-1},v.prototype.foreachTreeNode=function(m,D){var A,w,_,T,p;for(m||(m=this.document()),T=m.children,w=0,_=T.length;w<_;w++){if(A=T[w],p=D(A))return p;if(p=this.foreachTreeNode(A,D),p)return p}},v}()}).call(ee)),Br.exports}var un={exports:{}},Po;function Rs(){return Po||(Po=1,(function(){var o=function(n,i){return function(){return n.apply(i,arguments)}},e={}.hasOwnProperty;un.exports=function(){function n(i){this.assertLegalName=o(this.assertLegalName,this),this.assertLegalChar=o(this.assertLegalChar,this);var a,t,r;i||(i={}),this.options=i,this.options.version||(this.options.version="1.0"),t=i.stringify||{};for(a in t)e.call(t,a)&&(r=t[a],this[a]=r)}return n.prototype.name=function(i){return this.options.noValidation?i:this.assertLegalName(""+i||"")},n.prototype.text=function(i){return this.options.noValidation?i:this.assertLegalChar(this.textEscape(""+i||""))},n.prototype.cdata=function(i){return this.options.noValidation?i:(i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i))},n.prototype.comment=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},n.prototype.raw=function(i){return this.options.noValidation?i:""+i||""},n.prototype.attValue=function(i){return this.options.noValidation?i:this.assertLegalChar(this.attEscape(i=""+i||""))},n.prototype.insTarget=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.insValue=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return this.assertLegalChar(i)},n.prototype.xmlVersion=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},n.prototype.xmlEncoding=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return this.assertLegalChar(i)},n.prototype.xmlStandalone=function(i){return this.options.noValidation?i:i?"yes":"no"},n.prototype.dtdPubID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdSysID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdElementValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttType=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttDefault=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdEntityValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdNData=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.convertAttKey="@",n.prototype.convertPIKey="?",n.prototype.convertTextKey="#text",n.prototype.convertCDataKey="#cdata",n.prototype.convertCommentKey="#comment",n.prototype.convertRawKey="#raw",n.prototype.assertLegalChar=function(i){var a,t;if(this.options.noValidation)return i;if(a="",this.options.version==="1.0"){if(a=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,t=i.match(a))throw new Error("Invalid character in string: "+i+" at index "+t.index)}else if(this.options.version==="1.1"&&(a=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,t=i.match(a)))throw new Error("Invalid character in string: "+i+" at index "+t.index);return i},n.prototype.assertLegalName=function(i){var a;if(this.options.noValidation)return i;if(this.assertLegalChar(i),a=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!i.match(a))throw new Error("Invalid character in name");return i},n.prototype.textEscape=function(i){var a;return this.options.noValidation?i:(a=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(a,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},n.prototype.attEscape=function(i){var a;return this.options.noValidation?i:(a=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(a,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},n}()}).call(ee)),un.exports}var cn={exports:{}},ln={exports:{}},fn={exports:{}},Lo;function xt(){return Lo||(Lo=1,(function(){fn.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(ee)),fn.exports}var Mo;function js(){return Mo||(Mo=1,(function(){var o,e,n,i={}.hasOwnProperty;n=Pe().assign,o=le(),qn(),Xn(),Rn(),jn(),Mn(),Vn(),zn(),Wn(),Ms(),$n(),Bn(),kn(),Un(),e=xt(),ln.exports=function(){function a(t){var r,s,u;t||(t={}),this.options=t,s=t.writer||{};for(r in s)i.call(s,r)&&(u=s[r],this["_"+r]=this[r],this[r]=u)}return a.prototype.filterOptions=function(t){var r,s,u,f,c,h,l,g;return t||(t={}),t=n({},this.options,t),r={writer:this},r.pretty=t.pretty||!1,r.allowEmpty=t.allowEmpty||!1,r.indent=(s=t.indent)!=null?s:"  ",r.newline=(u=t.newline)!=null?u:`
`,r.offset=(f=t.offset)!=null?f:0,r.dontPrettyTextNodes=(c=(h=t.dontPrettyTextNodes)!=null?h:t.dontprettytextnodes)!=null?c:0,r.spaceBeforeSlash=(l=(g=t.spaceBeforeSlash)!=null?g:t.spacebeforeslash)!=null?l:"",r.spaceBeforeSlash===!0&&(r.spaceBeforeSlash=" "),r.suppressPrettyCount=0,r.user={},r.state=e.None,r},a.prototype.indent=function(t,r,s){var u;return!r.pretty||r.suppressPrettyCount?"":r.pretty&&(u=(s||0)+r.offset+1,u>0)?new Array(u).join(r.indent):""},a.prototype.endline=function(t,r,s){return!r.pretty||r.suppressPrettyCount?"":r.newline},a.prototype.attribute=function(t,r,s){var u;return this.openAttribute(t,r,s),u=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,r,s),u},a.prototype.cdata=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<![CDATA[",r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+="]]>"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.comment=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!-- ",r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=" -->"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.declaration=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<?xml",r.state=e.InsideTag,u+=' version="'+t.version+'"',t.encoding!=null&&(u+=' encoding="'+t.encoding+'"'),t.standalone!=null&&(u+=' standalone="'+t.standalone+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+"?>",u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.docType=function(t,r,s){var u,f,c,h,l;if(s||(s=0),this.openNode(t,r,s),r.state=e.OpenTag,h=this.indent(t,r,s),h+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?h+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(h+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(h+=" [",h+=this.endline(t,r,s),r.state=e.InsideTag,l=t.children,f=0,c=l.length;f<c;f++)u=l[f],h+=this.writeChildNode(u,r,s+1);r.state=e.CloseTag,h+="]"}return r.state=e.CloseTag,h+=r.spaceBeforeSlash+">",h+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),h},a.prototype.element=function(t,r,s){var u,f,c,h,l,g,y,b,O,x,v,m,D,A;s||(s=0),x=!1,v="",this.openNode(t,r,s),r.state=e.OpenTag,v+=this.indent(t,r,s)+"<"+t.name,m=t.attribs;for(O in m)i.call(m,O)&&(u=m[O],v+=this.attribute(u,r,s));if(c=t.children.length,h=c===0?null:t.children[0],c===0||t.children.every(function(w){return(w.type===o.Text||w.type===o.Raw)&&w.value===""}))r.allowEmpty?(v+=">",r.state=e.CloseTag,v+="</"+t.name+">"+this.endline(t,r,s)):(r.state=e.CloseTag,v+=r.spaceBeforeSlash+"/>"+this.endline(t,r,s));else if(r.pretty&&c===1&&(h.type===o.Text||h.type===o.Raw)&&h.value!=null)v+=">",r.state=e.InsideTag,r.suppressPrettyCount++,x=!0,v+=this.writeChildNode(h,r,s+1),r.suppressPrettyCount--,x=!1,r.state=e.CloseTag,v+="</"+t.name+">"+this.endline(t,r,s);else{if(r.dontPrettyTextNodes){for(D=t.children,l=0,y=D.length;l<y;l++)if(f=D[l],(f.type===o.Text||f.type===o.Raw)&&f.value!=null){r.suppressPrettyCount++,x=!0;break}}for(v+=">"+this.endline(t,r,s),r.state=e.InsideTag,A=t.children,g=0,b=A.length;g<b;g++)f=A[g],v+=this.writeChildNode(f,r,s+1);r.state=e.CloseTag,v+=this.indent(t,r,s)+"</"+t.name+">",x&&r.suppressPrettyCount--,v+=this.endline(t,r,s),r.state=e.None}return this.closeNode(t,r,s),v},a.prototype.writeChildNode=function(t,r,s){switch(t.type){case o.CData:return this.cdata(t,r,s);case o.Comment:return this.comment(t,r,s);case o.Element:return this.element(t,r,s);case o.Raw:return this.raw(t,r,s);case o.Text:return this.text(t,r,s);case o.ProcessingInstruction:return this.processingInstruction(t,r,s);case o.Dummy:return"";case o.Declaration:return this.declaration(t,r,s);case o.DocType:return this.docType(t,r,s);case o.AttributeDeclaration:return this.dtdAttList(t,r,s);case o.ElementDeclaration:return this.dtdElement(t,r,s);case o.EntityDeclaration:return this.dtdEntity(t,r,s);case o.NotationDeclaration:return this.dtdNotation(t,r,s);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},a.prototype.processingInstruction=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<?",r.state=e.InsideTag,u+=t.target,t.value&&(u+=" "+t.value),r.state=e.CloseTag,u+=r.spaceBeforeSlash+"?>",u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.raw=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s),r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.text=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s),r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdAttList=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!ATTLIST",r.state=e.InsideTag,u+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,t.defaultValueType!=="#DEFAULT"&&(u+=" "+t.defaultValueType),t.defaultValue&&(u+=' "'+t.defaultValue+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdElement=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!ELEMENT",r.state=e.InsideTag,u+=" "+t.name+" "+t.value,r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdEntity=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!ENTITY",r.state=e.InsideTag,t.pe&&(u+=" %"),u+=" "+t.name,t.value?u+=' "'+t.value+'"':(t.pubID&&t.sysID?u+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(u+=' SYSTEM "'+t.sysID+'"'),t.nData&&(u+=" NDATA "+t.nData)),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdNotation=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!NOTATION",r.state=e.InsideTag,u+=" "+t.name,t.pubID&&t.sysID?u+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?u+=' PUBLIC "'+t.pubID+'"':t.sysID&&(u+=' SYSTEM "'+t.sysID+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.openNode=function(t,r,s){},a.prototype.closeNode=function(t,r,s){},a.prototype.openAttribute=function(t,r,s){},a.prototype.closeAttribute=function(t,r,s){},a}()}).call(ee)),ln.exports}var Ro;function Hn(){return Ro||(Ro=1,(function(){var o,e=function(i,a){for(var t in a)n.call(a,t)&&(i[t]=a[t]);function r(){this.constructor=i}return r.prototype=a.prototype,i.prototype=new r,i.__super__=a.prototype,i},n={}.hasOwnProperty;o=js(),cn.exports=function(i){e(a,i);function a(t){a.__super__.constructor.call(this,t)}return a.prototype.document=function(t,r){var s,u,f,c,h;for(r=this.filterOptions(r),c="",h=t.children,u=0,f=h.length;u<f;u++)s=h[u],c+=this.writeChildNode(s,r,0);return r.pretty&&c.slice(-r.newline.length)===r.newline&&(c=c.slice(0,-r.newline.length)),c},a}(o)}).call(ee)),cn.exports}var jo;function qs(){return jo||(jo=1,(function(){var o,e,n,i,a,t,r,s=function(f,c){for(var h in c)u.call(c,h)&&(f[h]=c[h]);function l(){this.constructor=f}return l.prototype=c.prototype,f.prototype=new l,f.__super__=c.prototype,f},u={}.hasOwnProperty;r=Pe().isPlainObject,n=Ps(),e=dc(),i=De(),o=le(),t=Rs(),a=Hn(),jr.exports=function(f){s(c,f);function c(h){c.__super__.constructor.call(this,null),this.name="#document",this.type=o.Document,this.documentURI=null,this.domConfig=new e,h||(h={}),h.writer||(h.writer=new a),this.options=h,this.stringify=new t(h)}return Object.defineProperty(c.prototype,"implementation",{value:new n}),Object.defineProperty(c.prototype,"doctype",{get:function(){var h,l,g,y;for(y=this.children,l=0,g=y.length;l<g;l++)if(h=y[l],h.type===o.DocType)return h;return null}}),Object.defineProperty(c.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(c.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(c.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(c.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===o.Declaration?this.children[0].encoding:null}}),Object.defineProperty(c.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===o.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(c.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===o.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(c.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(c.prototype,"origin",{get:function(){return null}}),Object.defineProperty(c.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(c.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(c.prototype,"contentType",{get:function(){return null}}),c.prototype.end=function(h){var l;return l={},h?r(h)&&(l=h,h=this.options.writer):h=this.options.writer,h.document(this,h.filterOptions(l))},c.prototype.toString=function(h){return this.options.writer.document(this,this.options.writer.filterOptions(h))},c.prototype.createElement=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createTextNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createComment=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createCDATASection=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createProcessingInstruction=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createAttribute=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createEntityReference=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.importNode=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createElementNS=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createAttributeNS=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByTagNameNS=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementById=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.adoptNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.renameNode=function(h,l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByClassName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createEvent=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createNodeIterator=function(h,l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createTreeWalker=function(h,l,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},c}(i)}).call(ee)),jr.exports}var pn={exports:{}},qo;function yc(){return qo||(qo=1,(function(){var o,e,n,i,a,t,r,s,u,f,c,h,l,g,y,b,O,x,v,m,D,A,w,_={}.hasOwnProperty;w=Pe(),D=w.isObject,m=w.isFunction,A=w.isPlainObject,v=w.getValue,o=le(),h=qs(),l=Mn(),i=Rn(),a=jn(),y=Vn(),x=zn(),g=Wn(),f=qn(),c=Xn(),t=$n(),s=kn(),r=Bn(),u=Un(),n=Ls(),O=Rs(),b=Hn(),e=xt(),pn.exports=function(){function T(p,C,F){var M;this.name="?xml",this.type=o.Document,p||(p={}),M={},p.writer?A(p.writer)&&(M=p.writer,p.writer=new b):p.writer=new b,this.options=p,this.writer=p.writer,this.writerOptions=this.writer.filterOptions(M),this.stringify=new O(p),this.onDataCallback=C||function(){},this.onEndCallback=F||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return T.prototype.createChildNode=function(p){var C,F,M,U,W,H,J,Y;switch(p.type){case o.CData:this.cdata(p.value);break;case o.Comment:this.comment(p.value);break;case o.Element:M={},J=p.attribs;for(F in J)_.call(J,F)&&(C=J[F],M[F]=C.value);this.node(p.name,M);break;case o.Dummy:this.dummy();break;case o.Raw:this.raw(p.value);break;case o.Text:this.text(p.value);break;case o.ProcessingInstruction:this.instruction(p.target,p.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+p.constructor.name)}for(Y=p.children,W=0,H=Y.length;W<H;W++)U=Y[W],this.createChildNode(U),U.type===o.Element&&this.up();return this},T.prototype.dummy=function(){return this},T.prototype.node=function(p,C,F){var M;if(p==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(p));return this.openCurrent(),p=v(p),C==null&&(C={}),C=v(C),D(C)||(M=[C,F],F=M[0],C=M[1]),this.currentNode=new l(this,p,C),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,F!=null&&this.text(F),this},T.prototype.element=function(p,C,F){var M,U,W,H,J,Y;if(this.currentNode&&this.currentNode.type===o.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(p)||D(p)||m(p))for(H=this.options.noValidation,this.options.noValidation=!0,Y=new h(this.options).element("TEMP_ROOT"),Y.element(p),this.options.noValidation=H,J=Y.children,U=0,W=J.length;U<W;U++)M=J[U],this.createChildNode(M),M.type===o.Element&&this.up();else this.node(p,C,F);return this},T.prototype.attribute=function(p,C){var F,M;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(p));if(p!=null&&(p=v(p)),D(p))for(F in p)_.call(p,F)&&(M=p[F],this.attribute(F,M));else m(C)&&(C=C.apply()),this.options.keepNullAttributes&&C==null?this.currentNode.attribs[p]=new n(this,p,""):C!=null&&(this.currentNode.attribs[p]=new n(this,p,C));return this},T.prototype.text=function(p){var C;return this.openCurrent(),C=new x(this,p),this.onData(this.writer.text(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.cdata=function(p){var C;return this.openCurrent(),C=new i(this,p),this.onData(this.writer.cdata(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.comment=function(p){var C;return this.openCurrent(),C=new a(this,p),this.onData(this.writer.comment(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.raw=function(p){var C;return this.openCurrent(),C=new y(this,p),this.onData(this.writer.raw(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.instruction=function(p,C){var F,M,U,W,H;if(this.openCurrent(),p!=null&&(p=v(p)),C!=null&&(C=v(C)),Array.isArray(p))for(F=0,W=p.length;F<W;F++)M=p[F],this.instruction(M);else if(D(p))for(M in p)_.call(p,M)&&(U=p[M],this.instruction(M,U));else m(C)&&(C=C.apply()),H=new g(this,p,C),this.onData(this.writer.processingInstruction(H,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},T.prototype.declaration=function(p,C,F){var M;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return M=new f(this,p,C,F),this.onData(this.writer.declaration(M,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.doctype=function(p,C,F){if(this.openCurrent(),p==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new c(this,C,F),this.currentNode.rootNodeName=p,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},T.prototype.dtdElement=function(p,C){var F;return this.openCurrent(),F=new r(this,p,C),this.onData(this.writer.dtdElement(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.attList=function(p,C,F,M,U){var W;return this.openCurrent(),W=new t(this,p,C,F,M,U),this.onData(this.writer.dtdAttList(W,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.entity=function(p,C){var F;return this.openCurrent(),F=new s(this,!1,p,C),this.onData(this.writer.dtdEntity(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.pEntity=function(p,C){var F;return this.openCurrent(),F=new s(this,!0,p,C),this.onData(this.writer.dtdEntity(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.notation=function(p,C){var F;return this.openCurrent(),F=new u(this,p,C),this.onData(this.writer.dtdNotation(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},T.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},T.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},T.prototype.openNode=function(p){var C,F,M,U;if(!p.isOpen){if(!this.root&&this.currentLevel===0&&p.type===o.Element&&(this.root=p),F="",p.type===o.Element){this.writerOptions.state=e.OpenTag,F=this.writer.indent(p,this.writerOptions,this.currentLevel)+"<"+p.name,U=p.attribs;for(M in U)_.call(U,M)&&(C=U[M],F+=this.writer.attribute(C,this.writerOptions,this.currentLevel));F+=(p.children?">":"/>")+this.writer.endline(p,this.writerOptions,this.currentLevel),this.writerOptions.state=e.InsideTag}else this.writerOptions.state=e.OpenTag,F=this.writer.indent(p,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+p.rootNodeName,p.pubID&&p.sysID?F+=' PUBLIC "'+p.pubID+'" "'+p.sysID+'"':p.sysID&&(F+=' SYSTEM "'+p.sysID+'"'),p.children?(F+=" [",this.writerOptions.state=e.InsideTag):(this.writerOptions.state=e.CloseTag,F+=">"),F+=this.writer.endline(p,this.writerOptions,this.currentLevel);return this.onData(F,this.currentLevel),p.isOpen=!0}},T.prototype.closeNode=function(p){var C;if(!p.isClosed)return C="",this.writerOptions.state=e.CloseTag,p.type===o.Element?C=this.writer.indent(p,this.writerOptions,this.currentLevel)+"</"+p.name+">"+this.writer.endline(p,this.writerOptions,this.currentLevel):C=this.writer.indent(p,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(p,this.writerOptions,this.currentLevel),this.writerOptions.state=e.None,this.onData(C,this.currentLevel),p.isClosed=!0},T.prototype.onData=function(p,C){return this.documentStarted=!0,this.onDataCallback(p,C+1)},T.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},T.prototype.debugInfo=function(p){return p==null?"":"node: <"+p+">"},T.prototype.ele=function(){return this.element.apply(this,arguments)},T.prototype.nod=function(p,C,F){return this.node(p,C,F)},T.prototype.txt=function(p){return this.text(p)},T.prototype.dat=function(p){return this.cdata(p)},T.prototype.com=function(p){return this.comment(p)},T.prototype.ins=function(p,C){return this.instruction(p,C)},T.prototype.dec=function(p,C,F){return this.declaration(p,C,F)},T.prototype.dtd=function(p,C,F){return this.doctype(p,C,F)},T.prototype.e=function(p,C,F){return this.element(p,C,F)},T.prototype.n=function(p,C,F){return this.node(p,C,F)},T.prototype.t=function(p){return this.text(p)},T.prototype.d=function(p){return this.cdata(p)},T.prototype.c=function(p){return this.comment(p)},T.prototype.r=function(p){return this.raw(p)},T.prototype.i=function(p,C){return this.instruction(p,C)},T.prototype.att=function(){return this.currentNode&&this.currentNode.type===o.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},T.prototype.a=function(){return this.currentNode&&this.currentNode.type===o.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},T.prototype.ent=function(p,C){return this.entity(p,C)},T.prototype.pent=function(p,C){return this.pEntity(p,C)},T.prototype.not=function(p,C){return this.notation(p,C)},T}()}).call(ee)),pn.exports}var hn={exports:{}},$o;function vc(){return $o||($o=1,(function(){var o,e,n,i=function(t,r){for(var s in r)a.call(r,s)&&(t[s]=r[s]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;o=le(),n=js(),e=xt(),hn.exports=function(t){i(r,t);function r(s,u){this.stream=s,r.__super__.constructor.call(this,u)}return r.prototype.endline=function(s,u,f){return s.isLastRootNode&&u.state===e.CloseTag?"":r.__super__.endline.call(this,s,u,f)},r.prototype.document=function(s,u){var f,c,h,l,g,y,b,O,x;for(b=s.children,c=h=0,g=b.length;h<g;c=++h)f=b[c],f.isLastRootNode=c===s.children.length-1;for(u=this.filterOptions(u),O=s.children,x=[],l=0,y=O.length;l<y;l++)f=O[l],x.push(this.writeChildNode(f,u,0));return x},r.prototype.attribute=function(s,u,f){return this.stream.write(r.__super__.attribute.call(this,s,u,f))},r.prototype.cdata=function(s,u,f){return this.stream.write(r.__super__.cdata.call(this,s,u,f))},r.prototype.comment=function(s,u,f){return this.stream.write(r.__super__.comment.call(this,s,u,f))},r.prototype.declaration=function(s,u,f){return this.stream.write(r.__super__.declaration.call(this,s,u,f))},r.prototype.docType=function(s,u,f){var c,h,l,g;if(f||(f=0),this.openNode(s,u,f),u.state=e.OpenTag,this.stream.write(this.indent(s,u,f)),this.stream.write("<!DOCTYPE "+s.root().name),s.pubID&&s.sysID?this.stream.write(' PUBLIC "'+s.pubID+'" "'+s.sysID+'"'):s.sysID&&this.stream.write(' SYSTEM "'+s.sysID+'"'),s.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(s,u,f)),u.state=e.InsideTag,g=s.children,h=0,l=g.length;h<l;h++)c=g[h],this.writeChildNode(c,u,f+1);u.state=e.CloseTag,this.stream.write("]")}return u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+">"),this.stream.write(this.endline(s,u,f)),u.state=e.None,this.closeNode(s,u,f)},r.prototype.element=function(s,u,f){var c,h,l,g,y,b,O,x,v;f||(f=0),this.openNode(s,u,f),u.state=e.OpenTag,this.stream.write(this.indent(s,u,f)+"<"+s.name),x=s.attribs;for(O in x)a.call(x,O)&&(c=x[O],this.attribute(c,u,f));if(l=s.children.length,g=l===0?null:s.children[0],l===0||s.children.every(function(m){return(m.type===o.Text||m.type===o.Raw)&&m.value===""}))u.allowEmpty?(this.stream.write(">"),u.state=e.CloseTag,this.stream.write("</"+s.name+">")):(u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+"/>"));else if(u.pretty&&l===1&&(g.type===o.Text||g.type===o.Raw)&&g.value!=null)this.stream.write(">"),u.state=e.InsideTag,u.suppressPrettyCount++,this.writeChildNode(g,u,f+1),u.suppressPrettyCount--,u.state=e.CloseTag,this.stream.write("</"+s.name+">");else{for(this.stream.write(">"+this.endline(s,u,f)),u.state=e.InsideTag,v=s.children,y=0,b=v.length;y<b;y++)h=v[y],this.writeChildNode(h,u,f+1);u.state=e.CloseTag,this.stream.write(this.indent(s,u,f)+"</"+s.name+">")}return this.stream.write(this.endline(s,u,f)),u.state=e.None,this.closeNode(s,u,f)},r.prototype.processingInstruction=function(s,u,f){return this.stream.write(r.__super__.processingInstruction.call(this,s,u,f))},r.prototype.raw=function(s,u,f){return this.stream.write(r.__super__.raw.call(this,s,u,f))},r.prototype.text=function(s,u,f){return this.stream.write(r.__super__.text.call(this,s,u,f))},r.prototype.dtdAttList=function(s,u,f){return this.stream.write(r.__super__.dtdAttList.call(this,s,u,f))},r.prototype.dtdElement=function(s,u,f){return this.stream.write(r.__super__.dtdElement.call(this,s,u,f))},r.prototype.dtdEntity=function(s,u,f){return this.stream.write(r.__super__.dtdEntity.call(this,s,u,f))},r.prototype.dtdNotation=function(s,u,f){return this.stream.write(r.__super__.dtdNotation.call(this,s,u,f))},r}(n)}).call(ee)),hn.exports}var ko;function wc(){return ko||(ko=1,(function(){var o,e,n,i,a,t,r,s,u,f;f=Pe(),s=f.assign,u=f.isFunction,n=Ps(),i=qs(),a=yc(),r=Hn(),t=vc(),o=le(),e=xt(),xe.create=function(c,h,l,g){var y,b;if(c==null)throw new Error("Root element needs a name.");return g=s({},h,l,g),y=new i(g),b=y.element(c),g.headless||(y.declaration(g),(g.pubID!=null||g.sysID!=null)&&y.dtd(g)),b},xe.begin=function(c,h,l){var g;return u(c)&&(g=[c,h],h=g[0],l=g[1],c={}),h?new a(c,h,l):new i(c)},xe.stringWriter=function(c){return new r(c)},xe.streamWriter=function(c,h){return new t(c,h)},xe.implementation=new n,xe.nodeType=o,xe.writerState=e}).call(ee)),xe}var Bo;function Ec(){return Bo||(Bo=1,(function(){var o,e,n,i,a,t={}.hasOwnProperty;o=wc(),e=Pn().defaults,i=function(r){return typeof r=="string"&&(r.indexOf("&")>=0||r.indexOf(">")>=0||r.indexOf("<")>=0)},a=function(r){return"<![CDATA["+n(r)+"]]>"},n=function(r){return r.replace("]]>","]]]]><![CDATA[>")},Mr.Builder=function(){function r(s){var u,f,c;this.options={},f=e["0.2"];for(u in f)t.call(f,u)&&(c=f[u],this.options[u]=c);for(u in s)t.call(s,u)&&(c=s[u],this.options[u]=c)}return r.prototype.buildObject=function(s){var u,f,c,h,l;return u=this.options.attrkey,f=this.options.charkey,Object.keys(s).length===1&&this.options.rootName===e["0.2"].rootName?(l=Object.keys(s)[0],s=s[l]):l=this.options.rootName,c=function(g){return function(y,b){var O,x,v,m,D,A;if(typeof b!="object")g.options.cdata&&i(b)?y.raw(a(b)):y.txt(b);else if(Array.isArray(b)){for(m in b)if(t.call(b,m)){x=b[m];for(D in x)v=x[D],y=c(y.ele(D),v).up()}}else for(D in b)if(t.call(b,D))if(x=b[D],D===u){if(typeof x=="object")for(O in x)A=x[O],y=y.att(O,A)}else if(D===f)g.options.cdata&&i(x)?y=y.raw(a(x)):y=y.txt(x);else if(Array.isArray(x))for(m in x)t.call(x,m)&&(v=x[m],typeof v=="string"?g.options.cdata&&i(v)?y=y.ele(D).raw(a(v)).up():y=y.ele(D,v).up():y=c(y.ele(D),v).up());else typeof x=="object"?y=c(y.ele(D),x).up():typeof x=="string"&&g.options.cdata&&i(x)?y=y.ele(D).raw(a(x)).up():(x==null&&(x=""),y=y.ele(D,x.toString()).up());return y}}(this),h=o.create(l,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(h,s).end(this.options.renderOpts)},r}()}).call(ee)),Mr}var dn={},mn={},Uo;function bc(){return Uo||(Uo=1,function(o){(function(e){e.parser=function(N,E){return new i(N,E)},e.SAXParser=i,e.SAXStream=c,e.createStream=f,e.MAX_BUFFER_LENGTH=64*1024;var n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function i(N,E){if(!(this instanceof i))return new i(N,E);var X=this;t(X),X.q=X.c="",X.bufferCheckPosition=e.MAX_BUFFER_LENGTH,X.opt=E||{},X.opt.lowercase=X.opt.lowercase||X.opt.lowercasetags,X.looseCase=X.opt.lowercase?"toLowerCase":"toUpperCase",X.tags=[],X.closed=X.closedRoot=X.sawRoot=!1,X.tag=X.error=null,X.strict=!!N,X.noscript=!!(N||X.opt.noscript),X.state=p.BEGIN,X.strictEntities=X.opt.strictEntities,X.ENTITIES=X.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),X.attribList=[],X.opt.xmlns&&(X.ns=Object.create(b)),X.opt.unquotedAttributeValues===void 0&&(X.opt.unquotedAttributeValues=!N),X.trackPosition=X.opt.position!==!1,X.trackPosition&&(X.position=X.line=X.column=0),F(X,"onready")}Object.create||(Object.create=function(N){function E(){}E.prototype=N;var X=new E;return X}),Object.keys||(Object.keys=function(N){var E=[];for(var X in N)N.hasOwnProperty(X)&&E.push(X);return E});function a(N){for(var E=Math.max(e.MAX_BUFFER_LENGTH,10),X=0,d=0,I=n.length;d<I;d++){var S=N[n[d]].length;if(S>E)switch(n[d]){case"textNode":U(N);break;case"cdata":M(N,"oncdata",N.cdata),N.cdata="";break;case"script":M(N,"onscript",N.script),N.script="";break;default:H(N,"Max buffer length exceeded: "+n[d])}X=Math.max(X,S)}var q=e.MAX_BUFFER_LENGTH-X;N.bufferCheckPosition=q+N.position}function t(N){for(var E=0,X=n.length;E<X;E++)N[n[E]]=""}function r(N){U(N),N.cdata!==""&&(M(N,"oncdata",N.cdata),N.cdata=""),N.script!==""&&(M(N,"onscript",N.script),N.script="")}i.prototype={end:function(){J(this)},write:nt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){r(this)}};var s;try{s=require("stream").Stream}catch{s=function(){}}s||(s=function(){});var u=e.EVENTS.filter(function(N){return N!=="error"&&N!=="end"});function f(N,E){return new c(N,E)}function c(N,E){if(!(this instanceof c))return new c(N,E);s.apply(this),this._parser=new i(N,E),this.writable=!0,this.readable=!0;var X=this;this._parser.onend=function(){X.emit("end")},this._parser.onerror=function(d){X.emit("error",d),X._parser.error=null},this._decoder=null,u.forEach(function(d){Object.defineProperty(X,"on"+d,{get:function(){return X._parser["on"+d]},set:function(I){if(!I)return X.removeAllListeners(d),X._parser["on"+d]=I,I;X.on(d,I)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(s.prototype,{constructor:{value:c}}),c.prototype.write=function(N){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(N)){if(!this._decoder){var E=Ks.StringDecoder;this._decoder=new E("utf8")}N=this._decoder.write(N)}return this._parser.write(N.toString()),this.emit("data",N),!0},c.prototype.end=function(N){return N&&N.length&&this.write(N),this._parser.end(),!0},c.prototype.on=function(N,E){var X=this;return!X._parser["on"+N]&&u.indexOf(N)!==-1&&(X._parser["on"+N]=function(){var d=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);d.splice(0,0,N),X.emit.apply(X,d)}),s.prototype.on.call(X,N,E)};var h="[CDATA[",l="DOCTYPE",g="http://www.w3.org/XML/1998/namespace",y="http://www.w3.org/2000/xmlns/",b={xml:g,xmlns:y},O=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,x=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function D(N){return N===" "||N===`
`||N==="\r"||N==="	"}function A(N){return N==='"'||N==="'"}function w(N){return N===">"||D(N)}function _(N,E){return N.test(E)}function T(N,E){return!_(N,E)}var p=0;e.STATE={BEGIN:p++,BEGIN_WHITESPACE:p++,TEXT:p++,TEXT_ENTITY:p++,OPEN_WAKA:p++,SGML_DECL:p++,SGML_DECL_QUOTED:p++,DOCTYPE:p++,DOCTYPE_QUOTED:p++,DOCTYPE_DTD:p++,DOCTYPE_DTD_QUOTED:p++,COMMENT_STARTING:p++,COMMENT:p++,COMMENT_ENDING:p++,COMMENT_ENDED:p++,CDATA:p++,CDATA_ENDING:p++,CDATA_ENDING_2:p++,PROC_INST:p++,PROC_INST_BODY:p++,PROC_INST_ENDING:p++,OPEN_TAG:p++,OPEN_TAG_SLASH:p++,ATTRIB:p++,ATTRIB_NAME:p++,ATTRIB_NAME_SAW_WHITE:p++,ATTRIB_VALUE:p++,ATTRIB_VALUE_QUOTED:p++,ATTRIB_VALUE_CLOSED:p++,ATTRIB_VALUE_UNQUOTED:p++,ATTRIB_VALUE_ENTITY_Q:p++,ATTRIB_VALUE_ENTITY_U:p++,CLOSE_TAG:p++,CLOSE_TAG_SAW_WHITE:p++,SCRIPT:p++,SCRIPT_ENDING:p++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(N){var E=e.ENTITIES[N],X=typeof E=="number"?String.fromCharCode(E):E;e.ENTITIES[N]=X});for(var C in e.STATE)e.STATE[e.STATE[C]]=C;p=e.STATE;function F(N,E,X){N[E]&&N[E](X)}function M(N,E,X){N.textNode&&U(N),F(N,E,X)}function U(N){N.textNode=W(N.opt,N.textNode),N.textNode&&F(N,"ontext",N.textNode),N.textNode=""}function W(N,E){return N.trim&&(E=E.trim()),N.normalize&&(E=E.replace(/\s+/g," ")),E}function H(N,E){return U(N),N.trackPosition&&(E+=`
Line: `+N.line+`
Column: `+N.column+`
Char: `+N.c),E=new Error(E),N.error=E,F(N,"onerror",E),N}function J(N){return N.sawRoot&&!N.closedRoot&&Y(N,"Unclosed root tag"),N.state!==p.BEGIN&&N.state!==p.BEGIN_WHITESPACE&&N.state!==p.TEXT&&H(N,"Unexpected end"),U(N),N.c="",N.closed=!0,F(N,"onend"),i.call(N,N.strict,N.opt),N}function Y(N,E){if(typeof N!="object"||!(N instanceof i))throw new Error("bad call to strictFail");N.strict&&H(N,E)}function Te(N){N.strict||(N.tagName=N.tagName[N.looseCase]());var E=N.tags[N.tags.length-1]||N,X=N.tag={name:N.tagName,attributes:{}};N.opt.xmlns&&(X.ns=E.ns),N.attribList.length=0,M(N,"onopentagstart",X)}function Oe(N,E){var X=N.indexOf(":"),d=X<0?["",N]:N.split(":"),I=d[0],S=d[1];return E&&N==="xmlns"&&(I="xmlns",S=""),{prefix:I,local:S}}function he(N){if(N.strict||(N.attribName=N.attribName[N.looseCase]()),N.attribList.indexOf(N.attribName)!==-1||N.tag.attributes.hasOwnProperty(N.attribName)){N.attribName=N.attribValue="";return}if(N.opt.xmlns){var E=Oe(N.attribName,!0),X=E.prefix,d=E.local;if(X==="xmlns")if(d==="xml"&&N.attribValue!==g)Y(N,"xml: prefix must be bound to "+g+`
Actual: `+N.attribValue);else if(d==="xmlns"&&N.attribValue!==y)Y(N,"xmlns: prefix must be bound to "+y+`
Actual: `+N.attribValue);else{var I=N.tag,S=N.tags[N.tags.length-1]||N;I.ns===S.ns&&(I.ns=Object.create(S.ns)),I.ns[d]=N.attribValue}N.attribList.push([N.attribName,N.attribValue])}else N.tag.attributes[N.attribName]=N.attribValue,M(N,"onattribute",{name:N.attribName,value:N.attribValue});N.attribName=N.attribValue=""}function fe(N,E){if(N.opt.xmlns){var X=N.tag,d=Oe(N.tagName);X.prefix=d.prefix,X.local=d.local,X.uri=X.ns[d.prefix]||"",X.prefix&&!X.uri&&(Y(N,"Unbound namespace prefix: "+JSON.stringify(N.tagName)),X.uri=d.prefix);var I=N.tags[N.tags.length-1]||N;X.ns&&I.ns!==X.ns&&Object.keys(X.ns).forEach(function(G){M(N,"onopennamespace",{prefix:G,uri:X.ns[G]})});for(var S=0,q=N.attribList.length;S<q;S++){var L=N.attribList[S],R=L[0],B=L[1],P=Oe(R,!0),j=P.prefix,k=P.local,$=j===""?"":X.ns[j]||"",V={name:R,value:B,prefix:j,local:k,uri:$};j&&j!=="xmlns"&&!$&&(Y(N,"Unbound namespace prefix: "+JSON.stringify(j)),V.uri=j),N.tag.attributes[R]=V,M(N,"onattribute",V)}N.attribList.length=0}N.tag.isSelfClosing=!!E,N.sawRoot=!0,N.tags.push(N.tag),M(N,"onopentag",N.tag),E||(!N.noscript&&N.tagName.toLowerCase()==="script"?N.state=p.SCRIPT:N.state=p.TEXT,N.tag=null,N.tagName=""),N.attribName=N.attribValue="",N.attribList.length=0}function Ee(N){if(!N.tagName){Y(N,"Weird empty close tag."),N.textNode+="</>",N.state=p.TEXT;return}if(N.script){if(N.tagName!=="script"){N.script+="</"+N.tagName+">",N.tagName="",N.state=p.SCRIPT;return}M(N,"onscript",N.script),N.script=""}var E=N.tags.length,X=N.tagName;N.strict||(X=X[N.looseCase]());for(var d=X;E--;){var I=N.tags[E];if(I.name!==d)Y(N,"Unexpected close tag");else break}if(E<0){Y(N,"Unmatched closing tag: "+N.tagName),N.textNode+="</"+N.tagName+">",N.state=p.TEXT;return}N.tagName=X;for(var S=N.tags.length;S-- >E;){var q=N.tag=N.tags.pop();N.tagName=N.tag.name,M(N,"onclosetag",N.tagName);var L={};for(var R in q.ns)L[R]=q.ns[R];var B=N.tags[N.tags.length-1]||N;N.opt.xmlns&&q.ns!==B.ns&&Object.keys(q.ns).forEach(function(P){var j=q.ns[P];M(N,"onclosenamespace",{prefix:P,uri:j})})}E===0&&(N.closedRoot=!0),N.tagName=N.attribValue=N.attribName="",N.attribList.length=0,N.state=p.TEXT}function Le(N){var E=N.entity,X=E.toLowerCase(),d,I="";return N.ENTITIES[E]?N.ENTITIES[E]:N.ENTITIES[X]?N.ENTITIES[X]:(E=X,E.charAt(0)==="#"&&(E.charAt(1)==="x"?(E=E.slice(2),d=parseInt(E,16),I=d.toString(16)):(E=E.slice(1),d=parseInt(E,10),I=d.toString(10))),E=E.replace(/^0+/,""),isNaN(d)||I.toLowerCase()!==E?(Y(N,"Invalid character entity"),"&"+N.entity+";"):String.fromCodePoint(d))}function z(N,E){E==="<"?(N.state=p.OPEN_WAKA,N.startTagPosition=N.position):D(E)||(Y(N,"Non-whitespace before first tag."),N.textNode=E,N.state=p.TEXT)}function Xe(N,E){var X="";return E<N.length&&(X=N.charAt(E)),X}function nt(N){var E=this;if(this.error)throw this.error;if(E.closed)return H(E,"Cannot write after close. Assign an onready handler.");if(N===null)return J(E);typeof N=="object"&&(N=N.toString());for(var X=0,d="";d=Xe(N,X++),E.c=d,!!d;)switch(E.trackPosition&&(E.position++,d===`
`?(E.line++,E.column=0):E.column++),E.state){case p.BEGIN:if(E.state=p.BEGIN_WHITESPACE,d==="\uFEFF")continue;z(E,d);continue;case p.BEGIN_WHITESPACE:z(E,d);continue;case p.TEXT:if(E.sawRoot&&!E.closedRoot){for(var I=X-1;d&&d!=="<"&&d!=="&";)d=Xe(N,X++),d&&E.trackPosition&&(E.position++,d===`
`?(E.line++,E.column=0):E.column++);E.textNode+=N.substring(I,X-1)}d==="<"&&!(E.sawRoot&&E.closedRoot&&!E.strict)?(E.state=p.OPEN_WAKA,E.startTagPosition=E.position):(!D(d)&&(!E.sawRoot||E.closedRoot)&&Y(E,"Text data outside of root node."),d==="&"?E.state=p.TEXT_ENTITY:E.textNode+=d);continue;case p.SCRIPT:d==="<"?E.state=p.SCRIPT_ENDING:E.script+=d;continue;case p.SCRIPT_ENDING:d==="/"?E.state=p.CLOSE_TAG:(E.script+="<"+d,E.state=p.SCRIPT);continue;case p.OPEN_WAKA:if(d==="!")E.state=p.SGML_DECL,E.sgmlDecl="";else if(!D(d))if(_(O,d))E.state=p.OPEN_TAG,E.tagName=d;else if(d==="/")E.state=p.CLOSE_TAG,E.tagName="";else if(d==="?")E.state=p.PROC_INST,E.procInstName=E.procInstBody="";else{if(Y(E,"Unencoded <"),E.startTagPosition+1<E.position){var S=E.position-E.startTagPosition;d=new Array(S).join(" ")+d}E.textNode+="<"+d,E.state=p.TEXT}continue;case p.SGML_DECL:if(E.sgmlDecl+d==="--"){E.state=p.COMMENT,E.comment="",E.sgmlDecl="";continue}E.doctype&&E.doctype!==!0&&E.sgmlDecl?(E.state=p.DOCTYPE_DTD,E.doctype+="<!"+E.sgmlDecl+d,E.sgmlDecl=""):(E.sgmlDecl+d).toUpperCase()===h?(M(E,"onopencdata"),E.state=p.CDATA,E.sgmlDecl="",E.cdata=""):(E.sgmlDecl+d).toUpperCase()===l?(E.state=p.DOCTYPE,(E.doctype||E.sawRoot)&&Y(E,"Inappropriately located doctype declaration"),E.doctype="",E.sgmlDecl=""):d===">"?(M(E,"onsgmldeclaration",E.sgmlDecl),E.sgmlDecl="",E.state=p.TEXT):(A(d)&&(E.state=p.SGML_DECL_QUOTED),E.sgmlDecl+=d);continue;case p.SGML_DECL_QUOTED:d===E.q&&(E.state=p.SGML_DECL,E.q=""),E.sgmlDecl+=d;continue;case p.DOCTYPE:d===">"?(E.state=p.TEXT,M(E,"ondoctype",E.doctype),E.doctype=!0):(E.doctype+=d,d==="["?E.state=p.DOCTYPE_DTD:A(d)&&(E.state=p.DOCTYPE_QUOTED,E.q=d));continue;case p.DOCTYPE_QUOTED:E.doctype+=d,d===E.q&&(E.q="",E.state=p.DOCTYPE);continue;case p.DOCTYPE_DTD:d==="]"?(E.doctype+=d,E.state=p.DOCTYPE):d==="<"?(E.state=p.OPEN_WAKA,E.startTagPosition=E.position):A(d)?(E.doctype+=d,E.state=p.DOCTYPE_DTD_QUOTED,E.q=d):E.doctype+=d;continue;case p.DOCTYPE_DTD_QUOTED:E.doctype+=d,d===E.q&&(E.state=p.DOCTYPE_DTD,E.q="");continue;case p.COMMENT:d==="-"?E.state=p.COMMENT_ENDING:E.comment+=d;continue;case p.COMMENT_ENDING:d==="-"?(E.state=p.COMMENT_ENDED,E.comment=W(E.opt,E.comment),E.comment&&M(E,"oncomment",E.comment),E.comment=""):(E.comment+="-"+d,E.state=p.COMMENT);continue;case p.COMMENT_ENDED:d!==">"?(Y(E,"Malformed comment"),E.comment+="--"+d,E.state=p.COMMENT):E.doctype&&E.doctype!==!0?E.state=p.DOCTYPE_DTD:E.state=p.TEXT;continue;case p.CDATA:d==="]"?E.state=p.CDATA_ENDING:E.cdata+=d;continue;case p.CDATA_ENDING:d==="]"?E.state=p.CDATA_ENDING_2:(E.cdata+="]"+d,E.state=p.CDATA);continue;case p.CDATA_ENDING_2:d===">"?(E.cdata&&M(E,"oncdata",E.cdata),M(E,"onclosecdata"),E.cdata="",E.state=p.TEXT):d==="]"?E.cdata+="]":(E.cdata+="]]"+d,E.state=p.CDATA);continue;case p.PROC_INST:d==="?"?E.state=p.PROC_INST_ENDING:D(d)?E.state=p.PROC_INST_BODY:E.procInstName+=d;continue;case p.PROC_INST_BODY:if(!E.procInstBody&&D(d))continue;d==="?"?E.state=p.PROC_INST_ENDING:E.procInstBody+=d;continue;case p.PROC_INST_ENDING:d===">"?(M(E,"onprocessinginstruction",{name:E.procInstName,body:E.procInstBody}),E.procInstName=E.procInstBody="",E.state=p.TEXT):(E.procInstBody+="?"+d,E.state=p.PROC_INST_BODY);continue;case p.OPEN_TAG:_(x,d)?E.tagName+=d:(Te(E),d===">"?fe(E):d==="/"?E.state=p.OPEN_TAG_SLASH:(D(d)||Y(E,"Invalid character in tag name"),E.state=p.ATTRIB));continue;case p.OPEN_TAG_SLASH:d===">"?(fe(E,!0),Ee(E)):(Y(E,"Forward-slash in opening tag not followed by >"),E.state=p.ATTRIB);continue;case p.ATTRIB:if(D(d))continue;d===">"?fe(E):d==="/"?E.state=p.OPEN_TAG_SLASH:_(O,d)?(E.attribName=d,E.attribValue="",E.state=p.ATTRIB_NAME):Y(E,"Invalid attribute name");continue;case p.ATTRIB_NAME:d==="="?E.state=p.ATTRIB_VALUE:d===">"?(Y(E,"Attribute without value"),E.attribValue=E.attribName,he(E),fe(E)):D(d)?E.state=p.ATTRIB_NAME_SAW_WHITE:_(x,d)?E.attribName+=d:Y(E,"Invalid attribute name");continue;case p.ATTRIB_NAME_SAW_WHITE:if(d==="=")E.state=p.ATTRIB_VALUE;else{if(D(d))continue;Y(E,"Attribute without value"),E.tag.attributes[E.attribName]="",E.attribValue="",M(E,"onattribute",{name:E.attribName,value:""}),E.attribName="",d===">"?fe(E):_(O,d)?(E.attribName=d,E.state=p.ATTRIB_NAME):(Y(E,"Invalid attribute name"),E.state=p.ATTRIB)}continue;case p.ATTRIB_VALUE:if(D(d))continue;A(d)?(E.q=d,E.state=p.ATTRIB_VALUE_QUOTED):(E.opt.unquotedAttributeValues||H(E,"Unquoted attribute value"),E.state=p.ATTRIB_VALUE_UNQUOTED,E.attribValue=d);continue;case p.ATTRIB_VALUE_QUOTED:if(d!==E.q){d==="&"?E.state=p.ATTRIB_VALUE_ENTITY_Q:E.attribValue+=d;continue}he(E),E.q="",E.state=p.ATTRIB_VALUE_CLOSED;continue;case p.ATTRIB_VALUE_CLOSED:D(d)?E.state=p.ATTRIB:d===">"?fe(E):d==="/"?E.state=p.OPEN_TAG_SLASH:_(O,d)?(Y(E,"No whitespace between attributes"),E.attribName=d,E.attribValue="",E.state=p.ATTRIB_NAME):Y(E,"Invalid attribute name");continue;case p.ATTRIB_VALUE_UNQUOTED:if(!w(d)){d==="&"?E.state=p.ATTRIB_VALUE_ENTITY_U:E.attribValue+=d;continue}he(E),d===">"?fe(E):E.state=p.ATTRIB;continue;case p.CLOSE_TAG:if(E.tagName)d===">"?Ee(E):_(x,d)?E.tagName+=d:E.script?(E.script+="</"+E.tagName,E.tagName="",E.state=p.SCRIPT):(D(d)||Y(E,"Invalid tagname in closing tag"),E.state=p.CLOSE_TAG_SAW_WHITE);else{if(D(d))continue;T(O,d)?E.script?(E.script+="</"+d,E.state=p.SCRIPT):Y(E,"Invalid tagname in closing tag."):E.tagName=d}continue;case p.CLOSE_TAG_SAW_WHITE:if(D(d))continue;d===">"?Ee(E):Y(E,"Invalid characters in closing tag");continue;case p.TEXT_ENTITY:case p.ATTRIB_VALUE_ENTITY_Q:case p.ATTRIB_VALUE_ENTITY_U:var q,L;switch(E.state){case p.TEXT_ENTITY:q=p.TEXT,L="textNode";break;case p.ATTRIB_VALUE_ENTITY_Q:q=p.ATTRIB_VALUE_QUOTED,L="attribValue";break;case p.ATTRIB_VALUE_ENTITY_U:q=p.ATTRIB_VALUE_UNQUOTED,L="attribValue";break}if(d===";"){var R=Le(E);E.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(R)?(E.entity="",E.state=q,E.write(R)):(E[L]+=R,E.entity="",E.state=q)}else _(E.entity.length?m:v,d)?E.entity+=d:(Y(E,"Invalid character in entity name"),E[L]+="&"+E.entity+d,E.entity="",E.state=q);continue;default:throw new Error(E,"Unknown state: "+E.state)}return E.position>=E.bufferCheckPosition&&a(E),E}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var N=String.fromCharCode,E=Math.floor,X=function(){var d=16384,I=[],S,q,L=-1,R=arguments.length;if(!R)return"";for(var B="";++L<R;){var P=Number(arguments[L]);if(!isFinite(P)||P<0||P>1114111||E(P)!==P)throw RangeError("Invalid code point: "+P);P<=65535?I.push(P):(P-=65536,S=(P>>10)+55296,q=P%1024+56320,I.push(S,q)),(L+1===R||I.length>d)&&(B+=N.apply(null,I),I.length=0)}return B};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:X,configurable:!0,writable:!0}):String.fromCodePoint=X}()})(o)}(mn)),mn}var gn={},Xo;function Tc(){return Xo||(Xo=1,(function(){gn.stripBOM=function(o){return o[0]==="\uFEFF"?o.substring(1):o}}).call(ee)),gn}var ke={},Vo;function $s(){return Vo||(Vo=1,(function(){var o;o=new RegExp(/(?!xmlns)^.*:/),ke.normalize=function(e){return e.toLowerCase()},ke.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},ke.stripPrefix=function(e){return e.replace(o,"")},ke.parseNumbers=function(e){return isNaN(e)||(e=e%1===0?parseInt(e,10):parseFloat(e)),e},ke.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e=e.toLowerCase()==="true"),e}}).call(ee)),ke}var zo;function Oc(){return zo||(zo=1,function(o){(function(){var e,n,i,a,t,r,s,u,f=function(l,g){return function(){return l.apply(g,arguments)}},c=function(l,g){for(var y in g)h.call(g,y)&&(l[y]=g[y]);function b(){this.constructor=l}return b.prototype=g.prototype,l.prototype=new b,l.__super__=g.prototype,l},h={}.hasOwnProperty;s=bc(),i=Be,e=Tc(),r=$s(),u=Ys.setImmediate,n=Pn().defaults,a=function(l){return typeof l=="object"&&l!=null&&Object.keys(l).length===0},t=function(l,g,y){var b,O,x;for(b=0,O=l.length;b<O;b++)x=l[b],g=x(g,y);return g},o.Parser=function(l){c(g,l);function g(y){this.parseStringPromise=f(this.parseStringPromise,this),this.parseString=f(this.parseString,this),this.reset=f(this.reset,this),this.assignOrPush=f(this.assignOrPush,this),this.processAsync=f(this.processAsync,this);var b,O,x;if(!(this instanceof o.Parser))return new o.Parser(y);this.options={},O=n["0.2"];for(b in O)h.call(O,b)&&(x=O[b],this.options[b]=x);for(b in y)h.call(y,b)&&(x=y[b],this.options[b]=x);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(r.normalize)),this.reset()}return g.prototype.processAsync=function(){var y,b;try{return this.remaining.length<=this.options.chunkSize?(y=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(y),this.saxParser.close()):(y=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(y),u(this.processAsync))}catch(O){if(b=O,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(b)}},g.prototype.assignOrPush=function(y,b,O){return b in y?(y[b]instanceof Array||(y[b]=[y[b]]),y[b].push(O)):this.options.explicitArray?y[b]=[O]:y[b]=O},g.prototype.reset=function(){var y,b,O,x;return this.removeAllListeners(),this.saxParser=s.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(v){return function(m){if(v.saxParser.resume(),!v.saxParser.errThrown)return v.saxParser.errThrown=!0,v.emit("error",m)}}(this),this.saxParser.onend=function(v){return function(){if(!v.saxParser.ended)return v.saxParser.ended=!0,v.emit("end",v.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,x=[],y=this.options.attrkey,b=this.options.charkey,this.saxParser.onopentag=function(v){return function(m){var D,A,w,_,T;if(w=Object.create(null),w[b]="",!v.options.ignoreAttrs){T=m.attributes;for(D in T)h.call(T,D)&&(!(y in w)&&!v.options.mergeAttrs&&(w[y]=Object.create(null)),A=v.options.attrValueProcessors?t(v.options.attrValueProcessors,m.attributes[D],D):m.attributes[D],_=v.options.attrNameProcessors?t(v.options.attrNameProcessors,D):D,v.options.mergeAttrs?v.assignOrPush(w,_,A):w[y][_]=A)}return w["#name"]=v.options.tagNameProcessors?t(v.options.tagNameProcessors,m.name):m.name,v.options.xmlns&&(w[v.options.xmlnskey]={uri:m.uri,local:m.local}),x.push(w)}}(this),this.saxParser.onclosetag=function(v){return function(){var m,D,A,w,_,T,p,C,F,M;if(T=x.pop(),_=T["#name"],(!v.options.explicitChildren||!v.options.preserveChildrenOrder)&&delete T["#name"],T.cdata===!0&&(m=T.cdata,delete T.cdata),F=x[x.length-1],T[b].match(/^\s*$/)&&!m?(D=T[b],delete T[b]):(v.options.trim&&(T[b]=T[b].trim()),v.options.normalize&&(T[b]=T[b].replace(/\s{2,}/g," ").trim()),T[b]=v.options.valueProcessors?t(v.options.valueProcessors,T[b],_):T[b],Object.keys(T).length===1&&b in T&&!v.EXPLICIT_CHARKEY&&(T=T[b])),a(T)&&(typeof v.options.emptyTag=="function"?T=v.options.emptyTag():T=v.options.emptyTag!==""?v.options.emptyTag:D),v.options.validator!=null&&(M="/"+function(){var U,W,H;for(H=[],U=0,W=x.length;U<W;U++)w=x[U],H.push(w["#name"]);return H}().concat(_).join("/"),function(){var U;try{return T=v.options.validator(M,F&&F[_],T)}catch(W){return U=W,v.emit("error",U)}}()),v.options.explicitChildren&&!v.options.mergeAttrs&&typeof T=="object"){if(!v.options.preserveChildrenOrder)w=Object.create(null),v.options.attrkey in T&&(w[v.options.attrkey]=T[v.options.attrkey],delete T[v.options.attrkey]),!v.options.charsAsChildren&&v.options.charkey in T&&(w[v.options.charkey]=T[v.options.charkey],delete T[v.options.charkey]),Object.getOwnPropertyNames(T).length>0&&(w[v.options.childkey]=T),T=w;else if(F){F[v.options.childkey]=F[v.options.childkey]||[],p=Object.create(null);for(A in T)h.call(T,A)&&(p[A]=T[A]);F[v.options.childkey].push(p),delete T["#name"],Object.keys(T).length===1&&b in T&&!v.EXPLICIT_CHARKEY&&(T=T[b])}}return x.length>0?v.assignOrPush(F,_,T):(v.options.explicitRoot&&(C=T,T=Object.create(null),T[_]=C),v.resultObject=T,v.saxParser.ended=!0,v.emit("end",v.resultObject))}}(this),O=function(v){return function(m){var D,A;if(A=x[x.length-1],A)return A[b]+=m,v.options.explicitChildren&&v.options.preserveChildrenOrder&&v.options.charsAsChildren&&(v.options.includeWhiteChars||m.replace(/\\n/g,"").trim()!=="")&&(A[v.options.childkey]=A[v.options.childkey]||[],D={"#name":"__text__"},D[b]=m,v.options.normalize&&(D[b]=D[b].replace(/\s{2,}/g," ").trim()),A[v.options.childkey].push(D)),A}}(this),this.saxParser.ontext=O,this.saxParser.oncdata=function(v){return function(m){var D;if(D=O(m),D)return D.cdata=!0}}()},g.prototype.parseString=function(y,b){var O;b!=null&&typeof b=="function"&&(this.on("end",function(x){return this.reset(),b(null,x)}),this.on("error",function(x){return this.reset(),b(x)}));try{return y=y.toString(),y.trim()===""?(this.emit("end",null),!0):(y=e.stripBOM(y),this.options.async?(this.remaining=y,u(this.processAsync),this.saxParser):this.saxParser.write(y).close())}catch(x){if(O=x,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw O}else return this.emit("error",O),this.saxParser.errThrown=!0}},g.prototype.parseStringPromise=function(y){return new Promise(function(b){return function(O,x){return b.parseString(y,function(v,m){return v?x(v):O(m)})}}(this))},g}(i),o.parseString=function(l,g,y){var b,O,x;return y!=null?(typeof y=="function"&&(b=y),typeof g=="object"&&(O=g)):(typeof g=="function"&&(b=g),O={}),x=new o.Parser(O),x.parseString(l,b)},o.parseStringPromise=function(l,g){var y,b;return typeof g=="object"&&(y=g),b=new o.Parser(y),b.parseStringPromise(l)}}).call(ee)}(dn)),dn}(function(){var o,e,n,i,a=function(r,s){for(var u in s)t.call(s,u)&&(r[u]=s[u]);function f(){this.constructor=r}return f.prototype=s.prototype,r.prototype=new f,r.__super__=s.prototype,r},t={}.hasOwnProperty;e=Pn(),o=Ec(),n=Oc(),i=$s(),Me.defaults=e.defaults,Me.processors=i,Me.ValidationError=function(r){a(s,r);function s(u){this.message=u}return s}(Error),Me.Builder=o.Builder,Me.Parser=n.Parser,Me.parseString=n.parseString,Me.parseStringPromise=n.parseStringPromise}).call(ee);var Dn={exports:{}},pt={exports:{}},yn,Wo;function ks(){if(Wo)return yn;Wo=1;function o(e){i.debug=i,i.default=i,i.coerce=f,i.disable=s,i.enable=r,i.enabled=u,i.humanize=gs(),Object.keys(e).forEach(function(c){i[c]=e[c]}),i.instances=[],i.names=[],i.skips=[],i.formatters={};function n(c){for(var h=0,l=0;l<c.length;l++)h=(h<<5)-h+c.charCodeAt(l),h|=0;return i.colors[Math.abs(h)%i.colors.length]}i.selectColor=n;function i(c){var h;function l(){if(l.enabled){for(var g=arguments.length,y=new Array(g),b=0;b<g;b++)y[b]=arguments[b];var O=l,x=Number(new Date),v=x-(h||x);O.diff=v,O.prev=h,O.curr=x,h=x,y[0]=i.coerce(y[0]),typeof y[0]!="string"&&y.unshift("%O");var m=0;y[0]=y[0].replace(/%([a-zA-Z%])/g,function(A,w){if(A==="%%")return A;m++;var _=i.formatters[w];if(typeof _=="function"){var T=y[m];A=_.call(O,T),y.splice(m,1),m--}return A}),i.formatArgs.call(O,y);var D=O.log||i.log;D.apply(O,y)}}return l.namespace=c,l.enabled=i.enabled(c),l.useColors=i.useColors(),l.color=n(c),l.destroy=a,l.extend=t,typeof i.init=="function"&&i.init(l),i.instances.push(l),l}function a(){var c=i.instances.indexOf(this);return c!==-1?(i.instances.splice(c,1),!0):!1}function t(c,h){return i(this.namespace+(typeof h>"u"?":":h)+c)}function r(c){i.save(c),i.names=[],i.skips=[];var h,l=(typeof c=="string"?c:"").split(/[\s,]+/),g=l.length;for(h=0;h<g;h++)l[h]&&(c=l[h].replace(/\*/g,".*?"),c[0]==="-"?i.skips.push(new RegExp("^"+c.substr(1)+"$")):i.names.push(new RegExp("^"+c+"$")));for(h=0;h<i.instances.length;h++){var y=i.instances[h];y.enabled=i.enabled(y.namespace)}}function s(){i.enable("")}function u(c){if(c[c.length-1]==="*")return!0;var h,l;for(h=0,l=i.skips.length;h<l;h++)if(i.skips[h].test(c))return!1;for(h=0,l=i.names.length;h<l;h++)if(i.names[h].test(c))return!0;return!1}function f(c){return c instanceof Error?c.stack||c.message:c}return i.enable(i.load()),i}return yn=o,yn}var Ho;function Cc(){return Ho||(Ho=1,function(o,e){function n(c){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(l){return typeof l}:n=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},n(c)}e.log=t,e.formatArgs=a,e.save=r,e.load=s,e.useColors=i,e.storage=u(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),!!this.useColors){var h="color: "+this.color;c.splice(1,0,h,"color: inherit");var l=0,g=0;c[0].replace(/%[a-zA-Z%]/g,function(y){y!=="%%"&&(l++,y==="%c"&&(g=l))}),c.splice(g,0,h)}}function t(){var c;return(typeof console>"u"?"undefined":n(console))==="object"&&console.log&&(c=console).log.apply(c,arguments)}function r(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function s(){var c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=process.env.DEBUG),c}function u(){try{return localStorage}catch{}}o.exports=ks()(e);var f=o.exports.formatters;f.j=function(c){try{return JSON.stringify(c)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}(pt,pt.exports)),pt.exports}var ht={exports:{}},Go;function Dc(){return Go||(Go=1,function(o,e){var n=Nn,i=tt;e.init=h,e.log=u,e.formatArgs=r,e.save=f,e.load=c,e.useColors=t,e.colors=[6,2,3,4,5,1];try{var a=vs();a&&(a.stderr||a).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(function(g){return/^debug_/i.test(g)}).reduce(function(g,y){var b=y.substring(6).toLowerCase().replace(/_([a-z])/g,function(x,v){return v.toUpperCase()}),O=process.env[y];return/^(yes|on|true|enabled)$/i.test(O)?O=!0:/^(no|off|false|disabled)$/i.test(O)?O=!1:O==="null"?O=null:O=Number(O),g[b]=O,g},{});function t(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:n.isatty(process.stderr.fd)}function r(g){var y=this.namespace,b=this.useColors;if(b){var O=this.color,x="\x1B[3"+(O<8?O:"8;5;"+O),v="  ".concat(x,";1m").concat(y," \x1B[0m");g[0]=v+g[0].split(`
`).join(`
`+v),g.push(x+"m+"+o.exports.humanize(this.diff)+"\x1B[0m")}else g[0]=s()+y+" "+g[0]}function s(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function u(){return process.stderr.write(i.format.apply(i,arguments)+`
`)}function f(g){g?process.env.DEBUG=g:delete process.env.DEBUG}function c(){return process.env.DEBUG}function h(g){g.inspectOpts={};for(var y=Object.keys(e.inspectOpts),b=0;b<y.length;b++)g.inspectOpts[y[b]]=e.inspectOpts[y[b]]}o.exports=ks()(e);var l=o.exports.formatters;l.o=function(g){return this.inspectOpts.colors=this.useColors,i.inspect(g,this.inspectOpts).split(`
`).map(function(y){return y.trim()}).join(" ")},l.O=function(g){return this.inspectOpts.colors=this.useColors,i.inspect(g,this.inspectOpts)}}(ht,ht.exports)),ht.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Dn.exports=Cc():Dn.exports=Dc();var Ac=Dn.exports;const Ye=An,_c=_n,Nc=Gs,Je=Sn,Ko=ze,Ic=Me,xc=xs,Fc=Ac("roa"),dt=Nt;function Sc(o){return o.replace(/[\t\n\r\f]/g," ")}function Pc(o){const e=Object.keys(o),n={};for(let i=0;i<e.length;i++){const a=e[i];n[a.toLowerCase()]=o[a]}return n}function Lc(o){const e="x-acs-",n=Object.keys(o),i=[];for(let t=0;t<n.length;t++){const r=n[t];r.startsWith(e)&&i.push(r)}i.sort();var a="";for(let t=0;t<i.length;t++){const r=i[t];a+=`${r}:${Sc(o[r]).trim()}
`}return a}function Mc(o,e){const n=Object.keys(e).sort();if(n.length===0)return o;for(var i=[],a=0;a<n.length;a++){const t=n[a];i.push(`${t}=${e[t]}`)}return`${o}?${i.join("&")}`}function Rc(o,e,n,i){const a=n.accept,t=n["content-md5"]||"",r=n["content-type"]||"",s=n.date||"",u=`${o}
${a}
${t}
${r}
${s}
`,f=Lc(n),c=Mc(e,i);return`${u}${f}${c}`}function jc(o){const e=new Ic.Parser({});return new Promise((n,i)=>{e.parseString(o,(a,t)=>{if(a)return i(a);n(t)})})}class qc extends Error{constructor(e){const n=e.Message[0],i=e.Code[0],a=e.HostId[0],t=e.RequestId[0];super(`${n} hostid: ${a}, requestid: ${t}`),this.code=i}}class $c{constructor(e){if(Ye(e,'must pass "config"'),Ye(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Ye(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else Ye(e.accessKeyId,'must pass "config.accessKeyId"'),Ye(e.accessKeySecret,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=e.accessKeySecret,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:e.accessKeySecret,securityToken:e.securityToken})};this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.host=_c.parse(this.endpoint).hostname,this.opts=e.opts;var n=this.endpoint.startsWith("https://")?Et:wt;this.keepAliveAgent=new n.Agent({keepAlive:!0,keepAliveMsecs:3e3})}buildHeaders(){var n={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Je.makeNonce(),"x-acs-signature-method":"HMAC-SHA1","x-acs-signature-version":"1.0","x-acs-version":this.apiVersion,"user-agent":dt.DEFAULT_UA,"x-sdk-client":dt.DEFAULT_CLIENT};return this.securityToken&&(n["x-acs-accesskey-id"]=this.accessKeyId,n["x-acs-security-token"]=this.securityToken),n}signature(e){const n=Buffer.from(e,"utf8");return Je.sha1(n,this.accessKeySecret,"base64")}buildAuthorization(e){return`acs ${this.accessKeyId}:${this.signature(e)}`}async request(e,n,i={},a="",t={},r={}){const s=await this.credentialsProvider.getCredentials();var f={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Je.makeNonce(),"x-acs-version":this.apiVersion,"user-agent":dt.DEFAULT_UA,"x-sdk-client":dt.DEFAULT_CLIENT};s&&s.accessKeyId&&s.accessKeySecret&&(f["x-acs-signature-method"]="HMAC-SHA1",f["x-acs-signature-version"]="1.0",s.securityToken&&(f["x-acs-accesskey-id"]=s.accessKeyId,f["x-acs-security-token"]=s.securityToken));var c=Object.assign(f,Pc(t)),h=null;h=Buffer.from(a,"utf8"),c["content-md5"]=Je.md5(h,"base64"),c["content-length"]=h.length;var l=`${this.endpoint}${n}`;if(Object.keys(i).length&&(l+=`?${Nc.stringify(i)}`),s&&s.accessKeyId&&s.accessKeySecret){const m=Rc(e,n,c,i);Fc("stringToSign: %s",m);const D=Buffer.from(m,"utf8"),A=Je.sha1(D,s.accessKeySecret,"base64");c.authorization=`acs ${s.accessKeyId}:${A}`}const g=Object.assign({method:e,agent:this.keepAliveAgent,headers:c,data:h},this.opts,r),y=await Ko.request(l,g),b=await Ko.read(y,"utf8");if(r.rawBody)return b;const O=y.headers["content-type"]||"";if(O.startsWith("application/json")){const m=y.statusCode;if(m===204)return b;var x;try{x=xc.parse(b)}catch(D){throw D.name="FormatError",D.message="parse response to json error",D.body=b,D}if(m>=400){const D=x.Message||x.errorMsg||"",A=x.Code||x.errorCode||"",w=x.RequestId||"";var v=new Error(`code: ${m}, ${D}, requestid: ${w}`);throw v.name=`${A}Error`,v.statusCode=m,v.result=x,v.code=A,v}return x}if(O.startsWith("text/xml")){const m=await jc(b);if(m.Error)throw new qc(m.Error);return m}return b}put(e,n,i,a,t){return this.request("PUT",e,n,i,a,t)}post(e,n,i,a,t){return this.request("POST",e,n,i,a,t)}get(e,n,i,a){return this.request("GET",e,n,"",i,a)}delete(e,n,i,a){return this.request("DELETE",e,n,"",i,a)}}var kc=$c;At.exports=Ss;At.exports.ROAClient=kc;At.exports.RPCClient=Ss;var Bc=At.exports;const Uc=bt(Bc);async function Xc(){const o=new Uc({accessKeyId:vt.accessKeyId,accessKeySecret:vt.accessKeySecret,endpoint:"http://nls-meta.cn-shanghai.aliyuncs.com",apiVersion:"2019-02-28"});try{return(await o.request("CreateToken")).Token.Id}catch(e){return console.error("Error creating token:",e),null}}function et(o){return new Promise((e,n)=>{os.ffprobe(o,(i,a)=>{if(i)return n(i);e(a.format.duration||0)})})}async function Vc(o){try{const e=tt.promisify(rt.exec),{stdout:n}=await e(`ffprobe -v error -show_streams -select_streams a "${o}"`);return n.includes("codec_type=audio")}catch(e){return console.error(`hasAudio error: ${e}`),!1}}function zc(o,e){let n="";e.forEach((i,a)=>{const t=Yo(i.start),r=Yo(i.start+i.duration);n+=`${a+1}
${t} --> ${r}
${i.text}

`}),ae.writeFileSync(o,n)}function Yo(o){const e=new Date(0);return e.setSeconds(o),e.toISOString().slice(11,23).replace(".",",")}async function Wc(o){const e={win32:"C:/Windows/Fonts/",darwin:"/System/Library/Fonts/",linux:"/usr/share/fonts/"},n=process.platform,i=Q.join(e[n]||"",o);try{return await ae.promises.access(i),i}catch{return o}}const Ve="zhushou";function Ft(){switch(process.platform){case"win32":return Q.join(re.app.getPath("appData"),Ve);case"darwin":return Q.join(re.app.getPath("appData"),Ve);case"linux":return Q.join(re.app.getPath("appData"),Ve);default:return Q.join(re.app.getPath("documents"),Ve)}}function Gn(){try{const o=Ft();ae.existsSync(o)||(ae.mkdirSync(o),console.log("Created zhushou directory at:",o));try{ae.accessSync(o,ae.constants.W_OK)}catch{return console.error("No write permission for zhushou directory, falling back to documents"),Q.join(re.app.getPath("documents"),Ve)}return o}catch(o){return console.error("Failed to create zhushou directory:",o),Q.join(re.app.getPath("documents"),Ve)}}function Hc(){re.ipcMain.handle("get-default-save-path",()=>Gn())}function Gc(){re.ipcMain.handle("text2voice",async(o,e)=>{try{const n=JSON.parse(En(e));oe.log("accept params:"),oe.log(JSON.stringify(n));const i=n,a=n.outputDir||Ft(),t=n.outputFileName||`tts_${Date.now()}`,r=await Xc();Lt.existsSync(a)||Lt.mkdirSync(a,{recursive:!0});const s=new _u({url:vt.ttsUrl,appkey:vt.appkey,token:r}),u=Q.join(a,`${t}.${i.format||"mp3"}`),f=Lt.createWriteStream(u);return oe.log(u),new Promise((c,h)=>{s.on("meta",l=>{oe.info("接收到元信息:",l)}),s.on("data",l=>{try{f.write(l),oe.debug(`接收到数据块，大小: ${l.length} bytes`)}catch(g){oe.error("写入文件失败:",g),h(g)}}),s.on("completed",async()=>{f.end(),oe.info("语音合成完成");const l=await et(u);oe.info(`语音合成完成，时长: ${l}秒`),c({success:!0,outputFile:u,duration:l})}),s.on("closed",()=>{oe.info("连接已关闭")}),s.on("failed",l=>{f.end(),oe.error("语音合成失败:",l),h(l)}),s.start(i,!0,6e3)})}catch(n){throw oe.error("语音合成初始化失败:",n),n}})}const Kc={...Ae.webcrypto.subtle,generateKey:async(o,e,n)=>Ae.webcrypto.subtle.generateKey(o,e,n)},Yc={getRandomValues:o=>{if(!o)return o;switch(!0){case o instanceof Int8Array:return Ae.webcrypto.getRandomValues(o);case o instanceof Uint8Array:return Ae.webcrypto.getRandomValues(o);case o instanceof Uint8ClampedArray:return Ae.webcrypto.getRandomValues(o);case o instanceof Int16Array:return Ae.webcrypto.getRandomValues(o);case o instanceof Uint16Array:return Ae.webcrypto.getRandomValues(o);case o instanceof Int32Array:return Ae.webcrypto.getRandomValues(o);case o instanceof Uint32Array:return Ae.webcrypto.getRandomValues(o);default:throw new Error("Unsupported ArrayBufferView type")}},randomUUID:()=>Ae.webcrypto.randomUUID(),subtle:Kc};function Bs(){oe.transports.file.encoding="utf8",oe.transports.file.level="info",oe.transports.file.maxSize=5*1024*1024,oe.transports.file.format="[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}] {text}";const o=oe.transports.file.getFile().path;if(oe.transports.file.stream=ae.createWriteStream(o,{flags:"a",encoding:"utf8"}),process.platform==="win32"){process.env.CHCP="65001";try{require("child_process").execSync("chcp 65001")}catch{}}const e=global.console;return global.console=oe,{restore:()=>{global.console=e}}}Bs();async function Jc(o){const{videoPath:e,audioPath:n,isOpenOriginAudio:i,startTime:a,currentDuration:t,outputPath:r,subtitles:s,subtitlePath:u,titleConfig:f,videoWidth:c,videoHeight:h}=o;return new Promise(async(l,g)=>{const y=u;zc(y,s);const b=Ze().input(e).input(n);e.replace(/\\/g,"/").replace(/:/g,"\\:"),n.replace(/\\/g,"/").replace(/:/g,"\\:");const O=y.replace(/\\/g,"/").replace(/:/g,"\\:");r.replace(/\\/g,"/").replace(/:/g,"\\:");const x=[{filter:"trim",options:{start:a,duration:t},inputs:"0:v",outputs:"trimmed_video"},{filter:"setpts",options:"PTS-STARTPTS",inputs:"trimmed_video",outputs:"video_pts"},{filter:"scale",options:{w:c,h,force_original_aspect_ratio:"decrease",eval:"frame"},inputs:"video_pts",outputs:"scaled_video"},{filter:"pad",options:{width:c,height:h,x:"(ow-iw)/2",y:"(oh-ih)/2",color:"black"},inputs:"scaled_video",outputs:"padded_video"}];if(f){const A=f.duration||t,w={top:"10",middle:"(h-text_h)/2",bottom:"h-text_h-10"},_=await Wc("arial.ttf");x.push({filter:"drawtext",options:{text:f.text,fontfile:_,fontsize:f.fontSize||36,fontcolor:f.fontColor||"white",x:"(w-text_w)/2",y:w[f.position||"top"],shadowcolor:"black",shadowx:2,shadowy:2,enable:`between(t,0,${A})`},inputs:"padded_video",outputs:"video_with_title"})}else x.push({filter:"null",inputs:"padded_video",outputs:"video_with_title"});const v=f?`[video_with_title]subtitles='${O}':force_style='Fontsize=36,PrimaryColour=&HFFFFFF&'[video_with_subtitles]`:`[padded_video]subtitles='${O}':force_style='Fontsize=36,PrimaryColour=&HFFFFFF&'[video_with_subtitles]`;x.push(v);const m=[];let D="";i&&await Vc(e)?(m.push({filter:"atrim",options:{start:a,duration:t},inputs:"0:a",outputs:"trimmed_original"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_original",outputs:"original_pts"},{filter:"volume",options:"1.0",inputs:"original_pts",outputs:"original_audio"},{filter:"atrim",options:{start:0,duration:t},inputs:"1:a",outputs:"trimmed_new"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_new",outputs:"new_pts"},{filter:"volume",options:"1.0",inputs:"new_pts",outputs:"new_audio"},{filter:"amix",options:{inputs:2,duration:"longest"},inputs:["original_audio","new_audio"],outputs:"mixed_audio"}),D="mixed_audio"):(m.push({filter:"atrim",options:{start:0,duration:t},inputs:"1:a",outputs:"trimmed_new"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_new",outputs:"new_pts"},{filter:"volume",options:"1.0",inputs:"new_pts",outputs:"new_audio"}),D="new_audio"),b.complexFilter([...x,...m]).outputOptions(["-map [video_with_subtitles]",`-map [${D}]`,"-c:v libx264","-c:a aac","-preset fast"]),b.on("start",A=>{console.log("start to execute command: "+A)}).on("progress",A=>{console.log(`processing: ${Math.round(A.percent)}%`)}).on("end",()=>{console.log(`segment process done: ${r}`),l()}).on("error",A=>{console.error(`segment process error: ${A.message}`),g(A)}).save(r)})}async function Qc(o,e,n,i){const a=i.videoRatio,r=i.videoResolution.split("x").map(m=>parseInt(m)),s=a==="9:16"?r[0]:r[1],u=a==="9:16"?r[1]:r[0],f=o.zimuConfig.datas[0],c=f.path;let h=f.duration??await et(c);h=Math.ceil(h*100)/100;const l=o.videoList,g=o.isOpenOriginAudio??!0,y=[],b=`${n}_${o.name}_`,O=o.zimuConfig.datas.map(m=>({text:m.text,start:0,duration:h})),x=Q.join(e,`${n}_${o.name}_subtitles.srt`),v=o.videoTitleConfig.datas[0];for(const m of l){const D=m.path,A=m.duration??await et(D),w=h,_=Math.ceil(A/w),T=b+Q.basename(D,Q.extname(D));for(let p=0;p<_;p++){const C=p*w,F=m.duration-C,M=Math.min(w,F),U=Q.join(e,`${T}_part${p+1}_${C}-${C+M}.mp4`);y.push({videoPath:D,audioPath:c,outputPath:U,startTime:C,currentDuration:M,isOpenOriginAudio:g,subtitles:O,subtitlePath:x,titleConfig:v,videoWidth:s,videoHeight:u})}}return y}async function Zc(o,e){return new Promise((n,i)=>{const a=Ze();o.forEach(s=>{a.input(s)});const t=[];for(let s=0;s<o.length;s++)t.push(`[${s}:v]scale=1280:720:force_original_aspect_ratio=decrease,pad=1280:720:(ow-iw)/2:(oh-ih)/2,setsar=1[v${s}]`),t.push(`[${s}:a]aformat=sample_fmts=fltp:sample_rates=44100:channel_layouts=stereo[a${s}]`);const r=o.map((s,u)=>`[v${u}][a${u}]`).join("");t.push(`${r} concat=n=${o.length}:v=1:a=1[v][a]`),a.complexFilter(t).outputOptions(["-map [v]","-map [a]","-c:v libx264","-preset fast","-crf 23","-c:a aac","-b:a 128k","-movflags +faststart"]).on("start",s=>console.log("执行命令:",s)).on("progress",s=>console.log(`处理进度: ${Math.round(s.percent)}%`)).on("end",n).on("error",i).save(e)})}async function el(o){oe.log("accept params："),oe.log(JSON.stringify(o));const e=o.clips,n=o.outputFileName,i=o.outputDir??Gn(),a=o.globalConfig;for(const c of e)c.segments=await Qc(c,i,n,a);oe.log("split clip to segments done："),oe.log(JSON.stringify(e));const t=[];for(const c of e)t.push(...c.segments);oe.info("segments:"),oe.info(JSON.stringify(t));const r=t.map(c=>Jc(c));await Promise.all(r),oe.log("segment process done："),oe.log(JSON.stringify(t));let s=1;for(const c of e)(s===1||c.segments.length>1&&c.segments.length<s)&&(s=c.segments.length);oe.log(`we can generate ${s} videos`);const u=[];for(let c=0;c<s;c++){const h=[];let l=0;for(const g of e){const y=g.segments;let b;y.length===1?b=y[0]:b=y[c],h.push(b.outputPath),l+=b.currentDuration}u.push({videos:h,outputPath:Q.join(i,`${n}_${c+1}.mp4`),duration:l})}oe.log("concat videos start"),oe.log(JSON.stringify(u));const f=u.map(c=>Zc(c.videos,c.outputPath));return await Promise.all(f),oe.log("concat videos done："),oe.log(JSON.stringify(u)),u.map(c=>({outputPath:c.outputPath,duration:c.duration}))}function tl(){re.ipcMain.handle("video-mix-and-cut",async(o,e)=>{const n=JSON.parse(En(e));return el(n)}),re.ipcMain.handle("get-media-duration",async(o,e)=>{const n=JSON.parse(En(e));return et(n.path)})}function rl(o){re.ipcMain.handle("open-file-dialog",async(e,n)=>{if(!o)return null;const i=(n==null?void 0:n.defaultPath)||Ft(),a=(n==null?void 0:n.properties)||["openFile"],t=(n==null?void 0:n.title)||"选择文件",r=(n==null?void 0:n.buttonLabel)||"选择",s=(n==null?void 0:n.filters)||[{name:"All Files",extensions:["*"]}];n!=null&&n.multiple&&!a.includes("multiSelections")&&a.push("multiSelections");const u=await re.dialog.showOpenDialog(o,{title:t,defaultPath:i,buttonLabel:r,filters:s,properties:a});if(u.canceled)return[];{const f=u.filePaths.map(async c=>{const h=await et(c),l=`media://${encodeURIComponent(c)}`;return{path:Q.normalize(c),name:Q.basename(c),ext:Q.extname(c),mimeType:gt(c),duration:h,url:l}});return await Promise.all(f)}})}async function nl(o){const e=Q.normalize(o);if(e!==o||e.includes("..")||![re.app.getPath("documents"),re.app.getPath("downloads"),re.app.getPath("videos"),Ft()].map(a=>Q.normalize(a)).some(a=>e.startsWith(a+Q.sep)))return!1;try{return await ae.promises.access(e,ae.constants.R_OK),!0}catch{return!1}}function il(){re.protocol.handle("media",async o=>{try{const e=o.url.slice(8),n=decodeURIComponent(e).replace(/\//g,"\\").replace(/^\\/,""),i=Q.normalize(n);if(!await nl(i))return new Response("Access Denied",{status:403});const a=await ae.promises.stat(i);if(!a.isFile())return new Response("Not a file",{status:400});const t=o.headers.get("range"),r=a.size,s={"Content-Type":gt(i),"Cache-Control":"public, max-age=31536000"};if(t){const u=t.replace(/bytes=/,"").split("-"),f=parseInt(u[0],10),c=u[1]?parseInt(u[1],10):r-1,h=c-f+1,l=ae.createReadStream(i,{start:f,end:c}),g=Ui(l);return new Response(g,{status:206,headers:{"Content-Range":`bytes ${f}-${c}/${r}`,"Accept-Ranges":"bytes","Content-Length":h.toString(),"Content-Type":await gt(i),"Cache-Control":"public, max-age=31536000"}})}else{const u=ae.createReadStream(i),f=Ui(u);return new Response(f,{headers:{"Content-Length":r.toString(),"Content-Type":await gt(i),"Cache-Control":"public, max-age=31536000"}})}}catch{return new Response("Not Found",{status:404})}})}function ol(o){re.globalShortcut.register("CommandOrControl+R",()=>{o&&o.reload()})}global.crypto=Yc;process.env.LANG="zh_CN.UTF-8";process.env.LC_ALL="zh_CN.UTF-8";process.platform==="win32"&&(process.env.CHCP="65001");process.env.DIST=Q.join(__dirname,"../dist");process.env.VITE_PUBLIC=re.app.isPackaged?process.env.DIST:Q.join(process.env.DIST,"../public");let Ne;const Jo=process.env.VITE_DEV_SERVER_URL;function Us(){Ne=new re.BrowserWindow({icon:Q.join(process.env.VITE_PUBLIC,"electron-vite.svg"),webPreferences:{nodeIntegration:!0,contextIsolation:!0,preload:Q.join(__dirname,"preload.js")}}),Ne.webContents.on("did-finish-load",()=>{Ne==null||Ne.webContents.send("main-process-message",new Date().toLocaleString())}),Jo?Ne.loadURL(Jo):Ne.loadFile(Q.join(process.env.DIST,"index.html"))}Bs();Ka();Qs();Ya();Gc();Hc();tl();re.app.whenReady().then(()=>{Gn(),Ga(),il(),Us(),rl(Ne),ol(Ne)});re.app.on("window-all-closed",()=>{process.platform!=="darwin"&&(re.app.quit(),Ne=null)});re.app.on("activate",()=>{re.BrowserWindow.getAllWindows().length===0&&Us()});re.app.on("will-quit",()=>{re.globalShortcut.unregisterAll()});
//# sourceMappingURL=main.js.map
