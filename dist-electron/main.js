"use strict";var Wu=Object.defineProperty;var Hu=(t,e,r)=>e in t?Wu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var ie=(t,e,r)=>(Hu(t,typeof e!="symbol"?e+"":e,r),r),Ji=(t,e,r)=>{if(!e.has(t))throw TypeError("Cannot "+r)};var ke=(t,e,r)=>(Ji(t,e,"read from private field"),r?r.call(t):e.get(t)),jt=(t,e,r)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,r)},Xe=(t,e,r,o)=>(Ji(t,e,"write to private field"),o?o.call(t,r):e.set(t,r),r);var Tr=(t,e,r,o)=>({set _(s){Xe(t,e,s,r)},get _(){return ke(t,e,o)}});const se=require("electron"),Z=require("path"),ce=require("fs"),sr=require("child_process"),it=require("os"),$t=require("util"),ct=require("events"),ar=require("http"),ur=require("https"),Gu=require("ws"),cr=require("assert"),Yu=require("zlib"),Si=require("url"),ma=require("tty"),Ju=require("crypto"),Ku=require("querystring"),Qu=require("string_decoder"),Zu=require("timers"),ya=require("stream"),ec=require("constants");function tc(t){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(t){for(const r in t)if(r!=="default"){const o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,o.get?o:{enumerable:!0,get:()=>t[r]})}}return e.default=t,Object.freeze(e)}const Cr=tc(ce);require("iconv-lite");function Nt(t){return Buffer.from(t,"base64").toString("utf-8")}function Zt(t){switch(Z.extname(t).toLowerCase()){case".mp4":return"video/mp4";case".webm":return"video/webm";case".mov":return"video/quicktime";case".avi":return"video/x-msvideo";case".mkv":return"video/x-matroska";case".mp3":return"audio/mpeg";case".wav":return"audio/wav";case".ogg":return"audio/ogg";case".aac":return"audio/aac";case".flac":return"audio/flac";case".jpg":case".jpeg":return"image/jpeg";case".png":return"image/png";default:return"application/octet-stream"}}function Ki(t){return new ReadableStream({start(e){t.on("data",r=>{e.enqueue(r)}),t.on("end",()=>{e.close()}),t.on("error",r=>{e.error(r)})},cancel(){t.destroy()}})}function Qi(t){return process.platform==="win32"?t.replace(/\\/g,"\\\\").replace(/:/g,"\\:"):t.replace(/(\s)/g,"\\$1")}function rc(){se.ipcMain.handle("show-save-dialog",async(t,e)=>await se.dialog.showSaveDialog({title:e.title||"保存文件",defaultPath:e.defaultPath||se.app.getPath("documents"),filters:e.filters||[{name:"MP4 Videos",extensions:["mp4"]},{name:"All Files",extensions:["*"]}]})),se.ipcMain.handle("select-directory",async(t,e)=>{const r=e&&JSON.parse(Nt(e)),o=await se.dialog.showOpenDialog({properties:["openDirectory"],title:"选择保存目录",defaultPath:(r==null?void 0:r.defaultPath)||se.app.getPath("documents")});return!o.canceled&&o.filePaths.length>0?o.filePaths[0]:null})}function nc(){se.ipcMain.handle("open-file",async(t,e)=>{const{shell:r}=require("electron");await r.openPath(e)})}var ne=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function vt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ic(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var s=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(r,o,s.get?s:{enumerable:!0,get:function(){return t[o]}})}),r}var er={exports:{}},Dr={exports:{}},Zi;function ga(){return Zi||(Zi=1,function(t){let e={};try{e=require("electron")}catch{}e.ipcRenderer&&r(e),t.exports=r;function r({contextBridge:o,ipcRenderer:s}){if(!s)return;s.on("__ELECTRON_LOG_IPC__",(i,a)=>{window.postMessage({cmd:"message",...a})}),s.invoke("__ELECTRON_LOG__",{cmd:"getOptions"}).catch(i=>console.error(new Error(`electron-log isn't initialized in the main process. Please call log.initialize() before. ${i.message}`)));const n={sendToMain(i){try{s.send("__ELECTRON_LOG__",i)}catch(a){console.error("electronLog.sendToMain ",a,"data:",i),s.send("__ELECTRON_LOG__",{cmd:"errorHandler",error:{message:a==null?void 0:a.message,stack:a==null?void 0:a.stack},errorName:"sendToMain"})}},log(...i){n.sendToMain({data:i,level:"info"})}};for(const i of["error","warn","info","verbose","debug","silly"])n[i]=(...a)=>n.sendToMain({data:a,level:i});if(o&&process.contextIsolated)try{o.exposeInMainWorld("__electronLog",n)}catch{}typeof window=="object"?window.__electronLog=n:__electronLog=n}}(Dr)),Dr.exports}var Fr={exports:{}},Ar,eo;function oc(){if(eo)return Ar;eo=1,Ar=t;function t(e){return Object.defineProperties(r,{defaultLabel:{value:"",writable:!0},labelPadding:{value:!0,writable:!0},maxLabelLength:{value:0,writable:!0},labelLength:{get(){switch(typeof r.labelPadding){case"boolean":return r.labelPadding?r.maxLabelLength:0;case"number":return r.labelPadding;default:return 0}}}});function r(o){r.maxLabelLength=Math.max(r.maxLabelLength,o.length);const s={};for(const n of e.levels)s[n]=(...i)=>e.logData(i,{level:n,scope:o});return s.log=s.info,s}}return Ar}var _r,to;function sc(){if(to)return _r;to=1;class t{constructor({processMessage:r}){this.processMessage=r,this.buffer=[],this.enabled=!1,this.begin=this.begin.bind(this),this.commit=this.commit.bind(this),this.reject=this.reject.bind(this)}addMessage(r){this.buffer.push(r)}begin(){this.enabled=[]}commit(){this.enabled=!1,this.buffer.forEach(r=>this.processMessage(r)),this.buffer=[]}reject(){this.enabled=!1,this.buffer=[]}}return _r=t,_r}var Nr,ro;function va(){if(ro)return Nr;ro=1;const t=oc(),e=sc(),o=class o{constructor({allowUnknownLevel:n=!1,dependencies:i={},errorHandler:a,eventLogger:u,initializeFn:f,isDev:c=!1,levels:h=["error","warn","info","verbose","debug","silly"],logId:l,transportFactories:d={},variables:g}={}){ie(this,"dependencies",{});ie(this,"errorHandler",null);ie(this,"eventLogger",null);ie(this,"functions",{});ie(this,"hooks",[]);ie(this,"isDev",!1);ie(this,"levels",null);ie(this,"logId",null);ie(this,"scope",null);ie(this,"transports",{});ie(this,"variables",{});this.addLevel=this.addLevel.bind(this),this.create=this.create.bind(this),this.initialize=this.initialize.bind(this),this.logData=this.logData.bind(this),this.processMessage=this.processMessage.bind(this),this.allowUnknownLevel=n,this.buffering=new e(this),this.dependencies=i,this.initializeFn=f,this.isDev=c,this.levels=h,this.logId=l,this.scope=t(this),this.transportFactories=d,this.variables=g||{};for(const w of this.levels)this.addLevel(w,!1);this.log=this.info,this.functions.log=this.log,this.errorHandler=a,a==null||a.setOptions({...i,logFn:this.error}),this.eventLogger=u,u==null||u.setOptions({...i,logger:this});for(const[w,E]of Object.entries(d))this.transports[w]=E(this,i);o.instances[l]=this}static getInstance({logId:n}){return this.instances[n]||this.instances.default}addLevel(n,i=this.levels.length){i!==!1&&this.levels.splice(i,0,n),this[n]=(...a)=>this.logData(a,{level:n}),this.functions[n]=this[n]}catchErrors(n){return this.processMessage({data:["log.catchErrors is deprecated. Use log.errorHandler instead"],level:"warn"},{transports:["console"]}),this.errorHandler.startCatching(n)}create(n){return typeof n=="string"&&(n={logId:n}),new o({dependencies:this.dependencies,errorHandler:this.errorHandler,initializeFn:this.initializeFn,isDev:this.isDev,transportFactories:this.transportFactories,variables:{...this.variables},...n})}compareLevels(n,i,a=this.levels){const u=a.indexOf(n),f=a.indexOf(i);return f===-1||u===-1?!0:f<=u}initialize(n={}){this.initializeFn({logger:this,...this.dependencies,...n})}logData(n,i={}){this.buffering.enabled?this.buffering.addMessage({data:n,date:new Date,...i}):this.processMessage({data:n,...i})}processMessage(n,{transports:i=this.transports}={}){if(n.cmd==="errorHandler"){this.errorHandler.handle(n.error,{errorName:n.errorName,processType:"renderer",showDialog:!!n.showDialog});return}let a=n.level;this.allowUnknownLevel||(a=this.levels.includes(n.level)?n.level:"info");const u={date:new Date,logId:this.logId,...n,level:a,variables:{...this.variables,...n.variables}};for(const[f,c]of this.transportEntries(i))if(!(typeof c!="function"||c.level===!1)&&this.compareLevels(c.level,n.level))try{const h=this.hooks.reduce((l,d)=>l&&d(l,c,f),u);h&&c({...h,data:[...h.data]})}catch(h){this.processInternalErrorFn(h)}}processInternalErrorFn(n){}transportEntries(n=this.transports){return(Array.isArray(n)?n:Object.entries(n)).map(a=>{switch(typeof a){case"string":return this.transports[a]?[a,this.transports[a]]:null;case"function":return[a.name,a];default:return Array.isArray(a)?a:null}}).filter(Boolean)}};ie(o,"instances",{});let r=o;return Nr=r,Nr}var xr,no;function ac(){if(no)return xr;no=1;const t=console.error;class e{constructor({logFn:o=null}={}){ie(this,"logFn",null);ie(this,"onError",null);ie(this,"showDialog",!1);ie(this,"preventDefault",!0);this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.startCatching=this.startCatching.bind(this),this.logFn=o}handle(o,{logFn:s=this.logFn,errorName:n="",onError:i=this.onError,showDialog:a=this.showDialog}={}){try{(i==null?void 0:i({error:o,errorName:n,processType:"renderer"}))!==!1&&s({error:o,errorName:n,showDialog:a})}catch{t(o)}}setOptions({logFn:o,onError:s,preventDefault:n,showDialog:i}){typeof o=="function"&&(this.logFn=o),typeof s=="function"&&(this.onError=s),typeof n=="boolean"&&(this.preventDefault=n),typeof i=="boolean"&&(this.showDialog=i)}startCatching({onError:o,showDialog:s}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:o,showDialog:s}),window.addEventListener("error",n=>{var i;this.preventDefault&&((i=n.preventDefault)==null||i.call(n)),this.handleError(n.error||n)}),window.addEventListener("unhandledrejection",n=>{var i;this.preventDefault&&((i=n.preventDefault)==null||i.call(n)),this.handleRejection(n.reason||n)}))}handleError(o){this.handle(o,{errorName:"Unhandled"})}handleRejection(o){const s=o instanceof Error?o:new Error(JSON.stringify(o));this.handle(s,{errorName:"Unhandled rejection"})}}return xr=e,xr}var Pr,io;function lt(){if(io)return Pr;io=1,Pr={transform:t};function t({logger:e,message:r,transport:o,initialData:s=(r==null?void 0:r.data)||[],transforms:n=o==null?void 0:o.transforms}){return n.reduce((i,a)=>typeof a=="function"?a({data:i,logger:e,message:r,transport:o}):i,s)}return Pr}var Ir,oo;function uc(){if(oo)return Ir;oo=1;const{transform:t}=lt();Ir=r;const e={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};function r(s){return Object.assign(n,{format:"{h}:{i}:{s}.{ms}{scope} › {text}",transforms:[o],writeFn({message:{level:i,data:a}}){const u=e[i]||e.info;setTimeout(()=>u(...a))}});function n(i){n.writeFn({message:{...i,data:t({logger:s,message:i,transport:n})}})}}function o({data:s=[],logger:n={},message:i={},transport:a={}}){if(typeof a.format=="function")return a.format({data:s,level:(i==null?void 0:i.level)||"info",logger:n,message:i,transport:a});if(typeof a.format!="string")return s;s.unshift(a.format),typeof s[1]=="string"&&s[1].match(/%[1cdfiOos]/)&&(s=[`${s[0]}${s[1]}`,...s.slice(2)]);const u=i.date||new Date;return s[0]=s[0].replace(/\{(\w+)}/g,(f,c)=>{var h,l;switch(c){case"level":return i.level;case"logId":return i.logId;case"scope":{const d=i.scope||((h=n.scope)==null?void 0:h.defaultLabel);return d?` (${d})`:""}case"text":return"";case"y":return u.getFullYear().toString(10);case"m":return(u.getMonth()+1).toString(10).padStart(2,"0");case"d":return u.getDate().toString(10).padStart(2,"0");case"h":return u.getHours().toString(10).padStart(2,"0");case"i":return u.getMinutes().toString(10).padStart(2,"0");case"s":return u.getSeconds().toString(10).padStart(2,"0");case"ms":return u.getMilliseconds().toString(10).padStart(3,"0");case"iso":return u.toISOString();default:return((l=i.variables)==null?void 0:l[c])||f}}).trim(),s}return Ir}var Lr,so;function cc(){if(so)return Lr;so=1;const{transform:t}=lt();Lr=r;const e=new Set([Promise,WeakMap,WeakSet]);function r(n){return Object.assign(i,{depth:5,transforms:[s]});function i(a){if(!window.__electronLog){n.processMessage({data:["electron-log: logger isn't initialized in the main process"],level:"error"},{transports:["console"]});return}try{const u=t({initialData:a,logger:n,message:a,transport:i});__electronLog.sendToMain(u)}catch(u){n.transports.console({data:["electronLog.transports.ipc",u,"data:",a.data],level:"error"})}}}function o(n){return Object(n)!==n}function s({data:n,depth:i,seen:a=new WeakSet,transport:u={}}={}){const f=i||u.depth||5;return a.has(n)?"[Circular]":f<1?o(n)?n:Array.isArray(n)?"[Array]":`[${typeof n}]`:["function","symbol"].includes(typeof n)?n.toString():o(n)?n:e.has(n.constructor)?`[${n.constructor.name}]`:Array.isArray(n)?n.map(c=>s({data:c,depth:f-1,seen:a})):n instanceof Date?n.toISOString():n instanceof Error?n.stack:n instanceof Map?new Map(Array.from(n).map(([c,h])=>[s({data:c,depth:f-1,seen:a}),s({data:h,depth:f-1,seen:a})])):n instanceof Set?new Set(Array.from(n).map(c=>s({data:c,depth:f-1,seen:a}))):(a.add(n),Object.fromEntries(Object.entries(n).map(([c,h])=>[c,s({data:h,depth:f-1,seen:a})])))}return Lr}var ao;function lc(){return ao||(ao=1,function(t){const e=va(),r=ac(),o=uc(),s=cc();t.exports=n(),t.exports.Logger=e,t.exports.default=t.exports;function n(){const i=new e({allowUnknownLevel:!0,errorHandler:new r,initializeFn:()=>{},logId:"default",transportFactories:{console:o,ipc:s},variables:{processType:"renderer"}});return i.errorHandler.setOptions({logFn({error:a,errorName:u,showDialog:f}){i.transports.console({data:[u,a].filter(Boolean),level:"error"}),i.transports.ipc({cmd:"errorHandler",error:{cause:a==null?void 0:a.cause,code:a==null?void 0:a.code,name:a==null?void 0:a.name,message:a==null?void 0:a.message,stack:a==null?void 0:a.stack},errorName:u,logId:i.logId,showDialog:f})}}),typeof window=="object"&&window.addEventListener("message",a=>{const{cmd:u,logId:f,...c}=a.data||{},h=e.getInstance({logId:f});u==="message"&&h.processMessage(c,{transports:["console"]})}),new Proxy(i,{get(a,u){return typeof a[u]<"u"?a[u]:(...f)=>i.logData(f,{level:u})}})}}(Fr)),Fr.exports}var Mr,uo;function fc(){if(uo)return Mr;uo=1;const t=ce,e=Z;Mr={findAndReadPackageJson:r,tryReadJsonAt:o};function r(){return o(i())||o(n())||o(process.resourcesPath,"app.asar")||o(process.resourcesPath,"app")||o(process.cwd())||{name:void 0,version:void 0}}function o(...a){if(a[0])try{const u=e.join(...a),f=s("package.json",u);if(!f)return;const c=JSON.parse(t.readFileSync(f,"utf8")),h=(c==null?void 0:c.productName)||(c==null?void 0:c.name);return!h||h.toLowerCase()==="electron"?void 0:h?{name:h,version:c==null?void 0:c.version}:void 0}catch{return}}function s(a,u){let f=u;for(;;){const c=e.parse(f),h=c.root,l=c.dir;if(t.existsSync(e.join(f,a)))return e.resolve(e.join(f,a));if(f===h)return null;f=l}}function n(){const a=process.argv.filter(f=>f.indexOf("--user-data-dir=")===0);return a.length===0||typeof a[0]!="string"?null:a[0].replace("--user-data-dir=","")}function i(){var a;try{return(a=require.main)==null?void 0:a.filename}catch{return}}return Mr}var $r,co;function wa(){if(co)return $r;co=1;const t=sr,e=it,r=Z,o=fc();class s{constructor(){ie(this,"appName");ie(this,"appPackageJson");ie(this,"platform",process.platform)}getAppLogPath(i=this.getAppName()){return this.platform==="darwin"?r.join(this.getSystemPathHome(),"Library/Logs",i):r.join(this.getAppUserDataPath(i),"logs")}getAppName(){var a;const i=this.appName||((a=this.getAppPackageJson())==null?void 0:a.name);if(!i)throw new Error("electron-log can't determine the app name. It tried these methods:\n1. Use `electron.app.name`\n2. Use productName or name from the nearest package.json`\nYou can also set it through log.transports.file.setAppName()");return i}getAppPackageJson(){return typeof this.appPackageJson!="object"&&(this.appPackageJson=o.findAndReadPackageJson()),this.appPackageJson}getAppUserDataPath(i=this.getAppName()){return i?r.join(this.getSystemPathAppData(),i):void 0}getAppVersion(){var i;return(i=this.getAppPackageJson())==null?void 0:i.version}getElectronLogPath(){return this.getAppLogPath()}getMacOsVersion(){const i=Number(e.release().split(".")[0]);return i<=19?`10.${i-4}`:i-9}getOsVersion(){let i=e.type().replace("_"," "),a=e.release();return i==="Darwin"&&(i="macOS",a=this.getMacOsVersion()),`${i} ${a}`}getPathVariables(){const i=this.getAppName(),a=this.getAppVersion(),u=this;return{appData:this.getSystemPathAppData(),appName:i,appVersion:a,get electronDefaultDir(){return u.getElectronLogPath()},home:this.getSystemPathHome(),libraryDefaultDir:this.getAppLogPath(i),libraryTemplate:this.getAppLogPath("{appName}"),temp:this.getSystemPathTemp(),userData:this.getAppUserDataPath(i)}}getSystemPathAppData(){const i=this.getSystemPathHome();switch(this.platform){case"darwin":return r.join(i,"Library/Application Support");case"win32":return process.env.APPDATA||r.join(i,"AppData/Roaming");default:return process.env.XDG_CONFIG_HOME||r.join(i,".config")}}getSystemPathHome(){var i;return((i=e.homedir)==null?void 0:i.call(e))||process.env.HOME}getSystemPathTemp(){return e.tmpdir()}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:void 0,os:this.getOsVersion()}}isDev(){return process.env.NODE_ENV==="development"||process.env.ELECTRON_IS_DEV==="1"}isElectron(){return!!process.versions.electron}onAppEvent(i,a){}onAppReady(i){i()}onEveryWebContentsEvent(i,a){}onIpc(i,a){}onIpcInvoke(i,a){}openUrl(i,a=console.error){const f={darwin:"open",win32:"start",linux:"xdg-open"}[process.platform]||"xdg-open";t.exec(`${f} ${i}`,{},c=>{c&&a(c)})}setAppName(i){this.appName=i}setPlatform(i){this.platform=i}setPreloadFileForSessions({filePath:i,includeFutureSession:a=!0,getSessions:u=()=>[]}){}sendIpc(i,a){}showErrorBox(i,a){}}return $r=s,$r}var Rr,lo;function hc(){if(lo)return Rr;lo=1;const t=Z,e=wa();class r extends e{constructor({electron:n}={}){super();ie(this,"electron");this.electron=n}getAppName(){var i,a;let n;try{n=this.appName||((i=this.electron.app)==null?void 0:i.name)||((a=this.electron.app)==null?void 0:a.getName())}catch{}return n||super.getAppName()}getAppUserDataPath(n){return this.getPath("userData")||super.getAppUserDataPath(n)}getAppVersion(){var i;let n;try{n=(i=this.electron.app)==null?void 0:i.getVersion()}catch{}return n||super.getAppVersion()}getElectronLogPath(){return this.getPath("logs")||super.getElectronLogPath()}getPath(n){var i;try{return(i=this.electron.app)==null?void 0:i.getPath(n)}catch{return}}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:`Electron ${process.versions.electron}`,os:this.getOsVersion()}}getSystemPathAppData(){return this.getPath("appData")||super.getSystemPathAppData()}isDev(){var n;return((n=this.electron.app)==null?void 0:n.isPackaged)!==void 0?!this.electron.app.isPackaged:typeof process.execPath=="string"?t.basename(process.execPath).toLowerCase().startsWith("electron"):super.isDev()}onAppEvent(n,i){var a;return(a=this.electron.app)==null||a.on(n,i),()=>{var u;(u=this.electron.app)==null||u.off(n,i)}}onAppReady(n){var i,a,u;(i=this.electron.app)!=null&&i.isReady()?n():(a=this.electron.app)!=null&&a.once?(u=this.electron.app)==null||u.once("ready",n):n()}onEveryWebContentsEvent(n,i){var u,f,c;return(f=(u=this.electron.webContents)==null?void 0:u.getAllWebContents())==null||f.forEach(h=>{h.on(n,i)}),(c=this.electron.app)==null||c.on("web-contents-created",a),()=>{var h,l;(h=this.electron.webContents)==null||h.getAllWebContents().forEach(d=>{d.off(n,i)}),(l=this.electron.app)==null||l.off("web-contents-created",a)};function a(h,l){l.on(n,i)}}onIpc(n,i){var a;(a=this.electron.ipcMain)==null||a.on(n,i)}onIpcInvoke(n,i){var a,u;(u=(a=this.electron.ipcMain)==null?void 0:a.handle)==null||u.call(a,n,i)}openUrl(n,i=console.error){var a;(a=this.electron.shell)==null||a.openExternal(n).catch(i)}setPreloadFileForSessions({filePath:n,includeFutureSession:i=!0,getSessions:a=()=>{var u;return[(u=this.electron.session)==null?void 0:u.defaultSession]}}){for(const f of a().filter(Boolean))u(f);i&&this.onAppEvent("session-created",f=>{u(f)});function u(f){typeof f.registerPreloadScript=="function"?f.registerPreloadScript({filePath:n,id:"electron-log-preload",type:"frame"}):f.setPreloads([...f.getPreloads(),n])}}sendIpc(n,i){var a,u;(u=(a=this.electron.BrowserWindow)==null?void 0:a.getAllWindows())==null||u.forEach(f=>{var c,h;((c=f.webContents)==null?void 0:c.isDestroyed())===!1&&((h=f.webContents)==null?void 0:h.isCrashed())===!1&&f.webContents.send(n,i)})}showErrorBox(n,i){var a;(a=this.electron.dialog)==null||a.showErrorBox(n,i)}}return Rr=r,Rr}var kr,fo;function pc(){if(fo)return kr;fo=1;const t=ce,e=it,r=Z,o=ga();kr={initialize({externalApi:i,getSessions:a,includeFutureSession:u,logger:f,preload:c=!0,spyRendererConsole:h=!1}){i.onAppReady(()=>{try{c&&s({externalApi:i,getSessions:a,includeFutureSession:u,preloadOption:c}),h&&n({externalApi:i,logger:f})}catch(l){f.warn(l)}})}};function s({externalApi:i,getSessions:a,includeFutureSession:u,preloadOption:f}){let c=typeof f=="string"?f:void 0;try{c=r.resolve(__dirname,"../renderer/electron-log-preload.js")}catch{}if(!c||!t.existsSync(c)){c=r.join(i.getAppUserDataPath()||e.tmpdir(),"electron-log-preload.js");const h=`
      try {
        (${o.toString()})(require('electron'));
      } catch(e) {
        console.error(e);
      }
    `;t.writeFileSync(c,h,"utf8")}i.setPreloadFileForSessions({filePath:c,includeFutureSession:u,getSessions:a})}function n({externalApi:i,logger:a}){const u=["debug","info","warn","error"];i.onEveryWebContentsEvent("console-message",(f,c,h)=>{a.processMessage({data:[h],level:u[c],variables:{processType:"renderer"}})})}return kr}var jr,ho;function dc(){if(ho)return jr;ho=1;class t{constructor({externalApi:o,logFn:s=void 0,onError:n=void 0,showDialog:i=void 0}={}){ie(this,"externalApi");ie(this,"isActive",!1);ie(this,"logFn");ie(this,"onError");ie(this,"showDialog",!0);this.createIssue=this.createIssue.bind(this),this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.setOptions({externalApi:o,logFn:s,onError:n,showDialog:i}),this.startCatching=this.startCatching.bind(this),this.stopCatching=this.stopCatching.bind(this)}handle(o,{logFn:s=this.logFn,onError:n=this.onError,processType:i="browser",showDialog:a=this.showDialog,errorName:u=""}={}){var f;o=e(o);try{if(typeof n=="function"){const c=((f=this.externalApi)==null?void 0:f.getVersions())||{},h=this.createIssue;if(n({createIssue:h,error:o,errorName:u,processType:i,versions:c})===!1)return}u?s(u,o):s(o),a&&!u.includes("rejection")&&this.externalApi&&this.externalApi.showErrorBox(`A JavaScript error occurred in the ${i} process`,o.stack)}catch{console.error(o)}}setOptions({externalApi:o,logFn:s,onError:n,showDialog:i}){typeof o=="object"&&(this.externalApi=o),typeof s=="function"&&(this.logFn=s),typeof n=="function"&&(this.onError=n),typeof i=="boolean"&&(this.showDialog=i)}startCatching({onError:o,showDialog:s}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:o,showDialog:s}),process.on("uncaughtException",this.handleError),process.on("unhandledRejection",this.handleRejection))}stopCatching(){this.isActive=!1,process.removeListener("uncaughtException",this.handleError),process.removeListener("unhandledRejection",this.handleRejection)}createIssue(o,s){var n;(n=this.externalApi)==null||n.openUrl(`${o}?${new URLSearchParams(s).toString()}`)}handleError(o){this.handle(o,{errorName:"Unhandled"})}handleRejection(o){const s=o instanceof Error?o:new Error(JSON.stringify(o));this.handle(s,{errorName:"Unhandled rejection"})}}function e(r){if(r instanceof Error)return r;if(r&&typeof r=="object"){if(r.message)return Object.assign(new Error(r.message),r);try{return new Error(JSON.stringify(r))}catch(o){return new Error(`Couldn't normalize error ${String(r)}: ${o}`)}}return new Error(`Can't normalize error ${String(r)}`)}return jr=t,jr}var qr,po;function mc(){if(po)return qr;po=1;class t{constructor(r={}){ie(this,"disposers",[]);ie(this,"format","{eventSource}#{eventName}:");ie(this,"formatters",{app:{"certificate-error":({args:r})=>this.arrayToObject(r.slice(1,4),["url","error","certificate"]),"child-process-gone":({args:r})=>r.length===1?r[0]:r,"render-process-gone":({args:[r,o]})=>o&&typeof o=="object"?{...o,...this.getWebContentsDetails(r)}:[]},webContents:{"console-message":({args:[r,o,s,n]})=>{if(!(r<3))return{message:o,source:`${n}:${s}`}},"did-fail-load":({args:r})=>this.arrayToObject(r,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"did-fail-provisional-load":({args:r})=>this.arrayToObject(r,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"plugin-crashed":({args:r})=>this.arrayToObject(r,["name","version"]),"preload-error":({args:r})=>this.arrayToObject(r,["preloadPath","error"])}});ie(this,"events",{app:{"certificate-error":!0,"child-process-gone":!0,"render-process-gone":!0},webContents:{"did-fail-load":!0,"did-fail-provisional-load":!0,"plugin-crashed":!0,"preload-error":!0,unresponsive:!0}});ie(this,"externalApi");ie(this,"level","error");ie(this,"scope","");this.setOptions(r)}setOptions({events:r,externalApi:o,level:s,logger:n,format:i,formatters:a,scope:u}){typeof r=="object"&&(this.events=r),typeof o=="object"&&(this.externalApi=o),typeof s=="string"&&(this.level=s),typeof n=="object"&&(this.logger=n),(typeof i=="string"||typeof i=="function")&&(this.format=i),typeof a=="object"&&(this.formatters=a),typeof u=="string"&&(this.scope=u)}startLogging(r={}){this.setOptions(r),this.disposeListeners();for(const o of this.getEventNames(this.events.app))this.disposers.push(this.externalApi.onAppEvent(o,(...s)=>{this.handleEvent({eventSource:"app",eventName:o,handlerArgs:s})}));for(const o of this.getEventNames(this.events.webContents))this.disposers.push(this.externalApi.onEveryWebContentsEvent(o,(...s)=>{this.handleEvent({eventSource:"webContents",eventName:o,handlerArgs:s})}))}stopLogging(){this.disposeListeners()}arrayToObject(r,o){const s={};return o.forEach((n,i)=>{s[n]=r[i]}),r.length>o.length&&(s.unknownArgs=r.slice(o.length)),s}disposeListeners(){this.disposers.forEach(r=>r()),this.disposers=[]}formatEventLog({eventName:r,eventSource:o,handlerArgs:s}){var h;const[n,...i]=s;if(typeof this.format=="function")return this.format({args:i,event:n,eventName:r,eventSource:o});const a=(h=this.formatters[o])==null?void 0:h[r];let u=i;if(typeof a=="function"&&(u=a({args:i,event:n,eventName:r,eventSource:o})),!u)return;const f={};return Array.isArray(u)?f.args=u:typeof u=="object"&&Object.assign(f,u),o==="webContents"&&Object.assign(f,this.getWebContentsDetails(n==null?void 0:n.sender)),[this.format.replace("{eventSource}",o==="app"?"App":"WebContents").replace("{eventName}",r),f]}getEventNames(r){return!r||typeof r!="object"?[]:Object.entries(r).filter(([o,s])=>s).map(([o])=>o)}getWebContentsDetails(r){if(!(r!=null&&r.loadURL))return{};try{return{webContents:{id:r.id,url:r.getURL()}}}catch{return{}}}handleEvent({eventName:r,eventSource:o,handlerArgs:s}){var i;const n=this.formatEventLog({eventName:r,eventSource:o,handlerArgs:s});if(n){const a=this.scope?this.logger.scope(this.scope):this.logger;(i=a==null?void 0:a[this.level])==null||i.call(a,...n)}}}return qr=t,qr}var Br,mo;function Ea(){if(mo)return Br;mo=1;const{transform:t}=lt();Br={concatFirstStringElements:e,formatScope:o,formatText:n,formatVariables:s,timeZoneFromOffset:r,format({message:i,logger:a,transport:u,data:f=i==null?void 0:i.data}){switch(typeof u.format){case"string":return t({message:i,logger:a,transforms:[s,o,n],transport:u,initialData:[u.format,...f]});case"function":return u.format({data:f,level:(i==null?void 0:i.level)||"info",logger:a,message:i,transport:u});default:return f}}};function e({data:i}){return typeof i[0]!="string"||typeof i[1]!="string"||i[0].match(/%[1cdfiOos]/)?i:[`${i[0]} ${i[1]}`,...i.slice(2)]}function r(i){const a=Math.abs(i),u=i>0?"-":"+",f=Math.floor(a/60).toString().padStart(2,"0"),c=(a%60).toString().padStart(2,"0");return`${u}${f}:${c}`}function o({data:i,logger:a,message:u}){const{defaultLabel:f,labelLength:c}=(a==null?void 0:a.scope)||{},h=i[0];let l=u.scope;l||(l=f);let d;return l===""?d=c>0?"".padEnd(c+3):"":typeof l=="string"?d=` (${l})`.padEnd(c+3):d="",i[0]=h.replace("{scope}",d),i}function s({data:i,message:a}){let u=i[0];if(typeof u!="string")return i;u=u.replace("{level}]",`${a.level}]`.padEnd(6," "));const f=a.date||new Date;return i[0]=u.replace(/\{(\w+)}/g,(c,h)=>{var l;switch(h){case"level":return a.level||"info";case"logId":return a.logId;case"y":return f.getFullYear().toString(10);case"m":return(f.getMonth()+1).toString(10).padStart(2,"0");case"d":return f.getDate().toString(10).padStart(2,"0");case"h":return f.getHours().toString(10).padStart(2,"0");case"i":return f.getMinutes().toString(10).padStart(2,"0");case"s":return f.getSeconds().toString(10).padStart(2,"0");case"ms":return f.getMilliseconds().toString(10).padStart(3,"0");case"z":return r(f.getTimezoneOffset());case"iso":return f.toISOString();default:return((l=a.variables)==null?void 0:l[h])||c}}).trim(),i}function n({data:i}){const a=i[0];if(typeof a!="string")return i;if(a.lastIndexOf("{text}")===a.length-6)return i[0]=a.replace(/\s?{text}/,""),i[0]===""&&i.shift(),i;const f=a.split("{text}");let c=[];return f[0]!==""&&c.push(f[0]),c=c.concat(i.slice(1)),f[1]!==""&&c.push(f[1]),c}return Br}var Ur={exports:{}},yo;function lr(){return yo||(yo=1,function(t){const e=$t;t.exports={serialize:o,maxDepth({data:s,transport:n,depth:i=(n==null?void 0:n.depth)??6}){if(!s)return s;if(i<1)return Array.isArray(s)?"[array]":typeof s=="object"&&s?"[object]":s;if(Array.isArray(s))return s.map(u=>t.exports.maxDepth({data:u,depth:i-1}));if(typeof s!="object"||s&&typeof s.toISOString=="function")return s;if(s===null)return null;if(s instanceof Error)return s;const a={};for(const u in s)Object.prototype.hasOwnProperty.call(s,u)&&(a[u]=t.exports.maxDepth({data:s[u],depth:i-1}));return a},toJSON({data:s}){return JSON.parse(JSON.stringify(s,r()))},toString({data:s,transport:n}){const i=(n==null?void 0:n.inspectOptions)||{},a=s.map(u=>{if(u!==void 0)try{const f=JSON.stringify(u,r(),"  ");return f===void 0?void 0:JSON.parse(f)}catch{return u}});return e.formatWithOptions(i,...a)}};function r(s={}){const n=new WeakSet;return function(i,a){if(typeof a=="object"&&a!==null){if(n.has(a))return;n.add(a)}return o(i,a,s)}}function o(s,n,i={}){const a=(i==null?void 0:i.serializeMapAndSet)!==!1;return n instanceof Error?n.stack:n&&(typeof n=="function"?`[function] ${n.toString()}`:n instanceof Date?n.toISOString():a&&n instanceof Map&&Object.fromEntries?Object.fromEntries(n):a&&n instanceof Set&&Array.from?Array.from(n):n)}}(Ur)),Ur.exports}var Xr,go;function Oi(){if(go)return Xr;go=1,Xr={transformStyles:o,applyAnsiStyles({data:s}){return o(s,e,r)},removeStyles({data:s}){return o(s,()=>"")}};const t={unset:"\x1B[0m",black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"};function e(s){const n=s.replace(/color:\s*(\w+).*/,"$1").toLowerCase();return t[n]||""}function r(s){return s+t.unset}function o(s,n,i){const a={};return s.reduce((u,f,c,h)=>{if(a[c])return u;if(typeof f=="string"){let l=c,d=!1;f=f.replace(/%[1cdfiOos]/g,g=>{if(l+=1,g!=="%c")return g;const w=h[l];return typeof w=="string"?(a[l]=!0,d=!0,n(w,f)):g}),d&&i&&(f=i(f))}return u.push(f),u},[])}return Xr}var Vr,vo;function yc(){if(vo)return Vr;vo=1;const{concatFirstStringElements:t,format:e}=Ea(),{maxDepth:r,toJSON:o}=lr(),{applyAnsiStyles:s,removeStyles:n}=Oi(),{transform:i}=lt(),a={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};Vr=c;const f=`%c{h}:{i}:{s}.{ms}{scope}%c ${process.platform==="win32"?">":"›"} {text}`;Object.assign(c,{DEFAULT_FORMAT:f});function c(w){return Object.assign(E,{format:f,level:"silly",transforms:[h,e,d,t,r,o],useStyles:process.env.FORCE_STYLES,writeFn({message:_}){(a[_.level]||a.info)(..._.data)}});function E(_){const v=i({logger:w,message:_,transport:E});E.writeFn({message:{..._,data:v}})}}function h({data:w,message:E,transport:_}){return typeof _.format!="string"||!_.format.includes("%c")?w:[`color:${g(E.level)}`,"color:unset",...w]}function l(w,E){if(typeof w=="boolean")return w;const v=E==="error"||E==="warn"?process.stderr:process.stdout;return v&&v.isTTY}function d(w){const{message:E,transport:_}=w;return(l(_.useStyles,E.level)?s:n)(w)}function g(w){const E={error:"red",warn:"yellow",info:"cyan",default:"unset"};return E[w]||E.default}return Vr}var zr,wo;function ba(){if(wo)return zr;wo=1;const t=ct,e=ce,r=it;class o extends t{constructor({path:a,writeOptions:u={encoding:"utf8",flag:"a",mode:438},writeAsync:f=!1}){super();ie(this,"asyncWriteQueue",[]);ie(this,"bytesWritten",0);ie(this,"hasActiveAsyncWriting",!1);ie(this,"path",null);ie(this,"initialSize");ie(this,"writeOptions",null);ie(this,"writeAsync",!1);this.path=a,this.writeOptions=u,this.writeAsync=f}get size(){return this.getSize()}clear(){try{return e.writeFileSync(this.path,"",{mode:this.writeOptions.mode,flag:"w"}),this.reset(),!0}catch(a){return a.code==="ENOENT"?!0:(this.emit("error",a,this),!1)}}crop(a){try{const u=s(this.path,a||4096);this.clear(),this.writeLine(`[log cropped]${r.EOL}${u}`)}catch(u){this.emit("error",new Error(`Couldn't crop file ${this.path}. ${u.message}`),this)}}getSize(){if(this.initialSize===void 0)try{const a=e.statSync(this.path);this.initialSize=a.size}catch{this.initialSize=0}return this.initialSize+this.bytesWritten}increaseBytesWrittenCounter(a){this.bytesWritten+=Buffer.byteLength(a,this.writeOptions.encoding)}isNull(){return!1}nextAsyncWrite(){const a=this;if(this.hasActiveAsyncWriting||this.asyncWriteQueue.length===0)return;const u=this.asyncWriteQueue.join("");this.asyncWriteQueue=[],this.hasActiveAsyncWriting=!0,e.writeFile(this.path,u,this.writeOptions,f=>{a.hasActiveAsyncWriting=!1,f?a.emit("error",new Error(`Couldn't write to ${a.path}. ${f.message}`),this):a.increaseBytesWrittenCounter(u),a.nextAsyncWrite()})}reset(){this.initialSize=void 0,this.bytesWritten=0}toString(){return this.path}writeLine(a){if(a+=r.EOL,this.writeAsync){this.asyncWriteQueue.push(a),this.nextAsyncWrite();return}try{e.writeFileSync(this.path,a,this.writeOptions),this.increaseBytesWrittenCounter(a)}catch(u){this.emit("error",new Error(`Couldn't write to ${this.path}. ${u.message}`),this)}}}zr=o;function s(n,i){const a=Buffer.alloc(i),u=e.statSync(n),f=Math.min(u.size,i),c=Math.max(0,u.size-i),h=e.openSync(n,"r"),l=e.readSync(h,a,0,f,c);return e.closeSync(h),a.toString("utf8",0,l)}return zr}var Wr,Eo;function gc(){if(Eo)return Wr;Eo=1;const t=ba();class e extends t{clear(){}crop(){}getSize(){return 0}isNull(){return!0}writeLine(){}}return Wr=e,Wr}var Hr,bo;function vc(){if(bo)return Hr;bo=1;const t=ct,e=ce,r=Z,o=ba(),s=gc();class n extends t{constructor(){super();ie(this,"store",{});this.emitError=this.emitError.bind(this)}provide({filePath:u,writeOptions:f={},writeAsync:c=!1}){let h;try{if(u=r.resolve(u),this.store[u])return this.store[u];h=this.createFile({filePath:u,writeOptions:f,writeAsync:c})}catch(l){h=new s({path:u}),this.emitError(l,h)}return h.on("error",this.emitError),this.store[u]=h,h}createFile({filePath:u,writeOptions:f,writeAsync:c}){return this.testFileWriting({filePath:u,writeOptions:f}),new o({path:u,writeOptions:f,writeAsync:c})}emitError(u,f){this.emit("error",u,f)}testFileWriting({filePath:u,writeOptions:f}){e.mkdirSync(r.dirname(u),{recursive:!0}),e.writeFileSync(u,"",{flag:"a",mode:f.mode})}}return Hr=n,Hr}var Gr,So;function wc(){if(So)return Gr;So=1;const t=ce,e=it,r=Z,o=vc(),{transform:s}=lt(),{removeStyles:n}=Oi(),{format:i,concatFirstStringElements:a}=Ea(),{toString:u}=lr();Gr=c;const f=new o;function c(l,{registry:d=f,externalApi:g}={}){let w;return d.listenerCount("error")<1&&d.on("error",(F,S)=>{v(`Can't write to ${S}`,F)}),Object.assign(E,{fileName:h(l.variables.processType),format:"[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}]{scope} {text}",getFile:y,inspectOptions:{depth:5},level:"silly",maxSize:1024**2,readAllLogs:C,sync:!0,transforms:[n,i,a,u],writeOptions:{flag:"a",mode:438,encoding:"utf8"},archiveLogFn(F){const S=F.toString(),D=r.parse(S);try{t.renameSync(S,r.join(D.dir,`${D.name}.old${D.ext}`))}catch(T){v("Could not rotate log",T);const p=Math.round(E.maxSize/4);F.crop(Math.min(p,256*1024))}},resolvePathFn(F){return r.join(F.libraryDefaultDir,F.fileName)},setAppName(F){l.dependencies.externalApi.setAppName(F)}});function E(F){const S=y(F);E.maxSize>0&&S.size>E.maxSize&&(E.archiveLogFn(S),S.reset());const T=s({logger:l,message:F,transport:E});S.writeLine(T)}function _(){w||(w=Object.create(Object.prototype,{...Object.getOwnPropertyDescriptors(g.getPathVariables()),fileName:{get(){return E.fileName},enumerable:!0}}),typeof E.archiveLog=="function"&&(E.archiveLogFn=E.archiveLog,v("archiveLog is deprecated. Use archiveLogFn instead")),typeof E.resolvePath=="function"&&(E.resolvePathFn=E.resolvePath,v("resolvePath is deprecated. Use resolvePathFn instead")))}function v(F,S=null,D="error"){const T=[`electron-log.transports.file: ${F}`];S&&T.push(S),l.transports.console({data:T,date:new Date,level:D})}function y(F){_();const S=E.resolvePathFn(w,F);return d.provide({filePath:S,writeAsync:!E.sync,writeOptions:E.writeOptions})}function C({fileFilter:F=S=>S.endsWith(".log")}={}){_();const S=r.dirname(E.resolvePathFn(w));return t.existsSync(S)?t.readdirSync(S).map(D=>r.join(S,D)).filter(F).map(D=>{try{return{path:D,lines:t.readFileSync(D,"utf8").split(e.EOL)}}catch{return null}}).filter(Boolean):[]}}function h(l=process.type){switch(l){case"renderer":return"renderer.log";case"worker":return"worker.log";default:return"main.log"}}return Gr}var Yr,Oo;function Ec(){if(Oo)return Yr;Oo=1;const{maxDepth:t,toJSON:e}=lr(),{transform:r}=lt();Yr=o;function o(s,{externalApi:n}){return Object.assign(i,{depth:3,eventId:"__ELECTRON_LOG_IPC__",level:s.isDev?"silly":!1,transforms:[e,t]}),n!=null&&n.isElectron()?i:void 0;function i(a){var u;((u=a==null?void 0:a.variables)==null?void 0:u.processType)!=="renderer"&&(n==null||n.sendIpc(i.eventId,{...a,data:r({logger:s,message:a,transport:i})}))}}return Yr}var Jr,To;function bc(){if(To)return Jr;To=1;const t=ar,e=ur,{transform:r}=lt(),{removeStyles:o}=Oi(),{toJSON:s,maxDepth:n}=lr();Jr=i;function i(a){return Object.assign(u,{client:{name:"electron-application"},depth:6,level:!1,requestOptions:{},transforms:[o,s,n],makeBodyFn({message:f}){return JSON.stringify({client:u.client,data:f.data,date:f.date.getTime(),level:f.level,scope:f.scope,variables:f.variables})},processErrorFn({error:f}){a.processMessage({data:[`electron-log: can't POST ${u.url}`,f],level:"warn"},{transports:["console","file"]})},sendRequestFn({serverUrl:f,requestOptions:c,body:h}){const d=(f.startsWith("https:")?e:t).request(f,{method:"POST",...c,headers:{"Content-Type":"application/json","Content-Length":h.length,...c.headers}});return d.write(h),d.end(),d}});function u(f){if(!u.url)return;const c=u.makeBodyFn({logger:a,message:{...f,data:r({logger:a,message:f,transport:u})},transport:u}),h=u.sendRequestFn({serverUrl:u.url,requestOptions:u.requestOptions,body:Buffer.from(c,"utf8")});h.on("error",l=>u.processErrorFn({error:l,logger:a,message:f,request:h,transport:u}))}}return Jr}var Kr,Co;function Sa(){if(Co)return Kr;Co=1;const t=va(),e=dc(),r=mc(),o=yc(),s=wc(),n=Ec(),i=bc();Kr=a;function a({dependencies:u,initializeFn:f}){var h;const c=new t({dependencies:u,errorHandler:new e,eventLogger:new r,initializeFn:f,isDev:(h=u.externalApi)==null?void 0:h.isDev(),logId:"default",transportFactories:{console:o,file:s,ipc:n,remote:i},variables:{processType:"main"}});return c.default=c,c.Logger=t,c.processInternalErrorFn=l=>{c.transports.console.writeFn({message:{data:["Unhandled electron-log error",l],level:"error"}})},c}return Kr}var Qr,Do;function Sc(){if(Do)return Qr;Do=1;const t=se,e=hc(),{initialize:r}=pc(),o=Sa(),s=new e({electron:t}),n=o({dependencies:{externalApi:s},initializeFn:r});Qr=n,s.onIpc("__ELECTRON_LOG__",(a,u)=>{u.scope&&n.Logger.getInstance(u).scope(u.scope);const f=new Date(u.date);i({...u,date:f.getTime()?f:new Date})}),s.onIpcInvoke("__ELECTRON_LOG__",(a,{cmd:u="",logId:f})=>{switch(u){case"getOptions":return{levels:n.Logger.getInstance({logId:f}).levels,logId:f};default:return i({data:[`Unknown cmd '${u}'`],level:"error"}),{}}});function i(a){var u;(u=n.Logger.getInstance(a))==null||u.processMessage(a)}return Qr}var Zr,Fo;function Oc(){if(Fo)return Zr;Fo=1;const t=wa(),e=Sa(),r=new t;return Zr=e({dependencies:{externalApi:r}}),Zr}const Tc=typeof process>"u"||process.type==="renderer"||process.type==="worker",Cc=typeof process=="object"&&process.type==="browser";Tc?(ga(),er.exports=lc()):Cc?er.exports=Sc():er.exports=Oc();var Dc=er.exports;const oe=vt(Dc);var qt,Fc=new Uint8Array(16);function Oa(){if(!qt&&(qt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!qt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return qt(Fc)}const Ac=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function fr(t){return typeof t=="string"&&Ac.test(t)}var Se=[];for(var en=0;en<256;++en)Se.push((en+256).toString(16).substr(1));function hr(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=(Se[t[e+0]]+Se[t[e+1]]+Se[t[e+2]]+Se[t[e+3]]+"-"+Se[t[e+4]]+Se[t[e+5]]+"-"+Se[t[e+6]]+Se[t[e+7]]+"-"+Se[t[e+8]]+Se[t[e+9]]+"-"+Se[t[e+10]]+Se[t[e+11]]+Se[t[e+12]]+Se[t[e+13]]+Se[t[e+14]]+Se[t[e+15]]).toLowerCase();if(!fr(r))throw TypeError("Stringified UUID is invalid");return r}var Ao,tn,rn=0,nn=0;function _c(t,e,r){var o=e&&r||0,s=e||new Array(16);t=t||{};var n=t.node||Ao,i=t.clockseq!==void 0?t.clockseq:tn;if(n==null||i==null){var a=t.random||(t.rng||Oa)();n==null&&(n=Ao=[a[0]|1,a[1],a[2],a[3],a[4],a[5]]),i==null&&(i=tn=(a[6]<<8|a[7])&16383)}var u=t.msecs!==void 0?t.msecs:Date.now(),f=t.nsecs!==void 0?t.nsecs:nn+1,c=u-rn+(f-nn)/1e4;if(c<0&&t.clockseq===void 0&&(i=i+1&16383),(c<0||u>rn)&&t.nsecs===void 0&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");rn=u,nn=f,tn=i,u+=122192928e5;var h=((u&268435455)*1e4+f)%4294967296;s[o++]=h>>>24&255,s[o++]=h>>>16&255,s[o++]=h>>>8&255,s[o++]=h&255;var l=u/4294967296*1e4&268435455;s[o++]=l>>>8&255,s[o++]=l&255,s[o++]=l>>>24&15|16,s[o++]=l>>>16&255,s[o++]=i>>>8|128,s[o++]=i&255;for(var d=0;d<6;++d)s[o+d]=n[d];return e||hr(s)}function Ta(t){if(!fr(t))throw TypeError("Invalid UUID");var e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}function Nc(t){t=unescape(encodeURIComponent(t));for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}var xc="6ba7b810-9dad-11d1-80b4-00c04fd430c8",Pc="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function Ca(t,e,r){function o(s,n,i,a){if(typeof s=="string"&&(s=Nc(s)),typeof n=="string"&&(n=Ta(n)),n.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+s.length);if(u.set(n),u.set(s,n.length),u=r(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,i){a=a||0;for(var f=0;f<16;++f)i[a+f]=u[f];return i}return hr(u)}try{o.name=t}catch{}return o.DNS=xc,o.URL=Pc,o}function Ic(t){if(typeof t=="string"){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return Lc(Mc($c(t),t.length*8))}function Lc(t){for(var e=[],r=t.length*32,o="0123456789abcdef",s=0;s<r;s+=8){var n=t[s>>5]>>>s%32&255,i=parseInt(o.charAt(n>>>4&15)+o.charAt(n&15),16);e.push(i)}return e}function Da(t){return(t+64>>>9<<4)+14+1}function Mc(t,e){t[e>>5]|=128<<e%32,t[Da(e)-1]=e;for(var r=1732584193,o=-271733879,s=-1732584194,n=271733878,i=0;i<t.length;i+=16){var a=r,u=o,f=s,c=n;r=Ce(r,o,s,n,t[i],7,-680876936),n=Ce(n,r,o,s,t[i+1],12,-389564586),s=Ce(s,n,r,o,t[i+2],17,606105819),o=Ce(o,s,n,r,t[i+3],22,-1044525330),r=Ce(r,o,s,n,t[i+4],7,-176418897),n=Ce(n,r,o,s,t[i+5],12,1200080426),s=Ce(s,n,r,o,t[i+6],17,-1473231341),o=Ce(o,s,n,r,t[i+7],22,-45705983),r=Ce(r,o,s,n,t[i+8],7,1770035416),n=Ce(n,r,o,s,t[i+9],12,-1958414417),s=Ce(s,n,r,o,t[i+10],17,-42063),o=Ce(o,s,n,r,t[i+11],22,-1990404162),r=Ce(r,o,s,n,t[i+12],7,1804603682),n=Ce(n,r,o,s,t[i+13],12,-40341101),s=Ce(s,n,r,o,t[i+14],17,-1502002290),o=Ce(o,s,n,r,t[i+15],22,1236535329),r=De(r,o,s,n,t[i+1],5,-165796510),n=De(n,r,o,s,t[i+6],9,-1069501632),s=De(s,n,r,o,t[i+11],14,643717713),o=De(o,s,n,r,t[i],20,-373897302),r=De(r,o,s,n,t[i+5],5,-701558691),n=De(n,r,o,s,t[i+10],9,38016083),s=De(s,n,r,o,t[i+15],14,-660478335),o=De(o,s,n,r,t[i+4],20,-405537848),r=De(r,o,s,n,t[i+9],5,568446438),n=De(n,r,o,s,t[i+14],9,-1019803690),s=De(s,n,r,o,t[i+3],14,-187363961),o=De(o,s,n,r,t[i+8],20,1163531501),r=De(r,o,s,n,t[i+13],5,-1444681467),n=De(n,r,o,s,t[i+2],9,-51403784),s=De(s,n,r,o,t[i+7],14,1735328473),o=De(o,s,n,r,t[i+12],20,-1926607734),r=Fe(r,o,s,n,t[i+5],4,-378558),n=Fe(n,r,o,s,t[i+8],11,-2022574463),s=Fe(s,n,r,o,t[i+11],16,1839030562),o=Fe(o,s,n,r,t[i+14],23,-35309556),r=Fe(r,o,s,n,t[i+1],4,-1530992060),n=Fe(n,r,o,s,t[i+4],11,1272893353),s=Fe(s,n,r,o,t[i+7],16,-155497632),o=Fe(o,s,n,r,t[i+10],23,-1094730640),r=Fe(r,o,s,n,t[i+13],4,681279174),n=Fe(n,r,o,s,t[i],11,-358537222),s=Fe(s,n,r,o,t[i+3],16,-722521979),o=Fe(o,s,n,r,t[i+6],23,76029189),r=Fe(r,o,s,n,t[i+9],4,-640364487),n=Fe(n,r,o,s,t[i+12],11,-421815835),s=Fe(s,n,r,o,t[i+15],16,530742520),o=Fe(o,s,n,r,t[i+2],23,-995338651),r=Ae(r,o,s,n,t[i],6,-198630844),n=Ae(n,r,o,s,t[i+7],10,1126891415),s=Ae(s,n,r,o,t[i+14],15,-1416354905),o=Ae(o,s,n,r,t[i+5],21,-57434055),r=Ae(r,o,s,n,t[i+12],6,1700485571),n=Ae(n,r,o,s,t[i+3],10,-1894986606),s=Ae(s,n,r,o,t[i+10],15,-1051523),o=Ae(o,s,n,r,t[i+1],21,-2054922799),r=Ae(r,o,s,n,t[i+8],6,1873313359),n=Ae(n,r,o,s,t[i+15],10,-30611744),s=Ae(s,n,r,o,t[i+6],15,-1560198380),o=Ae(o,s,n,r,t[i+13],21,1309151649),r=Ae(r,o,s,n,t[i+4],6,-145523070),n=Ae(n,r,o,s,t[i+11],10,-1120210379),s=Ae(s,n,r,o,t[i+2],15,718787259),o=Ae(o,s,n,r,t[i+9],21,-343485551),r=tt(r,a),o=tt(o,u),s=tt(s,f),n=tt(n,c)}return[r,o,s,n]}function $c(t){if(t.length===0)return[];for(var e=t.length*8,r=new Uint32Array(Da(e)),o=0;o<e;o+=8)r[o>>5]|=(t[o/8]&255)<<o%32;return r}function tt(t,e){var r=(t&65535)+(e&65535),o=(t>>16)+(e>>16)+(r>>16);return o<<16|r&65535}function Rc(t,e){return t<<e|t>>>32-e}function pr(t,e,r,o,s,n){return tt(Rc(tt(tt(e,t),tt(o,n)),s),r)}function Ce(t,e,r,o,s,n,i){return pr(e&r|~e&o,t,e,s,n,i)}function De(t,e,r,o,s,n,i){return pr(e&o|r&~o,t,e,s,n,i)}function Fe(t,e,r,o,s,n,i){return pr(e^r^o,t,e,s,n,i)}function Ae(t,e,r,o,s,n,i){return pr(r^(e|~o),t,e,s,n,i)}var kc=Ca("v3",48,Ic);const jc=kc;function qc(t,e,r){t=t||{};var o=t.random||(t.rng||Oa)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,e){r=r||0;for(var s=0;s<16;++s)e[r+s]=o[s];return e}return hr(o)}function Bc(t,e,r,o){switch(t){case 0:return e&r^~e&o;case 1:return e^r^o;case 2:return e&r^e&o^r&o;case 3:return e^r^o}}function on(t,e){return t<<e|t>>>32-e}function Uc(t){var e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var o=unescape(encodeURIComponent(t));t=[];for(var s=0;s<o.length;++s)t.push(o.charCodeAt(s))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var n=t.length/4+2,i=Math.ceil(n/16),a=new Array(i),u=0;u<i;++u){for(var f=new Uint32Array(16),c=0;c<16;++c)f[c]=t[u*64+c*4]<<24|t[u*64+c*4+1]<<16|t[u*64+c*4+2]<<8|t[u*64+c*4+3];a[u]=f}a[i-1][14]=(t.length-1)*8/Math.pow(2,32),a[i-1][14]=Math.floor(a[i-1][14]),a[i-1][15]=(t.length-1)*8&4294967295;for(var h=0;h<i;++h){for(var l=new Uint32Array(80),d=0;d<16;++d)l[d]=a[h][d];for(var g=16;g<80;++g)l[g]=on(l[g-3]^l[g-8]^l[g-14]^l[g-16],1);for(var w=r[0],E=r[1],_=r[2],v=r[3],y=r[4],C=0;C<80;++C){var F=Math.floor(C/20),S=on(w,5)+Bc(F,E,_,v)+y+e[F]+l[C]>>>0;y=v,v=_,_=on(E,30)>>>0,E=w,w=S}r[0]=r[0]+w>>>0,r[1]=r[1]+E>>>0,r[2]=r[2]+_>>>0,r[3]=r[3]+v>>>0,r[4]=r[4]+y>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Xc=Ca("v5",80,Uc);const Vc=Xc,zc="00000000-0000-0000-0000-000000000000";function Wc(t){if(!fr(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)}const Hc=Object.freeze(Object.defineProperty({__proto__:null,NIL:zc,parse:Ta,stringify:hr,v1:_c,v3:jc,v4:qc,v5:Vc,validate:fr,version:Wc},Symbol.toStringTag,{value:"Module"})),Gc=ic(Hc),Yc=Gu,Bt=cr,{v1:tm,v4:Jc}=Gc;let Kc=class{constructor(e){Bt(e,'must pass "config"'),Bt(e.url,'must pass "url"'),Bt(e.appkey,'must pass "appkey"'),Bt(e.token,"must first get token from cache or getToken interface"),this._config=e}start(e,r){if(typeof e!="function")throw new Error("expect function onmessage");if(typeof r!="function")throw new Error("expect function onclose");return this._ws=new Yc(this._config.url,{headers:{"X-NLS-Token":this._config.token},perMessageDeflate:!1}),this._ws.on("message",(o,s)=>{e(o,s)}),this._ws.on("close",()=>{r()}),new Promise((o,s)=>{this._ws.on("open",()=>{o()}),this._ws.on("error",n=>{s(n)})})}send(e,r){this._ws!=null&&this._ws.send(e,{binary:r})}setPing(e,r){this._ping=setInterval(()=>{this._ws.ping(r)},e)}clearPing(){this._ping&&clearInterval(this._ping)}shutdown(){this._ws!=null&&(this._ping!=null&&clearInterval(this._ping),this._ws.terminate())}uuid(){return Jc().split("-").join("")}defaultContext(){return{sdk:{name:"nls-nodejs-sdk",version:"0.0.1",language:"nodejs"}}}};var Qc=Kc;ct.EventEmitter;ct.EventEmitter;const Zc=Qc,el=ct.EventEmitter;class tl{constructor(e,r=!1){this._event=new el,this._config=e,r?this._namespace="SpeechLongSynthesizer":this._namespace="SpeechSynthesizer"}defaultStartParams(e){return{voice:e,format:"wav",sample_rate:16e3,volume:50,speech_rate:0,pitch_rate:0,enable_subtitle:!1}}on(e,r){this._event.on(e,r)}async start(e,r,o){this._client=new Zc(this._config),this._taskid=this._client.uuid();let s={header:{message_id:this._client.uuid(),task_id:this._taskid,namespace:this._namespace,name:"StartSynthesis",appkey:this._config.appkey},payload:e,context:this._client.defaultContext()};return new Promise(async(n,i)=>{try{await this._client.start((a,u)=>{if(u)this._event.emit("data",a);else{let f=a.toString(),c=JSON.parse(f);c.header.name==="MetaInfo"?this._event.emit("meta",f):c.header.name==="SynthesisCompleted"?(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("completed",f),n(f)):c.header.name==="TaskFailed"&&(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("TaskFailed",f),this._event.emit("failed",f),i(f))}},()=>{this._event.emit("closed")}),r&&(o||(o=6e3),this._client.setPing(o)),this._client.send(JSON.stringify(s),!1)}catch(a){i(a)}})}shutdown(){this._client!=null&&this._client.shutdown()}}var rl=tl;const nl=vt(rl),nr={accessKeyId:"LTAI5tFCh5eoiNZX4n2wEy7Y",accessKeySecret:"XWYRzwspo5z4Ukuo8lKxZX4pUSgQ86",appkey:"JbBUqMYRUt0DrMcK",endpoint:"https://nls-gateway.aliyuncs.com",regionId:"cn-shanghai",ttsUrl:"wss://nls-gateway-cn-shanghai.aliyuncs.com/ws/v1"};var dr={exports:{}},wt={},hi={exports:{}},Ut={exports:{}},sn,_o;function Fa(){if(_o)return sn;_o=1;var t=1e3,e=t*60,r=e*60,o=r*24,s=o*7,n=o*365.25;sn=function(c,h){h=h||{};var l=typeof c;if(l==="string"&&c.length>0)return i(c);if(l==="number"&&isFinite(c))return h.long?u(c):a(c);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(c))};function i(c){if(c=String(c),!(c.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(c);if(h){var l=parseFloat(h[1]),d=(h[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return l*n;case"weeks":case"week":case"w":return l*s;case"days":case"day":case"d":return l*o;case"hours":case"hour":case"hrs":case"hr":case"h":return l*r;case"minutes":case"minute":case"mins":case"min":case"m":return l*e;case"seconds":case"second":case"secs":case"sec":case"s":return l*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return l;default:return}}}}function a(c){var h=Math.abs(c);return h>=o?Math.round(c/o)+"d":h>=r?Math.round(c/r)+"h":h>=e?Math.round(c/e)+"m":h>=t?Math.round(c/t)+"s":c+"ms"}function u(c){var h=Math.abs(c);return h>=o?f(c,h,o,"day"):h>=r?f(c,h,r,"hour"):h>=e?f(c,h,e,"minute"):h>=t?f(c,h,t,"second"):c+" ms"}function f(c,h,l,d){var g=h>=l*1.5;return Math.round(c/l)+" "+d+(g?"s":"")}return sn}var an,No;function Aa(){if(No)return an;No=1;function t(e){o.debug=o,o.default=o,o.coerce=f,o.disable=a,o.enable=n,o.enabled=u,o.humanize=Fa(),o.destroy=c,Object.keys(e).forEach(h=>{o[h]=e[h]}),o.names=[],o.skips=[],o.formatters={};function r(h){let l=0;for(let d=0;d<h.length;d++)l=(l<<5)-l+h.charCodeAt(d),l|=0;return o.colors[Math.abs(l)%o.colors.length]}o.selectColor=r;function o(h){let l,d=null,g,w;function E(..._){if(!E.enabled)return;const v=E,y=Number(new Date),C=y-(l||y);v.diff=C,v.prev=l,v.curr=y,l=y,_[0]=o.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let F=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(D,T)=>{if(D==="%%")return"%";F++;const p=o.formatters[T];if(typeof p=="function"){const b=_[F];D=p.call(v,b),_.splice(F,1),F--}return D}),o.formatArgs.call(v,_),(v.log||o.log).apply(v,_)}return E.namespace=h,E.useColors=o.useColors(),E.color=o.selectColor(h),E.extend=s,E.destroy=o.destroy,Object.defineProperty(E,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(g!==o.namespaces&&(g=o.namespaces,w=o.enabled(h)),w),set:_=>{d=_}}),typeof o.init=="function"&&o.init(E),E}function s(h,l){const d=o(this.namespace+(typeof l>"u"?":":l)+h);return d.log=this.log,d}function n(h){o.save(h),o.namespaces=h,o.names=[],o.skips=[];const l=(typeof h=="string"?h:"").trim().replace(" ",",").split(",").filter(Boolean);for(const d of l)d[0]==="-"?o.skips.push(d.slice(1)):o.names.push(d)}function i(h,l){let d=0,g=0,w=-1,E=0;for(;d<h.length;)if(g<l.length&&(l[g]===h[d]||l[g]==="*"))l[g]==="*"?(w=g,E=d,g++):(d++,g++);else if(w!==-1)g=w+1,E++,d=E;else return!1;for(;g<l.length&&l[g]==="*";)g++;return g===l.length}function a(){const h=[...o.names,...o.skips.map(l=>"-"+l)].join(",");return o.enable(""),h}function u(h){for(const l of o.skips)if(i(h,l))return!1;for(const l of o.names)if(i(h,l))return!0;return!1}function f(h){return h instanceof Error?h.stack||h.message:h}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return o.enable(o.load()),o}return an=t,an}var xo;function il(){return xo||(xo=1,function(t,e){e.formatArgs=o,e.save=s,e.load=n,e.useColors=r,e.storage=i(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function r(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let u;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(u=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(u[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;u.splice(1,0,f,"color: inherit");let c=0,h=0;u[0].replace(/%[a-zA-Z%]/g,l=>{l!=="%%"&&(c++,l==="%c"&&(h=c))}),u.splice(h,0,f)}e.log=console.debug||console.log||(()=>{});function s(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function n(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=process.env.DEBUG),u}function i(){try{return localStorage}catch{}}t.exports=Aa()(e);const{formatters:a}=t.exports;a.j=function(u){try{return JSON.stringify(u)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}(Ut,Ut.exports)),Ut.exports}var Xt={exports:{}},un,Po;function _a(){if(Po)return un;Po=1;function t(){const r=/(Chrome|Chromium)\/(?<chromeVersion>\d+)\./.exec(navigator.userAgent);if(r)return Number.parseInt(r.groups.chromeVersion,10)}const e=t()>=69?{level:1,hasBasic:!0,has256:!1,has16m:!1}:!1;return un={stdout:e,stderr:e},un}var Io;function ol(){return Io||(Io=1,function(t,e){const r=ma,o=$t;e.init=c,e.log=a,e.formatArgs=n,e.save=u,e.load=f,e.useColors=s,e.destroy=o.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),e.colors=[6,2,3,4,5,1];try{const l=_a();l&&(l.stderr||l).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(l=>/^debug_/i.test(l)).reduce((l,d)=>{const g=d.substring(6).toLowerCase().replace(/_([a-z])/g,(E,_)=>_.toUpperCase());let w=process.env[d];return/^(yes|on|true|enabled)$/i.test(w)?w=!0:/^(no|off|false|disabled)$/i.test(w)?w=!1:w==="null"?w=null:w=Number(w),l[g]=w,l},{});function s(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:r.isatty(process.stderr.fd)}function n(l){const{namespace:d,useColors:g}=this;if(g){const w=this.color,E="\x1B[3"+(w<8?w:"8;5;"+w),_=`  ${E};1m${d} \x1B[0m`;l[0]=_+l[0].split(`
`).join(`
`+_),l.push(E+"m+"+t.exports.humanize(this.diff)+"\x1B[0m")}else l[0]=i()+d+" "+l[0]}function i(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function a(...l){return process.stderr.write(o.formatWithOptions(e.inspectOpts,...l)+`
`)}function u(l){l?process.env.DEBUG=l:delete process.env.DEBUG}function f(){return process.env.DEBUG}function c(l){l.inspectOpts={};const d=Object.keys(e.inspectOpts);for(let g=0;g<d.length;g++)l.inspectOpts[d[g]]=e.inspectOpts[d[g]]}t.exports=Aa()(e);const{formatters:h}=t.exports;h.o=function(l){return this.inspectOpts.colors=this.useColors,o.inspect(l,this.inspectOpts).split(`
`).map(d=>d.trim()).join(" ")},h.O=function(l){return this.inspectOpts.colors=this.useColors,o.inspect(l,this.inspectOpts)}}(Xt,Xt.exports)),Xt.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?hi.exports=il():hi.exports=ol();var Na=hi.exports;const Lo=Yu,xa=ar,Pa=ur,sl=Si.parse,al=Si.format,qe=Na("httpx:body"),Vt=Na("httpx:header"),ul=new xa.Agent({keepAlive:!0}),cl=new Pa.Agent({keepAlive:!0}),cn=3e3,Qe=Symbol("TIMER::READ_TIMER"),pi=Symbol("TIMER::READ_TIME_OUT"),Ia=Symbol("TIMER::READ_TIMER_START_AT");function La(t){switch(t.headers["content-encoding"]){case"gzip":return t.pipe(Lo.createGunzip());case"deflate":return t.pipe(Lo.createInflate());default:return t}}var Mo=function(t,e,r){return t.name=e+t.name,t.message=`${r}. ${t.message}`,t};const Ot=function(t){return t!==null&&!isNaN(t)};wt.request=function(t,e){e||(e={});const r=typeof t=="string"?sl(t):t;let o,s;Ot(e.readTimeout)||Ot(e.connectTimeout)?(o=Ot(e.readTimeout)?Number(e.readTimeout):cn,s=Ot(e.connectTimeout)?Number(e.connectTimeout):cn):Ot(e.timeout)?o=s=Number(e.timeout):o=s=cn;const n=r.protocol==="https:",i=(e.method||"GET").toUpperCase(),a=n?cl:ul,u=e.agent||a;var f={host:r.hostname||"localhost",path:r.path||"/",method:i,port:r.port||(r.protocol==="https:"?443:80),agent:u,headers:e.headers||{},key:e.key||"",cert:e.cert||"",ca:e.ca||"",timeout:s};n&&typeof e.rejectUnauthorized<"u"&&(f.rejectUnauthorized=e.rejectUnauthorized),e.compression&&(f.headers["accept-encoding"]="gzip,deflate");const c=n?Pa:xa;return typeof e.beforeRequest=="function"&&(f=e.beforeRequest(f)),new Promise((h,l)=>{const d=c.request(f),g=e.data;var w=y=>{Vt.enabled&&(y.req._header.split(`\r
`).forEach(F=>{Vt("> %s",F)}),Vt("< HTTP/%s %s %s",y.httpVersion,y.statusCode,y.statusMessage),Object.keys(y.headers).forEach(F=>{Vt("< %s: %s",F,y.headers[F])})),h(y)},E=y=>{y.message+=`${i} ${al(r)} failed.`,d.socket&&d.socket[Qe]&&clearTimeout(d.socket[Qe]),l(y)},_=y=>{d.abort(),E(y)};const v=function(y){const C=setTimeout(()=>{y[Qe]&&(clearTimeout(y[Qe]),y[Qe]=null);var F=new Error,S=`ReadTimeout(${o})`;_(Mo(F,"RequestTimeout",S))},o);y[pi]=o,y[Qe]=C,y[Ia]=Date.now(),C.unref()};!g||typeof g=="string"||g instanceof Buffer?(qe.enabled&&qe(g?typeof g=="string"?g:`Buffer <ignored>, Buffer length: ${g.length}`:"<no request body>"),d.end(g)):typeof g.pipe=="function"&&(g.pipe(d),qe.enabled&&qe("<request body is a stream>"),g.once("error",y=>{_(Mo(y,"HttpX","Stream occor error"))})),d.on("timeout",()=>{var y=new Error;y.name="RequestTimeoutError",y.message=`ConnectTimeout: Connect ${t} failed.`,d.destroy(),l(y)}),d.on("response",w),d.on("error",E),d.once("socket",function(y){y.readyState==="opening"?y.once("connect",function(){v(y)}):v(y)})})};wt.read=function(t,e){const r=La(t);return new Promise((o,s)=>{const n=t.socket||t.client,i=()=>{const E=t.req;var _=new Error;return _.name="RequestTimeoutError",_.message=`ReadTimeout: ${n[pi]}. ${E.method} ${E.path} failed.`,_};let a;const u=n[Qe];if(!u){s(i());return}const f=n[pi]-(Date.now()-n[Ia]);if(clearTimeout(u),f<=0){s(i());return}a=setTimeout(function(){s(i())},f);var c,h,l,d=function(){r.removeListener("error",c),r.removeListener("data",h),r.removeListener("end",l),a&&clearTimeout(a)};const g=[];var w=0;h=function(E){g.push(E),w+=E.length},c=function(E){d(),s(E)},l=function(){d();var E=Buffer.concat(g,w);if(qe(""),e){const _=E.toString(e);return qe(_),o(_)}qe.enabled&&qe(E.toString()),o(E)},r.on("error",c),r.on("data",h),r.on("end",l)})};function ll(t){return new Promise((e,r)=>{var o,s,n,i=function(){t.removeListener("error",n),t.removeListener("end",s),t.removeListener("readable",o)};o=function(){i(),e(!1)},s=function(){i(),e(!0)},n=function(a){i(),r(a)},t.once("readable",o),t.once("end",s),t.once("error",n)})}class Ma{constructor(e,r,o,s){this.id=e,this.event=r,this.data=o,this.retry=s}}wt.Event=Ma;const $o="data:",Ro="event:",ko="id:",jo="retry:";function fl(t){for(let e=0;e<t.length;e++){const r=t.charAt(e);if(r<"0"||r>"9")return!1}return t.length>0}function hl(t,e){const r=t+e;let o=0;const s=[];for(let i=0;i<r.length-1;i++){const a=r[i],u=r[i+1];if(a===`
`&&u===`
`){const c=r.substring(o,i).split(`
`),h=new Ma;c.forEach(l=>{if(l.startsWith($o))h.data=l.substring($o.length).trim();else if(l.startsWith(Ro))h.event=l.substring(Ro.length).trim();else if(l.startsWith(ko))h.id=l.substring(ko.length).trim();else if(l.startsWith(jo)){const d=l.substring(jo.length).trim();fl(d)&&(h.retry=parseInt(d,10))}else l.startsWith(":")}),s.push(h),o=i+2}}const n=r.substring(o);return[s,n]}wt.readAsSSE=async function*(t){const e=La(t),r=t.socket||t.client;clearTimeout(r[Qe]);let o="";for(;;){if(await ll(e))return;let n;for(;(n=e.read())!==null;){const[i,a]=hl(o,n.toString());if(o=a,i&&i.length>0)for(const u of i)yield u}}};var Ti={};(function(t){const e=ce,r=it,o=Ju;t.loadJSONSync=function(s){var n=e.readFileSync(s,"utf8");n.charCodeAt(0)===65279&&(n=n.slice(1));try{return JSON.parse(n)}catch(i){throw i.message=s+": "+i.message,i}},t.encode=function(s,n){return typeof s!="string"&&(s=""+s),new Buffer(s,n)},t.makeHasher=function(s){return function(n,i){var a=o.createHash(s);return a.update(n),a.digest(i)}},t.createHash=t.makeHasher,t.md5=t.makeHasher("md5"),t.createHmac=function(s){return function(n,i,a){return o.createHmac(s,i).update(n).digest(a)}},t.sha1=t.createHmac("sha1"),t.random=function(s,n){return Math.floor(s+Math.random()*(n-s))},t.makeNonce=function(){var s=0,n;const i=r.hostname(),a=process.pid;return function(){var u=Math.floor(Math.random()*1e12);u===n?s++:s=0,n=u;var f=`${i}${a}${u}${s}`;return t.md5(f,"hex")}}(),t.pad2=function(s){return s<10?"0"+s:""+s},t.pad3=function(s){return s<10?"00"+s:s<100?"0"+s:""+s},t.getYYYYMMDD=function(s){var n=s.getFullYear(),i=t.pad2(s.getMonth()+1),a=t.pad2(s.getDate());return""+n+i+a},t.sleep=function(s){return new Promise(n=>{setTimeout(n,s)})},t.getIPv4=function(){for(var s=r.networkInterfaces(),n=Object.keys(s),i=0;i<n.length;i++)for(var a=n[i],u=s[a],f=0;f<u.length;f++){var c=u[f];if(!c.internal&&c.family==="IPv4")return c.address}return""},t.getMac=function(){for(var s=r.networkInterfaces(),n=Object.keys(s),i=0;i<n.length;i++)for(var a=n[i],u=s[a],f=0;f<u.length;f++){var c=u[f];if(!c.internal&&c.family==="IPv4")return c.mac}return"00:00:00:00:00:00"}})(Ti);var mr={exports:{}},$a={exports:{}},Ra={exports:{}};(function(t){(function(e){var r,o=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,n=Math.floor,i="[BigNumber Error] ",a=i+"Number primitive has more than 15 significant digits: ",u=1e14,f=14,c=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],l=1e7,d=1e9;function g(S){var D,T,p,b=Y.prototype={constructor:Y,toString:null,valueOf:null},A=new Y(1),I=20,V=4,q=-7,B=21,z=-1e7,W=1e7,J=!1,K=1,Q=0,re={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},ae="0123456789abcdefghijklmnopqrstuvwxyz",pe=!0;function Y(m,x){var P,k,M,$,X,L,R,U,j=this;if(!(j instanceof Y))return new Y(m,x);if(x==null){if(m&&m._isBigNumber===!0){j.s=m.s,!m.c||m.e>W?j.c=j.e=null:m.e<z?j.c=[j.e=0]:(j.e=m.e,j.c=m.c.slice());return}if((L=typeof m=="number")&&m*0==0){if(j.s=1/m<0?(m=-m,-1):1,m===~~m){for($=0,X=m;X>=10;X/=10,$++);$>W?j.c=j.e=null:(j.e=$,j.c=[m]);return}U=String(m)}else{if(!o.test(U=String(m)))return p(j,U,L);j.s=U.charCodeAt(0)==45?(U=U.slice(1),-1):1}($=U.indexOf("."))>-1&&(U=U.replace(".","")),(X=U.search(/e/i))>0?($<0&&($=X),$+=+U.slice(X+1),U=U.substring(0,X)):$<0&&($=U.length)}else{if(v(x,2,ae.length,"Base"),x==10&&pe)return j=new Y(m),O(j,I+j.e+1,V);if(U=String(m),L=typeof m=="number"){if(m*0!=0)return p(j,U,L,x);if(j.s=1/m<0?(U=U.slice(1),-1):1,Y.DEBUG&&U.replace(/^0\.0*|\./,"").length>15)throw Error(a+m)}else j.s=U.charCodeAt(0)===45?(U=U.slice(1),-1):1;for(P=ae.slice(0,x),$=X=0,R=U.length;X<R;X++)if(P.indexOf(k=U.charAt(X))<0){if(k=="."){if(X>$){$=R;continue}}else if(!M&&(U==U.toUpperCase()&&(U=U.toLowerCase())||U==U.toLowerCase()&&(U=U.toUpperCase()))){M=!0,X=-1,$=0;continue}return p(j,String(m),L,x)}L=!1,U=T(U,x,10,j.s),($=U.indexOf("."))>-1?U=U.replace(".",""):$=U.length}for(X=0;U.charCodeAt(X)===48;X++);for(R=U.length;U.charCodeAt(--R)===48;);if(U=U.slice(X,++R)){if(R-=X,L&&Y.DEBUG&&R>15&&(m>c||m!==n(m)))throw Error(a+j.s*m);if(($=$-X-1)>W)j.c=j.e=null;else if($<z)j.c=[j.e=0];else{if(j.e=$,j.c=[],X=($+1)%f,$<0&&(X+=f),X<R){for(X&&j.c.push(+U.slice(0,X)),R-=f;X<R;)j.c.push(+U.slice(X,X+=f));X=f-(U=U.slice(X)).length}else X-=R;for(;X--;U+="0");j.c.push(+U)}}else j.c=[j.e=0]}Y.clone=g,Y.ROUND_UP=0,Y.ROUND_DOWN=1,Y.ROUND_CEIL=2,Y.ROUND_FLOOR=3,Y.ROUND_HALF_UP=4,Y.ROUND_HALF_DOWN=5,Y.ROUND_HALF_EVEN=6,Y.ROUND_HALF_CEIL=7,Y.ROUND_HALF_FLOOR=8,Y.EUCLID=9,Y.config=Y.set=function(m){var x,P;if(m!=null)if(typeof m=="object"){if(m.hasOwnProperty(x="DECIMAL_PLACES")&&(P=m[x],v(P,0,d,x),I=P),m.hasOwnProperty(x="ROUNDING_MODE")&&(P=m[x],v(P,0,8,x),V=P),m.hasOwnProperty(x="EXPONENTIAL_AT")&&(P=m[x],P&&P.pop?(v(P[0],-d,0,x),v(P[1],0,d,x),q=P[0],B=P[1]):(v(P,-d,d,x),q=-(B=P<0?-P:P))),m.hasOwnProperty(x="RANGE"))if(P=m[x],P&&P.pop)v(P[0],-d,-1,x),v(P[1],1,d,x),z=P[0],W=P[1];else if(v(P,-d,d,x),P)z=-(W=P<0?-P:P);else throw Error(i+x+" cannot be zero: "+P);if(m.hasOwnProperty(x="CRYPTO"))if(P=m[x],P===!!P)if(P)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))J=P;else throw J=!P,Error(i+"crypto unavailable");else J=P;else throw Error(i+x+" not true or false: "+P);if(m.hasOwnProperty(x="MODULO_MODE")&&(P=m[x],v(P,0,9,x),K=P),m.hasOwnProperty(x="POW_PRECISION")&&(P=m[x],v(P,0,d,x),Q=P),m.hasOwnProperty(x="FORMAT"))if(P=m[x],typeof P=="object")re=P;else throw Error(i+x+" not an object: "+P);if(m.hasOwnProperty(x="ALPHABET"))if(P=m[x],typeof P=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(P))pe=P.slice(0,10)=="0123456789",ae=P;else throw Error(i+x+" invalid: "+P)}else throw Error(i+"Object expected: "+m);return{DECIMAL_PLACES:I,ROUNDING_MODE:V,EXPONENTIAL_AT:[q,B],RANGE:[z,W],CRYPTO:J,MODULO_MODE:K,POW_PRECISION:Q,FORMAT:re,ALPHABET:ae}},Y.isBigNumber=function(m){if(!m||m._isBigNumber!==!0)return!1;if(!Y.DEBUG)return!0;var x,P,k=m.c,M=m.e,$=m.s;e:if({}.toString.call(k)=="[object Array]"){if(($===1||$===-1)&&M>=-d&&M<=d&&M===n(M)){if(k[0]===0){if(M===0&&k.length===1)return!0;break e}if(x=(M+1)%f,x<1&&(x+=f),String(k[0]).length==x){for(x=0;x<k.length;x++)if(P=k[x],P<0||P>=u||P!==n(P))break e;if(P!==0)return!0}}}else if(k===null&&M===null&&($===null||$===1||$===-1))return!0;throw Error(i+"Invalid BigNumber: "+m)},Y.maximum=Y.max=function(){return Re(arguments,-1)},Y.minimum=Y.min=function(){return Re(arguments,1)},Y.random=function(){var m=9007199254740992,x=Math.random()*m&2097151?function(){return n(Math.random()*m)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(P){var k,M,$,X,L,R=0,U=[],j=new Y(A);if(P==null?P=I:v(P,0,d),X=s(P/f),J)if(crypto.getRandomValues){for(k=crypto.getRandomValues(new Uint32Array(X*=2));R<X;)L=k[R]*131072+(k[R+1]>>>11),L>=9e15?(M=crypto.getRandomValues(new Uint32Array(2)),k[R]=M[0],k[R+1]=M[1]):(U.push(L%1e14),R+=2);R=X/2}else if(crypto.randomBytes){for(k=crypto.randomBytes(X*=7);R<X;)L=(k[R]&31)*281474976710656+k[R+1]*1099511627776+k[R+2]*4294967296+k[R+3]*16777216+(k[R+4]<<16)+(k[R+5]<<8)+k[R+6],L>=9e15?crypto.randomBytes(7).copy(k,R):(U.push(L%1e14),R+=7);R=X/7}else throw J=!1,Error(i+"crypto unavailable");if(!J)for(;R<X;)L=x(),L<9e15&&(U[R++]=L%1e14);for(X=U[--R],P%=f,X&&P&&(L=h[f-P],U[R]=n(X/L)*L);U[R]===0;U.pop(),R--);if(R<0)U=[$=0];else{for($=-1;U[0]===0;U.splice(0,1),$-=f);for(R=1,L=U[0];L>=10;L/=10,R++);R<f&&($-=f-R)}return j.e=$,j.c=U,j}}(),Y.sum=function(){for(var m=1,x=arguments,P=new Y(x[0]);m<x.length;)P=P.plus(x[m++]);return P},T=function(){var m="0123456789";function x(P,k,M,$){for(var X,L=[0],R,U=0,j=P.length;U<j;){for(R=L.length;R--;L[R]*=k);for(L[0]+=$.indexOf(P.charAt(U++)),X=0;X<L.length;X++)L[X]>M-1&&(L[X+1]==null&&(L[X+1]=0),L[X+1]+=L[X]/M|0,L[X]%=M)}return L.reverse()}return function(P,k,M,$,X){var L,R,U,j,G,ee,te,fe,me=P.indexOf("."),we=I,le=V;for(me>=0&&(j=Q,Q=0,P=P.replace(".",""),fe=new Y(k),ee=fe.pow(P.length-me),Q=j,fe.c=x(F(E(ee.c),ee.e,"0"),10,M,m),fe.e=fe.c.length),te=x(P,k,M,X?(L=ae,m):(L=m,ae)),U=j=te.length;te[--j]==0;te.pop());if(!te[0])return L.charAt(0);if(me<0?--U:(ee.c=te,ee.e=U,ee.s=$,ee=D(ee,fe,we,le,M),te=ee.c,G=ee.r,U=ee.e),R=U+we+1,me=te[R],j=M/2,G=G||R<0||te[R+1]!=null,G=le<4?(me!=null||G)&&(le==0||le==(ee.s<0?3:2)):me>j||me==j&&(le==4||G||le==6&&te[R-1]&1||le==(ee.s<0?8:7)),R<1||!te[0])P=G?F(L.charAt(1),-we,L.charAt(0)):L.charAt(0);else{if(te.length=R,G)for(--M;++te[--R]>M;)te[R]=0,R||(++U,te=[1].concat(te));for(j=te.length;!te[--j];);for(me=0,P="";me<=j;P+=L.charAt(te[me++]));P=F(P,U,L.charAt(0))}return P}}(),D=function(){function m(k,M,$){var X,L,R,U,j=0,G=k.length,ee=M%l,te=M/l|0;for(k=k.slice();G--;)R=k[G]%l,U=k[G]/l|0,X=te*R+U*ee,L=ee*R+X%l*l+j,j=(L/$|0)+(X/l|0)+te*U,k[G]=L%$;return j&&(k=[j].concat(k)),k}function x(k,M,$,X){var L,R;if($!=X)R=$>X?1:-1;else for(L=R=0;L<$;L++)if(k[L]!=M[L]){R=k[L]>M[L]?1:-1;break}return R}function P(k,M,$,X){for(var L=0;$--;)k[$]-=L,L=k[$]<M[$]?1:0,k[$]=L*X+k[$]-M[$];for(;!k[0]&&k.length>1;k.splice(0,1));}return function(k,M,$,X,L){var R,U,j,G,ee,te,fe,me,we,le,he,Te,kt,Sr,Or,je,St,Me=k.s==M.s?1:-1,Ne=k.c,ye=M.c;if(!Ne||!Ne[0]||!ye||!ye[0])return new Y(!k.s||!M.s||(Ne?ye&&Ne[0]==ye[0]:!ye)?NaN:Ne&&Ne[0]==0||!ye?Me*0:Me/0);for(me=new Y(Me),we=me.c=[],U=k.e-M.e,Me=$+U+1,L||(L=u,U=w(k.e/f)-w(M.e/f),Me=Me/f|0),j=0;ye[j]==(Ne[j]||0);j++);if(ye[j]>(Ne[j]||0)&&U--,Me<0)we.push(1),G=!0;else{for(Sr=Ne.length,je=ye.length,j=0,Me+=2,ee=n(L/(ye[0]+1)),ee>1&&(ye=m(ye,ee,L),Ne=m(Ne,ee,L),je=ye.length,Sr=Ne.length),kt=je,le=Ne.slice(0,je),he=le.length;he<je;le[he++]=0);St=ye.slice(),St=[0].concat(St),Or=ye[0],ye[1]>=L/2&&Or++;do{if(ee=0,R=x(ye,le,je,he),R<0){if(Te=le[0],je!=he&&(Te=Te*L+(le[1]||0)),ee=n(Te/Or),ee>1)for(ee>=L&&(ee=L-1),te=m(ye,ee,L),fe=te.length,he=le.length;x(te,le,fe,he)==1;)ee--,P(te,je<fe?St:ye,fe,L),fe=te.length,R=1;else ee==0&&(R=ee=1),te=ye.slice(),fe=te.length;if(fe<he&&(te=[0].concat(te)),P(le,te,he,L),he=le.length,R==-1)for(;x(ye,le,je,he)<1;)ee++,P(le,je<he?St:ye,he,L),he=le.length}else R===0&&(ee++,le=[0]);we[j++]=ee,le[0]?le[he++]=Ne[kt]||0:(le=[Ne[kt]],he=1)}while((kt++<Sr||le[0]!=null)&&Me--);G=le[0]!=null,we[0]||we.splice(0,1)}if(L==u){for(j=1,Me=we[0];Me>=10;Me/=10,j++);O(me,$+(me.e=j+U*f-1)+1,X,G)}else me.e=U,me.r=+G;return me}}();function ve(m,x,P,k){var M,$,X,L,R;if(P==null?P=V:v(P,0,8),!m.c)return m.toString();if(M=m.c[0],X=m.e,x==null)R=E(m.c),R=k==1||k==2&&(X<=q||X>=B)?C(R,X):F(R,X,"0");else if(m=O(new Y(m),x,P),$=m.e,R=E(m.c),L=R.length,k==1||k==2&&(x<=$||$<=q)){for(;L<x;R+="0",L++);R=C(R,$)}else if(x-=X,R=F(R,$,"0"),$+1>L){if(--x>0)for(R+=".";x--;R+="0");}else if(x+=$-L,x>0)for($+1==L&&(R+=".");x--;R+="0");return m.s<0&&M?"-"+R:R}function Re(m,x){for(var P,k,M=1,$=new Y(m[0]);M<m.length;M++)k=new Y(m[M]),(!k.s||(P=_($,k))===x||P===0&&$.s===x)&&($=k);return $}function N(m,x,P){for(var k=1,M=x.length;!x[--M];x.pop());for(M=x[0];M>=10;M/=10,k++);return(P=k+P*f-1)>W?m.c=m.e=null:P<z?m.c=[m.e=0]:(m.e=P,m.c=x),m}p=function(){var m=/^(-?)0([xbo])(?=\w[\w.]*$)/i,x=/^([^.]+)\.$/,P=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,M=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function($,X,L,R){var U,j=L?X:X.replace(M,"");if(k.test(j))$.s=isNaN(j)?null:j<0?-1:1;else{if(!L&&(j=j.replace(m,function(G,ee,te){return U=(te=te.toLowerCase())=="x"?16:te=="b"?2:8,!R||R==U?ee:G}),R&&(U=R,j=j.replace(x,"$1").replace(P,"0.$1")),X!=j))return new Y(j,U);if(Y.DEBUG)throw Error(i+"Not a"+(R?" base "+R:"")+" number: "+X);$.s=null}$.c=$.e=null}}();function O(m,x,P,k){var M,$,X,L,R,U,j,G=m.c,ee=h;if(G){e:{for(M=1,L=G[0];L>=10;L/=10,M++);if($=x-M,$<0)$+=f,X=x,R=G[U=0],j=n(R/ee[M-X-1]%10);else if(U=s(($+1)/f),U>=G.length)if(k){for(;G.length<=U;G.push(0));R=j=0,M=1,$%=f,X=$-f+1}else break e;else{for(R=L=G[U],M=1;L>=10;L/=10,M++);$%=f,X=$-f+M,j=X<0?0:n(R/ee[M-X-1]%10)}if(k=k||x<0||G[U+1]!=null||(X<0?R:R%ee[M-X-1]),k=P<4?(j||k)&&(P==0||P==(m.s<0?3:2)):j>5||j==5&&(P==4||k||P==6&&($>0?X>0?R/ee[M-X]:0:G[U-1])%10&1||P==(m.s<0?8:7)),x<1||!G[0])return G.length=0,k?(x-=m.e+1,G[0]=ee[(f-x%f)%f],m.e=-x||0):G[0]=m.e=0,m;if($==0?(G.length=U,L=1,U--):(G.length=U+1,L=ee[f-$],G[U]=X>0?n(R/ee[M-X]%ee[X])*L:0),k)for(;;)if(U==0){for($=1,X=G[0];X>=10;X/=10,$++);for(X=G[0]+=L,L=1;X>=10;X/=10,L++);$!=L&&(m.e++,G[0]==u&&(G[0]=1));break}else{if(G[U]+=L,G[U]!=u)break;G[U--]=0,L=1}for($=G.length;G[--$]===0;G.pop());}m.e>W?m.c=m.e=null:m.e<z&&(m.c=[m.e=0])}return m}function H(m){var x,P=m.e;return P===null?m.toString():(x=E(m.c),x=P<=q||P>=B?C(x,P):F(x,P,"0"),m.s<0?"-"+x:x)}return b.absoluteValue=b.abs=function(){var m=new Y(this);return m.s<0&&(m.s=1),m},b.comparedTo=function(m,x){return _(this,new Y(m,x))},b.decimalPlaces=b.dp=function(m,x){var P,k,M,$=this;if(m!=null)return v(m,0,d),x==null?x=V:v(x,0,8),O(new Y($),m+$.e+1,x);if(!(P=$.c))return null;if(k=((M=P.length-1)-w(this.e/f))*f,M=P[M])for(;M%10==0;M/=10,k--);return k<0&&(k=0),k},b.dividedBy=b.div=function(m,x){return D(this,new Y(m,x),I,V)},b.dividedToIntegerBy=b.idiv=function(m,x){return D(this,new Y(m,x),0,1)},b.exponentiatedBy=b.pow=function(m,x){var P,k,M,$,X,L,R,U,j,G=this;if(m=new Y(m),m.c&&!m.isInteger())throw Error(i+"Exponent not an integer: "+H(m));if(x!=null&&(x=new Y(x)),L=m.e>14,!G.c||!G.c[0]||G.c[0]==1&&!G.e&&G.c.length==1||!m.c||!m.c[0])return j=new Y(Math.pow(+H(G),L?m.s*(2-y(m)):+H(m))),x?j.mod(x):j;if(R=m.s<0,x){if(x.c?!x.c[0]:!x.s)return new Y(NaN);k=!R&&G.isInteger()&&x.isInteger(),k&&(G=G.mod(x))}else{if(m.e>9&&(G.e>0||G.e<-1||(G.e==0?G.c[0]>1||L&&G.c[1]>=24e7:G.c[0]<8e13||L&&G.c[0]<=9999975e7)))return $=G.s<0&&y(m)?-0:0,G.e>-1&&($=1/$),new Y(R?1/$:$);Q&&($=s(Q/f+2))}for(L?(P=new Y(.5),R&&(m.s=1),U=y(m)):(M=Math.abs(+H(m)),U=M%2),j=new Y(A);;){if(U){if(j=j.times(G),!j.c)break;$?j.c.length>$&&(j.c.length=$):k&&(j=j.mod(x))}if(M){if(M=n(M/2),M===0)break;U=M%2}else if(m=m.times(P),O(m,m.e+1,1),m.e>14)U=y(m);else{if(M=+H(m),M===0)break;U=M%2}G=G.times(G),$?G.c&&G.c.length>$&&(G.c.length=$):k&&(G=G.mod(x))}return k?j:(R&&(j=A.div(j)),x?j.mod(x):$?O(j,Q,V,X):j)},b.integerValue=function(m){var x=new Y(this);return m==null?m=V:v(m,0,8),O(x,x.e+1,m)},b.isEqualTo=b.eq=function(m,x){return _(this,new Y(m,x))===0},b.isFinite=function(){return!!this.c},b.isGreaterThan=b.gt=function(m,x){return _(this,new Y(m,x))>0},b.isGreaterThanOrEqualTo=b.gte=function(m,x){return(x=_(this,new Y(m,x)))===1||x===0},b.isInteger=function(){return!!this.c&&w(this.e/f)>this.c.length-2},b.isLessThan=b.lt=function(m,x){return _(this,new Y(m,x))<0},b.isLessThanOrEqualTo=b.lte=function(m,x){return(x=_(this,new Y(m,x)))===-1||x===0},b.isNaN=function(){return!this.s},b.isNegative=function(){return this.s<0},b.isPositive=function(){return this.s>0},b.isZero=function(){return!!this.c&&this.c[0]==0},b.minus=function(m,x){var P,k,M,$,X=this,L=X.s;if(m=new Y(m,x),x=m.s,!L||!x)return new Y(NaN);if(L!=x)return m.s=-x,X.plus(m);var R=X.e/f,U=m.e/f,j=X.c,G=m.c;if(!R||!U){if(!j||!G)return j?(m.s=-x,m):new Y(G?X:NaN);if(!j[0]||!G[0])return G[0]?(m.s=-x,m):new Y(j[0]?X:V==3?-0:0)}if(R=w(R),U=w(U),j=j.slice(),L=R-U){for(($=L<0)?(L=-L,M=j):(U=R,M=G),M.reverse(),x=L;x--;M.push(0));M.reverse()}else for(k=($=(L=j.length)<(x=G.length))?L:x,L=x=0;x<k;x++)if(j[x]!=G[x]){$=j[x]<G[x];break}if($&&(M=j,j=G,G=M,m.s=-m.s),x=(k=G.length)-(P=j.length),x>0)for(;x--;j[P++]=0);for(x=u-1;k>L;){if(j[--k]<G[k]){for(P=k;P&&!j[--P];j[P]=x);--j[P],j[k]+=u}j[k]-=G[k]}for(;j[0]==0;j.splice(0,1),--U);return j[0]?N(m,j,U):(m.s=V==3?-1:1,m.c=[m.e=0],m)},b.modulo=b.mod=function(m,x){var P,k,M=this;return m=new Y(m,x),!M.c||!m.s||m.c&&!m.c[0]?new Y(NaN):!m.c||M.c&&!M.c[0]?new Y(M):(K==9?(k=m.s,m.s=1,P=D(M,m,0,3),m.s=k,P.s*=k):P=D(M,m,0,K),m=M.minus(P.times(m)),!m.c[0]&&K==1&&(m.s=M.s),m)},b.multipliedBy=b.times=function(m,x){var P,k,M,$,X,L,R,U,j,G,ee,te,fe,me,we,le=this,he=le.c,Te=(m=new Y(m,x)).c;if(!he||!Te||!he[0]||!Te[0])return!le.s||!m.s||he&&!he[0]&&!Te||Te&&!Te[0]&&!he?m.c=m.e=m.s=null:(m.s*=le.s,!he||!Te?m.c=m.e=null:(m.c=[0],m.e=0)),m;for(k=w(le.e/f)+w(m.e/f),m.s*=le.s,R=he.length,G=Te.length,R<G&&(fe=he,he=Te,Te=fe,M=R,R=G,G=M),M=R+G,fe=[];M--;fe.push(0));for(me=u,we=l,M=G;--M>=0;){for(P=0,ee=Te[M]%we,te=Te[M]/we|0,X=R,$=M+X;$>M;)U=he[--X]%we,j=he[X]/we|0,L=te*U+j*ee,U=ee*U+L%we*we+fe[$]+P,P=(U/me|0)+(L/we|0)+te*j,fe[$--]=U%me;fe[$]=P}return P?++k:fe.splice(0,1),N(m,fe,k)},b.negated=function(){var m=new Y(this);return m.s=-m.s||null,m},b.plus=function(m,x){var P,k=this,M=k.s;if(m=new Y(m,x),x=m.s,!M||!x)return new Y(NaN);if(M!=x)return m.s=-x,k.minus(m);var $=k.e/f,X=m.e/f,L=k.c,R=m.c;if(!$||!X){if(!L||!R)return new Y(M/0);if(!L[0]||!R[0])return R[0]?m:new Y(L[0]?k:M*0)}if($=w($),X=w(X),L=L.slice(),M=$-X){for(M>0?(X=$,P=R):(M=-M,P=L),P.reverse();M--;P.push(0));P.reverse()}for(M=L.length,x=R.length,M-x<0&&(P=R,R=L,L=P,x=M),M=0;x;)M=(L[--x]=L[x]+R[x]+M)/u|0,L[x]=u===L[x]?0:L[x]%u;return M&&(L=[M].concat(L),++X),N(m,L,X)},b.precision=b.sd=function(m,x){var P,k,M,$=this;if(m!=null&&m!==!!m)return v(m,1,d),x==null?x=V:v(x,0,8),O(new Y($),m,x);if(!(P=$.c))return null;if(M=P.length-1,k=M*f+1,M=P[M]){for(;M%10==0;M/=10,k--);for(M=P[0];M>=10;M/=10,k++);}return m&&$.e+1>k&&(k=$.e+1),k},b.shiftedBy=function(m){return v(m,-c,c),this.times("1e"+m)},b.squareRoot=b.sqrt=function(){var m,x,P,k,M,$=this,X=$.c,L=$.s,R=$.e,U=I+4,j=new Y("0.5");if(L!==1||!X||!X[0])return new Y(!L||L<0&&(!X||X[0])?NaN:X?$:1/0);if(L=Math.sqrt(+H($)),L==0||L==1/0?(x=E(X),(x.length+R)%2==0&&(x+="0"),L=Math.sqrt(+x),R=w((R+1)/2)-(R<0||R%2),L==1/0?x="5e"+R:(x=L.toExponential(),x=x.slice(0,x.indexOf("e")+1)+R),P=new Y(x)):P=new Y(L+""),P.c[0]){for(R=P.e,L=R+U,L<3&&(L=0);;)if(M=P,P=j.times(M.plus(D($,M,U,1))),E(M.c).slice(0,L)===(x=E(P.c)).slice(0,L))if(P.e<R&&--L,x=x.slice(L-3,L+1),x=="9999"||!k&&x=="4999"){if(!k&&(O(M,M.e+I+2,0),M.times(M).eq($))){P=M;break}U+=4,L+=4,k=1}else{(!+x||!+x.slice(1)&&x.charAt(0)=="5")&&(O(P,P.e+I+2,1),m=!P.times(P).eq($));break}}return O(P,P.e+I+1,V,m)},b.toExponential=function(m,x){return m!=null&&(v(m,0,d),m++),ve(this,m,x,1)},b.toFixed=function(m,x){return m!=null&&(v(m,0,d),m=m+this.e+1),ve(this,m,x)},b.toFormat=function(m,x,P){var k,M=this;if(P==null)m!=null&&x&&typeof x=="object"?(P=x,x=null):m&&typeof m=="object"?(P=m,m=x=null):P=re;else if(typeof P!="object")throw Error(i+"Argument not an object: "+P);if(k=M.toFixed(m,x),M.c){var $,X=k.split("."),L=+P.groupSize,R=+P.secondaryGroupSize,U=P.groupSeparator||"",j=X[0],G=X[1],ee=M.s<0,te=ee?j.slice(1):j,fe=te.length;if(R&&($=L,L=R,R=$,fe-=$),L>0&&fe>0){for($=fe%L||L,j=te.substr(0,$);$<fe;$+=L)j+=U+te.substr($,L);R>0&&(j+=U+te.slice($)),ee&&(j="-"+j)}k=G?j+(P.decimalSeparator||"")+((R=+P.fractionGroupSize)?G.replace(new RegExp("\\d{"+R+"}\\B","g"),"$&"+(P.fractionGroupSeparator||"")):G):j}return(P.prefix||"")+k+(P.suffix||"")},b.toFraction=function(m){var x,P,k,M,$,X,L,R,U,j,G,ee,te=this,fe=te.c;if(m!=null&&(L=new Y(m),!L.isInteger()&&(L.c||L.s!==1)||L.lt(A)))throw Error(i+"Argument "+(L.isInteger()?"out of range: ":"not an integer: ")+H(L));if(!fe)return new Y(te);for(x=new Y(A),U=P=new Y(A),k=R=new Y(A),ee=E(fe),$=x.e=ee.length-te.e-1,x.c[0]=h[(X=$%f)<0?f+X:X],m=!m||L.comparedTo(x)>0?$>0?x:U:L,X=W,W=1/0,L=new Y(ee),R.c[0]=0;j=D(L,x,0,1),M=P.plus(j.times(k)),M.comparedTo(m)!=1;)P=k,k=M,U=R.plus(j.times(M=U)),R=M,x=L.minus(j.times(M=x)),L=M;return M=D(m.minus(P),k,0,1),R=R.plus(M.times(U)),P=P.plus(M.times(k)),R.s=U.s=te.s,$=$*2,G=D(U,k,$,V).minus(te).abs().comparedTo(D(R,P,$,V).minus(te).abs())<1?[U,k]:[R,P],W=X,G},b.toNumber=function(){return+H(this)},b.toPrecision=function(m,x){return m!=null&&v(m,1,d),ve(this,m,x,2)},b.toString=function(m){var x,P=this,k=P.s,M=P.e;return M===null?k?(x="Infinity",k<0&&(x="-"+x)):x="NaN":(m==null?x=M<=q||M>=B?C(E(P.c),M):F(E(P.c),M,"0"):m===10&&pe?(P=O(new Y(P),I+M+1,V),x=F(E(P.c),P.e,"0")):(v(m,2,ae.length,"Base"),x=T(F(E(P.c),M,"0"),10,m,k,!0)),k<0&&P.c[0]&&(x="-"+x)),x},b.valueOf=b.toJSON=function(){return H(this)},b._isBigNumber=!0,S!=null&&Y.set(S),Y}function w(S){var D=S|0;return S>0||S===D?D:D-1}function E(S){for(var D,T,p=1,b=S.length,A=S[0]+"";p<b;){for(D=S[p++]+"",T=f-D.length;T--;D="0"+D);A+=D}for(b=A.length;A.charCodeAt(--b)===48;);return A.slice(0,b+1||1)}function _(S,D){var T,p,b=S.c,A=D.c,I=S.s,V=D.s,q=S.e,B=D.e;if(!I||!V)return null;if(T=b&&!b[0],p=A&&!A[0],T||p)return T?p?0:-V:I;if(I!=V)return I;if(T=I<0,p=q==B,!b||!A)return p?0:!b^T?1:-1;if(!p)return q>B^T?1:-1;for(V=(q=b.length)<(B=A.length)?q:B,I=0;I<V;I++)if(b[I]!=A[I])return b[I]>A[I]^T?1:-1;return q==B?0:q>B^T?1:-1}function v(S,D,T,p){if(S<D||S>T||S!==n(S))throw Error(i+(p||"Argument")+(typeof S=="number"?S<D||S>T?" out of range: ":" not an integer: ":" not a primitive number: ")+String(S))}function y(S){var D=S.c.length-1;return w(S.e/f)==D&&S.c[D]%2!=0}function C(S,D){return(S.length>1?S.charAt(0)+"."+S.slice(1):S)+(D<0?"e":"e+")+D}function F(S,D,T){var p,b;if(D<0){for(b=T+".";++D;b+=T);S=b+S}else if(p=S.length,++D>p){for(b=T,D-=p;--D;b+=T);S+=b}else D<p&&(S=S.slice(0,D)+"."+S.slice(D));return S}r=g(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(ne)})(Ra);var ka=Ra.exports;(function(t){var e=ka,r=t.exports;(function(){var o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s,n,i={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},a;function u(c){return o.lastIndex=0,o.test(c)?'"'+c.replace(o,function(h){var l=i[h];return typeof l=="string"?l:"\\u"+("0000"+h.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+c+'"'}function f(c,h){var l,d,g,w,E=s,_,v=h[c],y=v!=null&&(v instanceof e||e.isBigNumber(v));switch(v&&typeof v=="object"&&typeof v.toJSON=="function"&&(v=v.toJSON(c)),typeof a=="function"&&(v=a.call(h,c,v)),typeof v){case"string":return y?v:u(v);case"number":return isFinite(v)?String(v):"null";case"boolean":case"null":case"bigint":return String(v);case"object":if(!v)return"null";if(s+=n,_=[],Object.prototype.toString.apply(v)==="[object Array]"){for(w=v.length,l=0;l<w;l+=1)_[l]=f(l,v)||"null";return g=_.length===0?"[]":s?`[
`+s+_.join(`,
`+s)+`
`+E+"]":"["+_.join(",")+"]",s=E,g}if(a&&typeof a=="object")for(w=a.length,l=0;l<w;l+=1)typeof a[l]=="string"&&(d=a[l],g=f(d,v),g&&_.push(u(d)+(s?": ":":")+g));else Object.keys(v).forEach(function(C){var F=f(C,v);F&&_.push(u(C)+(s?": ":":")+F)});return g=_.length===0?"{}":s?`{
`+s+_.join(`,
`+s)+`
`+E+"}":"{"+_.join(",")+"}",s=E,g}}typeof r.stringify!="function"&&(r.stringify=function(c,h,l){var d;if(s="",n="",typeof l=="number")for(d=0;d<l;d+=1)n+=" ";else typeof l=="string"&&(n=l);if(a=h,h&&typeof h!="function"&&(typeof h!="object"||typeof h.length!="number"))throw new Error("JSON.stringify");return f("",{"":c})})})()})($a);var pl=$a.exports,zt=null;const dl=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,ml=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;var yl=function(t){var e={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(t!=null){if(t.strict===!0&&(e.strict=!0),t.storeAsString===!0&&(e.storeAsString=!0),e.alwaysParseAsBig=t.alwaysParseAsBig===!0?t.alwaysParseAsBig:!1,e.useNativeBigInt=t.useNativeBigInt===!0?t.useNativeBigInt:!1,typeof t.constructorAction<"u")if(t.constructorAction==="error"||t.constructorAction==="ignore"||t.constructorAction==="preserve")e.constructorAction=t.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${t.constructorAction}`);if(typeof t.protoAction<"u")if(t.protoAction==="error"||t.protoAction==="ignore"||t.protoAction==="preserve")e.protoAction=t.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${t.protoAction}`)}var r,o,s={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},n,i=function(w){throw{name:"SyntaxError",message:w,at:r,text:n}},a=function(w){return w&&w!==o&&i("Expected '"+w+"' instead of '"+o+"'"),o=n.charAt(r),r+=1,o},u=function(){var w,E="";for(o==="-"&&(E="-",a("-"));o>="0"&&o<="9";)E+=o,a();if(o===".")for(E+=".";a()&&o>="0"&&o<="9";)E+=o;if(o==="e"||o==="E")for(E+=o,a(),(o==="-"||o==="+")&&(E+=o,a());o>="0"&&o<="9";)E+=o,a();if(w=+E,!isFinite(w))i("Bad number");else return zt==null&&(zt=ka),E.length>15?e.storeAsString?E:e.useNativeBigInt?BigInt(E):new zt(E):e.alwaysParseAsBig?e.useNativeBigInt?BigInt(w):new zt(w):w},f=function(){var w,E,_="",v;if(o==='"')for(var y=r;a();){if(o==='"')return r-1>y&&(_+=n.substring(y,r-1)),a(),_;if(o==="\\"){if(r-1>y&&(_+=n.substring(y,r-1)),a(),o==="u"){for(v=0,E=0;E<4&&(w=parseInt(a(),16),!!isFinite(w));E+=1)v=v*16+w;_+=String.fromCharCode(v)}else if(typeof s[o]=="string")_+=s[o];else break;y=r}}i("Bad string")},c=function(){for(;o&&o<=" ";)a()},h=function(){switch(o){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null}i("Unexpected '"+o+"'")},l,d=function(){var w=[];if(o==="["){if(a("["),c(),o==="]")return a("]"),w;for(;o;){if(w.push(l()),c(),o==="]")return a("]"),w;a(","),c()}}i("Bad array")},g=function(){var w,E=Object.create(null);if(o==="{"){if(a("{"),c(),o==="}")return a("}"),E;for(;o;){if(w=f(),c(),a(":"),e.strict===!0&&Object.hasOwnProperty.call(E,w)&&i('Duplicate key "'+w+'"'),dl.test(w)===!0?e.protoAction==="error"?i("Object contains forbidden prototype property"):e.protoAction==="ignore"?l():E[w]=l():ml.test(w)===!0?e.constructorAction==="error"?i("Object contains forbidden constructor property"):e.constructorAction==="ignore"?l():E[w]=l():E[w]=l(),c(),o==="}")return a("}"),E;a(","),c()}}i("Bad object")};return l=function(){switch(c(),o){case"{":return g();case"[":return d();case'"':return f();case"-":return u();default:return o>="0"&&o<="9"?u():h()}},function(w,E){var _;return n=w+"",r=0,o=" ",_=l(),c(),o&&i("Syntax error"),typeof E=="function"?function v(y,C){var F,S=y[C];return S&&typeof S=="object"&&Object.keys(S).forEach(function(D){F=v(S,D),F!==void 0?S[D]=F:delete S[D]}),E.call(y,C,S)}({"":_},""):_}},gl=yl,ja=pl.stringify,qa=gl;mr.exports=function(t){return{parse:qa(t),stringify:ja}};mr.exports.parse=qa();mr.exports.stringify=ja;var Ba=mr.exports,yr={};const vl="@alicloud/pop-core",wl="1.8.0",El="AliCloud POP SDK core",bl="index.js",Sl="lib/rpc.d.ts",Ol={lint:"eslint --fix lib test",test:"mocha -R spec test/*.test.js","test-cov":"nyc -r=html -r=text -r=lcov mocha -t 3000 -R spec test/*.test.js","test-integration":"mocha -R spec test/*.integration.js",ci:"npm run lint && npm run test-cov"},Tl=["Aliyun","AliCloud","OpenAPI","POP","SDK","Core"],Cl="Jackson Tian",Dl="MIT",Fl={debug:"^3.1.0",httpx:"^2.1.2","json-bigint":"^1.0.0",kitx:"^1.2.1",xml2js:"^0.5.0"},Al=["lib","index.js"],_l={eslint:"^6.6.0","expect.js":"^0.3.1",mocha:"^4",muk:"^0.5.3",nyc:"^12.0.2",rewire:"^4.0.1"},Nl={test:"test"},xl={node:">=8.0.0"},Pl={type:"git",url:"git+https://github.com/aliyun/openapi-core-nodejs-sdk.git"},Il={url:"https://github.com/aliyun/openapi-core-nodejs-sdk/issues"},Ll="https://github.com/aliyun/openapi-core-nodejs-sdk#readme",Ml={name:vl,version:wl,description:El,main:bl,types:Sl,scripts:Ol,keywords:Tl,author:Cl,license:Dl,dependencies:Fl,files:Al,devDependencies:_l,directories:Nl,engines:xl,repository:Pl,bugs:Il,homepage:Ll},qo=it,di=Ml;yr.DEFAULT_UA=`AlibabaCloud (${qo.platform()}; ${qo.arch()}) Node.js/${process.version} Core/${di.version}`;yr.DEFAULT_CLIENT=`Node.js(${process.version}), ${di.name}: ${di.version}`;const Tt=cr,Bo=wt,Ze=Ti,$l=Ba,Uo=yr;function Ua(t){return t.slice(0,1).toUpperCase()+t.slice(1)}function Rl(t){for(var e=Object.keys(t),r={},o=0;o<e.length;o++){var s=e[o];r[Ua(s)]=t[s]}return r}function Xo(){var t=new Date,e=t.getUTCFullYear(),r=Ze.pad2(t.getUTCMonth()+1),o=Ze.pad2(t.getUTCDate()),s=Ze.pad2(t.getUTCHours()),n=Ze.pad2(t.getUTCMinutes()),i=Ze.pad2(t.getUTCSeconds());return`${e}-${r}-${o}T${s}:${n}:${i}Z`}function At(t){var e=encodeURIComponent(t);return e.replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function mi(t,e,r){for(var o=0;o<r.length;o++){var s=r[o];if(Array.isArray(s))mi(t,`${e}.${o+1}`,s);else if(s&&typeof s=="object"){const i=Object.keys(s);for(var n=0;n<i.length;n++)Array.isArray(s[i[n]])?mi(t,`${e}.${o+1}.${i[n]}`,s[i[n]]):t[`${e}.${o+1}.${i[n]}`]=s[i[n]]}else t[`${e}.${o+1}`]=s}}function kl(t){var e={},r=Object.keys(t);for(let n=0;n<r.length;n++){var o=r[n],s=t[o];Array.isArray(s)?mi(e,o,s):e[o]=s}return e}function jl(t){var e=[],r=kl(t),o=Object.keys(r).sort();for(let i=0;i<o.length;i++){var s=o[i],n=r[s];e.push([At(s),At(n)])}return e}function ln(t){for(var e=[],r=0;r<t.length;r++){var[o,s]=t[r];e.push(o+"="+s)}return e.join("&")}let ql=class{constructor(e,r){if(Tt(e,'must pass "config"'),Tt(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Tt(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else{Tt(e.accessKeyId,'must pass "config.accessKeyId"');var o=e.secretAccessKey||e.accessKeySecret;Tt(o,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=o,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:o,securityToken:e.securityToken})}}if(e.endpoint.endsWith("/")&&(e.endpoint=e.endpoint.slice(0,-1)),this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.verbose=r===!0,this.codes=new Set([200,"200","OK","Success","success"]),e.codes)for(var s of e.codes)this.codes.add(s);this.opts=e.opts||{};var n=this.endpoint.startsWith("https://")?ur:ar;this.keepAliveAgent=new n.Agent({keepAlive:!0,keepAliveMsecs:3e3})}async request(e,r={},o={}){const s=await this.credentialsProvider.getCredentials();o=Object.assign({headers:{"x-sdk-client":Uo.DEFAULT_CLIENT,"user-agent":Uo.DEFAULT_UA,"x-acs-action":e,"x-acs-version":this.apiVersion}},this.opts,o),o.formatAction!==!1&&(e=Ua(e)),o.formatParams!==!1&&(r=Rl(r));const n={Format:"JSON",Timestamp:Xo(),Version:this.apiVersion};s&&s.accessKeyId&&s.accessKeySecret&&(n.SignatureMethod="HMAC-SHA1",n.SignatureVersion="1.0",n.SignatureNonce=Ze.makeNonce(),n.AccessKeyId=s.accessKeyId,s.securityToken&&(n.SecurityToken=s.securityToken)),r=Object.assign({Action:e},n,r);const i=(o.method||"GET").toUpperCase(),a=jl(r);if(s&&s.accessKeyId&&s.accessKeySecret){const d=ln(a),g=`${i}&${At("/")}&${At(d)}`,w=s.accessKeySecret+"&",E=Ze.sha1(g,w,"base64");a.push(["Signature",At(E)])}const u=o.method==="POST"?`${this.endpoint}/`:`${this.endpoint}/?${ln(a)}`,f={url:u,request:null,response:null};o&&!o.agent&&(o.agent=this.keepAliveAgent),o.method==="POST"&&(o.headers=o.headers||{},o.headers["content-type"]="application/x-www-form-urlencoded",o.data=ln(a));const c=await Bo.request(u,o);f.request={headers:c.req.getHeaders?c.req.getHeaders():c.req._headers},f.response={statusCode:c.statusCode,headers:c.headers};const h=await Bo.read(c),l=$l.parse(h);if(l.Code&&!this.codes.has(l.Code)){const d=new Error(`${l.Message}, URL: ${u}`);throw d.name=l.Code+"Error",d.data=l,d.code=l.Code,d.url=u,d.entry=f,d}return this.verbose?[l,f]:l}_buildParams(){const e={Format:"JSON",SignatureMethod:"HMAC-SHA1",SignatureNonce:Ze.makeNonce(),SignatureVersion:"1.0",Timestamp:Xo(),AccessKeyId:this.accessKeyId,Version:this.apiVersion};return this.securityToken&&(e.SecurityToken=this.securityToken),e}};var Xa=ql,Ke={},fn={},Vo;function Ci(){return Vo||(Vo=1,(function(){fn.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(ne)),fn}var hn={},Ve={},ze={},zo;function Ge(){return zo||(zo=1,(function(){var t,e,r,o,s,n,i,a=[].slice,u={}.hasOwnProperty;t=function(){var f,c,h,l,d,g;if(g=arguments[0],d=2<=arguments.length?a.call(arguments,1):[],s(Object.assign))Object.assign.apply(null,arguments);else for(f=0,h=d.length;f<h;f++)if(l=d[f],l!=null)for(c in l)u.call(l,c)&&(g[c]=l[c]);return g},s=function(f){return!!f&&Object.prototype.toString.call(f)==="[object Function]"},n=function(f){var c;return!!f&&((c=typeof f)=="function"||c==="object")},r=function(f){return s(Array.isArray)?Array.isArray(f):Object.prototype.toString.call(f)==="[object Array]"},o=function(f){var c;if(r(f))return!f.length;for(c in f)if(u.call(f,c))return!1;return!0},i=function(f){var c,h;return n(f)&&(h=Object.getPrototypeOf(f))&&(c=h.constructor)&&typeof c=="function"&&c instanceof c&&Function.prototype.toString.call(c)===Function.prototype.toString.call(Object)},e=function(f){return s(f.valueOf)?f.valueOf():f},ze.assign=t,ze.isFunction=s,ze.isObject=n,ze.isArray=r,ze.isEmpty=o,ze.isPlainObject=i,ze.getValue=e}).call(ne)),ze}var pn={exports:{}},Wo;function Va(){return Wo||(Wo=1,(function(){pn.exports=function(){function t(){}return t.prototype.hasFeature=function(e,r){return!0},t.prototype.createDocumentType=function(e,r,o){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(e,r,o){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(e,r){throw new Error("This DOM method is not implemented.")},t}()}).call(ne)),pn.exports}var dn={exports:{}},mn={exports:{}},yn={exports:{}},Ho;function Bl(){return Ho||(Ho=1,(function(){yn.exports=function(){function t(){}return t.prototype.handleError=function(e){throw new Error(e)},t}()}).call(ne)),yn.exports}var gn={exports:{}},Go;function Ul(){return Go||(Go=1,(function(){gn.exports=function(){function t(e){this.arr=e||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(e){return this.arr[e]||null},t.prototype.contains=function(e){return this.arr.indexOf(e)!==-1},t}()}).call(ne)),gn.exports}var Yo;function Xl(){return Yo||(Yo=1,(function(){var t,e;t=Bl(),e=Ul(),mn.exports=function(){function r(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(r.prototype,"parameterNames",{get:function(){return new e(Object.keys(this.defaultParams))}}),r.prototype.getParameter=function(o){return this.params.hasOwnProperty(o)?this.params[o]:null},r.prototype.canSetParameter=function(o,s){return!0},r.prototype.setParameter=function(o,s){return s!=null?this.params[o]=s:delete this.params[o]},r}()}).call(ne)),mn.exports}var vn={exports:{}},wn={exports:{}},En={exports:{}},Jo;function ge(){return Jo||(Jo=1,(function(){En.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(ne)),En.exports}var bn={exports:{}},Ko;function za(){return Ko||(Ko=1,(function(){var t;t=ge(),$e(),bn.exports=function(){function e(r,o,s){if(this.parent=r,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),o==null)throw new Error("Missing attribute name. "+this.debugInfo(o));this.name=this.stringify.name(o),this.value=this.stringify.attValue(s),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(r){return this.value=r||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(r){return this.options.writer.attribute(this,this.options.writer.filterOptions(r))},e.prototype.debugInfo=function(r){return r=r||this.name,r==null?"parent: <"+this.parent.name+">":"attribute: {"+r+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(r){return!(r.namespaceURI!==this.namespaceURI||r.prefix!==this.prefix||r.localName!==this.localName||r.value!==this.value)},e}()}).call(ne)),bn.exports}var Sn={exports:{}},Qo;function Di(){return Qo||(Qo=1,(function(){Sn.exports=function(){function t(e){this.nodes=e}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(e){return this.nodes[e]},t.prototype.setNamedItem=function(e){var r;return r=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,r||null},t.prototype.removeNamedItem=function(e){var r;return r=this.nodes[e],delete this.nodes[e],r||null},t.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},t.prototype.getNamedItemNS=function(e,r){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(e,r){throw new Error("This DOM method is not implemented.")},t}()}).call(ne)),Sn.exports}var Zo;function Fi(){return Zo||(Zo=1,(function(){var t,e,r,o,s,n,i,a,u=function(c,h){for(var l in h)f.call(h,l)&&(c[l]=h[l]);function d(){this.constructor=c}return d.prototype=h.prototype,c.prototype=new d,c.__super__=h.prototype,c},f={}.hasOwnProperty;a=Ge(),i=a.isObject,n=a.isFunction,s=a.getValue,o=$e(),t=ge(),e=za(),r=Di(),wn.exports=function(c){u(h,c);function h(l,d,g){var w,E,_,v;if(h.__super__.constructor.call(this,l),d==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(d),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,g!=null&&this.attribute(g),l.type===t.Document&&(this.isRoot=!0,this.documentObject=l,l.rootObject=this,l.children)){for(v=l.children,E=0,_=v.length;E<_;E++)if(w=v[E],w.type===t.DocType){w.name=this.name;break}}}return Object.defineProperty(h.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(h.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(h.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(h.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(h.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new r(this.attribs)),this.attributeMap}}),h.prototype.clone=function(){var l,d,g,w;g=Object.create(this),g.isRoot&&(g.documentObject=null),g.attribs={},w=this.attribs;for(d in w)f.call(w,d)&&(l=w[d],g.attribs[d]=l.clone());return g.children=[],this.children.forEach(function(E){var _;return _=E.clone(),_.parent=g,g.children.push(_)}),g},h.prototype.attribute=function(l,d){var g,w;if(l!=null&&(l=s(l)),i(l))for(g in l)f.call(l,g)&&(w=l[g],this.attribute(g,w));else n(d)&&(d=d.apply()),this.options.keepNullAttributes&&d==null?this.attribs[l]=new e(this,l,""):d!=null&&(this.attribs[l]=new e(this,l,d));return this},h.prototype.removeAttribute=function(l){var d,g,w;if(l==null)throw new Error("Missing attribute name. "+this.debugInfo());if(l=s(l),Array.isArray(l))for(g=0,w=l.length;g<w;g++)d=l[g],delete this.attribs[d];else delete this.attribs[l];return this},h.prototype.toString=function(l){return this.options.writer.element(this,this.options.writer.filterOptions(l))},h.prototype.att=function(l,d){return this.attribute(l,d)},h.prototype.a=function(l,d){return this.attribute(l,d)},h.prototype.getAttribute=function(l){return this.attribs.hasOwnProperty(l)?this.attribs[l].value:null},h.prototype.setAttribute=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNode=function(l){return this.attribs.hasOwnProperty(l)?this.attribs[l]:null},h.prototype.setAttributeNode=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.removeAttributeNode=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagName=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNS=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setAttributeNS=function(l,d,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.removeAttributeNS=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNodeNS=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setAttributeNodeNS=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagNameNS=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.hasAttribute=function(l){return this.attribs.hasOwnProperty(l)},h.prototype.hasAttributeNS=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setIdAttribute=function(l,d){return this.attribs.hasOwnProperty(l)?this.attribs[l].isId:d},h.prototype.setIdAttributeNS=function(l,d,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setIdAttributeNode=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagName=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagNameNS=function(l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByClassName=function(l){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.isEqualNode=function(l){var d,g,w;if(!h.__super__.isEqualNode.apply(this,arguments).isEqualNode(l)||l.namespaceURI!==this.namespaceURI||l.prefix!==this.prefix||l.localName!==this.localName||l.attribs.length!==this.attribs.length)return!1;for(d=g=0,w=this.attribs.length-1;0<=w?g<=w:g>=w;d=0<=w?++g:--g)if(!this.attribs[d].isEqualNode(l.attribs[d]))return!1;return!0},h}(o)}).call(ne)),wn.exports}var On={exports:{}},Tn={exports:{}},es;function gr(){return es||(es=1,(function(){var t,e=function(o,s){for(var n in s)r.call(s,n)&&(o[n]=s[n]);function i(){this.constructor=o}return i.prototype=s.prototype,o.prototype=new i,o.__super__=s.prototype,o},r={}.hasOwnProperty;t=$e(),Tn.exports=function(o){e(s,o);function s(n){s.__super__.constructor.call(this,n),this.value=""}return Object.defineProperty(s.prototype,"data",{get:function(){return this.value},set:function(n){return this.value=n||""}}),Object.defineProperty(s.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(s.prototype,"textContent",{get:function(){return this.value},set:function(n){return this.value=n||""}}),s.prototype.clone=function(){return Object.create(this)},s.prototype.substringData=function(n,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.appendData=function(n){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.insertData=function(n,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.deleteData=function(n,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.replaceData=function(n,i,a){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.isEqualNode=function(n){return!(!s.__super__.isEqualNode.apply(this,arguments).isEqualNode(n)||n.data!==this.data)},s}(t)}).call(ne)),Tn.exports}var ts;function Ai(){return ts||(ts=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;t=ge(),e=gr(),On.exports=function(s){r(n,s);function n(i,a){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(a)}return n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return this.options.writer.cdata(this,this.options.writer.filterOptions(i))},n}(e)}).call(ne)),On.exports}var Cn={exports:{}},rs;function _i(){return rs||(rs=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;t=ge(),e=gr(),Cn.exports=function(s){r(n,s);function n(i,a){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(a)}return n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return this.options.writer.comment(this,this.options.writer.filterOptions(i))},n}(e)}).call(ne)),Cn.exports}var Dn={exports:{}},ns;function Ni(){return ns||(ns=1,(function(){var t,e,r,o=function(n,i){for(var a in i)s.call(i,a)&&(n[a]=i[a]);function u(){this.constructor=n}return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n},s={}.hasOwnProperty;r=Ge().isObject,e=$e(),t=ge(),Dn.exports=function(n){o(i,n);function i(a,u,f,c){var h;i.__super__.constructor.call(this,a),r(u)&&(h=u,u=h.version,f=h.encoding,c=h.standalone),u||(u="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(u),f!=null&&(this.encoding=this.stringify.xmlEncoding(f)),c!=null&&(this.standalone=this.stringify.xmlStandalone(c))}return i.prototype.toString=function(a){return this.options.writer.declaration(this,this.options.writer.filterOptions(a))},i}(e)}).call(ne)),Dn.exports}var Fn={exports:{}},An={exports:{}},is;function xi(){return is||(is=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;e=$e(),t=ge(),An.exports=function(s){r(n,s);function n(i,a,u,f,c,h){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(u==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(a));if(!f)throw new Error("Missing DTD attribute type. "+this.debugInfo(a));if(!c)throw new Error("Missing DTD attribute default. "+this.debugInfo(a));if(c.indexOf("#")!==0&&(c="#"+c),!c.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(a));if(h&&!c.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(a));this.elementName=this.stringify.name(a),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(u),this.attributeType=this.stringify.dtdAttType(f),h&&(this.defaultValue=this.stringify.dtdAttDefault(h)),this.defaultValueType=c}return n.prototype.toString=function(i){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(i))},n}(e)}).call(ne)),An.exports}var _n={exports:{}},os;function Pi(){return os||(os=1,(function(){var t,e,r,o=function(n,i){for(var a in i)s.call(i,a)&&(n[a]=i[a]);function u(){this.constructor=n}return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n},s={}.hasOwnProperty;r=Ge().isObject,e=$e(),t=ge(),_n.exports=function(n){o(i,n);function i(a,u,f,c){if(i.__super__.constructor.call(this,a),f==null)throw new Error("Missing DTD entity name. "+this.debugInfo(f));if(c==null)throw new Error("Missing DTD entity value. "+this.debugInfo(f));if(this.pe=!!u,this.name=this.stringify.name(f),this.type=t.EntityDeclaration,!r(c))this.value=this.stringify.dtdEntityValue(c),this.internal=!0;else{if(!c.pubID&&!c.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(f));if(c.pubID&&!c.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(f));if(this.internal=!1,c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID)),c.nData!=null&&(this.nData=this.stringify.dtdNData(c.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(f))}}return Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return null}}),i.prototype.toString=function(a){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(a))},i}(e)}).call(ne)),_n.exports}var Nn={exports:{}},ss;function Ii(){return ss||(ss=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;e=$e(),t=ge(),Nn.exports=function(s){r(n,s);function n(i,a,u){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing DTD element name. "+this.debugInfo());u||(u="(#PCDATA)"),Array.isArray(u)&&(u="("+u.join(",")+")"),this.name=this.stringify.name(a),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(u)}return n.prototype.toString=function(i){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(i))},n}(e)}).call(ne)),Nn.exports}var xn={exports:{}},as;function Li(){return as||(as=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;e=$e(),t=ge(),xn.exports=function(s){r(n,s);function n(i,a,u){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing DTD notation name. "+this.debugInfo(a));if(!u.pubID&&!u.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(a));this.name=this.stringify.name(a),this.type=t.NotationDeclaration,u.pubID!=null&&(this.pubID=this.stringify.dtdPubID(u.pubID)),u.sysID!=null&&(this.sysID=this.stringify.dtdSysID(u.sysID))}return Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),n.prototype.toString=function(i){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(i))},n}(e)}).call(ne)),xn.exports}var us;function Mi(){return us||(us=1,(function(){var t,e,r,o,s,n,i,a,u=function(c,h){for(var l in h)f.call(h,l)&&(c[l]=h[l]);function d(){this.constructor=c}return d.prototype=h.prototype,c.prototype=new d,c.__super__=h.prototype,c},f={}.hasOwnProperty;a=Ge().isObject,i=$e(),t=ge(),e=xi(),o=Pi(),r=Ii(),s=Li(),n=Di(),Fn.exports=function(c){u(h,c);function h(l,d,g){var w,E,_,v,y,C;if(h.__super__.constructor.call(this,l),this.type=t.DocType,l.children){for(v=l.children,E=0,_=v.length;E<_;E++)if(w=v[E],w.type===t.Element){this.name=w.name;break}}this.documentObject=l,a(d)&&(y=d,d=y.pubID,g=y.sysID),g==null&&(C=[d,g],g=C[0],d=C[1]),d!=null&&(this.pubID=this.stringify.dtdPubID(d)),g!=null&&(this.sysID=this.stringify.dtdSysID(g))}return Object.defineProperty(h.prototype,"entities",{get:function(){var l,d,g,w,E;for(w={},E=this.children,d=0,g=E.length;d<g;d++)l=E[d],l.type===t.EntityDeclaration&&!l.pe&&(w[l.name]=l);return new n(w)}}),Object.defineProperty(h.prototype,"notations",{get:function(){var l,d,g,w,E;for(w={},E=this.children,d=0,g=E.length;d<g;d++)l=E[d],l.type===t.NotationDeclaration&&(w[l.name]=l);return new n(w)}}),Object.defineProperty(h.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(h.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(h.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),h.prototype.element=function(l,d){var g;return g=new r(this,l,d),this.children.push(g),this},h.prototype.attList=function(l,d,g,w,E){var _;return _=new e(this,l,d,g,w,E),this.children.push(_),this},h.prototype.entity=function(l,d){var g;return g=new o(this,!1,l,d),this.children.push(g),this},h.prototype.pEntity=function(l,d){var g;return g=new o(this,!0,l,d),this.children.push(g),this},h.prototype.notation=function(l,d){var g;return g=new s(this,l,d),this.children.push(g),this},h.prototype.toString=function(l){return this.options.writer.docType(this,this.options.writer.filterOptions(l))},h.prototype.ele=function(l,d){return this.element(l,d)},h.prototype.att=function(l,d,g,w,E){return this.attList(l,d,g,w,E)},h.prototype.ent=function(l,d){return this.entity(l,d)},h.prototype.pent=function(l,d){return this.pEntity(l,d)},h.prototype.not=function(l,d){return this.notation(l,d)},h.prototype.up=function(){return this.root()||this.documentObject},h.prototype.isEqualNode=function(l){return!(!h.__super__.isEqualNode.apply(this,arguments).isEqualNode(l)||l.name!==this.name||l.publicId!==this.publicId||l.systemId!==this.systemId)},h}(i)}).call(ne)),Fn.exports}var Pn={exports:{}},cs;function $i(){return cs||(cs=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;t=ge(),e=$e(),Pn.exports=function(s){r(n,s);function n(i,a){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(a)}return n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return this.options.writer.raw(this,this.options.writer.filterOptions(i))},n}(e)}).call(ne)),Pn.exports}var In={exports:{}},ls;function Ri(){return ls||(ls=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;t=ge(),e=gr(),In.exports=function(s){r(n,s);function n(i,a){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(a)}return Object.defineProperty(n.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"wholeText",{get:function(){var i,a,u;for(u="",a=this.previousSibling;a;)u=a.data+u,a=a.previousSibling;for(u+=this.data,i=this.nextSibling;i;)u=u+i.data,i=i.nextSibling;return u}}),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return this.options.writer.text(this,this.options.writer.filterOptions(i))},n.prototype.splitText=function(i){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.replaceWholeText=function(i){throw new Error("This DOM method is not implemented."+this.debugInfo())},n}(e)}).call(ne)),In.exports}var Ln={exports:{}},fs;function ki(){return fs||(fs=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;t=ge(),e=gr(),Ln.exports=function(s){r(n,s);function n(i,a,u){if(n.__super__.constructor.call(this,i),a==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(a),this.name=this.target,u&&(this.value=this.stringify.insValue(u))}return n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(i))},n.prototype.isEqualNode=function(i){return!(!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(i)||i.target!==this.target)},n}(e)}).call(ne)),Ln.exports}var Mn={exports:{}},hs;function Wa(){return hs||(hs=1,(function(){var t,e,r=function(s,n){for(var i in n)o.call(n,i)&&(s[i]=n[i]);function a(){this.constructor=s}return a.prototype=n.prototype,s.prototype=new a,s.__super__=n.prototype,s},o={}.hasOwnProperty;e=$e(),t=ge(),Mn.exports=function(s){r(n,s);function n(i){n.__super__.constructor.call(this,i),this.type=t.Dummy}return n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return""},n}(e)}).call(ne)),Mn.exports}var $n={exports:{}},ps;function Vl(){return ps||(ps=1,(function(){$n.exports=function(){function t(e){this.nodes=e}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(e){return this.nodes[e]||null},t}()}).call(ne)),$n.exports}var Rn={exports:{}},ds;function zl(){return ds||(ds=1,(function(){Rn.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(ne)),Rn.exports}var ms;function $e(){return ms||(ms=1,(function(){var t,e,r,o,s,n,i,a,u,f,c,h,l,d,g,w,E,_={}.hasOwnProperty;E=Ge(),w=E.isObject,g=E.isFunction,d=E.isEmpty,l=E.getValue,a=null,r=null,o=null,s=null,n=null,c=null,h=null,f=null,i=null,e=null,u=null,t=null,vn.exports=function(){function v(y){this.parent=y,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,a||(a=Fi(),r=Ai(),o=_i(),s=Ni(),n=Mi(),c=$i(),h=Ri(),f=ki(),i=Wa(),e=ge(),u=Vl(),Di(),t=zl())}return Object.defineProperty(v.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(v.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(v.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(v.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(v.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(v.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(v.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(v.prototype,"previousSibling",{get:function(){var y;return y=this.parent.children.indexOf(this),this.parent.children[y-1]||null}}),Object.defineProperty(v.prototype,"nextSibling",{get:function(){var y;return y=this.parent.children.indexOf(this),this.parent.children[y+1]||null}}),Object.defineProperty(v.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(v.prototype,"textContent",{get:function(){var y,C,F,S,D;if(this.nodeType===e.Element||this.nodeType===e.DocumentFragment){for(D="",S=this.children,C=0,F=S.length;C<F;C++)y=S[C],y.textContent&&(D+=y.textContent);return D}else return null},set:function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),v.prototype.setParent=function(y){var C,F,S,D,T;for(this.parent=y,y&&(this.options=y.options,this.stringify=y.stringify),D=this.children,T=[],F=0,S=D.length;F<S;F++)C=D[F],T.push(C.setParent(this));return T},v.prototype.element=function(y,C,F){var S,D,T,p,b,A,I,V,q,B,z;if(A=null,C===null&&F==null&&(q=[{},null],C=q[0],F=q[1]),C==null&&(C={}),C=l(C),w(C)||(B=[C,F],F=B[0],C=B[1]),y!=null&&(y=l(y)),Array.isArray(y))for(T=0,I=y.length;T<I;T++)D=y[T],A=this.element(D);else if(g(y))A=this.element(y.apply());else if(w(y)){for(b in y)if(_.call(y,b))if(z=y[b],g(z)&&(z=z.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&b.indexOf(this.stringify.convertAttKey)===0)A=this.attribute(b.substr(this.stringify.convertAttKey.length),z);else if(!this.options.separateArrayItems&&Array.isArray(z)&&d(z))A=this.dummy();else if(w(z)&&d(z))A=this.element(b);else if(!this.options.keepNullNodes&&z==null)A=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(z))for(p=0,V=z.length;p<V;p++)D=z[p],S={},S[b]=D,A=this.element(S);else w(z)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&b.indexOf(this.stringify.convertTextKey)===0?A=this.element(z):(A=this.element(b),A.element(z)):A=this.element(b,z)}else!this.options.keepNullNodes&&F===null?A=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&y.indexOf(this.stringify.convertTextKey)===0?A=this.text(F):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&y.indexOf(this.stringify.convertCDataKey)===0?A=this.cdata(F):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&y.indexOf(this.stringify.convertCommentKey)===0?A=this.comment(F):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&y.indexOf(this.stringify.convertRawKey)===0?A=this.raw(F):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&y.indexOf(this.stringify.convertPIKey)===0?A=this.instruction(y.substr(this.stringify.convertPIKey.length),F):A=this.node(y,C,F);if(A==null)throw new Error("Could not create any elements with: "+y+". "+this.debugInfo());return A},v.prototype.insertBefore=function(y,C,F){var S,D,T,p,b;if(y!=null&&y.type)return T=y,p=C,T.setParent(this),p?(D=children.indexOf(p),b=children.splice(D),children.push(T),Array.prototype.push.apply(children,b)):children.push(T),T;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(y));return D=this.parent.children.indexOf(this),b=this.parent.children.splice(D),S=this.parent.element(y,C,F),Array.prototype.push.apply(this.parent.children,b),S},v.prototype.insertAfter=function(y,C,F){var S,D,T;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(y));return D=this.parent.children.indexOf(this),T=this.parent.children.splice(D+1),S=this.parent.element(y,C,F),Array.prototype.push.apply(this.parent.children,T),S},v.prototype.remove=function(){var y;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return y=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[y,y-y+1].concat([])),this.parent},v.prototype.node=function(y,C,F){var S,D;return y!=null&&(y=l(y)),C||(C={}),C=l(C),w(C)||(D=[C,F],F=D[0],C=D[1]),S=new a(this,y,C),F!=null&&S.text(F),this.children.push(S),S},v.prototype.text=function(y){var C;return w(y)&&this.element(y),C=new h(this,y),this.children.push(C),this},v.prototype.cdata=function(y){var C;return C=new r(this,y),this.children.push(C),this},v.prototype.comment=function(y){var C;return C=new o(this,y),this.children.push(C),this},v.prototype.commentBefore=function(y){var C,F;return C=this.parent.children.indexOf(this),F=this.parent.children.splice(C),this.parent.comment(y),Array.prototype.push.apply(this.parent.children,F),this},v.prototype.commentAfter=function(y){var C,F;return C=this.parent.children.indexOf(this),F=this.parent.children.splice(C+1),this.parent.comment(y),Array.prototype.push.apply(this.parent.children,F),this},v.prototype.raw=function(y){var C;return C=new c(this,y),this.children.push(C),this},v.prototype.dummy=function(){var y;return y=new i(this),y},v.prototype.instruction=function(y,C){var F,S,D,T,p;if(y!=null&&(y=l(y)),C!=null&&(C=l(C)),Array.isArray(y))for(T=0,p=y.length;T<p;T++)F=y[T],this.instruction(F);else if(w(y))for(F in y)_.call(y,F)&&(S=y[F],this.instruction(F,S));else g(C)&&(C=C.apply()),D=new f(this,y,C),this.children.push(D);return this},v.prototype.instructionBefore=function(y,C){var F,S;return F=this.parent.children.indexOf(this),S=this.parent.children.splice(F),this.parent.instruction(y,C),Array.prototype.push.apply(this.parent.children,S),this},v.prototype.instructionAfter=function(y,C){var F,S;return F=this.parent.children.indexOf(this),S=this.parent.children.splice(F+1),this.parent.instruction(y,C),Array.prototype.push.apply(this.parent.children,S),this},v.prototype.declaration=function(y,C,F){var S,D;return S=this.document(),D=new s(S,y,C,F),S.children.length===0?S.children.unshift(D):S.children[0].type===e.Declaration?S.children[0]=D:S.children.unshift(D),S.root()||S},v.prototype.dtd=function(y,C){var F,S,D,T,p,b,A,I,V,q;for(S=this.document(),D=new n(S,y,C),V=S.children,T=p=0,A=V.length;p<A;T=++p)if(F=V[T],F.type===e.DocType)return S.children[T]=D,D;for(q=S.children,T=b=0,I=q.length;b<I;T=++b)if(F=q[T],F.isRoot)return S.children.splice(T,0,D),D;return S.children.push(D),D},v.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},v.prototype.root=function(){var y;for(y=this;y;){if(y.type===e.Document)return y.rootObject;if(y.isRoot)return y;y=y.parent}},v.prototype.document=function(){var y;for(y=this;y;){if(y.type===e.Document)return y;y=y.parent}},v.prototype.end=function(y){return this.document().end(y)},v.prototype.prev=function(){var y;if(y=this.parent.children.indexOf(this),y<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[y-1]},v.prototype.next=function(){var y;if(y=this.parent.children.indexOf(this),y===-1||y===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[y+1]},v.prototype.importDocument=function(y){var C;return C=y.root().clone(),C.parent=this,C.isRoot=!1,this.children.push(C),this},v.prototype.debugInfo=function(y){var C,F;return y=y||this.name,y==null&&!((C=this.parent)!=null&&C.name)?"":y==null?"parent: <"+this.parent.name+">":(F=this.parent)!=null&&F.name?"node: <"+y+">, parent: <"+this.parent.name+">":"node: <"+y+">"},v.prototype.ele=function(y,C,F){return this.element(y,C,F)},v.prototype.nod=function(y,C,F){return this.node(y,C,F)},v.prototype.txt=function(y){return this.text(y)},v.prototype.dat=function(y){return this.cdata(y)},v.prototype.com=function(y){return this.comment(y)},v.prototype.ins=function(y,C){return this.instruction(y,C)},v.prototype.doc=function(){return this.document()},v.prototype.dec=function(y,C,F){return this.declaration(y,C,F)},v.prototype.e=function(y,C,F){return this.element(y,C,F)},v.prototype.n=function(y,C,F){return this.node(y,C,F)},v.prototype.t=function(y){return this.text(y)},v.prototype.d=function(y){return this.cdata(y)},v.prototype.c=function(y){return this.comment(y)},v.prototype.r=function(y){return this.raw(y)},v.prototype.i=function(y,C){return this.instruction(y,C)},v.prototype.u=function(){return this.up()},v.prototype.importXMLBuilder=function(y){return this.importDocument(y)},v.prototype.replaceChild=function(y,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.removeChild=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.appendChild=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.hasChildNodes=function(){return this.children.length!==0},v.prototype.cloneNode=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isSupported=function(y,C){return!0},v.prototype.hasAttributes=function(){return this.attribs.length!==0},v.prototype.compareDocumentPosition=function(y){var C,F;return C=this,C===y?0:this.document()!==y.document()?(F=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?F|=t.Preceding:F|=t.Following,F):C.isAncestor(y)?t.Contains|t.Preceding:C.isDescendant(y)?t.Contains|t.Following:C.isPreceding(y)?t.Preceding:t.Following},v.prototype.isSameNode=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.lookupPrefix=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isDefaultNamespace=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.lookupNamespaceURI=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.isEqualNode=function(y){var C,F,S;if(y.nodeType!==this.nodeType||y.children.length!==this.children.length)return!1;for(C=F=0,S=this.children.length-1;0<=S?F<=S:F>=S;C=0<=S?++F:--F)if(!this.children[C].isEqualNode(y.children[C]))return!1;return!0},v.prototype.getFeature=function(y,C){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.setUserData=function(y,C,F){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.getUserData=function(y){throw new Error("This DOM method is not implemented."+this.debugInfo())},v.prototype.contains=function(y){return y?y===this||this.isDescendant(y):!1},v.prototype.isDescendant=function(y){var C,F,S,D,T;for(T=this.children,S=0,D=T.length;S<D;S++)if(C=T[S],y===C||(F=C.isDescendant(y),F))return!0;return!1},v.prototype.isAncestor=function(y){return y.isDescendant(this)},v.prototype.isPreceding=function(y){var C,F;return C=this.treePosition(y),F=this.treePosition(this),C===-1||F===-1?!1:C<F},v.prototype.isFollowing=function(y){var C,F;return C=this.treePosition(y),F=this.treePosition(this),C===-1||F===-1?!1:C>F},v.prototype.treePosition=function(y){var C,F;return F=0,C=!1,this.foreachTreeNode(this.document(),function(S){if(F++,!C&&S===y)return C=!0}),C?F:-1},v.prototype.foreachTreeNode=function(y,C){var F,S,D,T,p;for(y||(y=this.document()),T=y.children,S=0,D=T.length;S<D;S++){if(F=T[S],p=C(F))return p;if(p=this.foreachTreeNode(F,C),p)return p}},v}()}).call(ne)),vn.exports}var kn={exports:{}},ys;function Ha(){return ys||(ys=1,(function(){var t=function(r,o){return function(){return r.apply(o,arguments)}},e={}.hasOwnProperty;kn.exports=function(){function r(o){this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this);var s,n,i;o||(o={}),this.options=o,this.options.version||(this.options.version="1.0"),n=o.stringify||{};for(s in n)e.call(n,s)&&(i=n[s],this[s]=i)}return r.prototype.name=function(o){return this.options.noValidation?o:this.assertLegalName(""+o||"")},r.prototype.text=function(o){return this.options.noValidation?o:this.assertLegalChar(this.textEscape(""+o||""))},r.prototype.cdata=function(o){return this.options.noValidation?o:(o=""+o||"",o=o.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(o))},r.prototype.comment=function(o){if(this.options.noValidation)return o;if(o=""+o||"",o.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+o);return this.assertLegalChar(o)},r.prototype.raw=function(o){return this.options.noValidation?o:""+o||""},r.prototype.attValue=function(o){return this.options.noValidation?o:this.assertLegalChar(this.attEscape(o=""+o||""))},r.prototype.insTarget=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.insValue=function(o){if(this.options.noValidation)return o;if(o=""+o||"",o.match(/\?>/))throw new Error("Invalid processing instruction value: "+o);return this.assertLegalChar(o)},r.prototype.xmlVersion=function(o){if(this.options.noValidation)return o;if(o=""+o||"",!o.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+o);return o},r.prototype.xmlEncoding=function(o){if(this.options.noValidation)return o;if(o=""+o||"",!o.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+o);return this.assertLegalChar(o)},r.prototype.xmlStandalone=function(o){return this.options.noValidation?o:o?"yes":"no"},r.prototype.dtdPubID=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.dtdSysID=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.dtdElementValue=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.dtdAttType=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.dtdAttDefault=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.dtdEntityValue=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.dtdNData=function(o){return this.options.noValidation?o:this.assertLegalChar(""+o||"")},r.prototype.convertAttKey="@",r.prototype.convertPIKey="?",r.prototype.convertTextKey="#text",r.prototype.convertCDataKey="#cdata",r.prototype.convertCommentKey="#comment",r.prototype.convertRawKey="#raw",r.prototype.assertLegalChar=function(o){var s,n;if(this.options.noValidation)return o;if(s="",this.options.version==="1.0"){if(s=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=o.match(s))throw new Error("Invalid character in string: "+o+" at index "+n.index)}else if(this.options.version==="1.1"&&(s=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=o.match(s)))throw new Error("Invalid character in string: "+o+" at index "+n.index);return o},r.prototype.assertLegalName=function(o){var s;if(this.options.noValidation)return o;if(this.assertLegalChar(o),s=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!o.match(s))throw new Error("Invalid character in name");return o},r.prototype.textEscape=function(o){var s;return this.options.noValidation?o:(s=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,o.replace(s,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},r.prototype.attEscape=function(o){var s;return this.options.noValidation?o:(s=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,o.replace(s,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},r}()}).call(ne)),kn.exports}var jn={exports:{}},qn={exports:{}},Bn={exports:{}},gs;function vr(){return gs||(gs=1,(function(){Bn.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(ne)),Bn.exports}var vs;function Ga(){return vs||(vs=1,(function(){var t,e,r,o={}.hasOwnProperty;r=Ge().assign,t=ge(),Ni(),Mi(),Ai(),_i(),Fi(),$i(),Ri(),ki(),Wa(),xi(),Ii(),Pi(),Li(),e=vr(),qn.exports=function(){function s(n){var i,a,u;n||(n={}),this.options=n,a=n.writer||{};for(i in a)o.call(a,i)&&(u=a[i],this["_"+i]=this[i],this[i]=u)}return s.prototype.filterOptions=function(n){var i,a,u,f,c,h,l,d;return n||(n={}),n=r({},this.options,n),i={writer:this},i.pretty=n.pretty||!1,i.allowEmpty=n.allowEmpty||!1,i.indent=(a=n.indent)!=null?a:"  ",i.newline=(u=n.newline)!=null?u:`
`,i.offset=(f=n.offset)!=null?f:0,i.dontPrettyTextNodes=(c=(h=n.dontPrettyTextNodes)!=null?h:n.dontprettytextnodes)!=null?c:0,i.spaceBeforeSlash=(l=(d=n.spaceBeforeSlash)!=null?d:n.spacebeforeslash)!=null?l:"",i.spaceBeforeSlash===!0&&(i.spaceBeforeSlash=" "),i.suppressPrettyCount=0,i.user={},i.state=e.None,i},s.prototype.indent=function(n,i,a){var u;return!i.pretty||i.suppressPrettyCount?"":i.pretty&&(u=(a||0)+i.offset+1,u>0)?new Array(u).join(i.indent):""},s.prototype.endline=function(n,i,a){return!i.pretty||i.suppressPrettyCount?"":i.newline},s.prototype.attribute=function(n,i,a){var u;return this.openAttribute(n,i,a),u=" "+n.name+'="'+n.value+'"',this.closeAttribute(n,i,a),u},s.prototype.cdata=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<![CDATA[",i.state=e.InsideTag,u+=n.value,i.state=e.CloseTag,u+="]]>"+this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.comment=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<!-- ",i.state=e.InsideTag,u+=n.value,i.state=e.CloseTag,u+=" -->"+this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.declaration=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<?xml",i.state=e.InsideTag,u+=' version="'+n.version+'"',n.encoding!=null&&(u+=' encoding="'+n.encoding+'"'),n.standalone!=null&&(u+=' standalone="'+n.standalone+'"'),i.state=e.CloseTag,u+=i.spaceBeforeSlash+"?>",u+=this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.docType=function(n,i,a){var u,f,c,h,l;if(a||(a=0),this.openNode(n,i,a),i.state=e.OpenTag,h=this.indent(n,i,a),h+="<!DOCTYPE "+n.root().name,n.pubID&&n.sysID?h+=' PUBLIC "'+n.pubID+'" "'+n.sysID+'"':n.sysID&&(h+=' SYSTEM "'+n.sysID+'"'),n.children.length>0){for(h+=" [",h+=this.endline(n,i,a),i.state=e.InsideTag,l=n.children,f=0,c=l.length;f<c;f++)u=l[f],h+=this.writeChildNode(u,i,a+1);i.state=e.CloseTag,h+="]"}return i.state=e.CloseTag,h+=i.spaceBeforeSlash+">",h+=this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),h},s.prototype.element=function(n,i,a){var u,f,c,h,l,d,g,w,E,_,v,y,C,F;a||(a=0),_=!1,v="",this.openNode(n,i,a),i.state=e.OpenTag,v+=this.indent(n,i,a)+"<"+n.name,y=n.attribs;for(E in y)o.call(y,E)&&(u=y[E],v+=this.attribute(u,i,a));if(c=n.children.length,h=c===0?null:n.children[0],c===0||n.children.every(function(S){return(S.type===t.Text||S.type===t.Raw)&&S.value===""}))i.allowEmpty?(v+=">",i.state=e.CloseTag,v+="</"+n.name+">"+this.endline(n,i,a)):(i.state=e.CloseTag,v+=i.spaceBeforeSlash+"/>"+this.endline(n,i,a));else if(i.pretty&&c===1&&(h.type===t.Text||h.type===t.Raw)&&h.value!=null)v+=">",i.state=e.InsideTag,i.suppressPrettyCount++,_=!0,v+=this.writeChildNode(h,i,a+1),i.suppressPrettyCount--,_=!1,i.state=e.CloseTag,v+="</"+n.name+">"+this.endline(n,i,a);else{if(i.dontPrettyTextNodes){for(C=n.children,l=0,g=C.length;l<g;l++)if(f=C[l],(f.type===t.Text||f.type===t.Raw)&&f.value!=null){i.suppressPrettyCount++,_=!0;break}}for(v+=">"+this.endline(n,i,a),i.state=e.InsideTag,F=n.children,d=0,w=F.length;d<w;d++)f=F[d],v+=this.writeChildNode(f,i,a+1);i.state=e.CloseTag,v+=this.indent(n,i,a)+"</"+n.name+">",_&&i.suppressPrettyCount--,v+=this.endline(n,i,a),i.state=e.None}return this.closeNode(n,i,a),v},s.prototype.writeChildNode=function(n,i,a){switch(n.type){case t.CData:return this.cdata(n,i,a);case t.Comment:return this.comment(n,i,a);case t.Element:return this.element(n,i,a);case t.Raw:return this.raw(n,i,a);case t.Text:return this.text(n,i,a);case t.ProcessingInstruction:return this.processingInstruction(n,i,a);case t.Dummy:return"";case t.Declaration:return this.declaration(n,i,a);case t.DocType:return this.docType(n,i,a);case t.AttributeDeclaration:return this.dtdAttList(n,i,a);case t.ElementDeclaration:return this.dtdElement(n,i,a);case t.EntityDeclaration:return this.dtdEntity(n,i,a);case t.NotationDeclaration:return this.dtdNotation(n,i,a);default:throw new Error("Unknown XML node type: "+n.constructor.name)}},s.prototype.processingInstruction=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<?",i.state=e.InsideTag,u+=n.target,n.value&&(u+=" "+n.value),i.state=e.CloseTag,u+=i.spaceBeforeSlash+"?>",u+=this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.raw=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a),i.state=e.InsideTag,u+=n.value,i.state=e.CloseTag,u+=this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.text=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a),i.state=e.InsideTag,u+=n.value,i.state=e.CloseTag,u+=this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.dtdAttList=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<!ATTLIST",i.state=e.InsideTag,u+=" "+n.elementName+" "+n.attributeName+" "+n.attributeType,n.defaultValueType!=="#DEFAULT"&&(u+=" "+n.defaultValueType),n.defaultValue&&(u+=' "'+n.defaultValue+'"'),i.state=e.CloseTag,u+=i.spaceBeforeSlash+">"+this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.dtdElement=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<!ELEMENT",i.state=e.InsideTag,u+=" "+n.name+" "+n.value,i.state=e.CloseTag,u+=i.spaceBeforeSlash+">"+this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.dtdEntity=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<!ENTITY",i.state=e.InsideTag,n.pe&&(u+=" %"),u+=" "+n.name,n.value?u+=' "'+n.value+'"':(n.pubID&&n.sysID?u+=' PUBLIC "'+n.pubID+'" "'+n.sysID+'"':n.sysID&&(u+=' SYSTEM "'+n.sysID+'"'),n.nData&&(u+=" NDATA "+n.nData)),i.state=e.CloseTag,u+=i.spaceBeforeSlash+">"+this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.dtdNotation=function(n,i,a){var u;return this.openNode(n,i,a),i.state=e.OpenTag,u=this.indent(n,i,a)+"<!NOTATION",i.state=e.InsideTag,u+=" "+n.name,n.pubID&&n.sysID?u+=' PUBLIC "'+n.pubID+'" "'+n.sysID+'"':n.pubID?u+=' PUBLIC "'+n.pubID+'"':n.sysID&&(u+=' SYSTEM "'+n.sysID+'"'),i.state=e.CloseTag,u+=i.spaceBeforeSlash+">"+this.endline(n,i,a),i.state=e.None,this.closeNode(n,i,a),u},s.prototype.openNode=function(n,i,a){},s.prototype.closeNode=function(n,i,a){},s.prototype.openAttribute=function(n,i,a){},s.prototype.closeAttribute=function(n,i,a){},s}()}).call(ne)),qn.exports}var ws;function ji(){return ws||(ws=1,(function(){var t,e=function(o,s){for(var n in s)r.call(s,n)&&(o[n]=s[n]);function i(){this.constructor=o}return i.prototype=s.prototype,o.prototype=new i,o.__super__=s.prototype,o},r={}.hasOwnProperty;t=Ga(),jn.exports=function(o){e(s,o);function s(n){s.__super__.constructor.call(this,n)}return s.prototype.document=function(n,i){var a,u,f,c,h;for(i=this.filterOptions(i),c="",h=n.children,u=0,f=h.length;u<f;u++)a=h[u],c+=this.writeChildNode(a,i,0);return i.pretty&&c.slice(-i.newline.length)===i.newline&&(c=c.slice(0,-i.newline.length)),c},s}(t)}).call(ne)),jn.exports}var Es;function Ya(){return Es||(Es=1,(function(){var t,e,r,o,s,n,i,a=function(f,c){for(var h in c)u.call(c,h)&&(f[h]=c[h]);function l(){this.constructor=f}return l.prototype=c.prototype,f.prototype=new l,f.__super__=c.prototype,f},u={}.hasOwnProperty;i=Ge().isPlainObject,r=Va(),e=Xl(),o=$e(),t=ge(),n=Ha(),s=ji(),dn.exports=function(f){a(c,f);function c(h){c.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new e,h||(h={}),h.writer||(h.writer=new s),this.options=h,this.stringify=new n(h)}return Object.defineProperty(c.prototype,"implementation",{value:new r}),Object.defineProperty(c.prototype,"doctype",{get:function(){var h,l,d,g;for(g=this.children,l=0,d=g.length;l<d;l++)if(h=g[l],h.type===t.DocType)return h;return null}}),Object.defineProperty(c.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(c.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(c.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(c.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(c.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(c.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(c.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(c.prototype,"origin",{get:function(){return null}}),Object.defineProperty(c.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(c.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(c.prototype,"contentType",{get:function(){return null}}),c.prototype.end=function(h){var l;return l={},h?i(h)&&(l=h,h=this.options.writer):h=this.options.writer,h.document(this,h.filterOptions(l))},c.prototype.toString=function(h){return this.options.writer.document(this,this.options.writer.filterOptions(h))},c.prototype.createElement=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createTextNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createComment=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createCDATASection=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createProcessingInstruction=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createAttribute=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createEntityReference=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.importNode=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createElementNS=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createAttributeNS=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByTagNameNS=function(h,l){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementById=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.adoptNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.renameNode=function(h,l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByClassName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createEvent=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createNodeIterator=function(h,l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createTreeWalker=function(h,l,d){throw new Error("This DOM method is not implemented."+this.debugInfo())},c}(o)}).call(ne)),dn.exports}var Un={exports:{}},bs;function Wl(){return bs||(bs=1,(function(){var t,e,r,o,s,n,i,a,u,f,c,h,l,d,g,w,E,_,v,y,C,F,S,D={}.hasOwnProperty;S=Ge(),C=S.isObject,y=S.isFunction,F=S.isPlainObject,v=S.getValue,t=ge(),h=Ya(),l=Fi(),o=Ai(),s=_i(),g=$i(),_=Ri(),d=ki(),f=Ni(),c=Mi(),n=xi(),a=Pi(),i=Ii(),u=Li(),r=za(),E=Ha(),w=ji(),e=vr(),Un.exports=function(){function T(p,b,A){var I;this.name="?xml",this.type=t.Document,p||(p={}),I={},p.writer?F(p.writer)&&(I=p.writer,p.writer=new w):p.writer=new w,this.options=p,this.writer=p.writer,this.writerOptions=this.writer.filterOptions(I),this.stringify=new E(p),this.onDataCallback=b||function(){},this.onEndCallback=A||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return T.prototype.createChildNode=function(p){var b,A,I,V,q,B,z,W;switch(p.type){case t.CData:this.cdata(p.value);break;case t.Comment:this.comment(p.value);break;case t.Element:I={},z=p.attribs;for(A in z)D.call(z,A)&&(b=z[A],I[A]=b.value);this.node(p.name,I);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(p.value);break;case t.Text:this.text(p.value);break;case t.ProcessingInstruction:this.instruction(p.target,p.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+p.constructor.name)}for(W=p.children,q=0,B=W.length;q<B;q++)V=W[q],this.createChildNode(V),V.type===t.Element&&this.up();return this},T.prototype.dummy=function(){return this},T.prototype.node=function(p,b,A){var I;if(p==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(p));return this.openCurrent(),p=v(p),b==null&&(b={}),b=v(b),C(b)||(I=[b,A],A=I[0],b=I[1]),this.currentNode=new l(this,p,b),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,A!=null&&this.text(A),this},T.prototype.element=function(p,b,A){var I,V,q,B,z,W;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(p)||C(p)||y(p))for(B=this.options.noValidation,this.options.noValidation=!0,W=new h(this.options).element("TEMP_ROOT"),W.element(p),this.options.noValidation=B,z=W.children,V=0,q=z.length;V<q;V++)I=z[V],this.createChildNode(I),I.type===t.Element&&this.up();else this.node(p,b,A);return this},T.prototype.attribute=function(p,b){var A,I;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(p));if(p!=null&&(p=v(p)),C(p))for(A in p)D.call(p,A)&&(I=p[A],this.attribute(A,I));else y(b)&&(b=b.apply()),this.options.keepNullAttributes&&b==null?this.currentNode.attribs[p]=new r(this,p,""):b!=null&&(this.currentNode.attribs[p]=new r(this,p,b));return this},T.prototype.text=function(p){var b;return this.openCurrent(),b=new _(this,p),this.onData(this.writer.text(b,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.cdata=function(p){var b;return this.openCurrent(),b=new o(this,p),this.onData(this.writer.cdata(b,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.comment=function(p){var b;return this.openCurrent(),b=new s(this,p),this.onData(this.writer.comment(b,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.raw=function(p){var b;return this.openCurrent(),b=new g(this,p),this.onData(this.writer.raw(b,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.instruction=function(p,b){var A,I,V,q,B;if(this.openCurrent(),p!=null&&(p=v(p)),b!=null&&(b=v(b)),Array.isArray(p))for(A=0,q=p.length;A<q;A++)I=p[A],this.instruction(I);else if(C(p))for(I in p)D.call(p,I)&&(V=p[I],this.instruction(I,V));else y(b)&&(b=b.apply()),B=new d(this,p,b),this.onData(this.writer.processingInstruction(B,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},T.prototype.declaration=function(p,b,A){var I;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return I=new f(this,p,b,A),this.onData(this.writer.declaration(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.doctype=function(p,b,A){if(this.openCurrent(),p==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new c(this,b,A),this.currentNode.rootNodeName=p,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},T.prototype.dtdElement=function(p,b){var A;return this.openCurrent(),A=new i(this,p,b),this.onData(this.writer.dtdElement(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.attList=function(p,b,A,I,V){var q;return this.openCurrent(),q=new n(this,p,b,A,I,V),this.onData(this.writer.dtdAttList(q,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.entity=function(p,b){var A;return this.openCurrent(),A=new a(this,!1,p,b),this.onData(this.writer.dtdEntity(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.pEntity=function(p,b){var A;return this.openCurrent(),A=new a(this,!0,p,b),this.onData(this.writer.dtdEntity(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.notation=function(p,b){var A;return this.openCurrent(),A=new u(this,p,b),this.onData(this.writer.dtdNotation(A,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},T.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},T.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},T.prototype.openNode=function(p){var b,A,I,V;if(!p.isOpen){if(!this.root&&this.currentLevel===0&&p.type===t.Element&&(this.root=p),A="",p.type===t.Element){this.writerOptions.state=e.OpenTag,A=this.writer.indent(p,this.writerOptions,this.currentLevel)+"<"+p.name,V=p.attribs;for(I in V)D.call(V,I)&&(b=V[I],A+=this.writer.attribute(b,this.writerOptions,this.currentLevel));A+=(p.children?">":"/>")+this.writer.endline(p,this.writerOptions,this.currentLevel),this.writerOptions.state=e.InsideTag}else this.writerOptions.state=e.OpenTag,A=this.writer.indent(p,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+p.rootNodeName,p.pubID&&p.sysID?A+=' PUBLIC "'+p.pubID+'" "'+p.sysID+'"':p.sysID&&(A+=' SYSTEM "'+p.sysID+'"'),p.children?(A+=" [",this.writerOptions.state=e.InsideTag):(this.writerOptions.state=e.CloseTag,A+=">"),A+=this.writer.endline(p,this.writerOptions,this.currentLevel);return this.onData(A,this.currentLevel),p.isOpen=!0}},T.prototype.closeNode=function(p){var b;if(!p.isClosed)return b="",this.writerOptions.state=e.CloseTag,p.type===t.Element?b=this.writer.indent(p,this.writerOptions,this.currentLevel)+"</"+p.name+">"+this.writer.endline(p,this.writerOptions,this.currentLevel):b=this.writer.indent(p,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(p,this.writerOptions,this.currentLevel),this.writerOptions.state=e.None,this.onData(b,this.currentLevel),p.isClosed=!0},T.prototype.onData=function(p,b){return this.documentStarted=!0,this.onDataCallback(p,b+1)},T.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},T.prototype.debugInfo=function(p){return p==null?"":"node: <"+p+">"},T.prototype.ele=function(){return this.element.apply(this,arguments)},T.prototype.nod=function(p,b,A){return this.node(p,b,A)},T.prototype.txt=function(p){return this.text(p)},T.prototype.dat=function(p){return this.cdata(p)},T.prototype.com=function(p){return this.comment(p)},T.prototype.ins=function(p,b){return this.instruction(p,b)},T.prototype.dec=function(p,b,A){return this.declaration(p,b,A)},T.prototype.dtd=function(p,b,A){return this.doctype(p,b,A)},T.prototype.e=function(p,b,A){return this.element(p,b,A)},T.prototype.n=function(p,b,A){return this.node(p,b,A)},T.prototype.t=function(p){return this.text(p)},T.prototype.d=function(p){return this.cdata(p)},T.prototype.c=function(p){return this.comment(p)},T.prototype.r=function(p){return this.raw(p)},T.prototype.i=function(p,b){return this.instruction(p,b)},T.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},T.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},T.prototype.ent=function(p,b){return this.entity(p,b)},T.prototype.pent=function(p,b){return this.pEntity(p,b)},T.prototype.not=function(p,b){return this.notation(p,b)},T}()}).call(ne)),Un.exports}var Xn={exports:{}},Ss;function Hl(){return Ss||(Ss=1,(function(){var t,e,r,o=function(n,i){for(var a in i)s.call(i,a)&&(n[a]=i[a]);function u(){this.constructor=n}return u.prototype=i.prototype,n.prototype=new u,n.__super__=i.prototype,n},s={}.hasOwnProperty;t=ge(),r=Ga(),e=vr(),Xn.exports=function(n){o(i,n);function i(a,u){this.stream=a,i.__super__.constructor.call(this,u)}return i.prototype.endline=function(a,u,f){return a.isLastRootNode&&u.state===e.CloseTag?"":i.__super__.endline.call(this,a,u,f)},i.prototype.document=function(a,u){var f,c,h,l,d,g,w,E,_;for(w=a.children,c=h=0,d=w.length;h<d;c=++h)f=w[c],f.isLastRootNode=c===a.children.length-1;for(u=this.filterOptions(u),E=a.children,_=[],l=0,g=E.length;l<g;l++)f=E[l],_.push(this.writeChildNode(f,u,0));return _},i.prototype.attribute=function(a,u,f){return this.stream.write(i.__super__.attribute.call(this,a,u,f))},i.prototype.cdata=function(a,u,f){return this.stream.write(i.__super__.cdata.call(this,a,u,f))},i.prototype.comment=function(a,u,f){return this.stream.write(i.__super__.comment.call(this,a,u,f))},i.prototype.declaration=function(a,u,f){return this.stream.write(i.__super__.declaration.call(this,a,u,f))},i.prototype.docType=function(a,u,f){var c,h,l,d;if(f||(f=0),this.openNode(a,u,f),u.state=e.OpenTag,this.stream.write(this.indent(a,u,f)),this.stream.write("<!DOCTYPE "+a.root().name),a.pubID&&a.sysID?this.stream.write(' PUBLIC "'+a.pubID+'" "'+a.sysID+'"'):a.sysID&&this.stream.write(' SYSTEM "'+a.sysID+'"'),a.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(a,u,f)),u.state=e.InsideTag,d=a.children,h=0,l=d.length;h<l;h++)c=d[h],this.writeChildNode(c,u,f+1);u.state=e.CloseTag,this.stream.write("]")}return u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+">"),this.stream.write(this.endline(a,u,f)),u.state=e.None,this.closeNode(a,u,f)},i.prototype.element=function(a,u,f){var c,h,l,d,g,w,E,_,v;f||(f=0),this.openNode(a,u,f),u.state=e.OpenTag,this.stream.write(this.indent(a,u,f)+"<"+a.name),_=a.attribs;for(E in _)s.call(_,E)&&(c=_[E],this.attribute(c,u,f));if(l=a.children.length,d=l===0?null:a.children[0],l===0||a.children.every(function(y){return(y.type===t.Text||y.type===t.Raw)&&y.value===""}))u.allowEmpty?(this.stream.write(">"),u.state=e.CloseTag,this.stream.write("</"+a.name+">")):(u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+"/>"));else if(u.pretty&&l===1&&(d.type===t.Text||d.type===t.Raw)&&d.value!=null)this.stream.write(">"),u.state=e.InsideTag,u.suppressPrettyCount++,this.writeChildNode(d,u,f+1),u.suppressPrettyCount--,u.state=e.CloseTag,this.stream.write("</"+a.name+">");else{for(this.stream.write(">"+this.endline(a,u,f)),u.state=e.InsideTag,v=a.children,g=0,w=v.length;g<w;g++)h=v[g],this.writeChildNode(h,u,f+1);u.state=e.CloseTag,this.stream.write(this.indent(a,u,f)+"</"+a.name+">")}return this.stream.write(this.endline(a,u,f)),u.state=e.None,this.closeNode(a,u,f)},i.prototype.processingInstruction=function(a,u,f){return this.stream.write(i.__super__.processingInstruction.call(this,a,u,f))},i.prototype.raw=function(a,u,f){return this.stream.write(i.__super__.raw.call(this,a,u,f))},i.prototype.text=function(a,u,f){return this.stream.write(i.__super__.text.call(this,a,u,f))},i.prototype.dtdAttList=function(a,u,f){return this.stream.write(i.__super__.dtdAttList.call(this,a,u,f))},i.prototype.dtdElement=function(a,u,f){return this.stream.write(i.__super__.dtdElement.call(this,a,u,f))},i.prototype.dtdEntity=function(a,u,f){return this.stream.write(i.__super__.dtdEntity.call(this,a,u,f))},i.prototype.dtdNotation=function(a,u,f){return this.stream.write(i.__super__.dtdNotation.call(this,a,u,f))},i}(r)}).call(ne)),Xn.exports}var Os;function Gl(){return Os||(Os=1,(function(){var t,e,r,o,s,n,i,a,u,f;f=Ge(),a=f.assign,u=f.isFunction,r=Va(),o=Ya(),s=Wl(),i=ji(),n=Hl(),t=ge(),e=vr(),Ve.create=function(c,h,l,d){var g,w;if(c==null)throw new Error("Root element needs a name.");return d=a({},h,l,d),g=new o(d),w=g.element(c),d.headless||(g.declaration(d),(d.pubID!=null||d.sysID!=null)&&g.dtd(d)),w},Ve.begin=function(c,h,l){var d;return u(c)&&(d=[c,h],h=d[0],l=d[1],c={}),h?new s(c,h,l):new o(c)},Ve.stringWriter=function(c){return new i(c)},Ve.streamWriter=function(c,h){return new n(c,h)},Ve.implementation=new r,Ve.nodeType=t,Ve.writerState=e}).call(ne)),Ve}var Ts;function Yl(){return Ts||(Ts=1,(function(){var t,e,r,o,s,n={}.hasOwnProperty;t=Gl(),e=Ci().defaults,o=function(i){return typeof i=="string"&&(i.indexOf("&")>=0||i.indexOf(">")>=0||i.indexOf("<")>=0)},s=function(i){return"<![CDATA["+r(i)+"]]>"},r=function(i){return i.replace("]]>","]]]]><![CDATA[>")},hn.Builder=function(){function i(a){var u,f,c;this.options={},f=e["0.2"];for(u in f)n.call(f,u)&&(c=f[u],this.options[u]=c);for(u in a)n.call(a,u)&&(c=a[u],this.options[u]=c)}return i.prototype.buildObject=function(a){var u,f,c,h,l;return u=this.options.attrkey,f=this.options.charkey,Object.keys(a).length===1&&this.options.rootName===e["0.2"].rootName?(l=Object.keys(a)[0],a=a[l]):l=this.options.rootName,c=function(d){return function(g,w){var E,_,v,y,C,F;if(typeof w!="object")d.options.cdata&&o(w)?g.raw(s(w)):g.txt(w);else if(Array.isArray(w)){for(y in w)if(n.call(w,y)){_=w[y];for(C in _)v=_[C],g=c(g.ele(C),v).up()}}else for(C in w)if(n.call(w,C))if(_=w[C],C===u){if(typeof _=="object")for(E in _)F=_[E],g=g.att(E,F)}else if(C===f)d.options.cdata&&o(_)?g=g.raw(s(_)):g=g.txt(_);else if(Array.isArray(_))for(y in _)n.call(_,y)&&(v=_[y],typeof v=="string"?d.options.cdata&&o(v)?g=g.ele(C).raw(s(v)).up():g=g.ele(C,v).up():g=c(g.ele(C),v).up());else typeof _=="object"?g=c(g.ele(C),_).up():typeof _=="string"&&d.options.cdata&&o(_)?g=g.ele(C).raw(s(_)).up():(_==null&&(_=""),g=g.ele(C,_.toString()).up());return g}}(this),h=t.create(l,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(h,a).end(this.options.renderOpts)},i}()}).call(ne)),hn}var Vn={},zn={},Cs;function Jl(){return Cs||(Cs=1,function(t){(function(e){e.parser=function(N,O){return new o(N,O)},e.SAXParser=o,e.SAXStream=c,e.createStream=f,e.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function o(N,O){if(!(this instanceof o))return new o(N,O);var H=this;n(H),H.q=H.c="",H.bufferCheckPosition=e.MAX_BUFFER_LENGTH,H.opt=O||{},H.opt.lowercase=H.opt.lowercase||H.opt.lowercasetags,H.looseCase=H.opt.lowercase?"toLowerCase":"toUpperCase",H.tags=[],H.closed=H.closedRoot=H.sawRoot=!1,H.tag=H.error=null,H.strict=!!N,H.noscript=!!(N||H.opt.noscript),H.state=p.BEGIN,H.strictEntities=H.opt.strictEntities,H.ENTITIES=H.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),H.attribList=[],H.opt.xmlns&&(H.ns=Object.create(w)),H.opt.unquotedAttributeValues===void 0&&(H.opt.unquotedAttributeValues=!N),H.trackPosition=H.opt.position!==!1,H.trackPosition&&(H.position=H.line=H.column=0),A(H,"onready")}Object.create||(Object.create=function(N){function O(){}O.prototype=N;var H=new O;return H}),Object.keys||(Object.keys=function(N){var O=[];for(var H in N)N.hasOwnProperty(H)&&O.push(H);return O});function s(N){for(var O=Math.max(e.MAX_BUFFER_LENGTH,10),H=0,m=0,x=r.length;m<x;m++){var P=N[r[m]].length;if(P>O)switch(r[m]){case"textNode":V(N);break;case"cdata":I(N,"oncdata",N.cdata),N.cdata="";break;case"script":I(N,"onscript",N.script),N.script="";break;default:B(N,"Max buffer length exceeded: "+r[m])}H=Math.max(H,P)}var k=e.MAX_BUFFER_LENGTH-H;N.bufferCheckPosition=k+N.position}function n(N){for(var O=0,H=r.length;O<H;O++)N[r[O]]=""}function i(N){V(N),N.cdata!==""&&(I(N,"oncdata",N.cdata),N.cdata=""),N.script!==""&&(I(N,"onscript",N.script),N.script="")}o.prototype={end:function(){z(this)},write:Re,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){i(this)}};var a;try{a=require("stream").Stream}catch{a=function(){}}a||(a=function(){});var u=e.EVENTS.filter(function(N){return N!=="error"&&N!=="end"});function f(N,O){return new c(N,O)}function c(N,O){if(!(this instanceof c))return new c(N,O);a.apply(this),this._parser=new o(N,O),this.writable=!0,this.readable=!0;var H=this;this._parser.onend=function(){H.emit("end")},this._parser.onerror=function(m){H.emit("error",m),H._parser.error=null},this._decoder=null,u.forEach(function(m){Object.defineProperty(H,"on"+m,{get:function(){return H._parser["on"+m]},set:function(x){if(!x)return H.removeAllListeners(m),H._parser["on"+m]=x,x;H.on(m,x)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(a.prototype,{constructor:{value:c}}),c.prototype.write=function(N){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(N)){if(!this._decoder){var O=Qu.StringDecoder;this._decoder=new O("utf8")}N=this._decoder.write(N)}return this._parser.write(N.toString()),this.emit("data",N),!0},c.prototype.end=function(N){return N&&N.length&&this.write(N),this._parser.end(),!0},c.prototype.on=function(N,O){var H=this;return!H._parser["on"+N]&&u.indexOf(N)!==-1&&(H._parser["on"+N]=function(){var m=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);m.splice(0,0,N),H.emit.apply(H,m)}),a.prototype.on.call(H,N,O)};var h="[CDATA[",l="DOCTYPE",d="http://www.w3.org/XML/1998/namespace",g="http://www.w3.org/2000/xmlns/",w={xml:d,xmlns:g},E=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,v=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function C(N){return N===" "||N===`
`||N==="\r"||N==="	"}function F(N){return N==='"'||N==="'"}function S(N){return N===">"||C(N)}function D(N,O){return N.test(O)}function T(N,O){return!D(N,O)}var p=0;e.STATE={BEGIN:p++,BEGIN_WHITESPACE:p++,TEXT:p++,TEXT_ENTITY:p++,OPEN_WAKA:p++,SGML_DECL:p++,SGML_DECL_QUOTED:p++,DOCTYPE:p++,DOCTYPE_QUOTED:p++,DOCTYPE_DTD:p++,DOCTYPE_DTD_QUOTED:p++,COMMENT_STARTING:p++,COMMENT:p++,COMMENT_ENDING:p++,COMMENT_ENDED:p++,CDATA:p++,CDATA_ENDING:p++,CDATA_ENDING_2:p++,PROC_INST:p++,PROC_INST_BODY:p++,PROC_INST_ENDING:p++,OPEN_TAG:p++,OPEN_TAG_SLASH:p++,ATTRIB:p++,ATTRIB_NAME:p++,ATTRIB_NAME_SAW_WHITE:p++,ATTRIB_VALUE:p++,ATTRIB_VALUE_QUOTED:p++,ATTRIB_VALUE_CLOSED:p++,ATTRIB_VALUE_UNQUOTED:p++,ATTRIB_VALUE_ENTITY_Q:p++,ATTRIB_VALUE_ENTITY_U:p++,CLOSE_TAG:p++,CLOSE_TAG_SAW_WHITE:p++,SCRIPT:p++,SCRIPT_ENDING:p++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(N){var O=e.ENTITIES[N],H=typeof O=="number"?String.fromCharCode(O):O;e.ENTITIES[N]=H});for(var b in e.STATE)e.STATE[e.STATE[b]]=b;p=e.STATE;function A(N,O,H){N[O]&&N[O](H)}function I(N,O,H){N.textNode&&V(N),A(N,O,H)}function V(N){N.textNode=q(N.opt,N.textNode),N.textNode&&A(N,"ontext",N.textNode),N.textNode=""}function q(N,O){return N.trim&&(O=O.trim()),N.normalize&&(O=O.replace(/\s+/g," ")),O}function B(N,O){return V(N),N.trackPosition&&(O+=`
Line: `+N.line+`
Column: `+N.column+`
Char: `+N.c),O=new Error(O),N.error=O,A(N,"onerror",O),N}function z(N){return N.sawRoot&&!N.closedRoot&&W(N,"Unclosed root tag"),N.state!==p.BEGIN&&N.state!==p.BEGIN_WHITESPACE&&N.state!==p.TEXT&&B(N,"Unexpected end"),V(N),N.c="",N.closed=!0,A(N,"onend"),o.call(N,N.strict,N.opt),N}function W(N,O){if(typeof N!="object"||!(N instanceof o))throw new Error("bad call to strictFail");N.strict&&B(N,O)}function J(N){N.strict||(N.tagName=N.tagName[N.looseCase]());var O=N.tags[N.tags.length-1]||N,H=N.tag={name:N.tagName,attributes:{}};N.opt.xmlns&&(H.ns=O.ns),N.attribList.length=0,I(N,"onopentagstart",H)}function K(N,O){var H=N.indexOf(":"),m=H<0?["",N]:N.split(":"),x=m[0],P=m[1];return O&&N==="xmlns"&&(x="xmlns",P=""),{prefix:x,local:P}}function Q(N){if(N.strict||(N.attribName=N.attribName[N.looseCase]()),N.attribList.indexOf(N.attribName)!==-1||N.tag.attributes.hasOwnProperty(N.attribName)){N.attribName=N.attribValue="";return}if(N.opt.xmlns){var O=K(N.attribName,!0),H=O.prefix,m=O.local;if(H==="xmlns")if(m==="xml"&&N.attribValue!==d)W(N,"xml: prefix must be bound to "+d+`
Actual: `+N.attribValue);else if(m==="xmlns"&&N.attribValue!==g)W(N,"xmlns: prefix must be bound to "+g+`
Actual: `+N.attribValue);else{var x=N.tag,P=N.tags[N.tags.length-1]||N;x.ns===P.ns&&(x.ns=Object.create(P.ns)),x.ns[m]=N.attribValue}N.attribList.push([N.attribName,N.attribValue])}else N.tag.attributes[N.attribName]=N.attribValue,I(N,"onattribute",{name:N.attribName,value:N.attribValue});N.attribName=N.attribValue=""}function re(N,O){if(N.opt.xmlns){var H=N.tag,m=K(N.tagName);H.prefix=m.prefix,H.local=m.local,H.uri=H.ns[m.prefix]||"",H.prefix&&!H.uri&&(W(N,"Unbound namespace prefix: "+JSON.stringify(N.tagName)),H.uri=m.prefix);var x=N.tags[N.tags.length-1]||N;H.ns&&x.ns!==H.ns&&Object.keys(H.ns).forEach(function(ee){I(N,"onopennamespace",{prefix:ee,uri:H.ns[ee]})});for(var P=0,k=N.attribList.length;P<k;P++){var M=N.attribList[P],$=M[0],X=M[1],L=K($,!0),R=L.prefix,U=L.local,j=R===""?"":H.ns[R]||"",G={name:$,value:X,prefix:R,local:U,uri:j};R&&R!=="xmlns"&&!j&&(W(N,"Unbound namespace prefix: "+JSON.stringify(R)),G.uri=R),N.tag.attributes[$]=G,I(N,"onattribute",G)}N.attribList.length=0}N.tag.isSelfClosing=!!O,N.sawRoot=!0,N.tags.push(N.tag),I(N,"onopentag",N.tag),O||(!N.noscript&&N.tagName.toLowerCase()==="script"?N.state=p.SCRIPT:N.state=p.TEXT,N.tag=null,N.tagName=""),N.attribName=N.attribValue="",N.attribList.length=0}function ae(N){if(!N.tagName){W(N,"Weird empty close tag."),N.textNode+="</>",N.state=p.TEXT;return}if(N.script){if(N.tagName!=="script"){N.script+="</"+N.tagName+">",N.tagName="",N.state=p.SCRIPT;return}I(N,"onscript",N.script),N.script=""}var O=N.tags.length,H=N.tagName;N.strict||(H=H[N.looseCase]());for(var m=H;O--;){var x=N.tags[O];if(x.name!==m)W(N,"Unexpected close tag");else break}if(O<0){W(N,"Unmatched closing tag: "+N.tagName),N.textNode+="</"+N.tagName+">",N.state=p.TEXT;return}N.tagName=H;for(var P=N.tags.length;P-- >O;){var k=N.tag=N.tags.pop();N.tagName=N.tag.name,I(N,"onclosetag",N.tagName);var M={};for(var $ in k.ns)M[$]=k.ns[$];var X=N.tags[N.tags.length-1]||N;N.opt.xmlns&&k.ns!==X.ns&&Object.keys(k.ns).forEach(function(L){var R=k.ns[L];I(N,"onclosenamespace",{prefix:L,uri:R})})}O===0&&(N.closedRoot=!0),N.tagName=N.attribValue=N.attribName="",N.attribList.length=0,N.state=p.TEXT}function pe(N){var O=N.entity,H=O.toLowerCase(),m,x="";return N.ENTITIES[O]?N.ENTITIES[O]:N.ENTITIES[H]?N.ENTITIES[H]:(O=H,O.charAt(0)==="#"&&(O.charAt(1)==="x"?(O=O.slice(2),m=parseInt(O,16),x=m.toString(16)):(O=O.slice(1),m=parseInt(O,10),x=m.toString(10))),O=O.replace(/^0+/,""),isNaN(m)||x.toLowerCase()!==O?(W(N,"Invalid character entity"),"&"+N.entity+";"):String.fromCodePoint(m))}function Y(N,O){O==="<"?(N.state=p.OPEN_WAKA,N.startTagPosition=N.position):C(O)||(W(N,"Non-whitespace before first tag."),N.textNode=O,N.state=p.TEXT)}function ve(N,O){var H="";return O<N.length&&(H=N.charAt(O)),H}function Re(N){var O=this;if(this.error)throw this.error;if(O.closed)return B(O,"Cannot write after close. Assign an onready handler.");if(N===null)return z(O);typeof N=="object"&&(N=N.toString());for(var H=0,m="";m=ve(N,H++),O.c=m,!!m;)switch(O.trackPosition&&(O.position++,m===`
`?(O.line++,O.column=0):O.column++),O.state){case p.BEGIN:if(O.state=p.BEGIN_WHITESPACE,m==="\uFEFF")continue;Y(O,m);continue;case p.BEGIN_WHITESPACE:Y(O,m);continue;case p.TEXT:if(O.sawRoot&&!O.closedRoot){for(var x=H-1;m&&m!=="<"&&m!=="&";)m=ve(N,H++),m&&O.trackPosition&&(O.position++,m===`
`?(O.line++,O.column=0):O.column++);O.textNode+=N.substring(x,H-1)}m==="<"&&!(O.sawRoot&&O.closedRoot&&!O.strict)?(O.state=p.OPEN_WAKA,O.startTagPosition=O.position):(!C(m)&&(!O.sawRoot||O.closedRoot)&&W(O,"Text data outside of root node."),m==="&"?O.state=p.TEXT_ENTITY:O.textNode+=m);continue;case p.SCRIPT:m==="<"?O.state=p.SCRIPT_ENDING:O.script+=m;continue;case p.SCRIPT_ENDING:m==="/"?O.state=p.CLOSE_TAG:(O.script+="<"+m,O.state=p.SCRIPT);continue;case p.OPEN_WAKA:if(m==="!")O.state=p.SGML_DECL,O.sgmlDecl="";else if(!C(m))if(D(E,m))O.state=p.OPEN_TAG,O.tagName=m;else if(m==="/")O.state=p.CLOSE_TAG,O.tagName="";else if(m==="?")O.state=p.PROC_INST,O.procInstName=O.procInstBody="";else{if(W(O,"Unencoded <"),O.startTagPosition+1<O.position){var P=O.position-O.startTagPosition;m=new Array(P).join(" ")+m}O.textNode+="<"+m,O.state=p.TEXT}continue;case p.SGML_DECL:if(O.sgmlDecl+m==="--"){O.state=p.COMMENT,O.comment="",O.sgmlDecl="";continue}O.doctype&&O.doctype!==!0&&O.sgmlDecl?(O.state=p.DOCTYPE_DTD,O.doctype+="<!"+O.sgmlDecl+m,O.sgmlDecl=""):(O.sgmlDecl+m).toUpperCase()===h?(I(O,"onopencdata"),O.state=p.CDATA,O.sgmlDecl="",O.cdata=""):(O.sgmlDecl+m).toUpperCase()===l?(O.state=p.DOCTYPE,(O.doctype||O.sawRoot)&&W(O,"Inappropriately located doctype declaration"),O.doctype="",O.sgmlDecl=""):m===">"?(I(O,"onsgmldeclaration",O.sgmlDecl),O.sgmlDecl="",O.state=p.TEXT):(F(m)&&(O.state=p.SGML_DECL_QUOTED),O.sgmlDecl+=m);continue;case p.SGML_DECL_QUOTED:m===O.q&&(O.state=p.SGML_DECL,O.q=""),O.sgmlDecl+=m;continue;case p.DOCTYPE:m===">"?(O.state=p.TEXT,I(O,"ondoctype",O.doctype),O.doctype=!0):(O.doctype+=m,m==="["?O.state=p.DOCTYPE_DTD:F(m)&&(O.state=p.DOCTYPE_QUOTED,O.q=m));continue;case p.DOCTYPE_QUOTED:O.doctype+=m,m===O.q&&(O.q="",O.state=p.DOCTYPE);continue;case p.DOCTYPE_DTD:m==="]"?(O.doctype+=m,O.state=p.DOCTYPE):m==="<"?(O.state=p.OPEN_WAKA,O.startTagPosition=O.position):F(m)?(O.doctype+=m,O.state=p.DOCTYPE_DTD_QUOTED,O.q=m):O.doctype+=m;continue;case p.DOCTYPE_DTD_QUOTED:O.doctype+=m,m===O.q&&(O.state=p.DOCTYPE_DTD,O.q="");continue;case p.COMMENT:m==="-"?O.state=p.COMMENT_ENDING:O.comment+=m;continue;case p.COMMENT_ENDING:m==="-"?(O.state=p.COMMENT_ENDED,O.comment=q(O.opt,O.comment),O.comment&&I(O,"oncomment",O.comment),O.comment=""):(O.comment+="-"+m,O.state=p.COMMENT);continue;case p.COMMENT_ENDED:m!==">"?(W(O,"Malformed comment"),O.comment+="--"+m,O.state=p.COMMENT):O.doctype&&O.doctype!==!0?O.state=p.DOCTYPE_DTD:O.state=p.TEXT;continue;case p.CDATA:m==="]"?O.state=p.CDATA_ENDING:O.cdata+=m;continue;case p.CDATA_ENDING:m==="]"?O.state=p.CDATA_ENDING_2:(O.cdata+="]"+m,O.state=p.CDATA);continue;case p.CDATA_ENDING_2:m===">"?(O.cdata&&I(O,"oncdata",O.cdata),I(O,"onclosecdata"),O.cdata="",O.state=p.TEXT):m==="]"?O.cdata+="]":(O.cdata+="]]"+m,O.state=p.CDATA);continue;case p.PROC_INST:m==="?"?O.state=p.PROC_INST_ENDING:C(m)?O.state=p.PROC_INST_BODY:O.procInstName+=m;continue;case p.PROC_INST_BODY:if(!O.procInstBody&&C(m))continue;m==="?"?O.state=p.PROC_INST_ENDING:O.procInstBody+=m;continue;case p.PROC_INST_ENDING:m===">"?(I(O,"onprocessinginstruction",{name:O.procInstName,body:O.procInstBody}),O.procInstName=O.procInstBody="",O.state=p.TEXT):(O.procInstBody+="?"+m,O.state=p.PROC_INST_BODY);continue;case p.OPEN_TAG:D(_,m)?O.tagName+=m:(J(O),m===">"?re(O):m==="/"?O.state=p.OPEN_TAG_SLASH:(C(m)||W(O,"Invalid character in tag name"),O.state=p.ATTRIB));continue;case p.OPEN_TAG_SLASH:m===">"?(re(O,!0),ae(O)):(W(O,"Forward-slash in opening tag not followed by >"),O.state=p.ATTRIB);continue;case p.ATTRIB:if(C(m))continue;m===">"?re(O):m==="/"?O.state=p.OPEN_TAG_SLASH:D(E,m)?(O.attribName=m,O.attribValue="",O.state=p.ATTRIB_NAME):W(O,"Invalid attribute name");continue;case p.ATTRIB_NAME:m==="="?O.state=p.ATTRIB_VALUE:m===">"?(W(O,"Attribute without value"),O.attribValue=O.attribName,Q(O),re(O)):C(m)?O.state=p.ATTRIB_NAME_SAW_WHITE:D(_,m)?O.attribName+=m:W(O,"Invalid attribute name");continue;case p.ATTRIB_NAME_SAW_WHITE:if(m==="=")O.state=p.ATTRIB_VALUE;else{if(C(m))continue;W(O,"Attribute without value"),O.tag.attributes[O.attribName]="",O.attribValue="",I(O,"onattribute",{name:O.attribName,value:""}),O.attribName="",m===">"?re(O):D(E,m)?(O.attribName=m,O.state=p.ATTRIB_NAME):(W(O,"Invalid attribute name"),O.state=p.ATTRIB)}continue;case p.ATTRIB_VALUE:if(C(m))continue;F(m)?(O.q=m,O.state=p.ATTRIB_VALUE_QUOTED):(O.opt.unquotedAttributeValues||B(O,"Unquoted attribute value"),O.state=p.ATTRIB_VALUE_UNQUOTED,O.attribValue=m);continue;case p.ATTRIB_VALUE_QUOTED:if(m!==O.q){m==="&"?O.state=p.ATTRIB_VALUE_ENTITY_Q:O.attribValue+=m;continue}Q(O),O.q="",O.state=p.ATTRIB_VALUE_CLOSED;continue;case p.ATTRIB_VALUE_CLOSED:C(m)?O.state=p.ATTRIB:m===">"?re(O):m==="/"?O.state=p.OPEN_TAG_SLASH:D(E,m)?(W(O,"No whitespace between attributes"),O.attribName=m,O.attribValue="",O.state=p.ATTRIB_NAME):W(O,"Invalid attribute name");continue;case p.ATTRIB_VALUE_UNQUOTED:if(!S(m)){m==="&"?O.state=p.ATTRIB_VALUE_ENTITY_U:O.attribValue+=m;continue}Q(O),m===">"?re(O):O.state=p.ATTRIB;continue;case p.CLOSE_TAG:if(O.tagName)m===">"?ae(O):D(_,m)?O.tagName+=m:O.script?(O.script+="</"+O.tagName,O.tagName="",O.state=p.SCRIPT):(C(m)||W(O,"Invalid tagname in closing tag"),O.state=p.CLOSE_TAG_SAW_WHITE);else{if(C(m))continue;T(E,m)?O.script?(O.script+="</"+m,O.state=p.SCRIPT):W(O,"Invalid tagname in closing tag."):O.tagName=m}continue;case p.CLOSE_TAG_SAW_WHITE:if(C(m))continue;m===">"?ae(O):W(O,"Invalid characters in closing tag");continue;case p.TEXT_ENTITY:case p.ATTRIB_VALUE_ENTITY_Q:case p.ATTRIB_VALUE_ENTITY_U:var k,M;switch(O.state){case p.TEXT_ENTITY:k=p.TEXT,M="textNode";break;case p.ATTRIB_VALUE_ENTITY_Q:k=p.ATTRIB_VALUE_QUOTED,M="attribValue";break;case p.ATTRIB_VALUE_ENTITY_U:k=p.ATTRIB_VALUE_UNQUOTED,M="attribValue";break}if(m===";"){var $=pe(O);O.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes($)?(O.entity="",O.state=k,O.write($)):(O[M]+=$,O.entity="",O.state=k)}else D(O.entity.length?y:v,m)?O.entity+=m:(W(O,"Invalid character in entity name"),O[M]+="&"+O.entity+m,O.entity="",O.state=k);continue;default:throw new Error(O,"Unknown state: "+O.state)}return O.position>=O.bufferCheckPosition&&s(O),O}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var N=String.fromCharCode,O=Math.floor,H=function(){var m=16384,x=[],P,k,M=-1,$=arguments.length;if(!$)return"";for(var X="";++M<$;){var L=Number(arguments[M]);if(!isFinite(L)||L<0||L>1114111||O(L)!==L)throw RangeError("Invalid code point: "+L);L<=65535?x.push(L):(L-=65536,P=(L>>10)+55296,k=L%1024+56320,x.push(P,k)),(M+1===$||x.length>m)&&(X+=N.apply(null,x),x.length=0)}return X};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:H,configurable:!0,writable:!0}):String.fromCodePoint=H}()})(t)}(zn)),zn}var Wn={},Ds;function Kl(){return Ds||(Ds=1,(function(){Wn.stripBOM=function(t){return t[0]==="\uFEFF"?t.substring(1):t}}).call(ne)),Wn}var ot={},Fs;function Ja(){return Fs||(Fs=1,(function(){var t;t=new RegExp(/(?!xmlns)^.*:/),ot.normalize=function(e){return e.toLowerCase()},ot.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},ot.stripPrefix=function(e){return e.replace(t,"")},ot.parseNumbers=function(e){return isNaN(e)||(e=e%1===0?parseInt(e,10):parseFloat(e)),e},ot.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e=e.toLowerCase()==="true"),e}}).call(ne)),ot}var As;function Ql(){return As||(As=1,function(t){(function(){var e,r,o,s,n,i,a,u,f=function(l,d){return function(){return l.apply(d,arguments)}},c=function(l,d){for(var g in d)h.call(d,g)&&(l[g]=d[g]);function w(){this.constructor=l}return w.prototype=d.prototype,l.prototype=new w,l.__super__=d.prototype,l},h={}.hasOwnProperty;a=Jl(),o=ct,e=Kl(),i=Ja(),u=Zu.setImmediate,r=Ci().defaults,s=function(l){return typeof l=="object"&&l!=null&&Object.keys(l).length===0},n=function(l,d,g){var w,E,_;for(w=0,E=l.length;w<E;w++)_=l[w],d=_(d,g);return d},t.Parser=function(l){c(d,l);function d(g){this.parseStringPromise=f(this.parseStringPromise,this),this.parseString=f(this.parseString,this),this.reset=f(this.reset,this),this.assignOrPush=f(this.assignOrPush,this),this.processAsync=f(this.processAsync,this);var w,E,_;if(!(this instanceof t.Parser))return new t.Parser(g);this.options={},E=r["0.2"];for(w in E)h.call(E,w)&&(_=E[w],this.options[w]=_);for(w in g)h.call(g,w)&&(_=g[w],this.options[w]=_);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(i.normalize)),this.reset()}return d.prototype.processAsync=function(){var g,w;try{return this.remaining.length<=this.options.chunkSize?(g=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(g),this.saxParser.close()):(g=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(g),u(this.processAsync))}catch(E){if(w=E,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(w)}},d.prototype.assignOrPush=function(g,w,E){return w in g?(g[w]instanceof Array||(g[w]=[g[w]]),g[w].push(E)):this.options.explicitArray?g[w]=[E]:g[w]=E},d.prototype.reset=function(){var g,w,E,_;return this.removeAllListeners(),this.saxParser=a.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(v){return function(y){if(v.saxParser.resume(),!v.saxParser.errThrown)return v.saxParser.errThrown=!0,v.emit("error",y)}}(this),this.saxParser.onend=function(v){return function(){if(!v.saxParser.ended)return v.saxParser.ended=!0,v.emit("end",v.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,_=[],g=this.options.attrkey,w=this.options.charkey,this.saxParser.onopentag=function(v){return function(y){var C,F,S,D,T;if(S=Object.create(null),S[w]="",!v.options.ignoreAttrs){T=y.attributes;for(C in T)h.call(T,C)&&(!(g in S)&&!v.options.mergeAttrs&&(S[g]=Object.create(null)),F=v.options.attrValueProcessors?n(v.options.attrValueProcessors,y.attributes[C],C):y.attributes[C],D=v.options.attrNameProcessors?n(v.options.attrNameProcessors,C):C,v.options.mergeAttrs?v.assignOrPush(S,D,F):S[g][D]=F)}return S["#name"]=v.options.tagNameProcessors?n(v.options.tagNameProcessors,y.name):y.name,v.options.xmlns&&(S[v.options.xmlnskey]={uri:y.uri,local:y.local}),_.push(S)}}(this),this.saxParser.onclosetag=function(v){return function(){var y,C,F,S,D,T,p,b,A,I;if(T=_.pop(),D=T["#name"],(!v.options.explicitChildren||!v.options.preserveChildrenOrder)&&delete T["#name"],T.cdata===!0&&(y=T.cdata,delete T.cdata),A=_[_.length-1],T[w].match(/^\s*$/)&&!y?(C=T[w],delete T[w]):(v.options.trim&&(T[w]=T[w].trim()),v.options.normalize&&(T[w]=T[w].replace(/\s{2,}/g," ").trim()),T[w]=v.options.valueProcessors?n(v.options.valueProcessors,T[w],D):T[w],Object.keys(T).length===1&&w in T&&!v.EXPLICIT_CHARKEY&&(T=T[w])),s(T)&&(typeof v.options.emptyTag=="function"?T=v.options.emptyTag():T=v.options.emptyTag!==""?v.options.emptyTag:C),v.options.validator!=null&&(I="/"+function(){var V,q,B;for(B=[],V=0,q=_.length;V<q;V++)S=_[V],B.push(S["#name"]);return B}().concat(D).join("/"),function(){var V;try{return T=v.options.validator(I,A&&A[D],T)}catch(q){return V=q,v.emit("error",V)}}()),v.options.explicitChildren&&!v.options.mergeAttrs&&typeof T=="object"){if(!v.options.preserveChildrenOrder)S=Object.create(null),v.options.attrkey in T&&(S[v.options.attrkey]=T[v.options.attrkey],delete T[v.options.attrkey]),!v.options.charsAsChildren&&v.options.charkey in T&&(S[v.options.charkey]=T[v.options.charkey],delete T[v.options.charkey]),Object.getOwnPropertyNames(T).length>0&&(S[v.options.childkey]=T),T=S;else if(A){A[v.options.childkey]=A[v.options.childkey]||[],p=Object.create(null);for(F in T)h.call(T,F)&&(p[F]=T[F]);A[v.options.childkey].push(p),delete T["#name"],Object.keys(T).length===1&&w in T&&!v.EXPLICIT_CHARKEY&&(T=T[w])}}return _.length>0?v.assignOrPush(A,D,T):(v.options.explicitRoot&&(b=T,T=Object.create(null),T[D]=b),v.resultObject=T,v.saxParser.ended=!0,v.emit("end",v.resultObject))}}(this),E=function(v){return function(y){var C,F;if(F=_[_.length-1],F)return F[w]+=y,v.options.explicitChildren&&v.options.preserveChildrenOrder&&v.options.charsAsChildren&&(v.options.includeWhiteChars||y.replace(/\\n/g,"").trim()!=="")&&(F[v.options.childkey]=F[v.options.childkey]||[],C={"#name":"__text__"},C[w]=y,v.options.normalize&&(C[w]=C[w].replace(/\s{2,}/g," ").trim()),F[v.options.childkey].push(C)),F}}(this),this.saxParser.ontext=E,this.saxParser.oncdata=function(v){return function(y){var C;if(C=E(y),C)return C.cdata=!0}}()},d.prototype.parseString=function(g,w){var E;w!=null&&typeof w=="function"&&(this.on("end",function(_){return this.reset(),w(null,_)}),this.on("error",function(_){return this.reset(),w(_)}));try{return g=g.toString(),g.trim()===""?(this.emit("end",null),!0):(g=e.stripBOM(g),this.options.async?(this.remaining=g,u(this.processAsync),this.saxParser):this.saxParser.write(g).close())}catch(_){if(E=_,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw E}else return this.emit("error",E),this.saxParser.errThrown=!0}},d.prototype.parseStringPromise=function(g){return new Promise(function(w){return function(E,_){return w.parseString(g,function(v,y){return v?_(v):E(y)})}}(this))},d}(o),t.parseString=function(l,d,g){var w,E,_;return g!=null?(typeof g=="function"&&(w=g),typeof d=="object"&&(E=d)):(typeof d=="function"&&(w=d),E={}),_=new t.Parser(E),_.parseString(l,w)},t.parseStringPromise=function(l,d){var g,w;return typeof d=="object"&&(g=d),w=new t.Parser(g),w.parseStringPromise(l)}}).call(ne)}(Vn)),Vn}(function(){var t,e,r,o,s=function(i,a){for(var u in a)n.call(a,u)&&(i[u]=a[u]);function f(){this.constructor=i}return f.prototype=a.prototype,i.prototype=new f,i.__super__=a.prototype,i},n={}.hasOwnProperty;e=Ci(),t=Yl(),r=Ql(),o=Ja(),Ke.defaults=e.defaults,Ke.processors=o,Ke.ValidationError=function(i){s(a,i);function a(u){this.message=u}return a}(Error),Ke.Builder=t.Builder,Ke.Parser=r.Parser,Ke.parseString=r.parseString,Ke.parseStringPromise=r.parseStringPromise}).call(ne);var yi={exports:{}},Wt={exports:{}},Hn,_s;function Ka(){if(_s)return Hn;_s=1;function t(e){o.debug=o,o.default=o,o.coerce=f,o.disable=a,o.enable=i,o.enabled=u,o.humanize=Fa(),Object.keys(e).forEach(function(c){o[c]=e[c]}),o.instances=[],o.names=[],o.skips=[],o.formatters={};function r(c){for(var h=0,l=0;l<c.length;l++)h=(h<<5)-h+c.charCodeAt(l),h|=0;return o.colors[Math.abs(h)%o.colors.length]}o.selectColor=r;function o(c){var h;function l(){if(l.enabled){for(var d=arguments.length,g=new Array(d),w=0;w<d;w++)g[w]=arguments[w];var E=l,_=Number(new Date),v=_-(h||_);E.diff=v,E.prev=h,E.curr=_,h=_,g[0]=o.coerce(g[0]),typeof g[0]!="string"&&g.unshift("%O");var y=0;g[0]=g[0].replace(/%([a-zA-Z%])/g,function(F,S){if(F==="%%")return F;y++;var D=o.formatters[S];if(typeof D=="function"){var T=g[y];F=D.call(E,T),g.splice(y,1),y--}return F}),o.formatArgs.call(E,g);var C=E.log||o.log;C.apply(E,g)}}return l.namespace=c,l.enabled=o.enabled(c),l.useColors=o.useColors(),l.color=r(c),l.destroy=s,l.extend=n,typeof o.init=="function"&&o.init(l),o.instances.push(l),l}function s(){var c=o.instances.indexOf(this);return c!==-1?(o.instances.splice(c,1),!0):!1}function n(c,h){return o(this.namespace+(typeof h>"u"?":":h)+c)}function i(c){o.save(c),o.names=[],o.skips=[];var h,l=(typeof c=="string"?c:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(c=l[h].replace(/\*/g,".*?"),c[0]==="-"?o.skips.push(new RegExp("^"+c.substr(1)+"$")):o.names.push(new RegExp("^"+c+"$")));for(h=0;h<o.instances.length;h++){var g=o.instances[h];g.enabled=o.enabled(g.namespace)}}function a(){o.enable("")}function u(c){if(c[c.length-1]==="*")return!0;var h,l;for(h=0,l=o.skips.length;h<l;h++)if(o.skips[h].test(c))return!1;for(h=0,l=o.names.length;h<l;h++)if(o.names[h].test(c))return!0;return!1}function f(c){return c instanceof Error?c.stack||c.message:c}return o.enable(o.load()),o}return Hn=t,Hn}var Ns;function Zl(){return Ns||(Ns=1,function(t,e){function r(c){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(l){return typeof l}:r=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},r(c)}e.log=n,e.formatArgs=s,e.save=i,e.load=a,e.useColors=o,e.storage=u(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function o(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function s(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!!this.useColors){var h="color: "+this.color;c.splice(1,0,h,"color: inherit");var l=0,d=0;c[0].replace(/%[a-zA-Z%]/g,function(g){g!=="%%"&&(l++,g==="%c"&&(d=l))}),c.splice(d,0,h)}}function n(){var c;return(typeof console>"u"?"undefined":r(console))==="object"&&console.log&&(c=console).log.apply(c,arguments)}function i(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function a(){var c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=process.env.DEBUG),c}function u(){try{return localStorage}catch{}}t.exports=Ka()(e);var f=t.exports.formatters;f.j=function(c){try{return JSON.stringify(c)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}(Wt,Wt.exports)),Wt.exports}var Ht={exports:{}},xs;function ef(){return xs||(xs=1,function(t,e){var r=ma,o=$t;e.init=h,e.log=u,e.formatArgs=i,e.save=f,e.load=c,e.useColors=n,e.colors=[6,2,3,4,5,1];try{var s=_a();s&&(s.stderr||s).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(function(d){return/^debug_/i.test(d)}).reduce(function(d,g){var w=g.substring(6).toLowerCase().replace(/_([a-z])/g,function(_,v){return v.toUpperCase()}),E=process.env[g];return/^(yes|on|true|enabled)$/i.test(E)?E=!0:/^(no|off|false|disabled)$/i.test(E)?E=!1:E==="null"?E=null:E=Number(E),d[w]=E,d},{});function n(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:r.isatty(process.stderr.fd)}function i(d){var g=this.namespace,w=this.useColors;if(w){var E=this.color,_="\x1B[3"+(E<8?E:"8;5;"+E),v="  ".concat(_,";1m").concat(g," \x1B[0m");d[0]=v+d[0].split(`
`).join(`
`+v),d.push(_+"m+"+t.exports.humanize(this.diff)+"\x1B[0m")}else d[0]=a()+g+" "+d[0]}function a(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function u(){return process.stderr.write(o.format.apply(o,arguments)+`
`)}function f(d){d?process.env.DEBUG=d:delete process.env.DEBUG}function c(){return process.env.DEBUG}function h(d){d.inspectOpts={};for(var g=Object.keys(e.inspectOpts),w=0;w<g.length;w++)d.inspectOpts[g[w]]=e.inspectOpts[g[w]]}t.exports=Ka()(e);var l=t.exports.formatters;l.o=function(d){return this.inspectOpts.colors=this.useColors,o.inspect(d,this.inspectOpts).split(`
`).map(function(g){return g.trim()}).join(" ")},l.O=function(d){return this.inspectOpts.colors=this.useColors,o.inspect(d,this.inspectOpts)}}(Ht,Ht.exports)),Ht.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?yi.exports=Zl():yi.exports=ef();var tf=yi.exports;const Ct=cr,rf=Si,nf=Ku,Dt=Ti,Ps=wt,of=Ke,sf=Ba,af=tf("roa"),Gt=yr;function uf(t){return t.replace(/[\t\n\r\f]/g," ")}function cf(t){const e=Object.keys(t),r={};for(let o=0;o<e.length;o++){const s=e[o];r[s.toLowerCase()]=t[s]}return r}function lf(t){const e="x-acs-",r=Object.keys(t),o=[];for(let n=0;n<r.length;n++){const i=r[n];i.startsWith(e)&&o.push(i)}o.sort();var s="";for(let n=0;n<o.length;n++){const i=o[n];s+=`${i}:${uf(t[i]).trim()}
`}return s}function ff(t,e){const r=Object.keys(e).sort();if(r.length===0)return t;for(var o=[],s=0;s<r.length;s++){const n=r[s];o.push(`${n}=${e[n]}`)}return`${t}?${o.join("&")}`}function hf(t,e,r,o){const s=r.accept,n=r["content-md5"]||"",i=r["content-type"]||"",a=r.date||"",u=`${t}
${s}
${n}
${i}
${a}
`,f=lf(r),c=ff(e,o);return`${u}${f}${c}`}function pf(t){const e=new of.Parser({});return new Promise((r,o)=>{e.parseString(t,(s,n)=>{if(s)return o(s);r(n)})})}class df extends Error{constructor(e){const r=e.Message[0],o=e.Code[0],s=e.HostId[0],n=e.RequestId[0];super(`${r} hostid: ${s}, requestid: ${n}`),this.code=o}}class mf{constructor(e){if(Ct(e,'must pass "config"'),Ct(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Ct(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else Ct(e.accessKeyId,'must pass "config.accessKeyId"'),Ct(e.accessKeySecret,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=e.accessKeySecret,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:e.accessKeySecret,securityToken:e.securityToken})};this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.host=rf.parse(this.endpoint).hostname,this.opts=e.opts;var r=this.endpoint.startsWith("https://")?ur:ar;this.keepAliveAgent=new r.Agent({keepAlive:!0,keepAliveMsecs:3e3})}buildHeaders(){var r={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Dt.makeNonce(),"x-acs-signature-method":"HMAC-SHA1","x-acs-signature-version":"1.0","x-acs-version":this.apiVersion,"user-agent":Gt.DEFAULT_UA,"x-sdk-client":Gt.DEFAULT_CLIENT};return this.securityToken&&(r["x-acs-accesskey-id"]=this.accessKeyId,r["x-acs-security-token"]=this.securityToken),r}signature(e){const r=Buffer.from(e,"utf8");return Dt.sha1(r,this.accessKeySecret,"base64")}buildAuthorization(e){return`acs ${this.accessKeyId}:${this.signature(e)}`}async request(e,r,o={},s="",n={},i={}){const a=await this.credentialsProvider.getCredentials();var f={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Dt.makeNonce(),"x-acs-version":this.apiVersion,"user-agent":Gt.DEFAULT_UA,"x-sdk-client":Gt.DEFAULT_CLIENT};a&&a.accessKeyId&&a.accessKeySecret&&(f["x-acs-signature-method"]="HMAC-SHA1",f["x-acs-signature-version"]="1.0",a.securityToken&&(f["x-acs-accesskey-id"]=a.accessKeyId,f["x-acs-security-token"]=a.securityToken));var c=Object.assign(f,cf(n)),h=null;h=Buffer.from(s,"utf8"),c["content-md5"]=Dt.md5(h,"base64"),c["content-length"]=h.length;var l=`${this.endpoint}${r}`;if(Object.keys(o).length&&(l+=`?${nf.stringify(o)}`),a&&a.accessKeyId&&a.accessKeySecret){const y=hf(e,r,c,o);af("stringToSign: %s",y);const C=Buffer.from(y,"utf8"),F=Dt.sha1(C,a.accessKeySecret,"base64");c.authorization=`acs ${a.accessKeyId}:${F}`}const d=Object.assign({method:e,agent:this.keepAliveAgent,headers:c,data:h},this.opts,i),g=await Ps.request(l,d),w=await Ps.read(g,"utf8");if(i.rawBody)return w;const E=g.headers["content-type"]||"";if(E.startsWith("application/json")){const y=g.statusCode;if(y===204)return w;var _;try{_=sf.parse(w)}catch(C){throw C.name="FormatError",C.message="parse response to json error",C.body=w,C}if(y>=400){const C=_.Message||_.errorMsg||"",F=_.Code||_.errorCode||"",S=_.RequestId||"";var v=new Error(`code: ${y}, ${C}, requestid: ${S}`);throw v.name=`${F}Error`,v.statusCode=y,v.result=_,v.code=F,v}return _}if(E.startsWith("text/xml")){const y=await pf(w);if(y.Error)throw new df(y.Error);return y}return w}put(e,r,o,s,n){return this.request("PUT",e,r,o,s,n)}post(e,r,o,s,n){return this.request("POST",e,r,o,s,n)}get(e,r,o,s){return this.request("GET",e,r,"",o,s)}delete(e,r,o,s){return this.request("DELETE",e,r,"",o,s)}}var yf=mf;dr.exports=Xa;dr.exports.ROAClient=yf;dr.exports.RPCClient=Xa;var gf=dr.exports;const vf=vt(gf);async function wf(){const t=new vf({accessKeyId:nr.accessKeyId,accessKeySecret:nr.accessKeySecret,endpoint:"http://nls-meta.cn-shanghai.aliyuncs.com",apiVersion:"2019-02-28"});try{return(await t.request("CreateToken")).Token.Id}catch(e){return console.error("Error creating token:",e),null}}var Qa={exports:{}},Gn,Is;function Ef(){if(Is)return Gn;Is=1,Gn=o,o.sync=s;var t=ce;function e(n,i){var a=i.pathExt!==void 0?i.pathExt:process.env.PATHEXT;if(!a||(a=a.split(";"),a.indexOf("")!==-1))return!0;for(var u=0;u<a.length;u++){var f=a[u].toLowerCase();if(f&&n.substr(-f.length).toLowerCase()===f)return!0}return!1}function r(n,i,a){return!n.isSymbolicLink()&&!n.isFile()?!1:e(i,a)}function o(n,i,a){t.stat(n,function(u,f){a(u,u?!1:r(f,n,i))})}function s(n,i){return r(t.statSync(n),n,i)}return Gn}var Yn,Ls;function bf(){if(Ls)return Yn;Ls=1,Yn=e,e.sync=r;var t=ce;function e(n,i,a){t.stat(n,function(u,f){a(u,u?!1:o(f,i))})}function r(n,i){return o(t.statSync(n),i)}function o(n,i){return n.isFile()&&s(n,i)}function s(n,i){var a=n.mode,u=n.uid,f=n.gid,c=i.uid!==void 0?i.uid:process.getuid&&process.getuid(),h=i.gid!==void 0?i.gid:process.getgid&&process.getgid(),l=parseInt("100",8),d=parseInt("010",8),g=parseInt("001",8),w=l|d,E=a&g||a&d&&f===h||a&l&&u===c||a&w&&c===0;return E}return Yn}var ir;process.platform==="win32"||ne.TESTING_WINDOWS?ir=Ef():ir=bf();var Sf=qi;qi.sync=Of;function qi(t,e,r){if(typeof e=="function"&&(r=e,e={}),!r){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(o,s){qi(t,e||{},function(n,i){n?s(n):o(i)})})}ir(t,e||{},function(o,s){o&&(o.code==="EACCES"||e&&e.ignoreErrors)&&(o=null,s=!1),r(o,s)})}function Of(t,e){try{return ir.sync(t,e||{})}catch(r){if(e&&e.ignoreErrors||r.code==="EACCES")return!1;throw r}}var Tf=nu;nu.sync=Df;var gi=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Za=Z,Cf=gi?";":":",eu=Sf;function tu(t){var e=new Error("not found: "+t);return e.code="ENOENT",e}function ru(t,e){var r=e.colon||Cf,o=e.path||process.env.PATH||"",s=[""];o=o.split(r);var n="";return gi&&(o.unshift(process.cwd()),n=e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM",s=n.split(r),t.indexOf(".")!==-1&&s[0]!==""&&s.unshift("")),(t.match(/\//)||gi&&t.match(/\\/))&&(o=[""]),{env:o,ext:s,extExe:n}}function nu(t,e,r){typeof e=="function"&&(r=e,e={});var o=ru(t,e),s=o.env,n=o.ext,i=o.extExe,a=[];(function u(f,c){if(f===c)return e.all&&a.length?r(null,a):r(tu(t));var h=s[f];h.charAt(0)==='"'&&h.slice(-1)==='"'&&(h=h.slice(1,-1));var l=Za.join(h,t);!h&&/^\.[\\\/]/.test(t)&&(l=t.slice(0,2)+l),function d(g,w){if(g===w)return u(f+1,c);var E=n[g];eu(l+E,{pathExt:i},function(_,v){if(!_&&v)if(e.all)a.push(l+E);else return r(null,l+E);return d(g+1,w)})}(0,n.length)})(0,s.length)}function Df(t,e){e=e||{};for(var r=ru(t,e),o=r.env,s=r.ext,n=r.extExe,i=[],a=0,u=o.length;a<u;a++){var f=o[a];f.charAt(0)==='"'&&f.slice(-1)==='"'&&(f=f.slice(1,-1));var c=Za.join(f,t);!f&&/^\.[\\\/]/.test(t)&&(c=t.slice(0,2)+c);for(var h=0,l=s.length;h<l;h++){var d=c+s[h],g;try{if(g=eu.sync(d,{pathExt:n}),g)if(e.all)i.push(d);else return d}catch{}}}if(e.all&&i.length)return i;if(e.nothrow)return null;throw tu(t)}sr.exec;var Ff=it.platform().match(/win(32|64)/),Af=Tf,Ms=/\r\n|\r|\n/g,Ft=/^\[?(.*?)\]?$/,$s=/[,]/,Yt={};function _f(t){var e={};t=t.replace(/=\s+/g,"=").trim();for(var r=t.split(" "),o=0;o<r.length;o++){var s=r[o].split("=",2),n=s[0],i=s[1];if(typeof i>"u")return null;e[n]=i}return e}var Rs=Qa.exports={isWindows:Ff,streamRegexp:Ft,copy:function(t,e){Object.keys(t).forEach(function(r){e[r]=t[r]})},args:function(){var t=[],e=function(){arguments.length===1&&Array.isArray(arguments[0])?t=t.concat(arguments[0]):t=t.concat([].slice.call(arguments))};return e.clear=function(){t=[]},e.get=function(){return t},e.find=function(r,o){var s=t.indexOf(r);if(s!==-1)return t.slice(s+1,s+1+(o||0))},e.remove=function(r,o){var s=t.indexOf(r);s!==-1&&t.splice(s,(o||0)+1)},e.clone=function(){var r=Rs.args();return r(t),r},e},makeFilterStrings:function(t){return t.map(function(e){if(typeof e=="string")return e;var r="";return Array.isArray(e.inputs)?r+=e.inputs.map(function(o){return o.replace(Ft,"[$1]")}).join(""):typeof e.inputs=="string"&&(r+=e.inputs.replace(Ft,"[$1]")),r+=e.filter,e.options&&(typeof e.options=="string"||typeof e.options=="number"?r+="="+e.options:Array.isArray(e.options)?r+="="+e.options.map(function(o){return typeof o=="string"&&o.match($s)?"'"+o+"'":o}).join(":"):Object.keys(e.options).length&&(r+="="+Object.keys(e.options).map(function(o){var s=e.options[o];return typeof s=="string"&&s.match($s)&&(s="'"+s+"'"),o+"="+s}).join(":"))),Array.isArray(e.outputs)?r+=e.outputs.map(function(o){return o.replace(Ft,"[$1]")}).join(""):typeof e.outputs=="string"&&(r+=e.outputs.replace(Ft,"[$1]")),r})},which:function(t,e){if(t in Yt)return e(null,Yt[t]);Af(t,function(r,o){if(r)return e(null,Yt[t]="");e(null,Yt[t]=o)})},timemarkToSeconds:function(t){if(typeof t=="number")return t;if(t.indexOf(":")===-1&&t.indexOf(".")>=0)return Number(t);var e=t.split(":"),r=Number(e.pop());return e.length&&(r+=Number(e.pop())*60),e.length&&(r+=Number(e.pop())*3600),r},extractCodecData:function(t,e,r){var o=/Input #[0-9]+, ([^ ]+),/,s=/Duration\: ([^,]+)/,n=/Audio\: (.*)/,i=/Video\: (.*)/;"inputStack"in r||(r.inputStack=[],r.inputIndex=-1,r.inInput=!1);var a=r.inputStack,u=r.inputIndex,f=r.inInput,c,h,l,d;if(c=e.match(o))f=r.inInput=!0,u=r.inputIndex=r.inputIndex+1,a[u]={format:c[1],audio:"",video:"",duration:""};else if(f&&(h=e.match(s)))a[u].duration=h[1];else if(f&&(l=e.match(n)))l=l[1].split(", "),a[u].audio=l[0],a[u].audio_details=l;else if(f&&(d=e.match(i)))d=d[1].split(", "),a[u].video=d[0],a[u].video_details=d;else if(/Output #\d+/.test(e))f=r.inInput=!1;else if(/Stream mapping:|Press (\[q\]|ctrl-c) to stop/.test(e))return t.emit.apply(t,["codecData"].concat(a)),!0;return!1},extractProgress:function(t,e){var r=_f(e);if(r){var o={frames:parseInt(r.frame,10),currentFps:parseInt(r.fps,10),currentKbps:r.bitrate?parseFloat(r.bitrate.replace("kbits/s","")):0,targetSize:parseInt(r.size||r.Lsize,10),timemark:r.time};if(t._ffprobeData&&t._ffprobeData.format&&t._ffprobeData.format.duration){var s=Number(t._ffprobeData.format.duration);isNaN(s)||(o.percent=Rs.timemarkToSeconds(o.timemark)/s*100)}t.emit("progress",o)}},extractError:function(t){return t.split(Ms).reduce(function(e,r){return r.charAt(0)===" "||r.charAt(0)==="["?[]:(e.push(r),e)},[]).join(`
`)},linesRing:function(t){var e=[],r=[],o=null,s=!1,n=t-1;function i(a){e.forEach(function(u){u(a)})}return{callback:function(a){r.forEach(function(u){a(u)}),e.push(a)},append:function(a){if(!s&&(a instanceof Buffer&&(a=""+a),!(!a||a.length===0))){var u=a.split(Ms);u.length===1?o!==null?o=o+u.shift():o=u.shift():(o!==null&&(o=o+u.shift(),i(o),r.push(o)),o=u.pop(),u.forEach(function(f){i(f),r.push(f)}),n>-1&&r.length>n&&r.splice(0,r.length-n))}},get:function(){return o!==null?r.concat([o]).join(`
`):r.join(`
`)},close:function(){s||(o!==null&&(i(o),r.push(o),n>-1&&r.length>n&&r.shift(),o=null),s=!0)}}}},Ye=Qa.exports,Jn,ks;function Nf(){if(ks)return Jn;ks=1;var t=Ye;return Jn=function(e){e.mergeAdd=e.addInput=e.input=function(r){var o=!1,s=!1;if(typeof r!="string"){if(!("readable"in r)||!r.readable)throw new Error("Invalid input");var n=this._inputs.some(function(a){return a.isStream});if(n)throw new Error("Only one input stream is supported");s=!0,r.pause()}else{var i=r.match(/^([a-z]{2,}):/i);o=!i||i[0]==="file"}return this._inputs.push(this._currentInput={source:r,isFile:o,isStream:s,options:t.args()}),this},e.withInputFormat=e.inputFormat=e.fromFormat=function(r){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-f",r),this},e.withInputFps=e.withInputFPS=e.withFpsInput=e.withFPSInput=e.inputFPS=e.inputFps=e.fpsInput=e.FPSInput=function(r){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-r",r),this},e.nativeFramerate=e.withNativeFramerate=e.native=function(){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-re"),this},e.setStartTime=e.seekInput=function(r){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-ss",r),this},e.loop=function(r){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-loop","1"),typeof r<"u"&&this.duration(r),this}},Jn}var Kn,js;function xf(){if(js)return Kn;js=1;var t=Ye;return Kn=function(e){e.withNoAudio=e.noAudio=function(){return this._currentOutput.audio.clear(),this._currentOutput.audioFilters.clear(),this._currentOutput.audio("-an"),this},e.withAudioCodec=e.audioCodec=function(r){return this._currentOutput.audio("-acodec",r),this},e.withAudioBitrate=e.audioBitrate=function(r){return this._currentOutput.audio("-b:a",(""+r).replace(/k?$/,"k")),this},e.withAudioChannels=e.audioChannels=function(r){return this._currentOutput.audio("-ac",r),this},e.withAudioFrequency=e.audioFrequency=function(r){return this._currentOutput.audio("-ar",r),this},e.withAudioQuality=e.audioQuality=function(r){return this._currentOutput.audio("-aq",r),this},e.withAudioFilter=e.withAudioFilters=e.audioFilter=e.audioFilters=function(r){return arguments.length>1&&(r=[].slice.call(arguments)),Array.isArray(r)||(r=[r]),this._currentOutput.audioFilters(t.makeFilterStrings(r)),this}},Kn}var Qn,qs;function Pf(){if(qs)return Qn;qs=1;var t=Ye;return Qn=function(e){e.withNoVideo=e.noVideo=function(){return this._currentOutput.video.clear(),this._currentOutput.videoFilters.clear(),this._currentOutput.video("-vn"),this},e.withVideoCodec=e.videoCodec=function(r){return this._currentOutput.video("-vcodec",r),this},e.withVideoBitrate=e.videoBitrate=function(r,o){return r=(""+r).replace(/k?$/,"k"),this._currentOutput.video("-b:v",r),o&&this._currentOutput.video("-maxrate",r,"-minrate",r,"-bufsize","3M"),this},e.withVideoFilter=e.withVideoFilters=e.videoFilter=e.videoFilters=function(r){return arguments.length>1&&(r=[].slice.call(arguments)),Array.isArray(r)||(r=[r]),this._currentOutput.videoFilters(t.makeFilterStrings(r)),this},e.withOutputFps=e.withOutputFPS=e.withFpsOutput=e.withFPSOutput=e.withFps=e.withFPS=e.outputFPS=e.outputFps=e.fpsOutput=e.FPSOutput=e.fps=e.FPS=function(r){return this._currentOutput.video("-r",r),this},e.takeFrames=e.withFrames=e.frames=function(r){return this._currentOutput.video("-vframes",r),this}},Qn}var Zn,Bs;function If(){if(Bs)return Zn;Bs=1;function t(r,o,s,n){return[{filter:"scale",options:{w:"if(gt(a,"+s+"),"+r+",trunc("+o+"*a/2)*2)",h:"if(lt(a,"+s+"),"+o+",trunc("+r+"/a/2)*2)"}},{filter:"pad",options:{w:r,h:o,x:"if(gt(a,"+s+"),0,("+r+"-iw)/2)",y:"if(lt(a,"+s+"),0,("+o+"-ih)/2)",color:n}}]}function e(r,o,s){var n=r.sizeData=r.sizeData||{};if(n[o]=s,!("size"in n))return[];var i=n.size.match(/([0-9]+)x([0-9]+)/),a=n.size.match(/([0-9]+)x\?/),u=n.size.match(/\?x([0-9]+)/),f=n.size.match(/\b([0-9]{1,3})%/),c,h,l;if(f){var d=Number(f[1])/100;return[{filter:"scale",options:{w:"trunc(iw*"+d+"/2)*2",h:"trunc(ih*"+d+"/2)*2"}}]}else{if(i)return c=Math.round(Number(i[1])/2)*2,h=Math.round(Number(i[2])/2)*2,l=c/h,n.pad?t(c,h,l,n.pad):[{filter:"scale",options:{w:c,h}}];if(a||u)return"aspect"in n?(c=a?a[1]:Math.round(Number(u[1])*n.aspect),h=u?u[1]:Math.round(Number(a[1])/n.aspect),c=Math.round(c/2)*2,h=Math.round(h/2)*2,n.pad?t(c,h,n.aspect,n.pad):[{filter:"scale",options:{w:c,h}}]):a?[{filter:"scale",options:{w:Math.round(Number(a[1])/2)*2,h:"trunc(ow/a/2)*2"}}]:[{filter:"scale",options:{w:"trunc(oh*a/2)*2",h:Math.round(Number(u[1])/2)*2}}];throw new Error("Invalid size specified: "+n.size)}}return Zn=function(r){r.keepPixelAspect=r.keepDisplayAspect=r.keepDisplayAspectRatio=r.keepDAR=function(){return this.videoFilters([{filter:"scale",options:{w:"if(gt(sar,1),iw*sar,iw)",h:"if(lt(sar,1),ih/sar,ih)"}},{filter:"setsar",options:"1"}])},r.withSize=r.setSize=r.size=function(o){var s=e(this._currentOutput,"size",o);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(s),this},r.withAspect=r.withAspectRatio=r.setAspect=r.setAspectRatio=r.aspect=r.aspectRatio=function(o){var s=Number(o);if(isNaN(s)){var n=o.match(/^(\d+):(\d+)$/);if(n)s=Number(n[1])/Number(n[2]);else throw new Error("Invalid aspect ratio: "+o)}var i=e(this._currentOutput,"aspect",s);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(i),this},r.applyAutopadding=r.applyAutoPadding=r.applyAutopad=r.applyAutoPad=r.withAutopadding=r.withAutoPadding=r.withAutopad=r.withAutoPad=r.autoPad=r.autopad=function(o,s){typeof o=="string"&&(s=o,o=!0),typeof o>"u"&&(o=!0);var n=e(this._currentOutput,"pad",o?s||"black":!1);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(n),this}},Zn}var ei,Us;function Lf(){if(Us)return ei;Us=1;var t=Ye;return ei=function(e){e.addOutput=e.output=function(r,o){var s=!1;if(!r&&this._currentOutput)throw new Error("Invalid output");if(r&&typeof r!="string"){if(!("writable"in r)||!r.writable)throw new Error("Invalid output")}else if(typeof r=="string"){var n=r.match(/^([a-z]{2,}):/i);s=!n||n[0]==="file"}if(r&&!("target"in this._currentOutput))this._currentOutput.target=r,this._currentOutput.isFile=s,this._currentOutput.pipeopts=o||{};else{if(r&&typeof r!="string"){var i=this._outputs.some(function(u){return typeof u.target!="string"});if(i)throw new Error("Only one output stream is supported")}this._outputs.push(this._currentOutput={target:r,isFile:s,flags:{},pipeopts:o||{}});var a=this;["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(u){a._currentOutput[u]=t.args()}),r||delete this._currentOutput.target}return this},e.seekOutput=e.seek=function(r){return this._currentOutput.options("-ss",r),this},e.withDuration=e.setDuration=e.duration=function(r){return this._currentOutput.options("-t",r),this},e.toFormat=e.withOutputFormat=e.outputFormat=e.format=function(r){return this._currentOutput.options("-f",r),this},e.map=function(r){return this._currentOutput.options("-map",r.replace(t.streamRegexp,"[$1]")),this},e.updateFlvMetadata=e.flvmeta=function(){return this._currentOutput.flags.flvmeta=!0,this}},ei}var ti,Xs;function Mf(){if(Xs)return ti;Xs=1;var t=Ye;return ti=function(e){e.addInputOption=e.addInputOptions=e.withInputOption=e.withInputOptions=e.inputOption=e.inputOptions=function(r){if(!this._currentInput)throw new Error("No input specified");var o=!0;return arguments.length>1&&(r=[].slice.call(arguments),o=!1),Array.isArray(r)||(r=[r]),this._currentInput.options(r.reduce(function(s,n){var i=String(n).split(" ");return o&&i.length===2?s.push(i[0],i[1]):s.push(n),s},[])),this},e.addOutputOption=e.addOutputOptions=e.addOption=e.addOptions=e.withOutputOption=e.withOutputOptions=e.withOption=e.withOptions=e.outputOption=e.outputOptions=function(r){var o=!0;return arguments.length>1&&(r=[].slice.call(arguments),o=!1),Array.isArray(r)||(r=[r]),this._currentOutput.options(r.reduce(function(s,n){var i=String(n).split(" ");return o&&i.length===2?s.push(i[0],i[1]):s.push(n),s},[])),this},e.filterGraph=e.complexFilter=function(r,o){if(this._complexFilters.clear(),Array.isArray(r)||(r=[r]),this._complexFilters("-filter_complex",t.makeFilterStrings(r).join(";")),Array.isArray(o)){var s=this;o.forEach(function(n){s._complexFilters("-map",n.replace(t.streamRegexp,"[$1]"))})}else typeof o=="string"&&this._complexFilters("-map",o.replace(t.streamRegexp,"[$1]"));return this}},ti}function $f(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ri,Vs;function Rf(){if(Vs)return ri;Vs=1;var t=Z;return ri=function(e){e.usingPreset=e.preset=function(r){if(typeof r=="function")r(this);else try{var o=t.join(this.options.presets,r),s=$f(o);if(typeof s.load=="function")s.load(this);else throw new Error("preset "+o+" has no load() function")}catch(n){throw new Error("preset "+o+" could not be loaded: "+n.message)}return this}},ri}var ni={exports:{}},zs;function Bi(){return zs||(zs=1,function(t){(function(){var e={},r,o;r=this,r!=null&&(o=r.async),e.noConflict=function(){return r.async=o,e};function s(S){var D=!1;return function(){if(D)throw new Error("Callback was already called.");D=!0,S.apply(r,arguments)}}var n=function(S,D){if(S.forEach)return S.forEach(D);for(var T=0;T<S.length;T+=1)D(S[T],T,S)},i=function(S,D){if(S.map)return S.map(D);var T=[];return n(S,function(p,b,A){T.push(D(p,b,A))}),T},a=function(S,D,T){return S.reduce?S.reduce(D,T):(n(S,function(p,b,A){T=D(T,p,b,A)}),T)},u=function(S){if(Object.keys)return Object.keys(S);var D=[];for(var T in S)S.hasOwnProperty(T)&&D.push(T);return D};typeof process>"u"||!process.nextTick?typeof setImmediate=="function"?(e.nextTick=function(S){setImmediate(S)},e.setImmediate=e.nextTick):(e.nextTick=function(S){setTimeout(S,0)},e.setImmediate=e.nextTick):(e.nextTick=process.nextTick,typeof setImmediate<"u"?e.setImmediate=function(S){setImmediate(S)}:e.setImmediate=e.nextTick),e.each=function(S,D,T){if(T=T||function(){},!S.length)return T();var p=0;n(S,function(b){D(b,s(function(A){A?(T(A),T=function(){}):(p+=1,p>=S.length&&T(null))}))})},e.forEach=e.each,e.eachSeries=function(S,D,T){if(T=T||function(){},!S.length)return T();var p=0,b=function(){D(S[p],function(A){A?(T(A),T=function(){}):(p+=1,p>=S.length?T(null):b())})};b()},e.forEachSeries=e.eachSeries,e.eachLimit=function(S,D,T,p){var b=f(D);b.apply(null,[S,T,p])},e.forEachLimit=e.eachLimit;var f=function(S){return function(D,T,p){if(p=p||function(){},!D.length||S<=0)return p();var b=0,A=0,I=0;(function V(){if(b>=D.length)return p();for(;I<S&&A<D.length;)A+=1,I+=1,T(D[A-1],function(q){q?(p(q),p=function(){}):(b+=1,I-=1,b>=D.length?p():V())})})()}},c=function(S){return function(){var D=Array.prototype.slice.call(arguments);return S.apply(null,[e.each].concat(D))}},h=function(S,D){return function(){var T=Array.prototype.slice.call(arguments);return D.apply(null,[f(S)].concat(T))}},l=function(S){return function(){var D=Array.prototype.slice.call(arguments);return S.apply(null,[e.eachSeries].concat(D))}},d=function(S,D,T,p){var b=[];D=i(D,function(A,I){return{index:I,value:A}}),S(D,function(A,I){T(A.value,function(V,q){b[A.index]=q,I(V)})},function(A){p(A,b)})};e.map=c(d),e.mapSeries=l(d),e.mapLimit=function(S,D,T,p){return g(D)(S,T,p)};var g=function(S){return h(S,d)};e.reduce=function(S,D,T,p){e.eachSeries(S,function(b,A){T(D,b,function(I,V){D=V,A(I)})},function(b){p(b,D)})},e.inject=e.reduce,e.foldl=e.reduce,e.reduceRight=function(S,D,T,p){var b=i(S,function(A){return A}).reverse();e.reduce(b,D,T,p)},e.foldr=e.reduceRight;var w=function(S,D,T,p){var b=[];D=i(D,function(A,I){return{index:I,value:A}}),S(D,function(A,I){T(A.value,function(V){V&&b.push(A),I()})},function(A){p(i(b.sort(function(I,V){return I.index-V.index}),function(I){return I.value}))})};e.filter=c(w),e.filterSeries=l(w),e.select=e.filter,e.selectSeries=e.filterSeries;var E=function(S,D,T,p){var b=[];D=i(D,function(A,I){return{index:I,value:A}}),S(D,function(A,I){T(A.value,function(V){V||b.push(A),I()})},function(A){p(i(b.sort(function(I,V){return I.index-V.index}),function(I){return I.value}))})};e.reject=c(E),e.rejectSeries=l(E);var _=function(S,D,T,p){S(D,function(b,A){T(b,function(I){I?(p(b),p=function(){}):A()})},function(b){p()})};e.detect=c(_),e.detectSeries=l(_),e.some=function(S,D,T){e.each(S,function(p,b){D(p,function(A){A&&(T(!0),T=function(){}),b()})},function(p){T(!1)})},e.any=e.some,e.every=function(S,D,T){e.each(S,function(p,b){D(p,function(A){A||(T(!1),T=function(){}),b()})},function(p){T(!0)})},e.all=e.every,e.sortBy=function(S,D,T){e.map(S,function(p,b){D(p,function(A,I){A?b(A):b(null,{value:p,criteria:I})})},function(p,b){if(p)return T(p);var A=function(I,V){var q=I.criteria,B=V.criteria;return q<B?-1:q>B?1:0};T(null,i(b.sort(A),function(I){return I.value}))})},e.auto=function(S,D){D=D||function(){};var T=u(S);if(!T.length)return D(null);var p={},b=[],A=function(q){b.unshift(q)},I=function(q){for(var B=0;B<b.length;B+=1)if(b[B]===q){b.splice(B,1);return}},V=function(){n(b.slice(0),function(q){q()})};A(function(){u(p).length===T.length&&(D(null,p),D=function(){})}),n(T,function(q){var B=S[q]instanceof Function?[S[q]]:S[q],z=function(Q){var re=Array.prototype.slice.call(arguments,1);if(re.length<=1&&(re=re[0]),Q){var ae={};n(u(p),function(pe){ae[pe]=p[pe]}),ae[q]=re,D(Q,ae),D=function(){}}else p[q]=re,e.setImmediate(V)},W=B.slice(0,Math.abs(B.length-1))||[],J=function(){return a(W,function(Q,re){return Q&&p.hasOwnProperty(re)},!0)&&!p.hasOwnProperty(q)};if(J())B[B.length-1](z,p);else{var K=function(){J()&&(I(K),B[B.length-1](z,p))};A(K)}})},e.waterfall=function(S,D){if(D=D||function(){},S.constructor!==Array){var T=new Error("First argument to waterfall must be an array of functions");return D(T)}if(!S.length)return D();var p=function(b){return function(A){if(A)D.apply(null,arguments),D=function(){};else{var I=Array.prototype.slice.call(arguments,1),V=b.next();V?I.push(p(V)):I.push(D),e.setImmediate(function(){b.apply(null,I)})}}};p(e.iterator(S))()};var v=function(S,D,T){if(T=T||function(){},D.constructor===Array)S.map(D,function(b,A){b&&b(function(I){var V=Array.prototype.slice.call(arguments,1);V.length<=1&&(V=V[0]),A.call(null,I,V)})},T);else{var p={};S.each(u(D),function(b,A){D[b](function(I){var V=Array.prototype.slice.call(arguments,1);V.length<=1&&(V=V[0]),p[b]=V,A(I)})},function(b){T(b,p)})}};e.parallel=function(S,D){v({map:e.map,each:e.each},S,D)},e.parallelLimit=function(S,D,T){v({map:g(D),each:f(D)},S,T)},e.series=function(S,D){if(D=D||function(){},S.constructor===Array)e.mapSeries(S,function(p,b){p&&p(function(A){var I=Array.prototype.slice.call(arguments,1);I.length<=1&&(I=I[0]),b.call(null,A,I)})},D);else{var T={};e.eachSeries(u(S),function(p,b){S[p](function(A){var I=Array.prototype.slice.call(arguments,1);I.length<=1&&(I=I[0]),T[p]=I,b(A)})},function(p){D(p,T)})}},e.iterator=function(S){var D=function(T){var p=function(){return S.length&&S[T].apply(null,arguments),p.next()};return p.next=function(){return T<S.length-1?D(T+1):null},p};return D(0)},e.apply=function(S){var D=Array.prototype.slice.call(arguments,1);return function(){return S.apply(null,D.concat(Array.prototype.slice.call(arguments)))}};var y=function(S,D,T,p){var b=[];S(D,function(A,I){T(A,function(V,q){b=b.concat(q||[]),I(V)})},function(A){p(A,b)})};e.concat=c(y),e.concatSeries=l(y),e.whilst=function(S,D,T){S()?D(function(p){if(p)return T(p);e.whilst(S,D,T)}):T()},e.doWhilst=function(S,D,T){S(function(p){if(p)return T(p);D()?e.doWhilst(S,D,T):T()})},e.until=function(S,D,T){S()?T():D(function(p){if(p)return T(p);e.until(S,D,T)})},e.doUntil=function(S,D,T){S(function(p){if(p)return T(p);D()?T():e.doUntil(S,D,T)})},e.queue=function(S,D){D===void 0&&(D=1);function T(A,I,V,q){I.constructor!==Array&&(I=[I]),n(I,function(B){var z={data:B,callback:typeof q=="function"?q:null};V?A.tasks.unshift(z):A.tasks.push(z),A.saturated&&A.tasks.length===D&&A.saturated(),e.setImmediate(A.process)})}var p=0,b={tasks:[],concurrency:D,saturated:null,empty:null,drain:null,push:function(A,I){T(b,A,!1,I)},unshift:function(A,I){T(b,A,!0,I)},process:function(){if(p<b.concurrency&&b.tasks.length){var A=b.tasks.shift();b.empty&&b.tasks.length===0&&b.empty(),p+=1;var I=function(){p-=1,A.callback&&A.callback.apply(A,arguments),b.drain&&b.tasks.length+p===0&&b.drain(),b.process()},V=s(I);S(A.data,V)}},length:function(){return b.tasks.length},running:function(){return p}};return b},e.cargo=function(S,D){var T=!1,p=[],b={tasks:p,payload:D,saturated:null,empty:null,drain:null,push:function(A,I){A.constructor!==Array&&(A=[A]),n(A,function(V){p.push({data:V,callback:typeof I=="function"?I:null}),b.saturated&&p.length===D&&b.saturated()}),e.setImmediate(b.process)},process:function A(){if(!T){if(p.length===0){b.drain&&b.drain();return}var I=typeof D=="number"?p.splice(0,D):p.splice(0),V=i(I,function(q){return q.data});b.empty&&b.empty(),T=!0,S(V,function(){T=!1;var q=arguments;n(I,function(B){B.callback&&B.callback.apply(null,q)}),A()})}},length:function(){return p.length},running:function(){return T}};return b};var C=function(S){return function(D){var T=Array.prototype.slice.call(arguments,1);D.apply(null,T.concat([function(p){var b=Array.prototype.slice.call(arguments,1);typeof console<"u"&&(p?console.error&&console.error(p):console[S]&&n(b,function(A){console[S](A)}))}]))}};e.log=C("log"),e.dir=C("dir"),e.memoize=function(S,D){var T={},p={};D=D||function(A){return A};var b=function(){var A=Array.prototype.slice.call(arguments),I=A.pop(),V=D.apply(null,A);V in T?I.apply(null,T[V]):V in p?p[V].push(I):(p[V]=[I],S.apply(null,A.concat([function(){T[V]=arguments;var q=p[V];delete p[V];for(var B=0,z=q.length;B<z;B++)q[B].apply(null,arguments)}])))};return b.memo=T,b.unmemoized=S,b},e.unmemoize=function(S){return function(){return(S.unmemoized||S).apply(null,arguments)}},e.times=function(S,D,T){for(var p=[],b=0;b<S;b++)p.push(b);return e.map(p,D,T)},e.timesSeries=function(S,D,T){for(var p=[],b=0;b<S;b++)p.push(b);return e.mapSeries(p,D,T)},e.compose=function(){var S=Array.prototype.reverse.call(arguments);return function(){var D=this,T=Array.prototype.slice.call(arguments),p=T.pop();e.reduce(S,T,function(b,A,I){A.apply(D,b.concat([function(){var V=arguments[0],q=Array.prototype.slice.call(arguments,1);I(V,q)}]))},function(b,A){p.apply(D,[b].concat(A))})}};var F=function(S,D){var T=function(){var b=this,A=Array.prototype.slice.call(arguments),I=A.pop();return S(D,function(V,q){V.apply(b,A.concat([q]))},I)};if(arguments.length>2){var p=Array.prototype.slice.call(arguments,2);return T.apply(this,p)}else return T};e.applyEach=c(F),e.applyEachSeries=l(F),e.forever=function(S,D){function T(p){if(p){if(D)return D(p);throw p}S(T)}T()},t.exports?t.exports=e:r.async=e})()}(ni)),ni.exports}var ii,Ws;function kf(){if(Ws)return ii;Ws=1;var t=sr.spawn,e=Bi(),r=Ye;function o(s){s._inputs[0].isStream||s.ffprobe(0,function(i,a){s._ffprobeData=a})}return ii=function(s){s._spawnFfmpeg=function(n,i,a,u){typeof i=="function"&&(u=a,a=i,i={}),typeof u>"u"&&(u=a,a=function(){});var f="stdoutLines"in i?i.stdoutLines:this.options.stdoutLines;this._getFfmpegPath(function(c,h){if(c)return u(c);if(!h||h.length===0)return u(new Error("Cannot find ffmpeg"));i.niceness&&i.niceness!==0&&!r.isWindows&&(n.unshift("-n",i.niceness,h),h="nice");var l=r.linesRing(f),d=!1,g=r.linesRing(f),w=!1,E=t(h,n,i);E.stderr&&E.stderr.setEncoding("utf8"),E.on("error",function(C){u(C)});var _=null;function v(C){C&&(_=C),y&&(d||!i.captureStdout)&&w&&u(_,l,g)}var y=!1;E.on("exit",function(C,F){y=!0,F?v(new Error("ffmpeg was killed with signal "+F)):C?v(new Error("ffmpeg exited with code "+C)):v()}),i.captureStdout&&(E.stdout.on("data",function(C){l.append(C)}),E.stdout.on("close",function(){l.close(),d=!0,v()})),E.stderr.on("data",function(C){g.append(C)}),E.stderr.on("close",function(){g.close(),w=!0,v()}),a(E,l,g)})},s._getArguments=function(){var n=this._complexFilters.get(),i=this._outputs.some(function(a){return a.isFile});return[].concat(this._inputs.reduce(function(a,u){var f=typeof u.source=="string"?u.source:"pipe:0";return a.concat(u.options.get(),["-i",f])},[]),this._global.get(),i?["-y"]:[],n,this._outputs.reduce(function(a,u){var f=r.makeFilterStrings(u.sizeFilters.get()),c=u.audioFilters.get(),h=u.videoFilters.get().concat(f),l;return u.target?typeof u.target=="string"?l=[u.target]:l=["pipe:1"]:l=[],a.concat(u.audio.get(),c.length?["-filter:a",c.join(",")]:[],u.video.get(),h.length?["-filter:v",h.join(",")]:[],u.options.get(),l)},[]))},s._prepare=function(n,i){var a=this;e.waterfall([function(u){a._checkCapabilities(u)},function(u){if(!i)return u();a.ffprobe(0,function(f,c){f||(a._ffprobeData=c),u()})},function(u){var f=a._outputs.some(function(c){return c.flags.flvmeta&&!c.isFile&&(a.logger.warn("Updating flv metadata is only supported for files"),c.flags.flvmeta=!1),c.flags.flvmeta});f?a._getFlvtoolPath(function(c){u(c)}):u()},function(u){var f;try{f=a._getArguments()}catch(c){return u(c)}u(null,f)},function(u,f){a.availableEncoders(function(c,h){for(var l=0;l<u.length;l++)(u[l]==="-acodec"||u[l]==="-vcodec")&&(l++,u[l]in h&&h[u[l]].experimental&&(u.splice(l+1,0,"-strict","experimental"),l+=2));f(null,u)})}],n),i||(this.listeners("progress").length>0?o(this):this.once("newListener",function(u){u==="progress"&&o(this)}))},s.exec=s.execute=s.run=function(){var n=this,i=this._outputs.some(function(h){return"target"in h});if(!i)throw new Error("No output specified");var a=this._outputs.filter(function(h){return typeof h.target!="string"})[0],u=this._inputs.filter(function(h){return typeof h.source!="string"})[0],f=!1;function c(h,l,d){f||(f=!0,h?n.emit("error",h,l,d):n.emit("end",l,d))}return n._prepare(function(h,l){if(h)return c(h);n._spawnFfmpeg(l,{captureStdout:!a,niceness:n.options.niceness,cwd:n.options.cwd,windowsHide:!0},function(g,w,E){if(n.ffmpegProc=g,n.emit("start","ffmpeg "+l.join(" ")),u&&(u.source.on("error",function(y){var C=new Error("Input stream error: "+y.message);C.inputStreamError=y,c(C),g.kill()}),u.source.resume(),u.source.pipe(g.stdin),g.stdin.on("error",function(){})),n.options.timeout&&(n.processTimer=setTimeout(function(){var y="process ran into a timeout ("+n.options.timeout+"s)";c(new Error(y),w.get(),E.get()),g.kill()},n.options.timeout*1e3)),a&&(g.stdout.pipe(a.target,a.pipeopts),a.target.on("close",function(){n.logger.debug("Output stream closed, scheduling kill for ffmpeg process"),setTimeout(function(){c(new Error("Output stream closed")),g.kill()},20)}),a.target.on("error",function(y){n.logger.debug("Output stream error, killing ffmpeg process");var C=new Error("Output stream error: "+y.message);C.outputStreamError=y,c(C,w.get(),E.get()),g.kill("SIGKILL")})),E){if(n.listeners("stderr").length&&E.callback(function(y){n.emit("stderr",y)}),n.listeners("codecData").length){var _=!1,v={};E.callback(function(y){_||(_=r.extractCodecData(n,y,v))})}n.listeners("progress").length&&E.callback(function(y){r.extractProgress(n,y)})}},function(g,w,E){if(clearTimeout(n.processTimer),delete n.ffmpegProc,g)g.message.match(/ffmpeg exited with code/)&&(g.message+=": "+r.extractError(E.get())),c(g,w.get(),E.get());else{var _=n._outputs.filter(function(v){return v.flags.flvmeta});_.length?n._getFlvtoolPath(function(v,y){if(v)return c(v);e.each(_,function(C,F){t(y,["-U",C.target],{windowsHide:!0}).on("error",function(S){F(new Error("Error running "+y+" on "+C.target+": "+S.message))}).on("exit",function(S,D){S!==0||D?F(new Error(y+" "+(D?"received signal "+D:"exited with code "+S))+" when running on "+C.target):F()})},function(C){C?c(C):c(null,w.get(),E.get())})}):c(null,w.get(),E.get())}})}),this},s.renice=function(n){if(!r.isWindows&&(n=n||0,(n<-20||n>20)&&this.logger.warn("Invalid niceness value: "+n+", must be between -20 and 20"),n=Math.min(20,Math.max(-20,n)),this.options.niceness=n,this.ffmpegProc)){var i=this.logger,a=this.ffmpegProc.pid,u=t("renice",[n,"-p",a],{windowsHide:!0});u.on("error",function(f){i.warn("could not renice process "+a+": "+f.message)}),u.on("exit",function(f,c){c?i.warn("could not renice process "+a+": renice was killed by signal "+c):f?i.warn("could not renice process "+a+": renice exited with "+f):i.info("successfully reniced process "+a+" to "+n+" niceness")})}return this},s.kill=function(n){return this.ffmpegProc?this.ffmpegProc.kill(n||"SIGKILL"):this.logger.warn("No running ffmpeg process, cannot send signal"),this}},ii}var oi,Hs;function jf(){if(Hs)return oi;Hs=1;var t=ce,e=Z,r=Bi(),o=Ye,s=/^\s*([D ])([E ])([VAS])([S ])([D ])([T ]) ([^ ]+) +(.*)$/,n=/^\s*([D\.])([E\.])([VAS])([I\.])([L\.])([S\.]) ([^ ]+) +(.*)$/,i=/\(encoders:([^\)]+)\)/,a=/\(decoders:([^\)]+)\)/,u=/^\s*([VAS\.])([F\.])([S\.])([X\.])([B\.])([D\.]) ([^ ]+) +(.*)$/,f=/^\s*([D ])([E ])\s+([^ ]+)\s+(.*)$/,c=/\r\n|\r|\n/,h=/^(?: [T\.][S\.][C\.] )?([^ ]+) +(AA?|VV?|\|)->(AA?|VV?|\|) +(.*)$/,l={};return oi=function(d){d.setFfmpegPath=function(g){return l.ffmpegPath=g,this},d.setFfprobePath=function(g){return l.ffprobePath=g,this},d.setFlvtoolPath=function(g){return l.flvtoolPath=g,this},d._forgetPaths=function(){delete l.ffmpegPath,delete l.ffprobePath,delete l.flvtoolPath},d._getFfmpegPath=function(g){if("ffmpegPath"in l)return g(null,l.ffmpegPath);r.waterfall([function(w){process.env.FFMPEG_PATH?t.exists(process.env.FFMPEG_PATH,function(E){E?w(null,process.env.FFMPEG_PATH):w(null,"")}):w(null,"")},function(w,E){if(w.length)return E(null,w);o.which("ffmpeg",function(_,v){E(_,v)})}],function(w,E){w?g(w):g(null,l.ffmpegPath=E||"")})},d._getFfprobePath=function(g){var w=this;if("ffprobePath"in l)return g(null,l.ffprobePath);r.waterfall([function(E){process.env.FFPROBE_PATH?t.exists(process.env.FFPROBE_PATH,function(_){E(null,_?process.env.FFPROBE_PATH:"")}):E(null,"")},function(E,_){if(E.length)return _(null,E);o.which("ffprobe",function(v,y){_(v,y)})},function(E,_){if(E.length)return _(null,E);w._getFfmpegPath(function(v,y){if(v)_(v);else if(y.length){var C=o.isWindows?"ffprobe.exe":"ffprobe",F=e.join(e.dirname(y),C);t.exists(F,function(S){_(null,S?F:"")})}else _(null,"")})}],function(E,_){E?g(E):g(null,l.ffprobePath=_||"")})},d._getFlvtoolPath=function(g){if("flvtoolPath"in l)return g(null,l.flvtoolPath);r.waterfall([function(w){process.env.FLVMETA_PATH?t.exists(process.env.FLVMETA_PATH,function(E){w(null,E?process.env.FLVMETA_PATH:"")}):w(null,"")},function(w,E){if(w.length)return E(null,w);process.env.FLVTOOL2_PATH?t.exists(process.env.FLVTOOL2_PATH,function(_){E(null,_?process.env.FLVTOOL2_PATH:"")}):E(null,"")},function(w,E){if(w.length)return E(null,w);o.which("flvmeta",function(_,v){E(_,v)})},function(w,E){if(w.length)return E(null,w);o.which("flvtool2",function(_,v){E(_,v)})}],function(w,E){w?g(w):g(null,l.flvtoolPath=E||"")})},d.availableFilters=d.getAvailableFilters=function(g){if("filters"in l)return g(null,l.filters);this._spawnFfmpeg(["-filters"],{captureStdout:!0,stdoutLines:0},function(w,E){if(w)return g(w);var _=E.get(),v=_.split(`
`),y={},C={A:"audio",V:"video","|":"none"};v.forEach(function(F){var S=F.match(h);S&&(y[S[1]]={description:S[4],input:C[S[2].charAt(0)],multipleInputs:S[2].length>1,output:C[S[3].charAt(0)],multipleOutputs:S[3].length>1})}),g(null,l.filters=y)})},d.availableCodecs=d.getAvailableCodecs=function(g){if("codecs"in l)return g(null,l.codecs);this._spawnFfmpeg(["-codecs"],{captureStdout:!0,stdoutLines:0},function(w,E){if(w)return g(w);var _=E.get(),v=_.split(c),y={};v.forEach(function(C){var F=C.match(s);if(F&&F[7]!=="="&&(y[F[7]]={type:{V:"video",A:"audio",S:"subtitle"}[F[3]],description:F[8],canDecode:F[1]==="D",canEncode:F[2]==="E",drawHorizBand:F[4]==="S",directRendering:F[5]==="D",weirdFrameTruncation:F[6]==="T"}),F=C.match(n),F&&F[7]!=="="){var S=y[F[7]]={type:{V:"video",A:"audio",S:"subtitle"}[F[3]],description:F[8],canDecode:F[1]==="D",canEncode:F[2]==="E",intraFrameOnly:F[4]==="I",isLossy:F[5]==="L",isLossless:F[6]==="S"},D=S.description.match(i);D=D?D[1].trim().split(" "):[];var T=S.description.match(a);if(T=T?T[1].trim().split(" "):[],D.length||T.length){var p={};o.copy(S,p),delete p.canEncode,delete p.canDecode,D.forEach(function(b){y[b]={},o.copy(p,y[b]),y[b].canEncode=!0}),T.forEach(function(b){b in y||(y[b]={},o.copy(p,y[b])),y[b].canDecode=!0})}}}),g(null,l.codecs=y)})},d.availableEncoders=d.getAvailableEncoders=function(g){if("encoders"in l)return g(null,l.encoders);this._spawnFfmpeg(["-encoders"],{captureStdout:!0,stdoutLines:0},function(w,E){if(w)return g(w);var _=E.get(),v=_.split(c),y={};v.forEach(function(C){var F=C.match(u);F&&F[7]!=="="&&(y[F[7]]={type:{V:"video",A:"audio",S:"subtitle"}[F[1]],description:F[8],frameMT:F[2]==="F",sliceMT:F[3]==="S",experimental:F[4]==="X",drawHorizBand:F[5]==="B",directRendering:F[6]==="D"})}),g(null,l.encoders=y)})},d.availableFormats=d.getAvailableFormats=function(g){if("formats"in l)return g(null,l.formats);this._spawnFfmpeg(["-formats"],{captureStdout:!0,stdoutLines:0},function(w,E){if(w)return g(w);var _=E.get(),v=_.split(c),y={};v.forEach(function(C){var F=C.match(f);F&&F[3].split(",").forEach(function(S){S in y||(y[S]={description:F[4],canDemux:!1,canMux:!1}),F[1]==="D"&&(y[S].canDemux=!0),F[2]==="E"&&(y[S].canMux=!0)})}),g(null,l.formats=y)})},d._checkCapabilities=function(g){var w=this;r.waterfall([function(E){w.availableFormats(E)},function(E,_){var v;if(v=w._outputs.reduce(function(y,C){var F=C.options.find("-f",1);return F&&(!(F[0]in E)||!E[F[0]].canMux)&&y.push(F),y},[]),v.length===1)return _(new Error("Output format "+v[0]+" is not available"));if(v.length>1)return _(new Error("Output formats "+v.join(", ")+" are not available"));if(v=w._inputs.reduce(function(y,C){var F=C.options.find("-f",1);return F&&(!(F[0]in E)||!E[F[0]].canDemux)&&y.push(F[0]),y},[]),v.length===1)return _(new Error("Input format "+v[0]+" is not available"));if(v.length>1)return _(new Error("Input formats "+v.join(", ")+" are not available"));_()},function(E){w.availableEncoders(E)},function(E,_){var v;if(v=w._outputs.reduce(function(y,C){var F=C.audio.find("-acodec",1);return F&&F[0]!=="copy"&&(!(F[0]in E)||E[F[0]].type!=="audio")&&y.push(F[0]),y},[]),v.length===1)return _(new Error("Audio codec "+v[0]+" is not available"));if(v.length>1)return _(new Error("Audio codecs "+v.join(", ")+" are not available"));if(v=w._outputs.reduce(function(y,C){var F=C.video.find("-vcodec",1);return F&&F[0]!=="copy"&&(!(F[0]in E)||E[F[0]].type!=="video")&&y.push(F[0]),y},[]),v.length===1)return _(new Error("Video codec "+v[0]+" is not available"));if(v.length>1)return _(new Error("Video codecs "+v.join(", ")+" are not available"));_()}],g)}},oi}var si,Gs;function qf(){if(Gs)return si;Gs=1;var t=sr.spawn;function e(s){return s.match(/^TAG:/)}function r(s){return s.match(/^DISPOSITION:/)}function o(s){var n=s.split(/\r\n|\r|\n/);n=n.filter(function(h){return h.length>0});var i={streams:[],format:{},chapters:[]};function a(h){for(var l={},d=n.shift();typeof d<"u";){if(d.toLowerCase()=="[/"+h+"]")return l;if(d.match(/^\[/)){d=n.shift();continue}var g=d.match(/^([^=]+)=(.*)$/);g&&(!g[1].match(/^TAG:/)&&g[2].match(/^[0-9]+(\.[0-9]+)?$/)?l[g[1]]=Number(g[2]):l[g[1]]=g[2]),d=n.shift()}return l}for(var u=n.shift();typeof u<"u";){if(u.match(/^\[stream/i)){var f=a("stream");i.streams.push(f)}else if(u.match(/^\[chapter/i)){var c=a("chapter");i.chapters.push(c)}else u.toLowerCase()==="[format]"&&(i.format=a("format"));u=n.shift()}return i}return si=function(s){s.ffprobe=function(){var n,i=null,a=[],u,u=arguments[arguments.length-1],f=!1;function c(h,l){f||(f=!0,u(h,l))}switch(arguments.length){case 3:i=arguments[0],a=arguments[1];break;case 2:typeof arguments[0]=="number"?i=arguments[0]:Array.isArray(arguments[0])&&(a=arguments[0]);break}if(i===null){if(!this._currentInput)return c(new Error("No input specified"));n=this._currentInput}else if(n=this._inputs[i],!n)return c(new Error("Invalid input index"));this._getFfprobePath(function(h,l){if(h)return c(h);if(!l)return c(new Error("Cannot find ffprobe"));var d="",g=!1,w="",E=!1,_=n.isStream?"pipe:0":n.source,v=t(l,["-show_streams","-show_format"].concat(a,_),{windowsHide:!0});n.isStream&&(v.stdin.on("error",function(S){["ECONNRESET","EPIPE","EOF"].indexOf(S.code)>=0||c(S)}),v.stdin.on("close",function(){n.source.pause(),n.source.unpipe(v.stdin)}),n.source.pipe(v.stdin)),v.on("error",u);var y=null;function C(S){if(S&&(y=S),F&&g&&E){if(y)return w&&(y.message+=`
`+w),c(y);var D=o(d);[D.format].concat(D.streams).forEach(function(T){if(T){var p=Object.keys(T).filter(e);p.length&&(T.tags=T.tags||{},p.forEach(function(A){T.tags[A.substr(4)]=T[A],delete T[A]}));var b=Object.keys(T).filter(r);b.length&&(T.disposition=T.disposition||{},b.forEach(function(A){T.disposition[A.substr(12)]=T[A],delete T[A]}))}}),c(null,D)}}var F=!1;v.on("exit",function(S,D){F=!0,S?C(new Error("ffprobe exited with code "+S)):D?C(new Error("ffprobe was killed with signal "+D)):C()}),v.stdout.on("data",function(S){d+=S}),v.stdout.on("close",function(){g=!0,C()}),v.stderr.on("data",function(S){w+=S}),v.stderr.on("close",function(){E=!0,C()})})}},si}var ai,Ys;function Bf(){if(Ys)return ai;Ys=1;var t=ce,e=Z,r=ya.PassThrough,o=Bi(),s=Ye;return ai=function(i){i.saveToFile=i.save=function(a){return this.output(a).run(),this},i.writeToStream=i.pipe=i.stream=function(a,u){if(a&&!("writable"in a)&&(u=a,a=void 0),!a){if(process.version.match(/v0\.8\./))throw new Error("PassThrough stream is not supported on node v0.8");a=new r}return this.output(a,u).run(),a},i.takeScreenshots=i.thumbnail=i.thumbnails=i.screenshot=i.screenshots=function(a,u){var f=this,c=this._currentInput.source;if(a=a||{count:1},typeof a=="number"&&(a={count:a}),"folder"in a||(a.folder=u||"."),"timestamps"in a&&(a.timemarks=a.timestamps),!("timemarks"in a)){if(!a.count)throw new Error("Cannot take screenshots: neither a count nor a timemark list are specified");var h=100/(1+a.count);a.timemarks=[];for(var l=0;l<a.count;l++)a.timemarks.push(h*(l+1)+"%")}if("size"in a){var d=a.size.match(/^(\d+)x(\d+)$/),g=a.size.match(/^(\d+)x\?$/),w=a.size.match(/^\?x(\d+)$/),E=a.size.match(/^(\d+)%$/);if(!d&&!g&&!w&&!E)throw new Error("Invalid size parameter: "+a.size)}var _;function v(y){_?y(null,_):f.ffprobe(function(C,F){_=F,y(C,F)})}return o.waterfall([function(C){if(a.timemarks.some(function(F){return(""+F).match(/^[\d.]+%$/)})){if(typeof c!="string")return C(new Error("Cannot compute screenshot timemarks with an input stream, please specify fixed timemarks"));v(function(F,S){if(F)C(F);else{var D=S.streams.reduce(function(p,b){return b.codec_type==="video"&&b.width*b.height>p.width*p.height?b:p},{width:0,height:0});if(D.width===0)return C(new Error("No video stream in input, cannot take screenshots"));var T=Number(D.duration);if(isNaN(T)&&(T=Number(S.format.duration)),isNaN(T))return C(new Error("Could not get input duration, please specify fixed timemarks"));a.timemarks=a.timemarks.map(function(p){return(""+p).match(/^([\d.]+)%$/)?T*parseFloat(p)/100:p}),C()}})}else C()},function(C){a.timemarks=a.timemarks.map(function(F){return s.timemarkToSeconds(F)}).sort(function(F,S){return F-S}),C()},function(C){var F=a.filename||"tn.png";if(F.indexOf(".")===-1&&(F+=".png"),a.timemarks.length>1&&!F.match(/%(s|0*i)/)){var S=e.extname(F);F=e.join(e.dirname(F),e.basename(F,S)+"_%i"+S)}C(null,F)},function(C,F){if(C.match(/%[bf]/)){if(typeof c!="string")return F(new Error("Cannot replace %f or %b when using an input stream"));C=C.replace(/%f/g,e.basename(c)).replace(/%b/g,e.basename(c,e.extname(c)))}F(null,C)},function(C,F){if(C.match(/%[whr]/)){if(d)return F(null,C,d[1],d[2]);v(function(S,D){if(S)return F(new Error("Could not determine video resolution to replace %w, %h or %r"));var T=D.streams.reduce(function(A,I){return I.codec_type==="video"&&I.width*I.height>A.width*A.height?I:A},{width:0,height:0});if(T.width===0)return F(new Error("No video stream in input, cannot replace %w, %h or %r"));var p=T.width,b=T.height;g?(b=b*Number(g[1])/p,p=Number(g[1])):w?(p=p*Number(w[1])/b,b=Number(w[1])):E&&(p=p*Number(E[1])/100,b=b*Number(E[1])/100),F(null,C,Math.round(p/2)*2,Math.round(b/2)*2)})}else F(null,C,-1,-1)},function(C,F,S,D){C=C.replace(/%r/g,"%wx%h").replace(/%w/g,F).replace(/%h/g,S),D(null,C)},function(C,F){var S=a.timemarks.map(function(D,T){return C.replace(/%s/g,s.timemarkToSeconds(D)).replace(/%(0*)i/g,function(p,b){var A=""+(T+1);return b.substr(0,Math.max(0,b.length+1-A.length))+A})});f.emit("filenames",S),F(null,S)},function(C,F){t.exists(a.folder,function(S){S?F(null,C):t.mkdir(a.folder,function(D){D?F(D):F(null,C)})})}],function(C,F){if(C)return f.emit("error",C);var S=a.timemarks.length,D,T=[D={filter:"split",options:S,outputs:[]}];if("size"in a){f.size(a.size);var p=f._currentOutput.sizeFilters.get().map(function(V,q){return q>0&&(V.inputs="size"+(q-1)),V.outputs="size"+q,V});D.inputs="size"+(p.length-1),T=p.concat(T),f._currentOutput.sizeFilters.clear()}for(var b=0,A=0;A<S;A++){var I="screen"+A;D.outputs.push(I),A===0&&(b=a.timemarks[A],f.seekInput(b)),f.output(e.join(a.folder,F[A])).frames(1).map(I),A>0&&f.seek(a.timemarks[A]-b)}f.complexFilter(T),f.run()}),this},i.mergeToFile=i.concatenate=i.concat=function(a,u){var f=this._inputs.filter(function(h){return!h.isStream})[0],c=this;return this.ffprobe(this._inputs.indexOf(f),function(h,l){if(h)return c.emit("error",h);var d=l.streams.some(function(w){return w.codec_type==="audio"}),g=l.streams.some(function(w){return w.codec_type==="video"});c.output(a,u).complexFilter({filter:"concat",options:{n:c._inputs.length,v:g?1:0,a:d?1:0}}).run()}),this}},ai}var Uf=Z,Xf=$t,iu=ct.EventEmitter,vi=Ye;function ue(t,e){if(!(this instanceof ue))return new ue(t,e);iu.call(this),typeof t=="object"&&!("readable"in t)?e=t:(e=e||{},e.source=t),this._inputs=[],e.source&&this.input(e.source),this._outputs=[],this.output();var r=this;["_global","_complexFilters"].forEach(function(o){r[o]=vi.args()}),e.stdoutLines="stdoutLines"in e?e.stdoutLines:100,e.presets=e.presets||e.preset||Uf.join(__dirname,"presets"),e.niceness=e.niceness||e.priority||0,this.options=e,this.logger=e.logger||{debug:function(){},info:function(){},warn:function(){},error:function(){}}}Xf.inherits(ue,iu);var Vf=ue;ue.prototype.clone=function(){var t=new ue,e=this;return t.options=this.options,t.logger=this.logger,t._inputs=this._inputs.map(function(r){return{source:r.source,options:r.options.clone()}}),"target"in this._outputs[0]?(t._outputs=[],t.output()):(t._outputs=[t._currentOutput={flags:{}}],["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(r){t._currentOutput[r]=e._currentOutput[r].clone()}),this._currentOutput.sizeData&&(t._currentOutput.sizeData={},vi.copy(this._currentOutput.sizeData,t._currentOutput.sizeData)),vi.copy(this._currentOutput.flags,t._currentOutput.flags)),["_global","_complexFilters"].forEach(function(r){t[r]=e[r].clone()}),t};Nf()(ue.prototype);xf()(ue.prototype);Pf()(ue.prototype);If()(ue.prototype);Lf()(ue.prototype);Mf()(ue.prototype);Rf()(ue.prototype);kf()(ue.prototype);jf()(ue.prototype);ue.setFfmpegPath=function(t){new ue().setFfmpegPath(t)};ue.setFfprobePath=function(t){new ue().setFfprobePath(t)};ue.setFlvtoolPath=function(t){new ue().setFlvtoolPath(t)};ue.availableFilters=ue.getAvailableFilters=function(t){new ue().availableFilters(t)};ue.availableCodecs=ue.getAvailableCodecs=function(t){new ue().availableCodecs(t)};ue.availableFormats=ue.getAvailableFormats=function(t){new ue().availableFormats(t)};ue.availableEncoders=ue.getAvailableEncoders=function(t){new ue().availableEncoders(t)};qf()(ue.prototype);ue.ffprobe=function(t){var e=new ue(t);e.ffprobe.apply(e,Array.prototype.slice.call(arguments,1))};Bf()(ue.prototype);var zf=Vf;const nt=vt(zf);function Wf(){let t,e,r;const o=process.platform,s=o==="win32"?"ffmpeg.exe":"ffmpeg",n=o==="win32"?"ffprobe.exe":"ffprobe";se.app.isPackaged?r=process.resourcesPath:r=Z.join(se.app.getAppPath(),"bin"),t=Z.join(r,s),e=Z.join(r,n),nt.setFfmpegPath(t),nt.setFfprobePath(e),Hf()}function Hf(){return new Promise((t,e)=>{const r=nt();r.on("stderr",o=>console.log("FFmpeg:",o)),r.output("-").addOption("-version").on("error",e).on("end",(o,s)=>{const n=s.split(`
`).find(i=>i.includes("ffmpeg version"));t(n||"FFmpeg version unknown")}).run()})}function xt(t){return new Promise((e,r)=>{nt.ffprobe(t,(o,s)=>{if(o)return r(o);e(s.format.duration||0)})})}async function Gf(t){return new Promise(e=>{nt.ffprobe(t,(r,o)=>{if(r)return oe.error("FFprobe检测音频流失败:",{filePath:t,error:r.message}),e(!1);const s=o.streams.some(n=>n.codec_type==="audio");oe.verbose(`音频流检测结果: ${t} -> ${s?"有":"无"}音频`),e(s)})})}function Yf(){if(se.app.isPackaged)return Z.join(process.resourcesPath,"fonts");{const t=Z.join(__dirname,"../../fonts");if(ce.existsSync(t))return t;{const e={win32:"C:/Windows/Fonts/",darwin:"/System/Library/Fonts/",linux:"/usr/share/fonts/"},r=process.platform;return Z.join(e[r]||"")}}}const dt="zhushou";function Jf(){return se.app.isPackaged?Z.dirname(process.execPath):se.app.getAppPath()}function ft(){try{const t=Jf(),e=Z.join(t,"data");return ce.existsSync(e)||ce.mkdirSync(e,{recursive:!0}),e}catch(t){switch(console.error("Failed to create zhushou directory:",t),process.platform){case"win32":return Z.join(se.app.getPath("appData"),dt);case"darwin":return Z.join(se.app.getPath("appData"),dt);case"linux":return Z.join(se.app.getPath("appData"),dt);default:return Z.join(se.app.getPath("documents"),dt)}}}function ou(){try{const t=ft();ce.existsSync(t)||(ce.mkdirSync(t),console.log("Created zhushou directory at:",t));try{ce.accessSync(t,ce.constants.W_OK)}catch{return console.error("No write permission for zhushou directory, falling back to documents"),Z.join(se.app.getPath("documents"),dt)}return t}catch(t){return console.error("Failed to create zhushou directory:",t),Z.join(se.app.getPath("documents"),dt)}}function Kf(){se.ipcMain.handle("get-default-save-path",()=>ou())}async function su(t){try{const e={text:t.text,voice:t.voice||"xiaoyun",format:t.format||"mp3",sample_rate:t.sample_rate||16e3,volume:t.volume||50,speech_rate:t.speech_rate||0,pitch_rate:t.pitch_rate||0},r=t.outputDir||ft(),o=t.outputFileName||`tts_${Date.now()}`,s=await wf();Cr.existsSync(r)||Cr.mkdirSync(r,{recursive:!0});const n=new nl({url:nr.ttsUrl,appkey:nr.appkey,token:s}),i=Z.join(r,`${o}.${e.format||"mp3"}`),a=Cr.createWriteStream(i);return oe.log(i),new Promise((u,f)=>{n.on("meta",c=>{oe.info("接收到元信息:",c)}),n.on("data",c=>{try{a.write(c),oe.debug(`接收到数据块，大小: ${c.length} bytes`)}catch(h){oe.error("写入文件失败:",h),f(h)}}),n.on("completed",async()=>{a.end(),oe.info("语音合成完成");const c=await xt(i);oe.info(`语音合成完成，时长: ${c}秒`),u({success:!0,outputFile:i,duration:Math.floor(c*1e3)/1e3})}),n.on("closed",()=>{oe.info("连接已关闭")}),n.on("failed",c=>{a.end(),oe.error("语音合成失败:",c),f(c)}),n.start(e,!0,6e3)})}catch(e){throw oe.error("语音合成初始化失败:",e),e}}function Qf(){se.ipcMain.handle("text2voice",async(t,e)=>{const r=JSON.parse(Nt(e));return oe.log("accept params:"),oe.log(JSON.stringify(r)),su(r)})}var Ie={},Ee={};Ee.fromCallback=function(t){return Object.defineProperty(function(...e){if(typeof e[e.length-1]=="function")t.apply(this,e);else return new Promise((r,o)=>{e.push((s,n)=>s!=null?o(s):r(n)),t.apply(this,e)})},"name",{value:t.name})};Ee.fromPromise=function(t){return Object.defineProperty(function(...e){const r=e[e.length-1];if(typeof r!="function")return t.apply(this,e);e.pop(),t.apply(this,e).then(o=>r(null,o),r)},"name",{value:t.name})};var Je=ec,Zf=process.cwd,tr=null,eh=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return tr||(tr=Zf.call(process)),tr};try{process.cwd()}catch{}if(typeof process.chdir=="function"){var Js=process.chdir;process.chdir=function(t){tr=null,Js.call(process,t)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Js)}var th=rh;function rh(t){Je.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&e(t),t.lutimes||r(t),t.chown=n(t.chown),t.fchown=n(t.fchown),t.lchown=n(t.lchown),t.chmod=o(t.chmod),t.fchmod=o(t.fchmod),t.lchmod=o(t.lchmod),t.chownSync=i(t.chownSync),t.fchownSync=i(t.fchownSync),t.lchownSync=i(t.lchownSync),t.chmodSync=s(t.chmodSync),t.fchmodSync=s(t.fchmodSync),t.lchmodSync=s(t.lchmodSync),t.stat=a(t.stat),t.fstat=a(t.fstat),t.lstat=a(t.lstat),t.statSync=u(t.statSync),t.fstatSync=u(t.fstatSync),t.lstatSync=u(t.lstatSync),t.chmod&&!t.lchmod&&(t.lchmod=function(c,h,l){l&&process.nextTick(l)},t.lchmodSync=function(){}),t.chown&&!t.lchown&&(t.lchown=function(c,h,l,d){d&&process.nextTick(d)},t.lchownSync=function(){}),eh==="win32"&&(t.rename=typeof t.rename!="function"?t.rename:function(c){function h(l,d,g){var w=Date.now(),E=0;c(l,d,function _(v){if(v&&(v.code==="EACCES"||v.code==="EPERM"||v.code==="EBUSY")&&Date.now()-w<6e4){setTimeout(function(){t.stat(d,function(y,C){y&&y.code==="ENOENT"?c(l,d,_):g(v)})},E),E<100&&(E+=10);return}g&&g(v)})}return Object.setPrototypeOf&&Object.setPrototypeOf(h,c),h}(t.rename)),t.read=typeof t.read!="function"?t.read:function(c){function h(l,d,g,w,E,_){var v;if(_&&typeof _=="function"){var y=0;v=function(C,F,S){if(C&&C.code==="EAGAIN"&&y<10)return y++,c.call(t,l,d,g,w,E,v);_.apply(this,arguments)}}return c.call(t,l,d,g,w,E,v)}return Object.setPrototypeOf&&Object.setPrototypeOf(h,c),h}(t.read),t.readSync=typeof t.readSync!="function"?t.readSync:function(c){return function(h,l,d,g,w){for(var E=0;;)try{return c.call(t,h,l,d,g,w)}catch(_){if(_.code==="EAGAIN"&&E<10){E++;continue}throw _}}}(t.readSync);function e(c){c.lchmod=function(h,l,d){c.open(h,Je.O_WRONLY|Je.O_SYMLINK,l,function(g,w){if(g){d&&d(g);return}c.fchmod(w,l,function(E){c.close(w,function(_){d&&d(E||_)})})})},c.lchmodSync=function(h,l){var d=c.openSync(h,Je.O_WRONLY|Je.O_SYMLINK,l),g=!0,w;try{w=c.fchmodSync(d,l),g=!1}finally{if(g)try{c.closeSync(d)}catch{}else c.closeSync(d)}return w}}function r(c){Je.hasOwnProperty("O_SYMLINK")&&c.futimes?(c.lutimes=function(h,l,d,g){c.open(h,Je.O_SYMLINK,function(w,E){if(w){g&&g(w);return}c.futimes(E,l,d,function(_){c.close(E,function(v){g&&g(_||v)})})})},c.lutimesSync=function(h,l,d){var g=c.openSync(h,Je.O_SYMLINK),w,E=!0;try{w=c.futimesSync(g,l,d),E=!1}finally{if(E)try{c.closeSync(g)}catch{}else c.closeSync(g)}return w}):c.futimes&&(c.lutimes=function(h,l,d,g){g&&process.nextTick(g)},c.lutimesSync=function(){})}function o(c){return c&&function(h,l,d){return c.call(t,h,l,function(g){f(g)&&(g=null),d&&d.apply(this,arguments)})}}function s(c){return c&&function(h,l){try{return c.call(t,h,l)}catch(d){if(!f(d))throw d}}}function n(c){return c&&function(h,l,d,g){return c.call(t,h,l,d,function(w){f(w)&&(w=null),g&&g.apply(this,arguments)})}}function i(c){return c&&function(h,l,d){try{return c.call(t,h,l,d)}catch(g){if(!f(g))throw g}}}function a(c){return c&&function(h,l,d){typeof l=="function"&&(d=l,l=null);function g(w,E){E&&(E.uid<0&&(E.uid+=4294967296),E.gid<0&&(E.gid+=4294967296)),d&&d.apply(this,arguments)}return l?c.call(t,h,l,g):c.call(t,h,g)}}function u(c){return c&&function(h,l){var d=l?c.call(t,h,l):c.call(t,h);return d&&(d.uid<0&&(d.uid+=4294967296),d.gid<0&&(d.gid+=4294967296)),d}}function f(c){if(!c||c.code==="ENOSYS")return!0;var h=!process.getuid||process.getuid()!==0;return!!(h&&(c.code==="EINVAL"||c.code==="EPERM"))}}var Ks=ya.Stream,nh=ih;function ih(t){return{ReadStream:e,WriteStream:r};function e(o,s){if(!(this instanceof e))return new e(o,s);Ks.call(this);var n=this;this.path=o,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,s=s||{};for(var i=Object.keys(s),a=0,u=i.length;a<u;a++){var f=i[a];this[f]=s[f]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){n._read()});return}t.open(this.path,this.flags,this.mode,function(c,h){if(c){n.emit("error",c),n.readable=!1;return}n.fd=h,n.emit("open",h),n._read()})}function r(o,s){if(!(this instanceof r))return new r(o,s);Ks.call(this),this.path=o,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,s=s||{};for(var n=Object.keys(s),i=0,a=n.length;i<a;i++){var u=n[i];this[u]=s[u]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}var oh=ah,sh=Object.getPrototypeOf||function(t){return t.__proto__};function ah(t){if(t===null||typeof t!="object")return t;if(t instanceof Object)var e={__proto__:sh(t)};else var e=Object.create(null);return Object.getOwnPropertyNames(t).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}),e}var de=ce,uh=th,ch=nh,lh=oh,Jt=$t,Oe,or;typeof Symbol=="function"&&typeof Symbol.for=="function"?(Oe=Symbol.for("graceful-fs.queue"),or=Symbol.for("graceful-fs.previous")):(Oe="___graceful-fs.queue",or="___graceful-fs.previous");function fh(){}function au(t,e){Object.defineProperty(t,Oe,{get:function(){return e}})}var ut=fh;Jt.debuglog?ut=Jt.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(ut=function(){var t=Jt.format.apply(Jt,arguments);t="GFS4: "+t.split(/\n/).join(`
GFS4: `),console.error(t)});if(!de[Oe]){var hh=ne[Oe]||[];au(de,hh),de.close=function(t){function e(r,o){return t.call(de,r,function(s){s||Qs(),typeof o=="function"&&o.apply(this,arguments)})}return Object.defineProperty(e,or,{value:t}),e}(de.close),de.closeSync=function(t){function e(r){t.apply(de,arguments),Qs()}return Object.defineProperty(e,or,{value:t}),e}(de.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){ut(de[Oe]),cr.equal(de[Oe].length,0)})}ne[Oe]||au(ne,de[Oe]);var Et=Ui(lh(de));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!de.__patched&&(Et=Ui(de),de.__patched=!0);function Ui(t){uh(t),t.gracefulify=Ui,t.createReadStream=F,t.createWriteStream=S;var e=t.readFile;t.readFile=r;function r(p,b,A){return typeof b=="function"&&(A=b,b=null),I(p,b,A);function I(V,q,B,z){return e(V,q,function(W){W&&(W.code==="EMFILE"||W.code==="ENFILE")?pt([I,[V,q,B],W,z||Date.now(),Date.now()]):typeof B=="function"&&B.apply(this,arguments)})}}var o=t.writeFile;t.writeFile=s;function s(p,b,A,I){return typeof A=="function"&&(I=A,A=null),V(p,b,A,I);function V(q,B,z,W,J){return o(q,B,z,function(K){K&&(K.code==="EMFILE"||K.code==="ENFILE")?pt([V,[q,B,z,W],K,J||Date.now(),Date.now()]):typeof W=="function"&&W.apply(this,arguments)})}}var n=t.appendFile;n&&(t.appendFile=i);function i(p,b,A,I){return typeof A=="function"&&(I=A,A=null),V(p,b,A,I);function V(q,B,z,W,J){return n(q,B,z,function(K){K&&(K.code==="EMFILE"||K.code==="ENFILE")?pt([V,[q,B,z,W],K,J||Date.now(),Date.now()]):typeof W=="function"&&W.apply(this,arguments)})}}var a=t.copyFile;a&&(t.copyFile=u);function u(p,b,A,I){return typeof A=="function"&&(I=A,A=0),V(p,b,A,I);function V(q,B,z,W,J){return a(q,B,z,function(K){K&&(K.code==="EMFILE"||K.code==="ENFILE")?pt([V,[q,B,z,W],K,J||Date.now(),Date.now()]):typeof W=="function"&&W.apply(this,arguments)})}}var f=t.readdir;t.readdir=h;var c=/^v[0-5]\./;function h(p,b,A){typeof b=="function"&&(A=b,b=null);var I=c.test(process.version)?function(B,z,W,J){return f(B,V(B,z,W,J))}:function(B,z,W,J){return f(B,z,V(B,z,W,J))};return I(p,b,A);function V(q,B,z,W){return function(J,K){J&&(J.code==="EMFILE"||J.code==="ENFILE")?pt([I,[q,B,z],J,W||Date.now(),Date.now()]):(K&&K.sort&&K.sort(),typeof z=="function"&&z.call(this,J,K))}}}if(process.version.substr(0,4)==="v0.8"){var l=ch(t);_=l.ReadStream,y=l.WriteStream}var d=t.ReadStream;d&&(_.prototype=Object.create(d.prototype),_.prototype.open=v);var g=t.WriteStream;g&&(y.prototype=Object.create(g.prototype),y.prototype.open=C),Object.defineProperty(t,"ReadStream",{get:function(){return _},set:function(p){_=p},enumerable:!0,configurable:!0}),Object.defineProperty(t,"WriteStream",{get:function(){return y},set:function(p){y=p},enumerable:!0,configurable:!0});var w=_;Object.defineProperty(t,"FileReadStream",{get:function(){return w},set:function(p){w=p},enumerable:!0,configurable:!0});var E=y;Object.defineProperty(t,"FileWriteStream",{get:function(){return E},set:function(p){E=p},enumerable:!0,configurable:!0});function _(p,b){return this instanceof _?(d.apply(this,arguments),this):_.apply(Object.create(_.prototype),arguments)}function v(){var p=this;T(p.path,p.flags,p.mode,function(b,A){b?(p.autoClose&&p.destroy(),p.emit("error",b)):(p.fd=A,p.emit("open",A),p.read())})}function y(p,b){return this instanceof y?(g.apply(this,arguments),this):y.apply(Object.create(y.prototype),arguments)}function C(){var p=this;T(p.path,p.flags,p.mode,function(b,A){b?(p.destroy(),p.emit("error",b)):(p.fd=A,p.emit("open",A))})}function F(p,b){return new t.ReadStream(p,b)}function S(p,b){return new t.WriteStream(p,b)}var D=t.open;t.open=T;function T(p,b,A,I){return typeof A=="function"&&(I=A,A=null),V(p,b,A,I);function V(q,B,z,W,J){return D(q,B,z,function(K,Q){K&&(K.code==="EMFILE"||K.code==="ENFILE")?pt([V,[q,B,z,W],K,J||Date.now(),Date.now()]):typeof W=="function"&&W.apply(this,arguments)})}}return t}function pt(t){ut("ENQUEUE",t[0].name,t[1]),de[Oe].push(t),Xi()}var Kt;function Qs(){for(var t=Date.now(),e=0;e<de[Oe].length;++e)de[Oe][e].length>2&&(de[Oe][e][3]=t,de[Oe][e][4]=t);Xi()}function Xi(){if(clearTimeout(Kt),Kt=void 0,de[Oe].length!==0){var t=de[Oe].shift(),e=t[0],r=t[1],o=t[2],s=t[3],n=t[4];if(s===void 0)ut("RETRY",e.name,r),e.apply(null,r);else if(Date.now()-s>=6e4){ut("TIMEOUT",e.name,r);var i=r.pop();typeof i=="function"&&i.call(null,o)}else{var a=Date.now()-n,u=Math.max(n-s,1),f=Math.min(u*1.2,100);a>=f?(ut("RETRY",e.name,r),e.apply(null,r.concat([s]))):de[Oe].push(t)}Kt===void 0&&(Kt=setTimeout(Xi,0))}}(function(t){const e=Ee.fromCallback,r=Et,o=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter(s=>typeof r[s]=="function");Object.assign(t,r),o.forEach(s=>{t[s]=e(r[s])}),t.exists=function(s,n){return typeof n=="function"?r.exists(s,n):new Promise(i=>r.exists(s,i))},t.read=function(s,n,i,a,u,f){return typeof f=="function"?r.read(s,n,i,a,u,f):new Promise((c,h)=>{r.read(s,n,i,a,u,(l,d,g)=>{if(l)return h(l);c({bytesRead:d,buffer:g})})})},t.write=function(s,n,...i){return typeof i[i.length-1]=="function"?r.write(s,n,...i):new Promise((a,u)=>{r.write(s,n,...i,(f,c,h)=>{if(f)return u(f);a({bytesWritten:c,buffer:h})})})},t.readv=function(s,n,...i){return typeof i[i.length-1]=="function"?r.readv(s,n,...i):new Promise((a,u)=>{r.readv(s,n,...i,(f,c,h)=>{if(f)return u(f);a({bytesRead:c,buffers:h})})})},t.writev=function(s,n,...i){return typeof i[i.length-1]=="function"?r.writev(s,n,...i):new Promise((a,u)=>{r.writev(s,n,...i,(f,c,h)=>{if(f)return u(f);a({bytesWritten:c,buffers:h})})})},typeof r.realpath.native=="function"?t.realpath.native=e(r.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")})(Ie);var Vi={},uu={};const ph=Z;uu.checkPath=function(e){if(process.platform==="win32"&&/[<>:"|?*]/.test(e.replace(ph.parse(e).root,""))){const o=new Error(`Path contains invalid characters: ${e}`);throw o.code="EINVAL",o}};const cu=Ie,{checkPath:lu}=uu,fu=t=>{const e={mode:511};return typeof t=="number"?t:{...e,...t}.mode};Vi.makeDir=async(t,e)=>(lu(t),cu.mkdir(t,{mode:fu(e),recursive:!0}));Vi.makeDirSync=(t,e)=>(lu(t),cu.mkdirSync(t,{mode:fu(e),recursive:!0}));const dh=Ee.fromPromise,{makeDir:mh,makeDirSync:ui}=Vi,ci=dh(mh);var Ue={mkdirs:ci,mkdirsSync:ui,mkdirp:ci,mkdirpSync:ui,ensureDir:ci,ensureDirSync:ui};const yh=Ee.fromPromise,hu=Ie;function gh(t){return hu.access(t).then(()=>!0).catch(()=>!1)}var ht={pathExists:yh(gh),pathExistsSync:hu.existsSync};const mt=Ie,vh=Ee.fromPromise;async function wh(t,e,r){const o=await mt.open(t,"r+");let s=null;try{await mt.futimes(o,e,r)}finally{try{await mt.close(o)}catch(n){s=n}}if(s)throw s}function Eh(t,e,r){const o=mt.openSync(t,"r+");return mt.futimesSync(o,e,r),mt.closeSync(o)}var pu={utimesMillis:vh(wh),utimesMillisSync:Eh};const yt=Ie,be=Z,Zs=Ee.fromPromise;function bh(t,e,r){const o=r.dereference?s=>yt.stat(s,{bigint:!0}):s=>yt.lstat(s,{bigint:!0});return Promise.all([o(t),o(e).catch(s=>{if(s.code==="ENOENT")return null;throw s})]).then(([s,n])=>({srcStat:s,destStat:n}))}function Sh(t,e,r){let o;const s=r.dereference?i=>yt.statSync(i,{bigint:!0}):i=>yt.lstatSync(i,{bigint:!0}),n=s(t);try{o=s(e)}catch(i){if(i.code==="ENOENT")return{srcStat:n,destStat:null};throw i}return{srcStat:n,destStat:o}}async function Oh(t,e,r,o){const{srcStat:s,destStat:n}=await bh(t,e,o);if(n){if(Rt(s,n)){const i=be.basename(t),a=be.basename(e);if(r==="move"&&i!==a&&i.toLowerCase()===a.toLowerCase())return{srcStat:s,destStat:n,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(s.isDirectory()&&!n.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`);if(!s.isDirectory()&&n.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`)}if(s.isDirectory()&&zi(t,e))throw new Error(wr(t,e,r));return{srcStat:s,destStat:n}}function Th(t,e,r,o){const{srcStat:s,destStat:n}=Sh(t,e,o);if(n){if(Rt(s,n)){const i=be.basename(t),a=be.basename(e);if(r==="move"&&i!==a&&i.toLowerCase()===a.toLowerCase())return{srcStat:s,destStat:n,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(s.isDirectory()&&!n.isDirectory())throw new Error(`Cannot overwrite non-directory '${e}' with directory '${t}'.`);if(!s.isDirectory()&&n.isDirectory())throw new Error(`Cannot overwrite directory '${e}' with non-directory '${t}'.`)}if(s.isDirectory()&&zi(t,e))throw new Error(wr(t,e,r));return{srcStat:s,destStat:n}}async function du(t,e,r,o){const s=be.resolve(be.dirname(t)),n=be.resolve(be.dirname(r));if(n===s||n===be.parse(n).root)return;let i;try{i=await yt.stat(n,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(Rt(e,i))throw new Error(wr(t,r,o));return du(t,e,n,o)}function mu(t,e,r,o){const s=be.resolve(be.dirname(t)),n=be.resolve(be.dirname(r));if(n===s||n===be.parse(n).root)return;let i;try{i=yt.statSync(n,{bigint:!0})}catch(a){if(a.code==="ENOENT")return;throw a}if(Rt(e,i))throw new Error(wr(t,r,o));return mu(t,e,n,o)}function Rt(t,e){return e.ino&&e.dev&&e.ino===t.ino&&e.dev===t.dev}function zi(t,e){const r=be.resolve(t).split(be.sep).filter(s=>s),o=be.resolve(e).split(be.sep).filter(s=>s);return r.every((s,n)=>o[n]===s)}function wr(t,e,r){return`Cannot ${r} '${t}' to a subdirectory of itself, '${e}'.`}var bt={checkPaths:Zs(Oh),checkPathsSync:Th,checkParentPaths:Zs(du),checkParentPathsSync:mu,isSrcSubdir:zi,areIdentical:Rt};const _e=Ie,Pt=Z,{mkdirs:Ch}=Ue,{pathExists:Dh}=ht,{utimesMillis:Fh}=pu,It=bt;async function Ah(t,e,r={}){typeof r=="function"&&(r={filter:r}),r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");const{srcStat:o,destStat:s}=await It.checkPaths(t,e,"copy",r);if(await It.checkParentPaths(t,o,e,"copy"),!await yu(t,e,r))return;const i=Pt.dirname(e);await Dh(i)||await Ch(i),await gu(s,t,e,r)}async function yu(t,e,r){return r.filter?r.filter(t,e):!0}async function gu(t,e,r,o){const n=await(o.dereference?_e.stat:_e.lstat)(e);if(n.isDirectory())return Ph(n,t,e,r,o);if(n.isFile()||n.isCharacterDevice()||n.isBlockDevice())return _h(n,t,e,r,o);if(n.isSymbolicLink())return Ih(t,e,r,o);throw n.isSocket()?new Error(`Cannot copy a socket file: ${e}`):n.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}async function _h(t,e,r,o,s){if(!e)return ea(t,r,o,s);if(s.overwrite)return await _e.unlink(o),ea(t,r,o,s);if(s.errorOnExist)throw new Error(`'${o}' already exists`)}async function ea(t,e,r,o){if(await _e.copyFile(e,r),o.preserveTimestamps){Nh(t.mode)&&await xh(r,t.mode);const s=await _e.stat(e);await Fh(r,s.atime,s.mtime)}return _e.chmod(r,t.mode)}function Nh(t){return(t&128)===0}function xh(t,e){return _e.chmod(t,e|128)}async function Ph(t,e,r,o,s){e||await _e.mkdir(o);const n=[];for await(const i of await _e.opendir(r)){const a=Pt.join(r,i.name),u=Pt.join(o,i.name);n.push(yu(a,u,s).then(f=>{if(f)return It.checkPaths(a,u,"copy",s).then(({destStat:c})=>gu(c,a,u,s))}))}await Promise.all(n),e||await _e.chmod(o,t.mode)}async function Ih(t,e,r,o){let s=await _e.readlink(e);if(o.dereference&&(s=Pt.resolve(process.cwd(),s)),!t)return _e.symlink(s,r);let n=null;try{n=await _e.readlink(r)}catch(i){if(i.code==="EINVAL"||i.code==="UNKNOWN")return _e.symlink(s,r);throw i}if(o.dereference&&(n=Pt.resolve(process.cwd(),n)),It.isSrcSubdir(s,n))throw new Error(`Cannot copy '${s}' to a subdirectory of itself, '${n}'.`);if(It.isSrcSubdir(n,s))throw new Error(`Cannot overwrite '${n}' with '${s}'.`);return await _e.unlink(r),_e.symlink(s,r)}var Lh=Ah;const xe=Et,Lt=Z,Mh=Ue.mkdirsSync,$h=pu.utimesMillisSync,Mt=bt;function Rh(t,e,r){typeof r=="function"&&(r={filter:r}),r=r||{},r.clobber="clobber"in r?!!r.clobber:!0,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&process.arch==="ia32"&&process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");const{srcStat:o,destStat:s}=Mt.checkPathsSync(t,e,"copy",r);if(Mt.checkParentPathsSync(t,o,e,"copy"),r.filter&&!r.filter(t,e))return;const n=Lt.dirname(e);return xe.existsSync(n)||Mh(n),vu(s,t,e,r)}function vu(t,e,r,o){const n=(o.dereference?xe.statSync:xe.lstatSync)(e);if(n.isDirectory())return Vh(n,t,e,r,o);if(n.isFile()||n.isCharacterDevice()||n.isBlockDevice())return kh(n,t,e,r,o);if(n.isSymbolicLink())return Hh(t,e,r,o);throw n.isSocket()?new Error(`Cannot copy a socket file: ${e}`):n.isFIFO()?new Error(`Cannot copy a FIFO pipe: ${e}`):new Error(`Unknown file: ${e}`)}function kh(t,e,r,o,s){return e?jh(t,r,o,s):wu(t,r,o,s)}function jh(t,e,r,o){if(o.overwrite)return xe.unlinkSync(r),wu(t,e,r,o);if(o.errorOnExist)throw new Error(`'${r}' already exists`)}function wu(t,e,r,o){return xe.copyFileSync(e,r),o.preserveTimestamps&&qh(t.mode,e,r),Wi(r,t.mode)}function qh(t,e,r){return Bh(t)&&Uh(r,t),Xh(e,r)}function Bh(t){return(t&128)===0}function Uh(t,e){return Wi(t,e|128)}function Wi(t,e){return xe.chmodSync(t,e)}function Xh(t,e){const r=xe.statSync(t);return $h(e,r.atime,r.mtime)}function Vh(t,e,r,o,s){return e?Eu(r,o,s):zh(t.mode,r,o,s)}function zh(t,e,r,o){return xe.mkdirSync(r),Eu(e,r,o),Wi(r,t)}function Eu(t,e,r){const o=xe.opendirSync(t);try{let s;for(;(s=o.readSync())!==null;)Wh(s.name,t,e,r)}finally{o.closeSync()}}function Wh(t,e,r,o){const s=Lt.join(e,t),n=Lt.join(r,t);if(o.filter&&!o.filter(s,n))return;const{destStat:i}=Mt.checkPathsSync(s,n,"copy",o);return vu(i,s,n,o)}function Hh(t,e,r,o){let s=xe.readlinkSync(e);if(o.dereference&&(s=Lt.resolve(process.cwd(),s)),t){let n;try{n=xe.readlinkSync(r)}catch(i){if(i.code==="EINVAL"||i.code==="UNKNOWN")return xe.symlinkSync(s,r);throw i}if(o.dereference&&(n=Lt.resolve(process.cwd(),n)),Mt.isSrcSubdir(s,n))throw new Error(`Cannot copy '${s}' to a subdirectory of itself, '${n}'.`);if(Mt.isSrcSubdir(n,s))throw new Error(`Cannot overwrite '${n}' with '${s}'.`);return Gh(s,r)}else return xe.symlinkSync(s,r)}function Gh(t,e){return xe.unlinkSync(e),xe.symlinkSync(t,e)}var Yh=Rh;const Jh=Ee.fromPromise;var Hi={copy:Jh(Lh),copySync:Yh};const bu=Et,Kh=Ee.fromCallback;function Qh(t,e){bu.rm(t,{recursive:!0,force:!0},e)}function Zh(t){bu.rmSync(t,{recursive:!0,force:!0})}var Er={remove:Kh(Qh),removeSync:Zh};const ep=Ee.fromPromise,Su=Ie,Ou=Z,Tu=Ue,Cu=Er,ta=ep(async function(e){let r;try{r=await Su.readdir(e)}catch{return Tu.mkdirs(e)}return Promise.all(r.map(o=>Cu.remove(Ou.join(e,o))))});function ra(t){let e;try{e=Su.readdirSync(t)}catch{return Tu.mkdirsSync(t)}e.forEach(r=>{r=Ou.join(t,r),Cu.removeSync(r)})}var tp={emptyDirSync:ra,emptydirSync:ra,emptyDir:ta,emptydir:ta};const rp=Ee.fromPromise,Du=Z,He=Ie,Fu=Ue;async function np(t){let e;try{e=await He.stat(t)}catch{}if(e&&e.isFile())return;const r=Du.dirname(t);let o=null;try{o=await He.stat(r)}catch(s){if(s.code==="ENOENT"){await Fu.mkdirs(r),await He.writeFile(t,"");return}else throw s}o.isDirectory()?await He.writeFile(t,""):await He.readdir(r)}function ip(t){let e;try{e=He.statSync(t)}catch{}if(e&&e.isFile())return;const r=Du.dirname(t);try{He.statSync(r).isDirectory()||He.readdirSync(r)}catch(o){if(o&&o.code==="ENOENT")Fu.mkdirsSync(r);else throw o}He.writeFileSync(t,"")}var op={createFile:rp(np),createFileSync:ip};const sp=Ee.fromPromise,Au=Z,et=Ie,_u=Ue,{pathExists:ap}=ht,{areIdentical:Nu}=bt;async function up(t,e){let r;try{r=await et.lstat(e)}catch{}let o;try{o=await et.lstat(t)}catch(i){throw i.message=i.message.replace("lstat","ensureLink"),i}if(r&&Nu(o,r))return;const s=Au.dirname(e);await ap(s)||await _u.mkdirs(s),await et.link(t,e)}function cp(t,e){let r;try{r=et.lstatSync(e)}catch{}try{const n=et.lstatSync(t);if(r&&Nu(n,r))return}catch(n){throw n.message=n.message.replace("lstat","ensureLink"),n}const o=Au.dirname(e);return et.existsSync(o)||_u.mkdirsSync(o),et.linkSync(t,e)}var lp={createLink:sp(up),createLinkSync:cp};const rt=Z,_t=Ie,{pathExists:fp}=ht,hp=Ee.fromPromise;async function pp(t,e){if(rt.isAbsolute(t)){try{await _t.lstat(t)}catch(n){throw n.message=n.message.replace("lstat","ensureSymlink"),n}return{toCwd:t,toDst:t}}const r=rt.dirname(e),o=rt.join(r,t);if(await fp(o))return{toCwd:o,toDst:t};try{await _t.lstat(t)}catch(n){throw n.message=n.message.replace("lstat","ensureSymlink"),n}return{toCwd:t,toDst:rt.relative(r,t)}}function dp(t,e){if(rt.isAbsolute(t)){if(!_t.existsSync(t))throw new Error("absolute srcpath does not exist");return{toCwd:t,toDst:t}}const r=rt.dirname(e),o=rt.join(r,t);if(_t.existsSync(o))return{toCwd:o,toDst:t};if(!_t.existsSync(t))throw new Error("relative srcpath does not exist");return{toCwd:t,toDst:rt.relative(r,t)}}var mp={symlinkPaths:hp(pp),symlinkPathsSync:dp};const xu=Ie,yp=Ee.fromPromise;async function gp(t,e){if(e)return e;let r;try{r=await xu.lstat(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}function vp(t,e){if(e)return e;let r;try{r=xu.lstatSync(t)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}var wp={symlinkType:yp(gp),symlinkTypeSync:vp};const Ep=Ee.fromPromise,Pu=Z,Be=Ie,{mkdirs:bp,mkdirsSync:Sp}=Ue,{symlinkPaths:Op,symlinkPathsSync:Tp}=mp,{symlinkType:Cp,symlinkTypeSync:Dp}=wp,{pathExists:Fp}=ht,{areIdentical:Iu}=bt;async function Ap(t,e,r){let o;try{o=await Be.lstat(e)}catch{}if(o&&o.isSymbolicLink()){const[a,u]=await Promise.all([Be.stat(t),Be.stat(e)]);if(Iu(a,u))return}const s=await Op(t,e);t=s.toDst;const n=await Cp(s.toCwd,r),i=Pu.dirname(e);return await Fp(i)||await bp(i),Be.symlink(t,e,n)}function _p(t,e,r){let o;try{o=Be.lstatSync(e)}catch{}if(o&&o.isSymbolicLink()){const a=Be.statSync(t),u=Be.statSync(e);if(Iu(a,u))return}const s=Tp(t,e);t=s.toDst,r=Dp(s.toCwd,r);const n=Pu.dirname(e);return Be.existsSync(n)||Sp(n),Be.symlinkSync(t,e,r)}var Np={createSymlink:Ep(Ap),createSymlinkSync:_p};const{createFile:na,createFileSync:ia}=op,{createLink:oa,createLinkSync:sa}=lp,{createSymlink:aa,createSymlinkSync:ua}=Np;var xp={createFile:na,createFileSync:ia,ensureFile:na,ensureFileSync:ia,createLink:oa,createLinkSync:sa,ensureLink:oa,ensureLinkSync:sa,createSymlink:aa,createSymlinkSync:ua,ensureSymlink:aa,ensureSymlinkSync:ua};function Pp(t,{EOL:e=`
`,finalEOL:r=!0,replacer:o=null,spaces:s}={}){const n=r?e:"";return JSON.stringify(t,o,s).replace(/\n/g,e)+n}function Ip(t){return Buffer.isBuffer(t)&&(t=t.toString("utf8")),t.replace(/^\uFEFF/,"")}var Gi={stringify:Pp,stripBom:Ip};let gt;try{gt=Et}catch{gt=ce}const br=Ee,{stringify:Lu,stripBom:Mu}=Gi;async function Lp(t,e={}){typeof e=="string"&&(e={encoding:e});const r=e.fs||gt,o="throws"in e?e.throws:!0;let s=await br.fromCallback(r.readFile)(t,e);s=Mu(s);let n;try{n=JSON.parse(s,e?e.reviver:null)}catch(i){if(o)throw i.message=`${t}: ${i.message}`,i;return null}return n}const Mp=br.fromPromise(Lp);function $p(t,e={}){typeof e=="string"&&(e={encoding:e});const r=e.fs||gt,o="throws"in e?e.throws:!0;try{let s=r.readFileSync(t,e);return s=Mu(s),JSON.parse(s,e.reviver)}catch(s){if(o)throw s.message=`${t}: ${s.message}`,s;return null}}async function Rp(t,e,r={}){const o=r.fs||gt,s=Lu(e,r);await br.fromCallback(o.writeFile)(t,s,r)}const kp=br.fromPromise(Rp);function jp(t,e,r={}){const o=r.fs||gt,s=Lu(e,r);return o.writeFileSync(t,s,r)}const qp={readFile:Mp,readFileSync:$p,writeFile:kp,writeFileSync:jp};var Bp=qp;const Qt=Bp;var Up={readJson:Qt.readFile,readJsonSync:Qt.readFileSync,writeJson:Qt.writeFile,writeJsonSync:Qt.writeFileSync};const Xp=Ee.fromPromise,wi=Ie,$u=Z,Ru=Ue,Vp=ht.pathExists;async function zp(t,e,r="utf-8"){const o=$u.dirname(t);return await Vp(o)||await Ru.mkdirs(o),wi.writeFile(t,e,r)}function Wp(t,...e){const r=$u.dirname(t);wi.existsSync(r)||Ru.mkdirsSync(r),wi.writeFileSync(t,...e)}var Yi={outputFile:Xp(zp),outputFileSync:Wp};const{stringify:Hp}=Gi,{outputFile:Gp}=Yi;async function Yp(t,e,r={}){const o=Hp(e,r);await Gp(t,o,r)}var Jp=Yp;const{stringify:Kp}=Gi,{outputFileSync:Qp}=Yi;function Zp(t,e,r){const o=Kp(e,r);Qp(t,o,r)}var ed=Zp;const td=Ee.fromPromise,Pe=Up;Pe.outputJson=td(Jp);Pe.outputJsonSync=ed;Pe.outputJSON=Pe.outputJson;Pe.outputJSONSync=Pe.outputJsonSync;Pe.writeJSON=Pe.writeJson;Pe.writeJSONSync=Pe.writeJsonSync;Pe.readJSON=Pe.readJson;Pe.readJSONSync=Pe.readJsonSync;var rd=Pe;const nd=Ie,ca=Z,{copy:id}=Hi,{remove:ku}=Er,{mkdirp:od}=Ue,{pathExists:sd}=ht,la=bt;async function ad(t,e,r={}){const o=r.overwrite||r.clobber||!1,{srcStat:s,isChangingCase:n=!1}=await la.checkPaths(t,e,"move",r);await la.checkParentPaths(t,s,e,"move");const i=ca.dirname(e);return ca.parse(i).root!==i&&await od(i),ud(t,e,o,n)}async function ud(t,e,r,o){if(!o){if(r)await ku(e);else if(await sd(e))throw new Error("dest already exists.")}try{await nd.rename(t,e)}catch(s){if(s.code!=="EXDEV")throw s;await cd(t,e,r)}}async function cd(t,e,r){return await id(t,e,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),ku(t)}var ld=ad;const ju=Et,Ei=Z,fd=Hi.copySync,qu=Er.removeSync,hd=Ue.mkdirpSync,fa=bt;function pd(t,e,r){r=r||{};const o=r.overwrite||r.clobber||!1,{srcStat:s,isChangingCase:n=!1}=fa.checkPathsSync(t,e,"move",r);return fa.checkParentPathsSync(t,s,e,"move"),dd(e)||hd(Ei.dirname(e)),md(t,e,o,n)}function dd(t){const e=Ei.dirname(t);return Ei.parse(e).root===e}function md(t,e,r,o){if(o)return li(t,e,r);if(r)return qu(e),li(t,e,r);if(ju.existsSync(e))throw new Error("dest already exists.");return li(t,e,r)}function li(t,e,r){try{ju.renameSync(t,e)}catch(o){if(o.code!=="EXDEV")throw o;return yd(t,e,r)}}function yd(t,e,r){return fd(t,e,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),qu(t)}var gd=pd;const vd=Ee.fromPromise;var wd={move:vd(ld),moveSync:gd},Ed={...Ie,...Hi,...tp,...xp,...rd,...Ue,...wd,...Yi,...ht,...Er};const bd=vt(Ed);function Sd(){const t=!se.app.isPackaged;oe.initialize({preload:!0,spyRendererConsole:t});const e=Z.join(ft(),"logs"),r=Z.join(e,"app.log");bd.ensureDirSync(e),oe.transports.file.level=t?"debug":"info",oe.transports.file.resolvePathFn=()=>r,oe.transports.file.maxSize=10*1024*1024,t&&(oe.transports.console.level="debug",oe.transports.file.format="[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}] {text}"),console.log(`[Logger] 日志文件路径: ${r}`)}var Bu={exports:{}};(function(t,e){(function(r,o){t.exports=o()})(ne,function(){var r=1e3,o=6e4,s=36e5,n="millisecond",i="second",a="minute",u="hour",f="day",c="week",h="month",l="quarter",d="year",g="date",w="Invalid Date",E=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(q){var B=["th","st","nd","rd"],z=q%100;return"["+q+(B[(z-20)%10]||B[z]||B[0])+"]"}},y=function(q,B,z){var W=String(q);return!W||W.length>=B?q:""+Array(B+1-W.length).join(z)+q},C={s:y,z:function(q){var B=-q.utcOffset(),z=Math.abs(B),W=Math.floor(z/60),J=z%60;return(B<=0?"+":"-")+y(W,2,"0")+":"+y(J,2,"0")},m:function q(B,z){if(B.date()<z.date())return-q(z,B);var W=12*(z.year()-B.year())+(z.month()-B.month()),J=B.clone().add(W,h),K=z-J<0,Q=B.clone().add(W+(K?-1:1),h);return+(-(W+(z-J)/(K?J-Q:Q-J))||0)},a:function(q){return q<0?Math.ceil(q)||0:Math.floor(q)},p:function(q){return{M:h,y:d,w:c,d:f,D:g,h:u,m:a,s:i,ms:n,Q:l}[q]||String(q||"").toLowerCase().replace(/s$/,"")},u:function(q){return q===void 0}},F="en",S={};S[F]=v;var D="$isDayjsObject",T=function(q){return q instanceof I||!(!q||!q[D])},p=function q(B,z,W){var J;if(!B)return F;if(typeof B=="string"){var K=B.toLowerCase();S[K]&&(J=K),z&&(S[K]=z,J=K);var Q=B.split("-");if(!J&&Q.length>1)return q(Q[0])}else{var re=B.name;S[re]=B,J=re}return!W&&J&&(F=J),J||!W&&F},b=function(q,B){if(T(q))return q.clone();var z=typeof B=="object"?B:{};return z.date=q,z.args=arguments,new I(z)},A=C;A.l=p,A.i=T,A.w=function(q,B){return b(q,{locale:B.$L,utc:B.$u,x:B.$x,$offset:B.$offset})};var I=function(){function q(z){this.$L=p(z.locale,null,!0),this.parse(z),this.$x=this.$x||z.x||{},this[D]=!0}var B=q.prototype;return B.parse=function(z){this.$d=function(W){var J=W.date,K=W.utc;if(J===null)return new Date(NaN);if(A.u(J))return new Date;if(J instanceof Date)return new Date(J);if(typeof J=="string"&&!/Z$/i.test(J)){var Q=J.match(E);if(Q){var re=Q[2]-1||0,ae=(Q[7]||"0").substring(0,3);return K?new Date(Date.UTC(Q[1],re,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,ae)):new Date(Q[1],re,Q[3]||1,Q[4]||0,Q[5]||0,Q[6]||0,ae)}}return new Date(J)}(z),this.init()},B.init=function(){var z=this.$d;this.$y=z.getFullYear(),this.$M=z.getMonth(),this.$D=z.getDate(),this.$W=z.getDay(),this.$H=z.getHours(),this.$m=z.getMinutes(),this.$s=z.getSeconds(),this.$ms=z.getMilliseconds()},B.$utils=function(){return A},B.isValid=function(){return this.$d.toString()!==w},B.isSame=function(z,W){var J=b(z);return this.startOf(W)<=J&&J<=this.endOf(W)},B.isAfter=function(z,W){return b(z)<this.startOf(W)},B.isBefore=function(z,W){return this.endOf(W)<b(z)},B.$g=function(z,W,J){return A.u(z)?this[W]:this.set(J,z)},B.unix=function(){return Math.floor(this.valueOf()/1e3)},B.valueOf=function(){return this.$d.getTime()},B.startOf=function(z,W){var J=this,K=!!A.u(W)||W,Q=A.p(z),re=function(H,m){var x=A.w(J.$u?Date.UTC(J.$y,m,H):new Date(J.$y,m,H),J);return K?x:x.endOf(f)},ae=function(H,m){return A.w(J.toDate()[H].apply(J.toDate("s"),(K?[0,0,0,0]:[23,59,59,999]).slice(m)),J)},pe=this.$W,Y=this.$M,ve=this.$D,Re="set"+(this.$u?"UTC":"");switch(Q){case d:return K?re(1,0):re(31,11);case h:return K?re(1,Y):re(0,Y+1);case c:var N=this.$locale().weekStart||0,O=(pe<N?pe+7:pe)-N;return re(K?ve-O:ve+(6-O),Y);case f:case g:return ae(Re+"Hours",0);case u:return ae(Re+"Minutes",1);case a:return ae(Re+"Seconds",2);case i:return ae(Re+"Milliseconds",3);default:return this.clone()}},B.endOf=function(z){return this.startOf(z,!1)},B.$set=function(z,W){var J,K=A.p(z),Q="set"+(this.$u?"UTC":""),re=(J={},J[f]=Q+"Date",J[g]=Q+"Date",J[h]=Q+"Month",J[d]=Q+"FullYear",J[u]=Q+"Hours",J[a]=Q+"Minutes",J[i]=Q+"Seconds",J[n]=Q+"Milliseconds",J)[K],ae=K===f?this.$D+(W-this.$W):W;if(K===h||K===d){var pe=this.clone().set(g,1);pe.$d[re](ae),pe.init(),this.$d=pe.set(g,Math.min(this.$D,pe.daysInMonth())).$d}else re&&this.$d[re](ae);return this.init(),this},B.set=function(z,W){return this.clone().$set(z,W)},B.get=function(z){return this[A.p(z)]()},B.add=function(z,W){var J,K=this;z=Number(z);var Q=A.p(W),re=function(Y){var ve=b(K);return A.w(ve.date(ve.date()+Math.round(Y*z)),K)};if(Q===h)return this.set(h,this.$M+z);if(Q===d)return this.set(d,this.$y+z);if(Q===f)return re(1);if(Q===c)return re(7);var ae=(J={},J[a]=o,J[u]=s,J[i]=r,J)[Q]||1,pe=this.$d.getTime()+z*ae;return A.w(pe,this)},B.subtract=function(z,W){return this.add(-1*z,W)},B.format=function(z){var W=this,J=this.$locale();if(!this.isValid())return J.invalidDate||w;var K=z||"YYYY-MM-DDTHH:mm:ssZ",Q=A.z(this),re=this.$H,ae=this.$m,pe=this.$M,Y=J.weekdays,ve=J.months,Re=J.meridiem,N=function(m,x,P,k){return m&&(m[x]||m(W,K))||P[x].slice(0,k)},O=function(m){return A.s(re%12||12,m,"0")},H=Re||function(m,x,P){var k=m<12?"AM":"PM";return P?k.toLowerCase():k};return K.replace(_,function(m,x){return x||function(P){switch(P){case"YY":return String(W.$y).slice(-2);case"YYYY":return A.s(W.$y,4,"0");case"M":return pe+1;case"MM":return A.s(pe+1,2,"0");case"MMM":return N(J.monthsShort,pe,ve,3);case"MMMM":return N(ve,pe);case"D":return W.$D;case"DD":return A.s(W.$D,2,"0");case"d":return String(W.$W);case"dd":return N(J.weekdaysMin,W.$W,Y,2);case"ddd":return N(J.weekdaysShort,W.$W,Y,3);case"dddd":return Y[W.$W];case"H":return String(re);case"HH":return A.s(re,2,"0");case"h":return O(1);case"hh":return O(2);case"a":return H(re,ae,!0);case"A":return H(re,ae,!1);case"m":return String(ae);case"mm":return A.s(ae,2,"0");case"s":return String(W.$s);case"ss":return A.s(W.$s,2,"0");case"SSS":return A.s(W.$ms,3,"0");case"Z":return Q}return null}(m)||Q.replace(":","")})},B.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},B.diff=function(z,W,J){var K,Q=this,re=A.p(W),ae=b(z),pe=(ae.utcOffset()-this.utcOffset())*o,Y=this-ae,ve=function(){return A.m(Q,ae)};switch(re){case d:K=ve()/12;break;case h:K=ve();break;case l:K=ve()/3;break;case c:K=(Y-pe)/6048e5;break;case f:K=(Y-pe)/864e5;break;case u:K=Y/s;break;case a:K=Y/o;break;case i:K=Y/r;break;default:K=Y}return J?K:A.a(K)},B.daysInMonth=function(){return this.endOf(h).$D},B.$locale=function(){return S[this.$L]},B.locale=function(z,W){if(!z)return this.$L;var J=this.clone(),K=p(z,W,!0);return K&&(J.$L=K),J},B.clone=function(){return A.w(this.$d,this)},B.toDate=function(){return new Date(this.valueOf())},B.toJSON=function(){return this.isValid()?this.toISOString():null},B.toISOString=function(){return this.$d.toISOString()},B.toString=function(){return this.$d.toUTCString()},q}(),V=I.prototype;return b.prototype=V,[["$ms",n],["$s",i],["$m",a],["$H",u],["$W",f],["$M",h],["$y",d],["$D",g]].forEach(function(q){V[q[1]]=function(B){return this.$g(B,q[0],q[1])}}),b.extend=function(q,B){return q.$i||(q(B,I,b),q.$i=!0),b},b.locale=p,b.isDayjs=T,b.unix=function(q){return b(1e3*q)},b.en=S[F],b.Ls=S,b.p={},b})})(Bu);var Od=Bu.exports;const bi=vt(Od);class Td{constructor(e){ie(this,"value");ie(this,"next");this.value=e}}var Le,st,at;class Cd{constructor(){jt(this,Le,void 0);jt(this,st,void 0);jt(this,at,void 0);this.clear()}enqueue(e){const r=new Td(e);ke(this,Le)?(ke(this,st).next=r,Xe(this,st,r)):(Xe(this,Le,r),Xe(this,st,r)),Tr(this,at)._++}dequeue(){const e=ke(this,Le);if(e)return Xe(this,Le,ke(this,Le).next),Tr(this,at)._--,e.value}peek(){if(ke(this,Le))return ke(this,Le).value}clear(){Xe(this,Le,void 0),Xe(this,st,void 0),Xe(this,at,0)}get size(){return ke(this,at)}*[Symbol.iterator](){let e=ke(this,Le);for(;e;)yield e.value,e=e.next}*drain(){for(;ke(this,Le);)yield this.dequeue()}}Le=new WeakMap,st=new WeakMap,at=new WeakMap;function Dd(t){ha(t);const e=new Cd;let r=0;const o=()=>{r<t&&e.size>0&&(e.dequeue()(),r++)},s=()=>{r--,o()},n=async(u,f,c)=>{const h=(async()=>u(...c))();f(h);try{await h}catch{}s()},i=(u,f,c)=>{new Promise(h=>{e.enqueue(h)}).then(n.bind(void 0,u,f,c)),(async()=>(await Promise.resolve(),r<t&&o()))()},a=(u,...f)=>new Promise(c=>{i(u,c,f)});return Object.defineProperties(a,{activeCount:{get:()=>r},pendingCount:{get:()=>e.size},clearQueue:{value(){e.clear()}},concurrency:{get:()=>t,set(u){ha(u),t=u,queueMicrotask(()=>{for(;r<t&&e.size>0;)o()})}}}),a}function ha(t){if(!((Number.isInteger(t)||t===Number.POSITIVE_INFINITY)&&t>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}const Fd=Dd(Math.max(1,Math.floor(require("os").cpus().length*.8)-1));async function Ad(t){const{videoPath:e,audioPath:r,isOpenOriginAudio:o,startTime:s,currentDuration:n,outputPath:i,videoWidth:a,videoHeight:u,assFilePath:f}=t;return new Promise(async(c,h)=>{const l=nt().input(e).input(r),d=[{filter:"trim",options:{start:s,duration:n},inputs:"0:v",outputs:"trimmed_video"},{filter:"setpts",options:"PTS-STARTPTS",inputs:"trimmed_video",outputs:"video_pts"},{filter:"scale",options:{w:a,h:u,force_original_aspect_ratio:"decrease",eval:"frame"},inputs:"video_pts",outputs:"scaled_video"},{filter:"pad",options:{width:a,height:u,x:"(ow-iw)/2",y:"(oh-ih)/2",color:"black"},inputs:"scaled_video",outputs:"padded_video"}],g=Yf();d.push({filter:"subtitles",options:{filename:`'${Qi(f)}'`,fontsdir:`'${Qi(g)}'`,original_size:`${a}x${u}`,stream_index:"0"},inputs:"padded_video",outputs:"video_with_subtitles"});const w=[];let E="";o&&await Gf(e)?(w.push({filter:"atrim",options:{start:s,duration:n},inputs:"0:a",outputs:"trimmed_original"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_original",outputs:"original_pts"},{filter:"volume",options:"1.0",inputs:"original_pts",outputs:"original_audio"},{filter:"atrim",options:{start:0,duration:n},inputs:"1:a",outputs:"trimmed_new"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_new",outputs:"new_pts"},{filter:"volume",options:"1.0",inputs:"new_pts",outputs:"new_audio"},{filter:"amix",options:{inputs:2,duration:"longest"},inputs:["original_audio","new_audio"],outputs:"mixed_audio"}),E="mixed_audio"):(w.push({filter:"atrim",options:{start:0,duration:n},inputs:"1:a",outputs:"trimmed_new"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_new",outputs:"new_pts"},{filter:"volume",options:"1.0",inputs:"new_pts",outputs:"new_audio"}),E="new_audio"),l.complexFilter([...d,...w]).outputOptions(["-map [video_with_subtitles]",`-map [${E}]`,"-c:v libx264","-c:a aac","-preset fast"]),l.on("start",_=>{console.log("start to execute command: "+_)}).on("progress",_=>{console.log(`processing: ${Math.round(_.percent)}%`)}).on("end",()=>{console.log(`segment process done: ${i}`),c()}).on("error",_=>{console.error(`segment process error: ${_.message}`),h(_)}).save(i)})}async function _d(t,e,r,o){const s=o.videoRatio,i=o.videoResolution.split("x").map(_=>parseInt(_)),a=s==="9:16"?i[0]:i[1],u=s==="9:16"?i[1]:i[0],f=t.zimuConfig.datas[0];if(!f.path){const _=t.zimuConfig.audioConfig,v=`${r}_${t.name}_${f.title}_${bi().format("YYYYMMDDHHmmss")}`,y=await su({text:f.text,voice:_.voice,speech_rate:_.speech_rate,volume:_.volume,pitch_rate:_.pitch_rate,outputFileName:v});f.path=y.outputFile,f.duration=y.duration}const c=f.path;let h=f.duration??await xt(c);h=Math.ceil(h*100)/100;const l=t.videoList,d=t.isOpenOriginAudio??!0,g=[],w=`${r}_${t.name}_`,E=t.assFilePath;for(const _ of l){const v=_.path,y=_.duration??await xt(v),C=h,F=Math.ceil(y/C),S=w+Z.basename(v,Z.extname(v));for(let D=0;D<F;D++){const T=D*C,p=_.duration-T,b=Math.min(C,p),A=Z.join(e,`${S}_part${D+1}_${T}-${T+b}.mp4`);g.push({videoPath:v,audioPath:c,outputPath:A,startTime:T,currentDuration:b,isOpenOriginAudio:d,videoWidth:a,videoHeight:u,assFilePath:E})}}return g}async function Nd(t,e){return new Promise((r,o)=>{const s=Z.extname(e),n=e.slice(0,e.length-s.length)+"_temp.txt";oe.log("生成临时文件："+n),ce.writeFileSync(n,t.map(i=>`file '${i}'`).join(`
`)),nt().input(n).inputFormat("concat").inputOptions(["-safe 0"]).outputOptions(["-c copy"]).on("start",i=>console.log("执行命令:",i)).on("progress",i=>console.log(`处理进度: ${Math.round(i.percent)}%`)).on("end",()=>{ce.unlinkSync(n),r()}).on("error",i=>{ce.unlinkSync(n),o(i)}).save(e)})}async function xd(t){var f;oe.log("accept params："),oe.log(JSON.stringify(t));const e=t.clips,r=t.outputFileName,o=t.globalConfig,s=o.outputDir||ft();for(const c of e)c.segments=await _d(c,s,r,o);oe.log("split clip to segments done："),oe.log(JSON.stringify(e));const n=[];for(const c of e)n.push(...c.segments);oe.info("segments:"),oe.info(JSON.stringify(n));const i=n.map(c=>Fd(()=>Ad(c)));await Promise.all(i),oe.log("segment process done："),oe.log(JSON.stringify(n));let a=1;for(const c of e)(a===1||c.segments.length>1&&c.segments.length<a)&&(a=c.segments.length);oe.log(`we can generate ${a} videos`);const u=[];for(let c=0;c<a;c++){const h=[];let l=0;for(const d of e){const g=d.segments;let w;g.length===1?w=g[0]:w=g[c],h.push(w.outputPath),l+=w.currentDuration}u.push({videos:h,outputPath:Z.join(s,`${r}_${c+1}.mp4`),duration:l})}oe.log("合成视频开始:");for(let c=0;c<u.length;c++){const h=u[c];oe.log(`开始合成视频: ${c+1}/${u.length}, 视频路径：${u[c].outputPath}`),oe.log(JSON.stringify(h));try{const l=new Promise((w,E)=>{setTimeout(()=>{E(new Error("视频合成操作超时（5分钟）"))},3e5)}),d=Nd(h.videos,h.outputPath);await Promise.race([d,l]),oe.log(`成功合成视频:${c+1}/${u.length}`);const g=(f=o.backgroundAudioConfig)==null?void 0:f.audio.path;if(g&&ce.existsSync(g)){const w=Z.join(s,`${r}_${c+1}_bg.mp4`);oe.log(`开始为视频添加背景音乐:${h.outputPath}`),await Pd(h.outputPath,o.backgroundAudioConfig,w),u[c].outputPath=w}}catch(l){oe.error(l),oe.error(`合成视频失败:${c+1}/${u.length}`)}}return oe.log("合成视频结束"),u.map(c=>({outputPath:c.outputPath,duration:c.duration}))}function Pd(t,e,r){return new Promise((o,s)=>{const n=e.audio.path,i=e.volume/100,a=nt().input(t).input(n).inputOptions(["-stream_loop -1"]),u=[{filter:"volume",options:i,inputs:"1:a",outputs:"scaled_audio"},{filter:"amix",options:{inputs:2,duration:"first"},inputs:["0:a","scaled_audio"],outputs:["mixed"]}];a.complexFilter(u).outputOptions(["-map 0:v","-map [mixed]","-c:v copy","-shortest"]).on("start",f=>console.log("开始添加背景音乐，执行命令:",f)).on("progress",f=>console.log(`处理进度: ${Math.round(f.percent)}%`)).on("end",()=>{console.log("背景音乐添加成功"),ce.unlinkSync(t),o(r)}).on("error",f=>{console.error("背景音乐添加失败:",f),s(f)}).save(r)})}function Id(){se.ipcMain.handle("video-mix-and-cut",async(t,e)=>{const r=JSON.parse(Nt(e)),o=bi("2025-06-12","YYYY-MM-DD");if(bi().isAfter(o))throw new Error("日期已失效");return xd(r)}),se.ipcMain.handle("get-media-duration",async(t,e)=>{const r=JSON.parse(Nt(e));return xt(r.path)})}const rr=Z.join(ft(),"config.json"),Ld={lastOpenedDirectory:ft()};function Uu(){try{ce.existsSync(rr)||ce.writeFileSync(rr,JSON.stringify(Ld,null,2));const t=ce.readFileSync(rr,"utf-8");return JSON.parse(t)}catch{return}}function Md(t){const e=Uu();return jd(e,t)}function $d(t,e){const r=Uu();qd(r,t,e),ce.writeFileSync(rr,JSON.stringify(r,null,2))}function Rd(){let t;try{if(t=Md("lastOpenedDirectory"),!t&&ce.existsSync(t))return t}catch{return ft()}}function kd(t){$d("lastOpenedDirectory",t)}function jd(t,e){return e.split(".").reduce((r,o)=>r&&r[o]!==void 0?r[o]:void 0,t)}function qd(t,e,r){const o=e.split(".");let s=t;for(let n=0;n<o.length-1;n++){const i=o[n];s[i]||(s[i]={}),s=s[i]}s[o[o.length-1]]=r}function Bd(t){se.ipcMain.handle("open-file-dialog",async(e,r)=>{if(!t)return null;const o=(r==null?void 0:r.defaultPath)||Rd(),s=(r==null?void 0:r.properties)||["openFile"],n=(r==null?void 0:r.title)||"选择文件",i=(r==null?void 0:r.buttonLabel)||"选择",a=(r==null?void 0:r.filters)||[{name:"All Files",extensions:["*"]}];r!=null&&r.multiple&&!s.includes("multiSelections")&&s.push("multiSelections");const u=await se.dialog.showOpenDialog(t,{title:n,defaultPath:o,buttonLabel:i,filters:a,properties:s});if(u.canceled)return[];{const f=Z.dirname(u.filePaths[0]);kd(f);const c=u.filePaths.map(async h=>{const l=await xt(h),d=`media://${encodeURIComponent(h)}`;return{path:Z.normalize(h),name:Z.basename(h),ext:Z.extname(h),mimeType:Zt(h),duration:l,url:d}});return await Promise.all(c)}})}async function Ud(t){const e=Z.normalize(t);if(e!==t||e.includes(".."))return!1;try{return await ce.promises.access(e,ce.constants.R_OK),!0}catch{return!1}}function Xd(){se.protocol.handle("media",async t=>{try{const e=t.url.slice(8),r=decodeURIComponent(e).replace(/\//g,"\\").replace(/^\\/,""),o=Z.normalize(r);if(!await Ud(o))return new Response("Access Denied",{status:403});const s=await ce.promises.stat(o);if(!s.isFile())return new Response("Not a file",{status:400});const n=t.headers.get("range"),i=s.size,a={"Content-Type":Zt(o),"Cache-Control":"public, max-age=31536000"};if(n){const u=n.replace(/bytes=/,"").split("-"),f=parseInt(u[0],10),c=u[1]?parseInt(u[1],10):i-1,h=c-f+1,l=ce.createReadStream(o,{start:f,end:c}),d=Ki(l);return new Response(d,{status:206,headers:{"Content-Range":`bytes ${f}-${c}/${i}`,"Accept-Ranges":"bytes","Content-Length":h.toString(),"Content-Type":await Zt(o),"Cache-Control":"public, max-age=31536000"}})}else{const u=ce.createReadStream(o),f=Ki(u);return new Response(f,{headers:{"Content-Length":i.toString(),"Content-Type":await Zt(o),"Cache-Control":"public, max-age=31536000"}})}}catch{return new Response("Not Found",{status:404})}})}function Vd(t){se.globalShortcut.register("CommandOrControl+R",()=>{t&&t.reload()})}function zd(){se.ipcMain.on("window-control",(t,e)=>{const r=se.BrowserWindow.fromWebContents(t.sender);if(r)switch(e){case"minimize":r.minimize();break;case"maximize":r.isMaximized()?r.unmaximize():r.maximize();break;case"close":r.close();break}})}function Wd(){const t=it.totalmem(),e=Math.floor(t/(1024*1024)/2),o=Math.max(e,4096);console.log(`System total memory: ${(t/(1024*1024*1024)).toFixed(2)}GB`),console.log(`Setting memory limit to: ${o}MB (${(o/1024).toFixed(2)}GB)`),se.app.commandLine.appendSwitch("js-flags",`--max-old-space-size=${o}`)}function Xu(t,e,r,o,s,n,i,a,u,f){const{fontFamily:c,fontSize:h,fontWeight:l,underline:d,italic:g,textAlign:w,customStyle:E}=e;let _=e.fontColor.replace("#",""),v="000000",y="000000",C={left:s==="subtitles"?1:7,center:s==="subtitles"?2:8,right:s==="subtitles"?3:9},F=1,S=2,D=e.fontSize,T=i;u<f&&(D=e.fontSize*(1+1080/1920/2)),T=i+D,E==="custom-style-1"?(v="1A1A1A",_="ffffff"):E==="custom-style-2"?(v="1A1A1A",_="627EE9"):E==="custom-style-3"?(v="1A1A1A",_="1A1A1A"):E==="custom-style-4"?(v="B463FE",_="B463FE"):E==="custom-style-5"?(v="FF9C20",_="FF9C20"):E==="custom-style-6"?(v="2278FF",_="2278FF"):E==="custom-style-7"?(F=3,_="1A1A1A",y="FFE306",S=4,v="FFE306"):E==="custom-style-8"?(v="1A1A1A",_="FAF5B0"):E==="custom-style-9"?(v="1A1A1A",_="FF9C20"):E==="custom-style-10"?(v="F09CAF",_="FFFFFF"):E==="custom-style-11"&&(v="F86F32",_="FDDC63");const b=`Style: ${a||s},Arial,${D},${fi(_)},&H000000FF&,${fi(v)},${fi(y,"80")},${l==="bold"?1:0},${g?1:0},${d?1:0},0,100,100,0,0,${F},${S},0,${C[w]},0,0,0,0`,A=`Dialogue: 0,${pa(r)},${pa(r+o)},${a||s},,0,0,0,,{\\pos(${n},${T})}${t}`;return{style:b,dialogue:A}}function Hd(t,e,r,o,s){const n=o,i=s,a=e.join(`
`),u=r.join(`
`),f=`
[Script Info]
Title: Dynamic Subtitles
ScriptType: v4.00+
PlayResX: ${n}
PlayResY: ${i}
ScaledBorderAndShadow: yes
WrapStyle: 0

[V4+ Styles]
Format: Name, Fontname, Fontsize, PrimaryColour, SecondaryColour, OutlineColour, BackColour, Bold, Italic, Underline, StrikeOut, ScaleX, ScaleY, Spacing, Angle, BorderStyle, Outline, Shadow, Alignment, MarginL, MarginR, MarginV, Encoding
${a}

[Events]
Format: Layer, Start, End, Style, Name, MarginL, MarginR, MarginV, Effect, Text
${u}
  `;return ce.writeFileSync(t,f.trim()),t}function pa(t){const e=Math.floor(t/3600),r=Math.floor(t%3600/60),o=Math.floor(t%60),s=Math.floor((t-Math.floor(t))*100);return`${e}:${r.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}.${s.toString().padStart(2,"0")}`}function fi(t,e="00"){const r=`${t.slice(4,6)}${t.slice(2,4)}${t.slice(0,2)}`;return`&H${e}${r}&`}function Gd(t,e,r,o,s,n,i){const a=Vu(t,r.fontSize),u=Yd(a,e),f=[];for(let c=0;c<u.length;c++){const h=u[c],l=`subtitles-${c}`,d=h.end-h.start,g=Xu(h.text,r,h.start,d,"subtitles",o,s,l,n,i);f.push({style:g.style,dialogue:g.dialogue})}return f}function Vu(t,e){const r=[],n=Jd(e)*1,i=t.split(/([。！？；\n])/).filter(a=>a.trim());oe.log("字幕分句结果："),oe.log(JSON.stringify(i));for(let a=0;a<i.length;a++){let u=i[a];if(u.length>n){const f=u.split(/([,，])/).filter(c=>c.trim());for(const c of f)if(c.length>n){const h=c.split(/\s+/);oe.log("句子分词结果："),oe.log(JSON.stringify(h));let l="";for(const d of h)if(l.length+d.length>n)if(d.length===n)l&&r.push(l),r.push(d);else{const g=l+(l?" ":"")+d;for(let w=0;w<g.length;){const E=Math.min(w+n,g.length);E<g.length?r.push(g.substring(w,E)):l=g.substring(w,E),w=E}}else l+=(l?" ":"")+d;l&&r.push(l)}else r.push(c)}else r.push(u)}return oe.log("字幕分屏结果："),oe.log(JSON.stringify(r)),r}function Yd(t,e){const r=[],s=t.reduce((i,a)=>i+a.length,0)/e;let n=0;for(const i of t){const a=i.length/s,u=Math.min(n+a,e);r.push({text:i,start:n,end:u}),n=u,n<e&&(n+=.2)}return r}function Jd(t){return Math.floor(1280/(t*.6)/2)}function Kd(t,e,r,o){const s=r.videoRatio,i=r.videoResolution.split("x"),a=s==="9:16",u=a?i[0]:i[1],f=a?i[1]:i[0],c=Z.join(r.outputDir,o);console.log(c),console.log(o),console.log(r.outputDir);const h=[],l=[],d=e.datas[0],g=e.datas[0].duration,w=Gd(d.text,g,e.textConfig,e.posX,e.posY,u,f);if(h.push(...w.map(E=>E.style)),l.push(...w.map(E=>E.dialogue)),t){const E=t==null?void 0:t.datas[0],_=E.duration||g,y=Vu(E.text,E.textConfig.fontSize).join("\\n"),C=Xu(y,E.textConfig,E.start,_,"title",E.posX,E.posY,"title",u,f);h.push(C.style),l.push(C.dialogue)}return Hd(c,h,l,u,f),c}function Qd(){se.ipcMain.handle("generate-ass-file",async(t,e)=>{const r=JSON.parse(Nt(e));return Kd(r.videoTitleConfig,r.zimuConfig,r.globalConfig,r.outputPath)})}typeof crypto>"u"&&(global.crypto=require("crypto").webcrypto);process.env.LANG="zh_CN.UTF-8";process.env.LC_ALL="zh_CN.UTF-8";process.platform==="win32"&&(process.env.CHCP="65001");process.env.DIST=Z.join(__dirname,"../dist");process.env.VITE_PUBLIC=se.app.isPackaged?process.env.DIST:Z.join(process.env.DIST,"../public");Wd();let We;const da=process.env.VITE_DEV_SERVER_URL;function zu(){We=new se.BrowserWindow({icon:Z.join(process.env.VITE_PUBLIC,"vite.svg"),webPreferences:{nodeIntegration:!0,contextIsolation:!0,scrollBounce:!0,preload:Z.join(__dirname,"preload.js")},autoHideMenuBar:!0}),We.webContents.on("did-finish-load",()=>{We==null||We.webContents.send("main-process-message",new Date().toLocaleString())}),da?We.loadURL(da):We.loadFile(Z.join(process.env.DIST,"index.html"))}Sd();Wf();rc();nc();Qf();Kf();Id();Qd();const Zd=async t=>{Bd(t),Vd(t),zd()};se.app.whenReady().then(()=>{se.app.commandLine.appendSwitch("disable-direct-write"),ou(),Xd(),zu(),Zd(We)});se.app.on("window-all-closed",()=>{process.platform!=="darwin"&&(se.app.quit(),We=null)});se.app.on("activate",()=>{se.BrowserWindow.getAllWindows().length===0&&zu()});se.app.on("will-quit",()=>{se.globalShortcut.unregisterAll()});
//# sourceMappingURL=main.js.map
