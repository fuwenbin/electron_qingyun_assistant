"use strict";var Xs=Object.defineProperty;var Vs=(s,e,n)=>e in s?Xs(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var Z=(s,e,n)=>(Vs(s,typeof e!="symbol"?e+"":e,n),n);const re=require("electron"),Q=require("path"),tt=require("util"),Be=require("events"),rt=require("child_process"),$e=require("os"),ae=require("fs"),zs=require("stream"),wt=require("http"),Et=require("https"),Ws=require("ws"),Dn=require("assert"),Hs=require("zlib"),Nn=require("url"),_n=require("tty"),De=require("crypto"),Gs=require("querystring"),Ks=require("string_decoder"),Ys=require("timers");function Js(s){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(s){for(const n in s)if(n!=="default"){const i=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>s[n]})}}return e.default=s,Object.freeze(e)}const Lt=Js(ae);function Qs(){re.ipcMain.handle("show-save-dialog",async(s,e)=>await re.dialog.showSaveDialog({title:e.title||"保存文件",defaultPath:e.defaultPath||re.app.getPath("documents"),filters:e.filters||[{name:"MP4 Videos",extensions:["mp4"]},{name:"All Files",extensions:["*"]}]})),re.ipcMain.handle("select-directory",async()=>{const s=await re.dialog.showOpenDialog({properties:["openDirectory"],title:"选择保存目录",defaultPath:re.app.getPath("documents")});return!s.canceled&&s.filePaths.length>0?s.filePaths[0]:null})}var ee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tt(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function Zs(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(s).forEach(function(i){var a=Object.getOwnPropertyDescriptor(s,i);Object.defineProperty(n,i,a.get?a:{enumerable:!0,get:function(){return s[i]}})}),n}var Qo={exports:{}},Mt,Kn;function ea(){if(Kn)return Mt;Kn=1,Mt=i,i.sync=a;var s=ae;function e(t,r){var o=r.pathExt!==void 0?r.pathExt:process.env.PATHEXT;if(!o||(o=o.split(";"),o.indexOf("")!==-1))return!0;for(var u=0;u<o.length;u++){var f=o[u].toLowerCase();if(f&&t.substr(-f.length).toLowerCase()===f)return!0}return!1}function n(t,r,o){return!t.isSymbolicLink()&&!t.isFile()?!1:e(r,o)}function i(t,r,o){s.stat(t,function(u,f){o(u,u?!1:n(f,t,r))})}function a(t,r){return n(s.statSync(t),t,r)}return Mt}var Rt,Yn;function ta(){if(Yn)return Rt;Yn=1,Rt=e,e.sync=n;var s=ae;function e(t,r,o){s.stat(t,function(u,f){o(u,u?!1:i(f,r))})}function n(t,r){return i(s.statSync(t),r)}function i(t,r){return t.isFile()&&a(t,r)}function a(t,r){var o=t.mode,u=t.uid,f=t.gid,l=r.uid!==void 0?r.uid:process.getuid&&process.getuid(),p=r.gid!==void 0?r.gid:process.getgid&&process.getgid(),c=parseInt("100",8),m=parseInt("010",8),v=parseInt("001",8),T=c|m,b=o&v||o&m&&f===p||o&c&&u===l||o&T&&l===0;return b}return Rt}var yt;process.platform==="win32"||ee.TESTING_WINDOWS?yt=ea():yt=ta();var ra=In;In.sync=na;function In(s,e,n){if(typeof e=="function"&&(n=e,e={}),!n){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(i,a){In(s,e||{},function(t,r){t?a(t):i(r)})})}yt(s,e||{},function(i,a){i&&(i.code==="EACCES"||e&&e.ignoreErrors)&&(i=null,a=!1),n(i,a)})}function na(s,e){try{return yt.sync(s,e||{})}catch(n){if(e&&e.ignoreErrors||n.code==="EACCES")return!1;throw n}}var ia=ns;ns.sync=sa;var vn=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Zo=Q,oa=vn?";":":",es=ra;function ts(s){var e=new Error("not found: "+s);return e.code="ENOENT",e}function rs(s,e){var n=e.colon||oa,i=e.path||process.env.PATH||"",a=[""];i=i.split(n);var t="";return vn&&(i.unshift(process.cwd()),t=e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM",a=t.split(n),s.indexOf(".")!==-1&&a[0]!==""&&a.unshift("")),(s.match(/\//)||vn&&s.match(/\\/))&&(i=[""]),{env:i,ext:a,extExe:t}}function ns(s,e,n){typeof e=="function"&&(n=e,e={});var i=rs(s,e),a=i.env,t=i.ext,r=i.extExe,o=[];(function u(f,l){if(f===l)return e.all&&o.length?n(null,o):n(ts(s));var p=a[f];p.charAt(0)==='"'&&p.slice(-1)==='"'&&(p=p.slice(1,-1));var c=Zo.join(p,s);!p&&/^\.[\\\/]/.test(s)&&(c=s.slice(0,2)+c),function m(v,T){if(v===T)return u(f+1,l);var b=t[v];es(c+b,{pathExt:r},function(x,y){if(!x&&y)if(e.all)o.push(c+b);else return n(null,c+b);return m(v+1,T)})}(0,t.length)})(0,a.length)}function sa(s,e){e=e||{};for(var n=rs(s,e),i=n.env,a=n.ext,t=n.extExe,r=[],o=0,u=i.length;o<u;o++){var f=i[o];f.charAt(0)==='"'&&f.slice(-1)==='"'&&(f=f.slice(1,-1));var l=Zo.join(f,s);!f&&/^\.[\\\/]/.test(s)&&(l=s.slice(0,2)+l);for(var p=0,c=a.length;p<c;p++){var m=l+a[p],v;try{if(v=es.sync(m,{pathExt:t}),v)if(e.all)r.push(m);else return m}catch{}}}if(e.all&&r.length)return r;if(e.nothrow)return null;throw ts(s)}rt.exec;var aa=$e.platform().match(/win(32|64)/),ua=ia,Jn=/\r\n|\r|\n/g,He=/^\[?(.*?)\]?$/,Qn=/[,]/,ot={};function ca(s){var e={};s=s.replace(/=\s+/g,"=").trim();for(var n=s.split(" "),i=0;i<n.length;i++){var a=n[i].split("=",2),t=a[0],r=a[1];if(typeof r>"u")return null;e[t]=r}return e}var Zn=Qo.exports={isWindows:aa,streamRegexp:He,copy:function(s,e){Object.keys(s).forEach(function(n){e[n]=s[n]})},args:function(){var s=[],e=function(){arguments.length===1&&Array.isArray(arguments[0])?s=s.concat(arguments[0]):s=s.concat([].slice.call(arguments))};return e.clear=function(){s=[]},e.get=function(){return s},e.find=function(n,i){var a=s.indexOf(n);if(a!==-1)return s.slice(a+1,a+1+(i||0))},e.remove=function(n,i){var a=s.indexOf(n);a!==-1&&s.splice(a,(i||0)+1)},e.clone=function(){var n=Zn.args();return n(s),n},e},makeFilterStrings:function(s){return s.map(function(e){if(typeof e=="string")return e;var n="";return Array.isArray(e.inputs)?n+=e.inputs.map(function(i){return i.replace(He,"[$1]")}).join(""):typeof e.inputs=="string"&&(n+=e.inputs.replace(He,"[$1]")),n+=e.filter,e.options&&(typeof e.options=="string"||typeof e.options=="number"?n+="="+e.options:Array.isArray(e.options)?n+="="+e.options.map(function(i){return typeof i=="string"&&i.match(Qn)?"'"+i+"'":i}).join(":"):Object.keys(e.options).length&&(n+="="+Object.keys(e.options).map(function(i){var a=e.options[i];return typeof a=="string"&&a.match(Qn)&&(a="'"+a+"'"),i+"="+a}).join(":"))),Array.isArray(e.outputs)?n+=e.outputs.map(function(i){return i.replace(He,"[$1]")}).join(""):typeof e.outputs=="string"&&(n+=e.outputs.replace(He,"[$1]")),n})},which:function(s,e){if(s in ot)return e(null,ot[s]);ua(s,function(n,i){if(n)return e(null,ot[s]="");e(null,ot[s]=i)})},timemarkToSeconds:function(s){if(typeof s=="number")return s;if(s.indexOf(":")===-1&&s.indexOf(".")>=0)return Number(s);var e=s.split(":"),n=Number(e.pop());return e.length&&(n+=Number(e.pop())*60),e.length&&(n+=Number(e.pop())*3600),n},extractCodecData:function(s,e,n){var i=/Input #[0-9]+, ([^ ]+),/,a=/Duration\: ([^,]+)/,t=/Audio\: (.*)/,r=/Video\: (.*)/;"inputStack"in n||(n.inputStack=[],n.inputIndex=-1,n.inInput=!1);var o=n.inputStack,u=n.inputIndex,f=n.inInput,l,p,c,m;if(l=e.match(i))f=n.inInput=!0,u=n.inputIndex=n.inputIndex+1,o[u]={format:l[1],audio:"",video:"",duration:""};else if(f&&(p=e.match(a)))o[u].duration=p[1];else if(f&&(c=e.match(t)))c=c[1].split(", "),o[u].audio=c[0],o[u].audio_details=c;else if(f&&(m=e.match(r)))m=m[1].split(", "),o[u].video=m[0],o[u].video_details=m;else if(/Output #\d+/.test(e))f=n.inInput=!1;else if(/Stream mapping:|Press (\[q\]|ctrl-c) to stop/.test(e))return s.emit.apply(s,["codecData"].concat(o)),!0;return!1},extractProgress:function(s,e){var n=ca(e);if(n){var i={frames:parseInt(n.frame,10),currentFps:parseInt(n.fps,10),currentKbps:n.bitrate?parseFloat(n.bitrate.replace("kbits/s","")):0,targetSize:parseInt(n.size||n.Lsize,10),timemark:n.time};if(s._ffprobeData&&s._ffprobeData.format&&s._ffprobeData.format.duration){var a=Number(s._ffprobeData.format.duration);isNaN(a)||(i.percent=Zn.timemarkToSeconds(i.timemark)/a*100)}s.emit("progress",i)}},extractError:function(s){return s.split(Jn).reduce(function(e,n){return n.charAt(0)===" "||n.charAt(0)==="["?[]:(e.push(n),e)},[]).join(`
`)},linesRing:function(s){var e=[],n=[],i=null,a=!1,t=s-1;function r(o){e.forEach(function(u){u(o)})}return{callback:function(o){n.forEach(function(u){o(u)}),e.push(o)},append:function(o){if(!a&&(o instanceof Buffer&&(o=""+o),!(!o||o.length===0))){var u=o.split(Jn);u.length===1?i!==null?i=i+u.shift():i=u.shift():(i!==null&&(i=i+u.shift(),r(i),n.push(i)),i=u.pop(),u.forEach(function(f){r(f),n.push(f)}),t>-1&&n.length>t&&n.splice(0,n.length-t))}},get:function(){return i!==null?n.concat([i]).join(`
`):n.join(`
`)},close:function(){a||(i!==null&&(r(i),n.push(i),t>-1&&n.length>t&&n.shift(),i=null),a=!0)}}}},Se=Qo.exports,jt,ei;function fa(){if(ei)return jt;ei=1;var s=Se;return jt=function(e){e.mergeAdd=e.addInput=e.input=function(n){var i=!1,a=!1;if(typeof n!="string"){if(!("readable"in n)||!n.readable)throw new Error("Invalid input");var t=this._inputs.some(function(o){return o.isStream});if(t)throw new Error("Only one input stream is supported");a=!0,n.pause()}else{var r=n.match(/^([a-z]{2,}):/i);i=!r||r[0]==="file"}return this._inputs.push(this._currentInput={source:n,isFile:i,isStream:a,options:s.args()}),this},e.withInputFormat=e.inputFormat=e.fromFormat=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-f",n),this},e.withInputFps=e.withInputFPS=e.withFpsInput=e.withFPSInput=e.inputFPS=e.inputFps=e.fpsInput=e.FPSInput=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-r",n),this},e.nativeFramerate=e.withNativeFramerate=e.native=function(){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-re"),this},e.setStartTime=e.seekInput=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-ss",n),this},e.loop=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-loop","1"),typeof n<"u"&&this.duration(n),this}},jt}var qt,ti;function la(){if(ti)return qt;ti=1;var s=Se;return qt=function(e){e.withNoAudio=e.noAudio=function(){return this._currentOutput.audio.clear(),this._currentOutput.audioFilters.clear(),this._currentOutput.audio("-an"),this},e.withAudioCodec=e.audioCodec=function(n){return this._currentOutput.audio("-acodec",n),this},e.withAudioBitrate=e.audioBitrate=function(n){return this._currentOutput.audio("-b:a",(""+n).replace(/k?$/,"k")),this},e.withAudioChannels=e.audioChannels=function(n){return this._currentOutput.audio("-ac",n),this},e.withAudioFrequency=e.audioFrequency=function(n){return this._currentOutput.audio("-ar",n),this},e.withAudioQuality=e.audioQuality=function(n){return this._currentOutput.audio("-aq",n),this},e.withAudioFilter=e.withAudioFilters=e.audioFilter=e.audioFilters=function(n){return arguments.length>1&&(n=[].slice.call(arguments)),Array.isArray(n)||(n=[n]),this._currentOutput.audioFilters(s.makeFilterStrings(n)),this}},qt}var $t,ri;function pa(){if(ri)return $t;ri=1;var s=Se;return $t=function(e){e.withNoVideo=e.noVideo=function(){return this._currentOutput.video.clear(),this._currentOutput.videoFilters.clear(),this._currentOutput.video("-vn"),this},e.withVideoCodec=e.videoCodec=function(n){return this._currentOutput.video("-vcodec",n),this},e.withVideoBitrate=e.videoBitrate=function(n,i){return n=(""+n).replace(/k?$/,"k"),this._currentOutput.video("-b:v",n),i&&this._currentOutput.video("-maxrate",n,"-minrate",n,"-bufsize","3M"),this},e.withVideoFilter=e.withVideoFilters=e.videoFilter=e.videoFilters=function(n){return arguments.length>1&&(n=[].slice.call(arguments)),Array.isArray(n)||(n=[n]),this._currentOutput.videoFilters(s.makeFilterStrings(n)),this},e.withOutputFps=e.withOutputFPS=e.withFpsOutput=e.withFPSOutput=e.withFps=e.withFPS=e.outputFPS=e.outputFps=e.fpsOutput=e.FPSOutput=e.fps=e.FPS=function(n){return this._currentOutput.video("-r",n),this},e.takeFrames=e.withFrames=e.frames=function(n){return this._currentOutput.video("-vframes",n),this}},$t}var kt,ni;function ha(){if(ni)return kt;ni=1;function s(n,i,a,t){return[{filter:"scale",options:{w:"if(gt(a,"+a+"),"+n+",trunc("+i+"*a/2)*2)",h:"if(lt(a,"+a+"),"+i+",trunc("+n+"/a/2)*2)"}},{filter:"pad",options:{w:n,h:i,x:"if(gt(a,"+a+"),0,("+n+"-iw)/2)",y:"if(lt(a,"+a+"),0,("+i+"-ih)/2)",color:t}}]}function e(n,i,a){var t=n.sizeData=n.sizeData||{};if(t[i]=a,!("size"in t))return[];var r=t.size.match(/([0-9]+)x([0-9]+)/),o=t.size.match(/([0-9]+)x\?/),u=t.size.match(/\?x([0-9]+)/),f=t.size.match(/\b([0-9]{1,3})%/),l,p,c;if(f){var m=Number(f[1])/100;return[{filter:"scale",options:{w:"trunc(iw*"+m+"/2)*2",h:"trunc(ih*"+m+"/2)*2"}}]}else{if(r)return l=Math.round(Number(r[1])/2)*2,p=Math.round(Number(r[2])/2)*2,c=l/p,t.pad?s(l,p,c,t.pad):[{filter:"scale",options:{w:l,h:p}}];if(o||u)return"aspect"in t?(l=o?o[1]:Math.round(Number(u[1])*t.aspect),p=u?u[1]:Math.round(Number(o[1])/t.aspect),l=Math.round(l/2)*2,p=Math.round(p/2)*2,t.pad?s(l,p,t.aspect,t.pad):[{filter:"scale",options:{w:l,h:p}}]):o?[{filter:"scale",options:{w:Math.round(Number(o[1])/2)*2,h:"trunc(ow/a/2)*2"}}]:[{filter:"scale",options:{w:"trunc(oh*a/2)*2",h:Math.round(Number(u[1])/2)*2}}];throw new Error("Invalid size specified: "+t.size)}}return kt=function(n){n.keepPixelAspect=n.keepDisplayAspect=n.keepDisplayAspectRatio=n.keepDAR=function(){return this.videoFilters([{filter:"scale",options:{w:"if(gt(sar,1),iw*sar,iw)",h:"if(lt(sar,1),ih/sar,ih)"}},{filter:"setsar",options:"1"}])},n.withSize=n.setSize=n.size=function(i){var a=e(this._currentOutput,"size",i);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(a),this},n.withAspect=n.withAspectRatio=n.setAspect=n.setAspectRatio=n.aspect=n.aspectRatio=function(i){var a=Number(i);if(isNaN(a)){var t=i.match(/^(\d+):(\d+)$/);if(t)a=Number(t[1])/Number(t[2]);else throw new Error("Invalid aspect ratio: "+i)}var r=e(this._currentOutput,"aspect",a);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(r),this},n.applyAutopadding=n.applyAutoPadding=n.applyAutopad=n.applyAutoPad=n.withAutopadding=n.withAutoPadding=n.withAutopad=n.withAutoPad=n.autoPad=n.autopad=function(i,a){typeof i=="string"&&(a=i,i=!0),typeof i>"u"&&(i=!0);var t=e(this._currentOutput,"pad",i?a||"black":!1);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(t),this}},kt}var Bt,ii;function da(){if(ii)return Bt;ii=1;var s=Se;return Bt=function(e){e.addOutput=e.output=function(n,i){var a=!1;if(!n&&this._currentOutput)throw new Error("Invalid output");if(n&&typeof n!="string"){if(!("writable"in n)||!n.writable)throw new Error("Invalid output")}else if(typeof n=="string"){var t=n.match(/^([a-z]{2,}):/i);a=!t||t[0]==="file"}if(n&&!("target"in this._currentOutput))this._currentOutput.target=n,this._currentOutput.isFile=a,this._currentOutput.pipeopts=i||{};else{if(n&&typeof n!="string"){var r=this._outputs.some(function(u){return typeof u.target!="string"});if(r)throw new Error("Only one output stream is supported")}this._outputs.push(this._currentOutput={target:n,isFile:a,flags:{},pipeopts:i||{}});var o=this;["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(u){o._currentOutput[u]=s.args()}),n||delete this._currentOutput.target}return this},e.seekOutput=e.seek=function(n){return this._currentOutput.options("-ss",n),this},e.withDuration=e.setDuration=e.duration=function(n){return this._currentOutput.options("-t",n),this},e.toFormat=e.withOutputFormat=e.outputFormat=e.format=function(n){return this._currentOutput.options("-f",n),this},e.map=function(n){return this._currentOutput.options("-map",n.replace(s.streamRegexp,"[$1]")),this},e.updateFlvMetadata=e.flvmeta=function(){return this._currentOutput.flags.flvmeta=!0,this}},Bt}var Ut,oi;function ma(){if(oi)return Ut;oi=1;var s=Se;return Ut=function(e){e.addInputOption=e.addInputOptions=e.withInputOption=e.withInputOptions=e.inputOption=e.inputOptions=function(n){if(!this._currentInput)throw new Error("No input specified");var i=!0;return arguments.length>1&&(n=[].slice.call(arguments),i=!1),Array.isArray(n)||(n=[n]),this._currentInput.options(n.reduce(function(a,t){var r=String(t).split(" ");return i&&r.length===2?a.push(r[0],r[1]):a.push(t),a},[])),this},e.addOutputOption=e.addOutputOptions=e.addOption=e.addOptions=e.withOutputOption=e.withOutputOptions=e.withOption=e.withOptions=e.outputOption=e.outputOptions=function(n){var i=!0;return arguments.length>1&&(n=[].slice.call(arguments),i=!1),Array.isArray(n)||(n=[n]),this._currentOutput.options(n.reduce(function(a,t){var r=String(t).split(" ");return i&&r.length===2?a.push(r[0],r[1]):a.push(t),a},[])),this},e.filterGraph=e.complexFilter=function(n,i){if(this._complexFilters.clear(),Array.isArray(n)||(n=[n]),this._complexFilters("-filter_complex",s.makeFilterStrings(n).join(";")),Array.isArray(i)){var a=this;i.forEach(function(t){a._complexFilters("-map",t.replace(s.streamRegexp,"[$1]"))})}else typeof i=="string"&&this._complexFilters("-map",i.replace(s.streamRegexp,"[$1]"));return this}},Ut}function ga(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Xt,si;function ya(){if(si)return Xt;si=1;var s=Q;return Xt=function(e){e.usingPreset=e.preset=function(n){if(typeof n=="function")n(this);else try{var i=s.join(this.options.presets,n),a=ga(i);if(typeof a.load=="function")a.load(this);else throw new Error("preset "+i+" has no load() function")}catch(t){throw new Error("preset "+i+" could not be loaded: "+t.message)}return this}},Xt}var Vt={exports:{}},ai;function xn(){return ai||(ai=1,function(s){(function(){var e={},n,i;n=this,n!=null&&(i=n.async),e.noConflict=function(){return n.async=i,e};function a(E){var D=!1;return function(){if(D)throw new Error("Callback was already called.");D=!0,E.apply(n,arguments)}}var t=function(E,D){if(E.forEach)return E.forEach(D);for(var O=0;O<E.length;O+=1)D(E[O],O,E)},r=function(E,D){if(E.map)return E.map(D);var O=[];return t(E,function(h,C,F){O.push(D(h,C,F))}),O},o=function(E,D,O){return E.reduce?E.reduce(D,O):(t(E,function(h,C,F){O=D(O,h,C,F)}),O)},u=function(E){if(Object.keys)return Object.keys(E);var D=[];for(var O in E)E.hasOwnProperty(O)&&D.push(O);return D};typeof process>"u"||!process.nextTick?typeof setImmediate=="function"?(e.nextTick=function(E){setImmediate(E)},e.setImmediate=e.nextTick):(e.nextTick=function(E){setTimeout(E,0)},e.setImmediate=e.nextTick):(e.nextTick=process.nextTick,typeof setImmediate<"u"?e.setImmediate=function(E){setImmediate(E)}:e.setImmediate=e.nextTick),e.each=function(E,D,O){if(O=O||function(){},!E.length)return O();var h=0;t(E,function(C){D(C,a(function(F){F?(O(F),O=function(){}):(h+=1,h>=E.length&&O(null))}))})},e.forEach=e.each,e.eachSeries=function(E,D,O){if(O=O||function(){},!E.length)return O();var h=0,C=function(){D(E[h],function(F){F?(O(F),O=function(){}):(h+=1,h>=E.length?O(null):C())})};C()},e.forEachSeries=e.eachSeries,e.eachLimit=function(E,D,O,h){var C=f(D);C.apply(null,[E,O,h])},e.forEachLimit=e.eachLimit;var f=function(E){return function(D,O,h){if(h=h||function(){},!D.length||E<=0)return h();var C=0,F=0,M=0;(function U(){if(C>=D.length)return h();for(;M<E&&F<D.length;)F+=1,M+=1,O(D[F-1],function(W){W?(h(W),h=function(){}):(C+=1,M-=1,C>=D.length?h():U())})})()}},l=function(E){return function(){var D=Array.prototype.slice.call(arguments);return E.apply(null,[e.each].concat(D))}},p=function(E,D){return function(){var O=Array.prototype.slice.call(arguments);return D.apply(null,[f(E)].concat(O))}},c=function(E){return function(){var D=Array.prototype.slice.call(arguments);return E.apply(null,[e.eachSeries].concat(D))}},m=function(E,D,O,h){var C=[];D=r(D,function(F,M){return{index:M,value:F}}),E(D,function(F,M){O(F.value,function(U,W){C[F.index]=W,M(U)})},function(F){h(F,C)})};e.map=l(m),e.mapSeries=c(m),e.mapLimit=function(E,D,O,h){return v(D)(E,O,h)};var v=function(E){return p(E,m)};e.reduce=function(E,D,O,h){e.eachSeries(E,function(C,F){O(D,C,function(M,U){D=U,F(M)})},function(C){h(C,D)})},e.inject=e.reduce,e.foldl=e.reduce,e.reduceRight=function(E,D,O,h){var C=r(E,function(F){return F}).reverse();e.reduce(C,D,O,h)},e.foldr=e.reduceRight;var T=function(E,D,O,h){var C=[];D=r(D,function(F,M){return{index:M,value:F}}),E(D,function(F,M){O(F.value,function(U){U&&C.push(F),M()})},function(F){h(r(C.sort(function(M,U){return M.index-U.index}),function(M){return M.value}))})};e.filter=l(T),e.filterSeries=c(T),e.select=e.filter,e.selectSeries=e.filterSeries;var b=function(E,D,O,h){var C=[];D=r(D,function(F,M){return{index:M,value:F}}),E(D,function(F,M){O(F.value,function(U){U||C.push(F),M()})},function(F){h(r(C.sort(function(M,U){return M.index-U.index}),function(M){return M.value}))})};e.reject=l(b),e.rejectSeries=c(b);var x=function(E,D,O,h){E(D,function(C,F){O(C,function(M){M?(h(C),h=function(){}):F()})},function(C){h()})};e.detect=l(x),e.detectSeries=c(x),e.some=function(E,D,O){e.each(E,function(h,C){D(h,function(F){F&&(O(!0),O=function(){}),C()})},function(h){O(!1)})},e.any=e.some,e.every=function(E,D,O){e.each(E,function(h,C){D(h,function(F){F||(O(!1),O=function(){}),C()})},function(h){O(!0)})},e.all=e.every,e.sortBy=function(E,D,O){e.map(E,function(h,C){D(h,function(F,M){F?C(F):C(null,{value:h,criteria:M})})},function(h,C){if(h)return O(h);var F=function(M,U){var W=M.criteria,H=U.criteria;return W<H?-1:W>H?1:0};O(null,r(C.sort(F),function(M){return M.value}))})},e.auto=function(E,D){D=D||function(){};var O=u(E);if(!O.length)return D(null);var h={},C=[],F=function(W){C.unshift(W)},M=function(W){for(var H=0;H<C.length;H+=1)if(C[H]===W){C.splice(H,1);return}},U=function(){t(C.slice(0),function(W){W()})};F(function(){u(h).length===O.length&&(D(null,h),D=function(){})}),t(O,function(W){var H=E[W]instanceof Function?[E[W]]:E[W],J=function(he){var le=Array.prototype.slice.call(arguments,1);if(le.length<=1&&(le=le[0]),he){var Ee={};t(u(h),function(Le){Ee[Le]=h[Le]}),Ee[W]=le,D(he,Ee),D=function(){}}else h[W]=le,e.setImmediate(U)},Y=H.slice(0,Math.abs(H.length-1))||[],be=function(){return o(Y,function(he,le){return he&&h.hasOwnProperty(le)},!0)&&!h.hasOwnProperty(W)};if(be())H[H.length-1](J,h);else{var Oe=function(){be()&&(M(Oe),H[H.length-1](J,h))};F(Oe)}})},e.waterfall=function(E,D){if(D=D||function(){},E.constructor!==Array){var O=new Error("First argument to waterfall must be an array of functions");return D(O)}if(!E.length)return D();var h=function(C){return function(F){if(F)D.apply(null,arguments),D=function(){};else{var M=Array.prototype.slice.call(arguments,1),U=C.next();U?M.push(h(U)):M.push(D),e.setImmediate(function(){C.apply(null,M)})}}};h(e.iterator(E))()};var y=function(E,D,O){if(O=O||function(){},D.constructor===Array)E.map(D,function(C,F){C&&C(function(M){var U=Array.prototype.slice.call(arguments,1);U.length<=1&&(U=U[0]),F.call(null,M,U)})},O);else{var h={};E.each(u(D),function(C,F){D[C](function(M){var U=Array.prototype.slice.call(arguments,1);U.length<=1&&(U=U[0]),h[C]=U,F(M)})},function(C){O(C,h)})}};e.parallel=function(E,D){y({map:e.map,each:e.each},E,D)},e.parallelLimit=function(E,D,O){y({map:v(D),each:f(D)},E,O)},e.series=function(E,D){if(D=D||function(){},E.constructor===Array)e.mapSeries(E,function(h,C){h&&h(function(F){var M=Array.prototype.slice.call(arguments,1);M.length<=1&&(M=M[0]),C.call(null,F,M)})},D);else{var O={};e.eachSeries(u(E),function(h,C){E[h](function(F){var M=Array.prototype.slice.call(arguments,1);M.length<=1&&(M=M[0]),O[h]=M,C(F)})},function(h){D(h,O)})}},e.iterator=function(E){var D=function(O){var h=function(){return E.length&&E[O].apply(null,arguments),h.next()};return h.next=function(){return O<E.length-1?D(O+1):null},h};return D(0)},e.apply=function(E){var D=Array.prototype.slice.call(arguments,1);return function(){return E.apply(null,D.concat(Array.prototype.slice.call(arguments)))}};var g=function(E,D,O,h){var C=[];E(D,function(F,M){O(F,function(U,W){C=C.concat(W||[]),M(U)})},function(F){h(F,C)})};e.concat=l(g),e.concatSeries=c(g),e.whilst=function(E,D,O){E()?D(function(h){if(h)return O(h);e.whilst(E,D,O)}):O()},e.doWhilst=function(E,D,O){E(function(h){if(h)return O(h);D()?e.doWhilst(E,D,O):O()})},e.until=function(E,D,O){E()?O():D(function(h){if(h)return O(h);e.until(E,D,O)})},e.doUntil=function(E,D,O){E(function(h){if(h)return O(h);D()?O():e.doUntil(E,D,O)})},e.queue=function(E,D){D===void 0&&(D=1);function O(F,M,U,W){M.constructor!==Array&&(M=[M]),t(M,function(H){var J={data:H,callback:typeof W=="function"?W:null};U?F.tasks.unshift(J):F.tasks.push(J),F.saturated&&F.tasks.length===D&&F.saturated(),e.setImmediate(F.process)})}var h=0,C={tasks:[],concurrency:D,saturated:null,empty:null,drain:null,push:function(F,M){O(C,F,!1,M)},unshift:function(F,M){O(C,F,!0,M)},process:function(){if(h<C.concurrency&&C.tasks.length){var F=C.tasks.shift();C.empty&&C.tasks.length===0&&C.empty(),h+=1;var M=function(){h-=1,F.callback&&F.callback.apply(F,arguments),C.drain&&C.tasks.length+h===0&&C.drain(),C.process()},U=a(M);E(F.data,U)}},length:function(){return C.tasks.length},running:function(){return h}};return C},e.cargo=function(E,D){var O=!1,h=[],C={tasks:h,payload:D,saturated:null,empty:null,drain:null,push:function(F,M){F.constructor!==Array&&(F=[F]),t(F,function(U){h.push({data:U,callback:typeof M=="function"?M:null}),C.saturated&&h.length===D&&C.saturated()}),e.setImmediate(C.process)},process:function F(){if(!O){if(h.length===0){C.drain&&C.drain();return}var M=typeof D=="number"?h.splice(0,D):h.splice(0),U=r(M,function(W){return W.data});C.empty&&C.empty(),O=!0,E(U,function(){O=!1;var W=arguments;t(M,function(H){H.callback&&H.callback.apply(null,W)}),F()})}},length:function(){return h.length},running:function(){return O}};return C};var A=function(E){return function(D){var O=Array.prototype.slice.call(arguments,1);D.apply(null,O.concat([function(h){var C=Array.prototype.slice.call(arguments,1);typeof console<"u"&&(h?console.error&&console.error(h):console[E]&&t(C,function(F){console[E](F)}))}]))}};e.log=A("log"),e.dir=A("dir"),e.memoize=function(E,D){var O={},h={};D=D||function(F){return F};var C=function(){var F=Array.prototype.slice.call(arguments),M=F.pop(),U=D.apply(null,F);U in O?M.apply(null,O[U]):U in h?h[U].push(M):(h[U]=[M],E.apply(null,F.concat([function(){O[U]=arguments;var W=h[U];delete h[U];for(var H=0,J=W.length;H<J;H++)W[H].apply(null,arguments)}])))};return C.memo=O,C.unmemoized=E,C},e.unmemoize=function(E){return function(){return(E.unmemoized||E).apply(null,arguments)}},e.times=function(E,D,O){for(var h=[],C=0;C<E;C++)h.push(C);return e.map(h,D,O)},e.timesSeries=function(E,D,O){for(var h=[],C=0;C<E;C++)h.push(C);return e.mapSeries(h,D,O)},e.compose=function(){var E=Array.prototype.reverse.call(arguments);return function(){var D=this,O=Array.prototype.slice.call(arguments),h=O.pop();e.reduce(E,O,function(C,F,M){F.apply(D,C.concat([function(){var U=arguments[0],W=Array.prototype.slice.call(arguments,1);M(U,W)}]))},function(C,F){h.apply(D,[C].concat(F))})}};var N=function(E,D){var O=function(){var C=this,F=Array.prototype.slice.call(arguments),M=F.pop();return E(D,function(U,W){U.apply(C,F.concat([W]))},M)};if(arguments.length>2){var h=Array.prototype.slice.call(arguments,2);return O.apply(this,h)}else return O};e.applyEach=l(N),e.applyEachSeries=c(N),e.forever=function(E,D){function O(h){if(h){if(D)return D(h);throw h}E(O)}O()},s.exports?s.exports=e:n.async=e})()}(Vt)),Vt.exports}var zt,ui;function va(){if(ui)return zt;ui=1;var s=rt.spawn,e=xn(),n=Se;function i(a){a._inputs[0].isStream||a.ffprobe(0,function(r,o){a._ffprobeData=o})}return zt=function(a){a._spawnFfmpeg=function(t,r,o,u){typeof r=="function"&&(u=o,o=r,r={}),typeof u>"u"&&(u=o,o=function(){});var f="stdoutLines"in r?r.stdoutLines:this.options.stdoutLines;this._getFfmpegPath(function(l,p){if(l)return u(l);if(!p||p.length===0)return u(new Error("Cannot find ffmpeg"));r.niceness&&r.niceness!==0&&!n.isWindows&&(t.unshift("-n",r.niceness,p),p="nice");var c=n.linesRing(f),m=!1,v=n.linesRing(f),T=!1,b=s(p,t,r);b.stderr&&b.stderr.setEncoding("utf8"),b.on("error",function(A){u(A)});var x=null;function y(A){A&&(x=A),g&&(m||!r.captureStdout)&&T&&u(x,c,v)}var g=!1;b.on("exit",function(A,N){g=!0,N?y(new Error("ffmpeg was killed with signal "+N)):A?y(new Error("ffmpeg exited with code "+A)):y()}),r.captureStdout&&(b.stdout.on("data",function(A){c.append(A)}),b.stdout.on("close",function(){c.close(),m=!0,y()})),b.stderr.on("data",function(A){v.append(A)}),b.stderr.on("close",function(){v.close(),T=!0,y()}),o(b,c,v)})},a._getArguments=function(){var t=this._complexFilters.get(),r=this._outputs.some(function(o){return o.isFile});return[].concat(this._inputs.reduce(function(o,u){var f=typeof u.source=="string"?u.source:"pipe:0";return o.concat(u.options.get(),["-i",f])},[]),this._global.get(),r?["-y"]:[],t,this._outputs.reduce(function(o,u){var f=n.makeFilterStrings(u.sizeFilters.get()),l=u.audioFilters.get(),p=u.videoFilters.get().concat(f),c;return u.target?typeof u.target=="string"?c=[u.target]:c=["pipe:1"]:c=[],o.concat(u.audio.get(),l.length?["-filter:a",l.join(",")]:[],u.video.get(),p.length?["-filter:v",p.join(",")]:[],u.options.get(),c)},[]))},a._prepare=function(t,r){var o=this;e.waterfall([function(u){o._checkCapabilities(u)},function(u){if(!r)return u();o.ffprobe(0,function(f,l){f||(o._ffprobeData=l),u()})},function(u){var f=o._outputs.some(function(l){return l.flags.flvmeta&&!l.isFile&&(o.logger.warn("Updating flv metadata is only supported for files"),l.flags.flvmeta=!1),l.flags.flvmeta});f?o._getFlvtoolPath(function(l){u(l)}):u()},function(u){var f;try{f=o._getArguments()}catch(l){return u(l)}u(null,f)},function(u,f){o.availableEncoders(function(l,p){for(var c=0;c<u.length;c++)(u[c]==="-acodec"||u[c]==="-vcodec")&&(c++,u[c]in p&&p[u[c]].experimental&&(u.splice(c+1,0,"-strict","experimental"),c+=2));f(null,u)})}],t),r||(this.listeners("progress").length>0?i(this):this.once("newListener",function(u){u==="progress"&&i(this)}))},a.exec=a.execute=a.run=function(){var t=this,r=this._outputs.some(function(p){return"target"in p});if(!r)throw new Error("No output specified");var o=this._outputs.filter(function(p){return typeof p.target!="string"})[0],u=this._inputs.filter(function(p){return typeof p.source!="string"})[0],f=!1;function l(p,c,m){f||(f=!0,p?t.emit("error",p,c,m):t.emit("end",c,m))}return t._prepare(function(p,c){if(p)return l(p);t._spawnFfmpeg(c,{captureStdout:!o,niceness:t.options.niceness,cwd:t.options.cwd,windowsHide:!0},function(v,T,b){if(t.ffmpegProc=v,t.emit("start","ffmpeg "+c.join(" ")),u&&(u.source.on("error",function(g){var A=new Error("Input stream error: "+g.message);A.inputStreamError=g,l(A),v.kill()}),u.source.resume(),u.source.pipe(v.stdin),v.stdin.on("error",function(){})),t.options.timeout&&(t.processTimer=setTimeout(function(){var g="process ran into a timeout ("+t.options.timeout+"s)";l(new Error(g),T.get(),b.get()),v.kill()},t.options.timeout*1e3)),o&&(v.stdout.pipe(o.target,o.pipeopts),o.target.on("close",function(){t.logger.debug("Output stream closed, scheduling kill for ffmpeg process"),setTimeout(function(){l(new Error("Output stream closed")),v.kill()},20)}),o.target.on("error",function(g){t.logger.debug("Output stream error, killing ffmpeg process");var A=new Error("Output stream error: "+g.message);A.outputStreamError=g,l(A,T.get(),b.get()),v.kill("SIGKILL")})),b){if(t.listeners("stderr").length&&b.callback(function(g){t.emit("stderr",g)}),t.listeners("codecData").length){var x=!1,y={};b.callback(function(g){x||(x=n.extractCodecData(t,g,y))})}t.listeners("progress").length&&b.callback(function(g){n.extractProgress(t,g)})}},function(v,T,b){if(clearTimeout(t.processTimer),delete t.ffmpegProc,v)v.message.match(/ffmpeg exited with code/)&&(v.message+=": "+n.extractError(b.get())),l(v,T.get(),b.get());else{var x=t._outputs.filter(function(y){return y.flags.flvmeta});x.length?t._getFlvtoolPath(function(y,g){if(y)return l(y);e.each(x,function(A,N){s(g,["-U",A.target],{windowsHide:!0}).on("error",function(E){N(new Error("Error running "+g+" on "+A.target+": "+E.message))}).on("exit",function(E,D){E!==0||D?N(new Error(g+" "+(D?"received signal "+D:"exited with code "+E))+" when running on "+A.target):N()})},function(A){A?l(A):l(null,T.get(),b.get())})}):l(null,T.get(),b.get())}})}),this},a.renice=function(t){if(!n.isWindows&&(t=t||0,(t<-20||t>20)&&this.logger.warn("Invalid niceness value: "+t+", must be between -20 and 20"),t=Math.min(20,Math.max(-20,t)),this.options.niceness=t,this.ffmpegProc)){var r=this.logger,o=this.ffmpegProc.pid,u=s("renice",[t,"-p",o],{windowsHide:!0});u.on("error",function(f){r.warn("could not renice process "+o+": "+f.message)}),u.on("exit",function(f,l){l?r.warn("could not renice process "+o+": renice was killed by signal "+l):f?r.warn("could not renice process "+o+": renice exited with "+f):r.info("successfully reniced process "+o+" to "+t+" niceness")})}return this},a.kill=function(t){return this.ffmpegProc?this.ffmpegProc.kill(t||"SIGKILL"):this.logger.warn("No running ffmpeg process, cannot send signal"),this}},zt}var Wt,ci;function wa(){if(ci)return Wt;ci=1;var s=ae,e=Q,n=xn(),i=Se,a=/^\s*([D ])([E ])([VAS])([S ])([D ])([T ]) ([^ ]+) +(.*)$/,t=/^\s*([D\.])([E\.])([VAS])([I\.])([L\.])([S\.]) ([^ ]+) +(.*)$/,r=/\(encoders:([^\)]+)\)/,o=/\(decoders:([^\)]+)\)/,u=/^\s*([VAS\.])([F\.])([S\.])([X\.])([B\.])([D\.]) ([^ ]+) +(.*)$/,f=/^\s*([D ])([E ])\s+([^ ]+)\s+(.*)$/,l=/\r\n|\r|\n/,p=/^(?: [T\.][S\.][C\.] )?([^ ]+) +(AA?|VV?|\|)->(AA?|VV?|\|) +(.*)$/,c={};return Wt=function(m){m.setFfmpegPath=function(v){return c.ffmpegPath=v,this},m.setFfprobePath=function(v){return c.ffprobePath=v,this},m.setFlvtoolPath=function(v){return c.flvtoolPath=v,this},m._forgetPaths=function(){delete c.ffmpegPath,delete c.ffprobePath,delete c.flvtoolPath},m._getFfmpegPath=function(v){if("ffmpegPath"in c)return v(null,c.ffmpegPath);n.waterfall([function(T){process.env.FFMPEG_PATH?s.exists(process.env.FFMPEG_PATH,function(b){b?T(null,process.env.FFMPEG_PATH):T(null,"")}):T(null,"")},function(T,b){if(T.length)return b(null,T);i.which("ffmpeg",function(x,y){b(x,y)})}],function(T,b){T?v(T):v(null,c.ffmpegPath=b||"")})},m._getFfprobePath=function(v){var T=this;if("ffprobePath"in c)return v(null,c.ffprobePath);n.waterfall([function(b){process.env.FFPROBE_PATH?s.exists(process.env.FFPROBE_PATH,function(x){b(null,x?process.env.FFPROBE_PATH:"")}):b(null,"")},function(b,x){if(b.length)return x(null,b);i.which("ffprobe",function(y,g){x(y,g)})},function(b,x){if(b.length)return x(null,b);T._getFfmpegPath(function(y,g){if(y)x(y);else if(g.length){var A=i.isWindows?"ffprobe.exe":"ffprobe",N=e.join(e.dirname(g),A);s.exists(N,function(E){x(null,E?N:"")})}else x(null,"")})}],function(b,x){b?v(b):v(null,c.ffprobePath=x||"")})},m._getFlvtoolPath=function(v){if("flvtoolPath"in c)return v(null,c.flvtoolPath);n.waterfall([function(T){process.env.FLVMETA_PATH?s.exists(process.env.FLVMETA_PATH,function(b){T(null,b?process.env.FLVMETA_PATH:"")}):T(null,"")},function(T,b){if(T.length)return b(null,T);process.env.FLVTOOL2_PATH?s.exists(process.env.FLVTOOL2_PATH,function(x){b(null,x?process.env.FLVTOOL2_PATH:"")}):b(null,"")},function(T,b){if(T.length)return b(null,T);i.which("flvmeta",function(x,y){b(x,y)})},function(T,b){if(T.length)return b(null,T);i.which("flvtool2",function(x,y){b(x,y)})}],function(T,b){T?v(T):v(null,c.flvtoolPath=b||"")})},m.availableFilters=m.getAvailableFilters=function(v){if("filters"in c)return v(null,c.filters);this._spawnFfmpeg(["-filters"],{captureStdout:!0,stdoutLines:0},function(T,b){if(T)return v(T);var x=b.get(),y=x.split(`
`),g={},A={A:"audio",V:"video","|":"none"};y.forEach(function(N){var E=N.match(p);E&&(g[E[1]]={description:E[4],input:A[E[2].charAt(0)],multipleInputs:E[2].length>1,output:A[E[3].charAt(0)],multipleOutputs:E[3].length>1})}),v(null,c.filters=g)})},m.availableCodecs=m.getAvailableCodecs=function(v){if("codecs"in c)return v(null,c.codecs);this._spawnFfmpeg(["-codecs"],{captureStdout:!0,stdoutLines:0},function(T,b){if(T)return v(T);var x=b.get(),y=x.split(l),g={};y.forEach(function(A){var N=A.match(a);if(N&&N[7]!=="="&&(g[N[7]]={type:{V:"video",A:"audio",S:"subtitle"}[N[3]],description:N[8],canDecode:N[1]==="D",canEncode:N[2]==="E",drawHorizBand:N[4]==="S",directRendering:N[5]==="D",weirdFrameTruncation:N[6]==="T"}),N=A.match(t),N&&N[7]!=="="){var E=g[N[7]]={type:{V:"video",A:"audio",S:"subtitle"}[N[3]],description:N[8],canDecode:N[1]==="D",canEncode:N[2]==="E",intraFrameOnly:N[4]==="I",isLossy:N[5]==="L",isLossless:N[6]==="S"},D=E.description.match(r);D=D?D[1].trim().split(" "):[];var O=E.description.match(o);if(O=O?O[1].trim().split(" "):[],D.length||O.length){var h={};i.copy(E,h),delete h.canEncode,delete h.canDecode,D.forEach(function(C){g[C]={},i.copy(h,g[C]),g[C].canEncode=!0}),O.forEach(function(C){C in g||(g[C]={},i.copy(h,g[C])),g[C].canDecode=!0})}}}),v(null,c.codecs=g)})},m.availableEncoders=m.getAvailableEncoders=function(v){if("encoders"in c)return v(null,c.encoders);this._spawnFfmpeg(["-encoders"],{captureStdout:!0,stdoutLines:0},function(T,b){if(T)return v(T);var x=b.get(),y=x.split(l),g={};y.forEach(function(A){var N=A.match(u);N&&N[7]!=="="&&(g[N[7]]={type:{V:"video",A:"audio",S:"subtitle"}[N[1]],description:N[8],frameMT:N[2]==="F",sliceMT:N[3]==="S",experimental:N[4]==="X",drawHorizBand:N[5]==="B",directRendering:N[6]==="D"})}),v(null,c.encoders=g)})},m.availableFormats=m.getAvailableFormats=function(v){if("formats"in c)return v(null,c.formats);this._spawnFfmpeg(["-formats"],{captureStdout:!0,stdoutLines:0},function(T,b){if(T)return v(T);var x=b.get(),y=x.split(l),g={};y.forEach(function(A){var N=A.match(f);N&&N[3].split(",").forEach(function(E){E in g||(g[E]={description:N[4],canDemux:!1,canMux:!1}),N[1]==="D"&&(g[E].canDemux=!0),N[2]==="E"&&(g[E].canMux=!0)})}),v(null,c.formats=g)})},m._checkCapabilities=function(v){var T=this;n.waterfall([function(b){T.availableFormats(b)},function(b,x){var y;if(y=T._outputs.reduce(function(g,A){var N=A.options.find("-f",1);return N&&(!(N[0]in b)||!b[N[0]].canMux)&&g.push(N),g},[]),y.length===1)return x(new Error("Output format "+y[0]+" is not available"));if(y.length>1)return x(new Error("Output formats "+y.join(", ")+" are not available"));if(y=T._inputs.reduce(function(g,A){var N=A.options.find("-f",1);return N&&(!(N[0]in b)||!b[N[0]].canDemux)&&g.push(N[0]),g},[]),y.length===1)return x(new Error("Input format "+y[0]+" is not available"));if(y.length>1)return x(new Error("Input formats "+y.join(", ")+" are not available"));x()},function(b){T.availableEncoders(b)},function(b,x){var y;if(y=T._outputs.reduce(function(g,A){var N=A.audio.find("-acodec",1);return N&&N[0]!=="copy"&&(!(N[0]in b)||b[N[0]].type!=="audio")&&g.push(N[0]),g},[]),y.length===1)return x(new Error("Audio codec "+y[0]+" is not available"));if(y.length>1)return x(new Error("Audio codecs "+y.join(", ")+" are not available"));if(y=T._outputs.reduce(function(g,A){var N=A.video.find("-vcodec",1);return N&&N[0]!=="copy"&&(!(N[0]in b)||b[N[0]].type!=="video")&&g.push(N[0]),g},[]),y.length===1)return x(new Error("Video codec "+y[0]+" is not available"));if(y.length>1)return x(new Error("Video codecs "+y.join(", ")+" are not available"));x()}],v)}},Wt}var Ht,fi;function Ea(){if(fi)return Ht;fi=1;var s=rt.spawn;function e(a){return a.match(/^TAG:/)}function n(a){return a.match(/^DISPOSITION:/)}function i(a){var t=a.split(/\r\n|\r|\n/);t=t.filter(function(p){return p.length>0});var r={streams:[],format:{},chapters:[]};function o(p){for(var c={},m=t.shift();typeof m<"u";){if(m.toLowerCase()=="[/"+p+"]")return c;if(m.match(/^\[/)){m=t.shift();continue}var v=m.match(/^([^=]+)=(.*)$/);v&&(!v[1].match(/^TAG:/)&&v[2].match(/^[0-9]+(\.[0-9]+)?$/)?c[v[1]]=Number(v[2]):c[v[1]]=v[2]),m=t.shift()}return c}for(var u=t.shift();typeof u<"u";){if(u.match(/^\[stream/i)){var f=o("stream");r.streams.push(f)}else if(u.match(/^\[chapter/i)){var l=o("chapter");r.chapters.push(l)}else u.toLowerCase()==="[format]"&&(r.format=o("format"));u=t.shift()}return r}return Ht=function(a){a.ffprobe=function(){var t,r=null,o=[],u,u=arguments[arguments.length-1],f=!1;function l(p,c){f||(f=!0,u(p,c))}switch(arguments.length){case 3:r=arguments[0],o=arguments[1];break;case 2:typeof arguments[0]=="number"?r=arguments[0]:Array.isArray(arguments[0])&&(o=arguments[0]);break}if(r===null){if(!this._currentInput)return l(new Error("No input specified"));t=this._currentInput}else if(t=this._inputs[r],!t)return l(new Error("Invalid input index"));this._getFfprobePath(function(p,c){if(p)return l(p);if(!c)return l(new Error("Cannot find ffprobe"));var m="",v=!1,T="",b=!1,x=t.isStream?"pipe:0":t.source,y=s(c,["-show_streams","-show_format"].concat(o,x),{windowsHide:!0});t.isStream&&(y.stdin.on("error",function(E){["ECONNRESET","EPIPE","EOF"].indexOf(E.code)>=0||l(E)}),y.stdin.on("close",function(){t.source.pause(),t.source.unpipe(y.stdin)}),t.source.pipe(y.stdin)),y.on("error",u);var g=null;function A(E){if(E&&(g=E),N&&v&&b){if(g)return T&&(g.message+=`
`+T),l(g);var D=i(m);[D.format].concat(D.streams).forEach(function(O){if(O){var h=Object.keys(O).filter(e);h.length&&(O.tags=O.tags||{},h.forEach(function(F){O.tags[F.substr(4)]=O[F],delete O[F]}));var C=Object.keys(O).filter(n);C.length&&(O.disposition=O.disposition||{},C.forEach(function(F){O.disposition[F.substr(12)]=O[F],delete O[F]}))}}),l(null,D)}}var N=!1;y.on("exit",function(E,D){N=!0,E?A(new Error("ffprobe exited with code "+E)):D?A(new Error("ffprobe was killed with signal "+D)):A()}),y.stdout.on("data",function(E){m+=E}),y.stdout.on("close",function(){v=!0,A()}),y.stderr.on("data",function(E){T+=E}),y.stderr.on("close",function(){b=!0,A()})})}},Ht}var Gt,li;function Ta(){if(li)return Gt;li=1;var s=ae,e=Q,n=zs.PassThrough,i=xn(),a=Se;return Gt=function(r){r.saveToFile=r.save=function(o){return this.output(o).run(),this},r.writeToStream=r.pipe=r.stream=function(o,u){if(o&&!("writable"in o)&&(u=o,o=void 0),!o){if(process.version.match(/v0\.8\./))throw new Error("PassThrough stream is not supported on node v0.8");o=new n}return this.output(o,u).run(),o},r.takeScreenshots=r.thumbnail=r.thumbnails=r.screenshot=r.screenshots=function(o,u){var f=this,l=this._currentInput.source;if(o=o||{count:1},typeof o=="number"&&(o={count:o}),"folder"in o||(o.folder=u||"."),"timestamps"in o&&(o.timemarks=o.timestamps),!("timemarks"in o)){if(!o.count)throw new Error("Cannot take screenshots: neither a count nor a timemark list are specified");var p=100/(1+o.count);o.timemarks=[];for(var c=0;c<o.count;c++)o.timemarks.push(p*(c+1)+"%")}if("size"in o){var m=o.size.match(/^(\d+)x(\d+)$/),v=o.size.match(/^(\d+)x\?$/),T=o.size.match(/^\?x(\d+)$/),b=o.size.match(/^(\d+)%$/);if(!m&&!v&&!T&&!b)throw new Error("Invalid size parameter: "+o.size)}var x;function y(g){x?g(null,x):f.ffprobe(function(A,N){x=N,g(A,N)})}return i.waterfall([function(A){if(o.timemarks.some(function(N){return(""+N).match(/^[\d.]+%$/)})){if(typeof l!="string")return A(new Error("Cannot compute screenshot timemarks with an input stream, please specify fixed timemarks"));y(function(N,E){if(N)A(N);else{var D=E.streams.reduce(function(h,C){return C.codec_type==="video"&&C.width*C.height>h.width*h.height?C:h},{width:0,height:0});if(D.width===0)return A(new Error("No video stream in input, cannot take screenshots"));var O=Number(D.duration);if(isNaN(O)&&(O=Number(E.format.duration)),isNaN(O))return A(new Error("Could not get input duration, please specify fixed timemarks"));o.timemarks=o.timemarks.map(function(h){return(""+h).match(/^([\d.]+)%$/)?O*parseFloat(h)/100:h}),A()}})}else A()},function(A){o.timemarks=o.timemarks.map(function(N){return a.timemarkToSeconds(N)}).sort(function(N,E){return N-E}),A()},function(A){var N=o.filename||"tn.png";if(N.indexOf(".")===-1&&(N+=".png"),o.timemarks.length>1&&!N.match(/%(s|0*i)/)){var E=e.extname(N);N=e.join(e.dirname(N),e.basename(N,E)+"_%i"+E)}A(null,N)},function(A,N){if(A.match(/%[bf]/)){if(typeof l!="string")return N(new Error("Cannot replace %f or %b when using an input stream"));A=A.replace(/%f/g,e.basename(l)).replace(/%b/g,e.basename(l,e.extname(l)))}N(null,A)},function(A,N){if(A.match(/%[whr]/)){if(m)return N(null,A,m[1],m[2]);y(function(E,D){if(E)return N(new Error("Could not determine video resolution to replace %w, %h or %r"));var O=D.streams.reduce(function(F,M){return M.codec_type==="video"&&M.width*M.height>F.width*F.height?M:F},{width:0,height:0});if(O.width===0)return N(new Error("No video stream in input, cannot replace %w, %h or %r"));var h=O.width,C=O.height;v?(C=C*Number(v[1])/h,h=Number(v[1])):T?(h=h*Number(T[1])/C,C=Number(T[1])):b&&(h=h*Number(b[1])/100,C=C*Number(b[1])/100),N(null,A,Math.round(h/2)*2,Math.round(C/2)*2)})}else N(null,A,-1,-1)},function(A,N,E,D){A=A.replace(/%r/g,"%wx%h").replace(/%w/g,N).replace(/%h/g,E),D(null,A)},function(A,N){var E=o.timemarks.map(function(D,O){return A.replace(/%s/g,a.timemarkToSeconds(D)).replace(/%(0*)i/g,function(h,C){var F=""+(O+1);return C.substr(0,Math.max(0,C.length+1-F.length))+F})});f.emit("filenames",E),N(null,E)},function(A,N){s.exists(o.folder,function(E){E?N(null,A):s.mkdir(o.folder,function(D){D?N(D):N(null,A)})})}],function(A,N){if(A)return f.emit("error",A);var E=o.timemarks.length,D,O=[D={filter:"split",options:E,outputs:[]}];if("size"in o){f.size(o.size);var h=f._currentOutput.sizeFilters.get().map(function(U,W){return W>0&&(U.inputs="size"+(W-1)),U.outputs="size"+W,U});D.inputs="size"+(h.length-1),O=h.concat(O),f._currentOutput.sizeFilters.clear()}for(var C=0,F=0;F<E;F++){var M="screen"+F;D.outputs.push(M),F===0&&(C=o.timemarks[F],f.seekInput(C)),f.output(e.join(o.folder,N[F])).frames(1).map(M),F>0&&f.seek(o.timemarks[F]-C)}f.complexFilter(O),f.run()}),this},r.mergeToFile=r.concatenate=r.concat=function(o,u){var f=this._inputs.filter(function(p){return!p.isStream})[0],l=this;return this.ffprobe(this._inputs.indexOf(f),function(p,c){if(p)return l.emit("error",p);var m=c.streams.some(function(T){return T.codec_type==="audio"}),v=c.streams.some(function(T){return T.codec_type==="video"});l.output(o,u).complexFilter({filter:"concat",options:{n:l._inputs.length,v:v?1:0,a:m?1:0}}).run()}),this}},Gt}var ba=Q,Oa=tt,is=Be.EventEmitter,wn=Se;function te(s,e){if(!(this instanceof te))return new te(s,e);is.call(this),typeof s=="object"&&!("readable"in s)?e=s:(e=e||{},e.source=s),this._inputs=[],e.source&&this.input(e.source),this._outputs=[],this.output();var n=this;["_global","_complexFilters"].forEach(function(i){n[i]=wn.args()}),e.stdoutLines="stdoutLines"in e?e.stdoutLines:100,e.presets=e.presets||e.preset||ba.join(__dirname,"presets"),e.niceness=e.niceness||e.priority||0,this.options=e,this.logger=e.logger||{debug:function(){},info:function(){},warn:function(){},error:function(){}}}Oa.inherits(te,is);var Ca=te;te.prototype.clone=function(){var s=new te,e=this;return s.options=this.options,s.logger=this.logger,s._inputs=this._inputs.map(function(n){return{source:n.source,options:n.options.clone()}}),"target"in this._outputs[0]?(s._outputs=[],s.output()):(s._outputs=[s._currentOutput={flags:{}}],["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(n){s._currentOutput[n]=e._currentOutput[n].clone()}),this._currentOutput.sizeData&&(s._currentOutput.sizeData={},wn.copy(this._currentOutput.sizeData,s._currentOutput.sizeData)),wn.copy(this._currentOutput.flags,s._currentOutput.flags)),["_global","_complexFilters"].forEach(function(n){s[n]=e[n].clone()}),s};fa()(te.prototype);la()(te.prototype);pa()(te.prototype);ha()(te.prototype);da()(te.prototype);ma()(te.prototype);ya()(te.prototype);va()(te.prototype);wa()(te.prototype);te.setFfmpegPath=function(s){new te().setFfmpegPath(s)};te.setFfprobePath=function(s){new te().setFfprobePath(s)};te.setFlvtoolPath=function(s){new te().setFlvtoolPath(s)};te.availableFilters=te.getAvailableFilters=function(s){new te().availableFilters(s)};te.availableCodecs=te.getAvailableCodecs=function(s){new te().availableCodecs(s)};te.availableFormats=te.getAvailableFormats=function(s){new te().availableFormats(s)};te.availableEncoders=te.getAvailableEncoders=function(s){new te().availableEncoders(s)};Ea()(te.prototype);te.ffprobe=function(s){var e=new te(s);e.ffprobe.apply(e,Array.prototype.slice.call(arguments,1))};Ta()(te.prototype);var os=Ca;const Ze=Tt(os);var mt={exports:{}},Kt={exports:{}},pi;function ss(){return pi||(pi=1,function(s){let e={};try{e=require("electron")}catch{}e.ipcRenderer&&n(e),s.exports=n;function n({contextBridge:i,ipcRenderer:a}){if(!a)return;a.on("__ELECTRON_LOG_IPC__",(r,o)=>{window.postMessage({cmd:"message",...o})}),a.invoke("__ELECTRON_LOG__",{cmd:"getOptions"}).catch(r=>console.error(new Error(`electron-log isn't initialized in the main process. Please call log.initialize() before. ${r.message}`)));const t={sendToMain(r){try{a.send("__ELECTRON_LOG__",r)}catch(o){console.error("electronLog.sendToMain ",o,"data:",r),a.send("__ELECTRON_LOG__",{cmd:"errorHandler",error:{message:o==null?void 0:o.message,stack:o==null?void 0:o.stack},errorName:"sendToMain"})}},log(...r){t.sendToMain({data:r,level:"info"})}};for(const r of["error","warn","info","verbose","debug","silly"])t[r]=(...o)=>t.sendToMain({data:o,level:r});if(i&&process.contextIsolated)try{i.exposeInMainWorld("__electronLog",t)}catch{}typeof window=="object"?window.__electronLog=t:__electronLog=t}}(Kt)),Kt.exports}var Yt={exports:{}},Jt,hi;function Aa(){if(hi)return Jt;hi=1,Jt=s;function s(e){return Object.defineProperties(n,{defaultLabel:{value:"",writable:!0},labelPadding:{value:!0,writable:!0},maxLabelLength:{value:0,writable:!0},labelLength:{get(){switch(typeof n.labelPadding){case"boolean":return n.labelPadding?n.maxLabelLength:0;case"number":return n.labelPadding;default:return 0}}}});function n(i){n.maxLabelLength=Math.max(n.maxLabelLength,i.length);const a={};for(const t of e.levels)a[t]=(...r)=>e.logData(r,{level:t,scope:i});return a.log=a.info,a}}return Jt}var Qt,di;function Da(){if(di)return Qt;di=1;class s{constructor({processMessage:n}){this.processMessage=n,this.buffer=[],this.enabled=!1,this.begin=this.begin.bind(this),this.commit=this.commit.bind(this),this.reject=this.reject.bind(this)}addMessage(n){this.buffer.push(n)}begin(){this.enabled=[]}commit(){this.enabled=!1,this.buffer.forEach(n=>this.processMessage(n)),this.buffer=[]}reject(){this.enabled=!1,this.buffer=[]}}return Qt=s,Qt}var Zt,mi;function as(){if(mi)return Zt;mi=1;const s=Aa(),e=Da(),i=class i{constructor({allowUnknownLevel:t=!1,dependencies:r={},errorHandler:o,eventLogger:u,initializeFn:f,isDev:l=!1,levels:p=["error","warn","info","verbose","debug","silly"],logId:c,transportFactories:m={},variables:v}={}){Z(this,"dependencies",{});Z(this,"errorHandler",null);Z(this,"eventLogger",null);Z(this,"functions",{});Z(this,"hooks",[]);Z(this,"isDev",!1);Z(this,"levels",null);Z(this,"logId",null);Z(this,"scope",null);Z(this,"transports",{});Z(this,"variables",{});this.addLevel=this.addLevel.bind(this),this.create=this.create.bind(this),this.initialize=this.initialize.bind(this),this.logData=this.logData.bind(this),this.processMessage=this.processMessage.bind(this),this.allowUnknownLevel=t,this.buffering=new e(this),this.dependencies=r,this.initializeFn=f,this.isDev=l,this.levels=p,this.logId=c,this.scope=s(this),this.transportFactories=m,this.variables=v||{};for(const T of this.levels)this.addLevel(T,!1);this.log=this.info,this.functions.log=this.log,this.errorHandler=o,o==null||o.setOptions({...r,logFn:this.error}),this.eventLogger=u,u==null||u.setOptions({...r,logger:this});for(const[T,b]of Object.entries(m))this.transports[T]=b(this,r);i.instances[c]=this}static getInstance({logId:t}){return this.instances[t]||this.instances.default}addLevel(t,r=this.levels.length){r!==!1&&this.levels.splice(r,0,t),this[t]=(...o)=>this.logData(o,{level:t}),this.functions[t]=this[t]}catchErrors(t){return this.processMessage({data:["log.catchErrors is deprecated. Use log.errorHandler instead"],level:"warn"},{transports:["console"]}),this.errorHandler.startCatching(t)}create(t){return typeof t=="string"&&(t={logId:t}),new i({dependencies:this.dependencies,errorHandler:this.errorHandler,initializeFn:this.initializeFn,isDev:this.isDev,transportFactories:this.transportFactories,variables:{...this.variables},...t})}compareLevels(t,r,o=this.levels){const u=o.indexOf(t),f=o.indexOf(r);return f===-1||u===-1?!0:f<=u}initialize(t={}){this.initializeFn({logger:this,...this.dependencies,...t})}logData(t,r={}){this.buffering.enabled?this.buffering.addMessage({data:t,date:new Date,...r}):this.processMessage({data:t,...r})}processMessage(t,{transports:r=this.transports}={}){if(t.cmd==="errorHandler"){this.errorHandler.handle(t.error,{errorName:t.errorName,processType:"renderer",showDialog:!!t.showDialog});return}let o=t.level;this.allowUnknownLevel||(o=this.levels.includes(t.level)?t.level:"info");const u={date:new Date,logId:this.logId,...t,level:o,variables:{...this.variables,...t.variables}};for(const[f,l]of this.transportEntries(r))if(!(typeof l!="function"||l.level===!1)&&this.compareLevels(l.level,t.level))try{const p=this.hooks.reduce((c,m)=>c&&m(c,l,f),u);p&&l({...p,data:[...p.data]})}catch(p){this.processInternalErrorFn(p)}}processInternalErrorFn(t){}transportEntries(t=this.transports){return(Array.isArray(t)?t:Object.entries(t)).map(o=>{switch(typeof o){case"string":return this.transports[o]?[o,this.transports[o]]:null;case"function":return[o.name,o];default:return Array.isArray(o)?o:null}}).filter(Boolean)}};Z(i,"instances",{});let n=i;return Zt=n,Zt}var er,gi;function Na(){if(gi)return er;gi=1;const s=console.error;class e{constructor({logFn:i=null}={}){Z(this,"logFn",null);Z(this,"onError",null);Z(this,"showDialog",!1);Z(this,"preventDefault",!0);this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.startCatching=this.startCatching.bind(this),this.logFn=i}handle(i,{logFn:a=this.logFn,errorName:t="",onError:r=this.onError,showDialog:o=this.showDialog}={}){try{(r==null?void 0:r({error:i,errorName:t,processType:"renderer"}))!==!1&&a({error:i,errorName:t,showDialog:o})}catch{s(i)}}setOptions({logFn:i,onError:a,preventDefault:t,showDialog:r}){typeof i=="function"&&(this.logFn=i),typeof a=="function"&&(this.onError=a),typeof t=="boolean"&&(this.preventDefault=t),typeof r=="boolean"&&(this.showDialog=r)}startCatching({onError:i,showDialog:a}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:i,showDialog:a}),window.addEventListener("error",t=>{var r;this.preventDefault&&((r=t.preventDefault)==null||r.call(t)),this.handleError(t.error||t)}),window.addEventListener("unhandledrejection",t=>{var r;this.preventDefault&&((r=t.preventDefault)==null||r.call(t)),this.handleRejection(t.reason||t)}))}handleError(i){this.handle(i,{errorName:"Unhandled"})}handleRejection(i){const a=i instanceof Error?i:new Error(JSON.stringify(i));this.handle(a,{errorName:"Unhandled rejection"})}}return er=e,er}var tr,yi;function Ue(){if(yi)return tr;yi=1,tr={transform:s};function s({logger:e,message:n,transport:i,initialData:a=(n==null?void 0:n.data)||[],transforms:t=i==null?void 0:i.transforms}){return t.reduce((r,o)=>typeof o=="function"?o({data:r,logger:e,message:n,transport:i}):r,a)}return tr}var rr,vi;function _a(){if(vi)return rr;vi=1;const{transform:s}=Ue();rr=n;const e={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};function n(a){return Object.assign(t,{format:"{h}:{i}:{s}.{ms}{scope} › {text}",transforms:[i],writeFn({message:{level:r,data:o}}){const u=e[r]||e.info;setTimeout(()=>u(...o))}});function t(r){t.writeFn({message:{...r,data:s({logger:a,message:r,transport:t})}})}}function i({data:a=[],logger:t={},message:r={},transport:o={}}){if(typeof o.format=="function")return o.format({data:a,level:(r==null?void 0:r.level)||"info",logger:t,message:r,transport:o});if(typeof o.format!="string")return a;a.unshift(o.format),typeof a[1]=="string"&&a[1].match(/%[1cdfiOos]/)&&(a=[`${a[0]} ${a[1]}`,...a.slice(2)]);const u=r.date||new Date;return a[0]=a[0].replace(/\{(\w+)}/g,(f,l)=>{var p,c;switch(l){case"level":return r.level;case"logId":return r.logId;case"scope":{const m=r.scope||((p=t.scope)==null?void 0:p.defaultLabel);return m?` (${m})`:""}case"text":return"";case"y":return u.getFullYear().toString(10);case"m":return(u.getMonth()+1).toString(10).padStart(2,"0");case"d":return u.getDate().toString(10).padStart(2,"0");case"h":return u.getHours().toString(10).padStart(2,"0");case"i":return u.getMinutes().toString(10).padStart(2,"0");case"s":return u.getSeconds().toString(10).padStart(2,"0");case"ms":return u.getMilliseconds().toString(10).padStart(3,"0");case"iso":return u.toISOString();default:return((c=r.variables)==null?void 0:c[l])||f}}).trim(),a}return rr}var nr,wi;function Ia(){if(wi)return nr;wi=1;const{transform:s}=Ue();nr=n;const e=new Set([Promise,WeakMap,WeakSet]);function n(t){return Object.assign(r,{depth:5,transforms:[a]});function r(o){if(!window.__electronLog){t.processMessage({data:["electron-log: logger isn't initialized in the main process"],level:"error"},{transports:["console"]});return}try{const u=s({initialData:o,logger:t,message:o,transport:r});__electronLog.sendToMain(u)}catch(u){t.transports.console({data:["electronLog.transports.ipc",u,"data:",o.data],level:"error"})}}}function i(t){return Object(t)!==t}function a({data:t,depth:r,seen:o=new WeakSet,transport:u={}}={}){const f=r||u.depth||5;return o.has(t)?"[Circular]":f<1?i(t)?t:Array.isArray(t)?"[Array]":`[${typeof t}]`:["function","symbol"].includes(typeof t)?t.toString():i(t)?t:e.has(t.constructor)?`[${t.constructor.name}]`:Array.isArray(t)?t.map(l=>a({data:l,depth:f-1,seen:o})):t instanceof Date?t.toISOString():t instanceof Error?t.stack:t instanceof Map?new Map(Array.from(t).map(([l,p])=>[a({data:l,depth:f-1,seen:o}),a({data:p,depth:f-1,seen:o})])):t instanceof Set?new Set(Array.from(t).map(l=>a({data:l,depth:f-1,seen:o}))):(o.add(t),Object.fromEntries(Object.entries(t).map(([l,p])=>[l,a({data:p,depth:f-1,seen:o})])))}return nr}var Ei;function xa(){return Ei||(Ei=1,function(s){const e=as(),n=Na(),i=_a(),a=Ia();s.exports=t(),s.exports.Logger=e,s.exports.default=s.exports;function t(){const r=new e({allowUnknownLevel:!0,errorHandler:new n,initializeFn:()=>{},logId:"default",transportFactories:{console:i,ipc:a},variables:{processType:"renderer"}});return r.errorHandler.setOptions({logFn({error:o,errorName:u,showDialog:f}){r.transports.console({data:[u,o].filter(Boolean),level:"error"}),r.transports.ipc({cmd:"errorHandler",error:{cause:o==null?void 0:o.cause,code:o==null?void 0:o.code,name:o==null?void 0:o.name,message:o==null?void 0:o.message,stack:o==null?void 0:o.stack},errorName:u,logId:r.logId,showDialog:f})}}),typeof window=="object"&&window.addEventListener("message",o=>{const{cmd:u,logId:f,...l}=o.data||{},p=e.getInstance({logId:f});u==="message"&&p.processMessage(l,{transports:["console"]})}),new Proxy(r,{get(o,u){return typeof o[u]<"u"?o[u]:(...f)=>r.logData(f,{level:u})}})}}(Yt)),Yt.exports}var ir,Ti;function Fa(){if(Ti)return ir;Ti=1;const s=ae,e=Q;ir={findAndReadPackageJson:n,tryReadJsonAt:i};function n(){return i(r())||i(t())||i(process.resourcesPath,"app.asar")||i(process.resourcesPath,"app")||i(process.cwd())||{name:void 0,version:void 0}}function i(...o){if(o[0])try{const u=e.join(...o),f=a("package.json",u);if(!f)return;const l=JSON.parse(s.readFileSync(f,"utf8")),p=(l==null?void 0:l.productName)||(l==null?void 0:l.name);return!p||p.toLowerCase()==="electron"?void 0:p?{name:p,version:l==null?void 0:l.version}:void 0}catch{return}}function a(o,u){let f=u;for(;;){const l=e.parse(f),p=l.root,c=l.dir;if(s.existsSync(e.join(f,o)))return e.resolve(e.join(f,o));if(f===p)return null;f=c}}function t(){const o=process.argv.filter(f=>f.indexOf("--user-data-dir=")===0);return o.length===0||typeof o[0]!="string"?null:o[0].replace("--user-data-dir=","")}function r(){var o;try{return(o=require.main)==null?void 0:o.filename}catch{return}}return ir}var or,bi;function us(){if(bi)return or;bi=1;const s=rt,e=$e,n=Q,i=Fa();class a{constructor(){Z(this,"appName");Z(this,"appPackageJson");Z(this,"platform",process.platform)}getAppLogPath(r=this.getAppName()){return this.platform==="darwin"?n.join(this.getSystemPathHome(),"Library/Logs",r):n.join(this.getAppUserDataPath(r),"logs")}getAppName(){var o;const r=this.appName||((o=this.getAppPackageJson())==null?void 0:o.name);if(!r)throw new Error("electron-log can't determine the app name. It tried these methods:\n1. Use `electron.app.name`\n2. Use productName or name from the nearest package.json`\nYou can also set it through log.transports.file.setAppName()");return r}getAppPackageJson(){return typeof this.appPackageJson!="object"&&(this.appPackageJson=i.findAndReadPackageJson()),this.appPackageJson}getAppUserDataPath(r=this.getAppName()){return r?n.join(this.getSystemPathAppData(),r):void 0}getAppVersion(){var r;return(r=this.getAppPackageJson())==null?void 0:r.version}getElectronLogPath(){return this.getAppLogPath()}getMacOsVersion(){const r=Number(e.release().split(".")[0]);return r<=19?`10.${r-4}`:r-9}getOsVersion(){let r=e.type().replace("_"," "),o=e.release();return r==="Darwin"&&(r="macOS",o=this.getMacOsVersion()),`${r} ${o}`}getPathVariables(){const r=this.getAppName(),o=this.getAppVersion(),u=this;return{appData:this.getSystemPathAppData(),appName:r,appVersion:o,get electronDefaultDir(){return u.getElectronLogPath()},home:this.getSystemPathHome(),libraryDefaultDir:this.getAppLogPath(r),libraryTemplate:this.getAppLogPath("{appName}"),temp:this.getSystemPathTemp(),userData:this.getAppUserDataPath(r)}}getSystemPathAppData(){const r=this.getSystemPathHome();switch(this.platform){case"darwin":return n.join(r,"Library/Application Support");case"win32":return process.env.APPDATA||n.join(r,"AppData/Roaming");default:return process.env.XDG_CONFIG_HOME||n.join(r,".config")}}getSystemPathHome(){var r;return((r=e.homedir)==null?void 0:r.call(e))||process.env.HOME}getSystemPathTemp(){return e.tmpdir()}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:void 0,os:this.getOsVersion()}}isDev(){return process.env.NODE_ENV==="development"||process.env.ELECTRON_IS_DEV==="1"}isElectron(){return!!process.versions.electron}onAppEvent(r,o){}onAppReady(r){r()}onEveryWebContentsEvent(r,o){}onIpc(r,o){}onIpcInvoke(r,o){}openUrl(r,o=console.error){const f={darwin:"open",win32:"start",linux:"xdg-open"}[process.platform]||"xdg-open";s.exec(`${f} ${r}`,{},l=>{l&&o(l)})}setAppName(r){this.appName=r}setPlatform(r){this.platform=r}setPreloadFileForSessions({filePath:r,includeFutureSession:o=!0,getSessions:u=()=>[]}){}sendIpc(r,o){}showErrorBox(r,o){}}return or=a,or}var sr,Oi;function Sa(){if(Oi)return sr;Oi=1;const s=Q,e=us();class n extends e{constructor({electron:t}={}){super();Z(this,"electron");this.electron=t}getAppName(){var r,o;let t;try{t=this.appName||((r=this.electron.app)==null?void 0:r.name)||((o=this.electron.app)==null?void 0:o.getName())}catch{}return t||super.getAppName()}getAppUserDataPath(t){return this.getPath("userData")||super.getAppUserDataPath(t)}getAppVersion(){var r;let t;try{t=(r=this.electron.app)==null?void 0:r.getVersion()}catch{}return t||super.getAppVersion()}getElectronLogPath(){return this.getPath("logs")||super.getElectronLogPath()}getPath(t){var r;try{return(r=this.electron.app)==null?void 0:r.getPath(t)}catch{return}}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:`Electron ${process.versions.electron}`,os:this.getOsVersion()}}getSystemPathAppData(){return this.getPath("appData")||super.getSystemPathAppData()}isDev(){var t;return((t=this.electron.app)==null?void 0:t.isPackaged)!==void 0?!this.electron.app.isPackaged:typeof process.execPath=="string"?s.basename(process.execPath).toLowerCase().startsWith("electron"):super.isDev()}onAppEvent(t,r){var o;return(o=this.electron.app)==null||o.on(t,r),()=>{var u;(u=this.electron.app)==null||u.off(t,r)}}onAppReady(t){var r,o,u;(r=this.electron.app)!=null&&r.isReady()?t():(o=this.electron.app)!=null&&o.once?(u=this.electron.app)==null||u.once("ready",t):t()}onEveryWebContentsEvent(t,r){var u,f,l;return(f=(u=this.electron.webContents)==null?void 0:u.getAllWebContents())==null||f.forEach(p=>{p.on(t,r)}),(l=this.electron.app)==null||l.on("web-contents-created",o),()=>{var p,c;(p=this.electron.webContents)==null||p.getAllWebContents().forEach(m=>{m.off(t,r)}),(c=this.electron.app)==null||c.off("web-contents-created",o)};function o(p,c){c.on(t,r)}}onIpc(t,r){var o;(o=this.electron.ipcMain)==null||o.on(t,r)}onIpcInvoke(t,r){var o,u;(u=(o=this.electron.ipcMain)==null?void 0:o.handle)==null||u.call(o,t,r)}openUrl(t,r=console.error){var o;(o=this.electron.shell)==null||o.openExternal(t).catch(r)}setPreloadFileForSessions({filePath:t,includeFutureSession:r=!0,getSessions:o=()=>{var u;return[(u=this.electron.session)==null?void 0:u.defaultSession]}}){for(const f of o().filter(Boolean))u(f);r&&this.onAppEvent("session-created",f=>{u(f)});function u(f){typeof f.registerPreloadScript=="function"?f.registerPreloadScript({filePath:t,id:"electron-log-preload",type:"frame"}):f.setPreloads([...f.getPreloads(),t])}}sendIpc(t,r){var o,u;(u=(o=this.electron.BrowserWindow)==null?void 0:o.getAllWindows())==null||u.forEach(f=>{var l,p;((l=f.webContents)==null?void 0:l.isDestroyed())===!1&&((p=f.webContents)==null?void 0:p.isCrashed())===!1&&f.webContents.send(t,r)})}showErrorBox(t,r){var o;(o=this.electron.dialog)==null||o.showErrorBox(t,r)}}return sr=n,sr}var ar,Ci;function Pa(){if(Ci)return ar;Ci=1;const s=ae,e=$e,n=Q,i=ss();ar={initialize({externalApi:r,getSessions:o,includeFutureSession:u,logger:f,preload:l=!0,spyRendererConsole:p=!1}){r.onAppReady(()=>{try{l&&a({externalApi:r,getSessions:o,includeFutureSession:u,preloadOption:l}),p&&t({externalApi:r,logger:f})}catch(c){f.warn(c)}})}};function a({externalApi:r,getSessions:o,includeFutureSession:u,preloadOption:f}){let l=typeof f=="string"?f:void 0;try{l=n.resolve(__dirname,"../renderer/electron-log-preload.js")}catch{}if(!l||!s.existsSync(l)){l=n.join(r.getAppUserDataPath()||e.tmpdir(),"electron-log-preload.js");const p=`
      try {
        (${i.toString()})(require('electron'));
      } catch(e) {
        console.error(e);
      }
    `;s.writeFileSync(l,p,"utf8")}r.setPreloadFileForSessions({filePath:l,includeFutureSession:u,getSessions:o})}function t({externalApi:r,logger:o}){const u=["debug","info","warn","error"];r.onEveryWebContentsEvent("console-message",(f,l,p)=>{o.processMessage({data:[p],level:u[l],variables:{processType:"renderer"}})})}return ar}var ur,Ai;function La(){if(Ai)return ur;Ai=1;class s{constructor({externalApi:i,logFn:a=void 0,onError:t=void 0,showDialog:r=void 0}={}){Z(this,"externalApi");Z(this,"isActive",!1);Z(this,"logFn");Z(this,"onError");Z(this,"showDialog",!0);this.createIssue=this.createIssue.bind(this),this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.setOptions({externalApi:i,logFn:a,onError:t,showDialog:r}),this.startCatching=this.startCatching.bind(this),this.stopCatching=this.stopCatching.bind(this)}handle(i,{logFn:a=this.logFn,onError:t=this.onError,processType:r="browser",showDialog:o=this.showDialog,errorName:u=""}={}){var f;i=e(i);try{if(typeof t=="function"){const l=((f=this.externalApi)==null?void 0:f.getVersions())||{},p=this.createIssue;if(t({createIssue:p,error:i,errorName:u,processType:r,versions:l})===!1)return}u?a(u,i):a(i),o&&!u.includes("rejection")&&this.externalApi&&this.externalApi.showErrorBox(`A JavaScript error occurred in the ${r} process`,i.stack)}catch{console.error(i)}}setOptions({externalApi:i,logFn:a,onError:t,showDialog:r}){typeof i=="object"&&(this.externalApi=i),typeof a=="function"&&(this.logFn=a),typeof t=="function"&&(this.onError=t),typeof r=="boolean"&&(this.showDialog=r)}startCatching({onError:i,showDialog:a}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:i,showDialog:a}),process.on("uncaughtException",this.handleError),process.on("unhandledRejection",this.handleRejection))}stopCatching(){this.isActive=!1,process.removeListener("uncaughtException",this.handleError),process.removeListener("unhandledRejection",this.handleRejection)}createIssue(i,a){var t;(t=this.externalApi)==null||t.openUrl(`${i}?${new URLSearchParams(a).toString()}`)}handleError(i){this.handle(i,{errorName:"Unhandled"})}handleRejection(i){const a=i instanceof Error?i:new Error(JSON.stringify(i));this.handle(a,{errorName:"Unhandled rejection"})}}function e(n){if(n instanceof Error)return n;if(n&&typeof n=="object"){if(n.message)return Object.assign(new Error(n.message),n);try{return new Error(JSON.stringify(n))}catch(i){return new Error(`Couldn't normalize error ${String(n)}: ${i}`)}}return new Error(`Can't normalize error ${String(n)}`)}return ur=s,ur}var cr,Di;function Ma(){if(Di)return cr;Di=1;class s{constructor(n={}){Z(this,"disposers",[]);Z(this,"format","{eventSource}#{eventName}:");Z(this,"formatters",{app:{"certificate-error":({args:n})=>this.arrayToObject(n.slice(1,4),["url","error","certificate"]),"child-process-gone":({args:n})=>n.length===1?n[0]:n,"render-process-gone":({args:[n,i]})=>i&&typeof i=="object"?{...i,...this.getWebContentsDetails(n)}:[]},webContents:{"console-message":({args:[n,i,a,t]})=>{if(!(n<3))return{message:i,source:`${t}:${a}`}},"did-fail-load":({args:n})=>this.arrayToObject(n,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"did-fail-provisional-load":({args:n})=>this.arrayToObject(n,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"plugin-crashed":({args:n})=>this.arrayToObject(n,["name","version"]),"preload-error":({args:n})=>this.arrayToObject(n,["preloadPath","error"])}});Z(this,"events",{app:{"certificate-error":!0,"child-process-gone":!0,"render-process-gone":!0},webContents:{"did-fail-load":!0,"did-fail-provisional-load":!0,"plugin-crashed":!0,"preload-error":!0,unresponsive:!0}});Z(this,"externalApi");Z(this,"level","error");Z(this,"scope","");this.setOptions(n)}setOptions({events:n,externalApi:i,level:a,logger:t,format:r,formatters:o,scope:u}){typeof n=="object"&&(this.events=n),typeof i=="object"&&(this.externalApi=i),typeof a=="string"&&(this.level=a),typeof t=="object"&&(this.logger=t),(typeof r=="string"||typeof r=="function")&&(this.format=r),typeof o=="object"&&(this.formatters=o),typeof u=="string"&&(this.scope=u)}startLogging(n={}){this.setOptions(n),this.disposeListeners();for(const i of this.getEventNames(this.events.app))this.disposers.push(this.externalApi.onAppEvent(i,(...a)=>{this.handleEvent({eventSource:"app",eventName:i,handlerArgs:a})}));for(const i of this.getEventNames(this.events.webContents))this.disposers.push(this.externalApi.onEveryWebContentsEvent(i,(...a)=>{this.handleEvent({eventSource:"webContents",eventName:i,handlerArgs:a})}))}stopLogging(){this.disposeListeners()}arrayToObject(n,i){const a={};return i.forEach((t,r)=>{a[t]=n[r]}),n.length>i.length&&(a.unknownArgs=n.slice(i.length)),a}disposeListeners(){this.disposers.forEach(n=>n()),this.disposers=[]}formatEventLog({eventName:n,eventSource:i,handlerArgs:a}){var p;const[t,...r]=a;if(typeof this.format=="function")return this.format({args:r,event:t,eventName:n,eventSource:i});const o=(p=this.formatters[i])==null?void 0:p[n];let u=r;if(typeof o=="function"&&(u=o({args:r,event:t,eventName:n,eventSource:i})),!u)return;const f={};return Array.isArray(u)?f.args=u:typeof u=="object"&&Object.assign(f,u),i==="webContents"&&Object.assign(f,this.getWebContentsDetails(t==null?void 0:t.sender)),[this.format.replace("{eventSource}",i==="app"?"App":"WebContents").replace("{eventName}",n),f]}getEventNames(n){return!n||typeof n!="object"?[]:Object.entries(n).filter(([i,a])=>a).map(([i])=>i)}getWebContentsDetails(n){if(!(n!=null&&n.loadURL))return{};try{return{webContents:{id:n.id,url:n.getURL()}}}catch{return{}}}handleEvent({eventName:n,eventSource:i,handlerArgs:a}){var r;const t=this.formatEventLog({eventName:n,eventSource:i,handlerArgs:a});if(t){const o=this.scope?this.logger.scope(this.scope):this.logger;(r=o==null?void 0:o[this.level])==null||r.call(o,...t)}}}return cr=s,cr}var fr,Ni;function cs(){if(Ni)return fr;Ni=1;const{transform:s}=Ue();fr={concatFirstStringElements:e,formatScope:i,formatText:t,formatVariables:a,timeZoneFromOffset:n,format({message:r,logger:o,transport:u,data:f=r==null?void 0:r.data}){switch(typeof u.format){case"string":return s({message:r,logger:o,transforms:[a,i,t],transport:u,initialData:[u.format,...f]});case"function":return u.format({data:f,level:(r==null?void 0:r.level)||"info",logger:o,message:r,transport:u});default:return f}}};function e({data:r}){return typeof r[0]!="string"||typeof r[1]!="string"||r[0].match(/%[1cdfiOos]/)?r:[`${r[0]} ${r[1]}`,...r.slice(2)]}function n(r){const o=Math.abs(r),u=r>0?"-":"+",f=Math.floor(o/60).toString().padStart(2,"0"),l=(o%60).toString().padStart(2,"0");return`${u}${f}:${l}`}function i({data:r,logger:o,message:u}){const{defaultLabel:f,labelLength:l}=(o==null?void 0:o.scope)||{},p=r[0];let c=u.scope;c||(c=f);let m;return c===""?m=l>0?"".padEnd(l+3):"":typeof c=="string"?m=` (${c})`.padEnd(l+3):m="",r[0]=p.replace("{scope}",m),r}function a({data:r,message:o}){let u=r[0];if(typeof u!="string")return r;u=u.replace("{level}]",`${o.level}]`.padEnd(6," "));const f=o.date||new Date;return r[0]=u.replace(/\{(\w+)}/g,(l,p)=>{var c;switch(p){case"level":return o.level||"info";case"logId":return o.logId;case"y":return f.getFullYear().toString(10);case"m":return(f.getMonth()+1).toString(10).padStart(2,"0");case"d":return f.getDate().toString(10).padStart(2,"0");case"h":return f.getHours().toString(10).padStart(2,"0");case"i":return f.getMinutes().toString(10).padStart(2,"0");case"s":return f.getSeconds().toString(10).padStart(2,"0");case"ms":return f.getMilliseconds().toString(10).padStart(3,"0");case"z":return n(f.getTimezoneOffset());case"iso":return f.toISOString();default:return((c=o.variables)==null?void 0:c[p])||l}}).trim(),r}function t({data:r}){const o=r[0];if(typeof o!="string")return r;if(o.lastIndexOf("{text}")===o.length-6)return r[0]=o.replace(/\s?{text}/,""),r[0]===""&&r.shift(),r;const f=o.split("{text}");let l=[];return f[0]!==""&&l.push(f[0]),l=l.concat(r.slice(1)),f[1]!==""&&l.push(f[1]),l}return fr}var lr={exports:{}},_i;function bt(){return _i||(_i=1,function(s){const e=tt;s.exports={serialize:i,maxDepth({data:a,transport:t,depth:r=(t==null?void 0:t.depth)??6}){if(!a)return a;if(r<1)return Array.isArray(a)?"[array]":typeof a=="object"&&a?"[object]":a;if(Array.isArray(a))return a.map(u=>s.exports.maxDepth({data:u,depth:r-1}));if(typeof a!="object"||a&&typeof a.toISOString=="function")return a;if(a===null)return null;if(a instanceof Error)return a;const o={};for(const u in a)Object.prototype.hasOwnProperty.call(a,u)&&(o[u]=s.exports.maxDepth({data:a[u],depth:r-1}));return o},toJSON({data:a}){return JSON.parse(JSON.stringify(a,n()))},toString({data:a,transport:t}){const r=(t==null?void 0:t.inspectOptions)||{},o=a.map(u=>{if(u!==void 0)try{const f=JSON.stringify(u,n(),"  ");return f===void 0?void 0:JSON.parse(f)}catch{return u}});return e.formatWithOptions(r,...o)}};function n(a={}){const t=new WeakSet;return function(r,o){if(typeof o=="object"&&o!==null){if(t.has(o))return;t.add(o)}return i(r,o,a)}}function i(a,t,r={}){const o=(r==null?void 0:r.serializeMapAndSet)!==!1;return t instanceof Error?t.stack:t&&(typeof t=="function"?`[function] ${t.toString()}`:t instanceof Date?t.toISOString():o&&t instanceof Map&&Object.fromEntries?Object.fromEntries(t):o&&t instanceof Set&&Array.from?Array.from(t):t)}}(lr)),lr.exports}var pr,Ii;function Fn(){if(Ii)return pr;Ii=1,pr={transformStyles:i,applyAnsiStyles({data:a}){return i(a,e,n)},removeStyles({data:a}){return i(a,()=>"")}};const s={unset:"\x1B[0m",black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"};function e(a){const t=a.replace(/color:\s*(\w+).*/,"$1").toLowerCase();return s[t]||""}function n(a){return a+s.unset}function i(a,t,r){const o={};return a.reduce((u,f,l,p)=>{if(o[l])return u;if(typeof f=="string"){let c=l,m=!1;f=f.replace(/%[1cdfiOos]/g,v=>{if(c+=1,v!=="%c")return v;const T=p[c];return typeof T=="string"?(o[c]=!0,m=!0,t(T,f)):v}),m&&r&&(f=r(f))}return u.push(f),u},[])}return pr}var hr,xi;function Ra(){if(xi)return hr;xi=1;const{concatFirstStringElements:s,format:e}=cs(),{maxDepth:n,toJSON:i}=bt(),{applyAnsiStyles:a,removeStyles:t}=Fn(),{transform:r}=Ue(),o={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};hr=l;const f=`%c{h}:{i}:{s}.{ms}{scope}%c ${process.platform==="win32"?">":"›"} {text}`;Object.assign(l,{DEFAULT_FORMAT:f});function l(T){return Object.assign(b,{format:f,level:"silly",transforms:[p,e,m,s,n,i],useStyles:process.env.FORCE_STYLES,writeFn({message:x}){(o[x.level]||o.info)(...x.data)}});function b(x){const y=r({logger:T,message:x,transport:b});b.writeFn({message:{...x,data:y}})}}function p({data:T,message:b,transport:x}){return x.format!==f?T:[`color:${v(b.level)}`,"color:unset",...T]}function c(T,b){if(typeof T=="boolean")return T;const y=b==="error"||b==="warn"?process.stderr:process.stdout;return y&&y.isTTY}function m(T){const{message:b,transport:x}=T;return(c(x.useStyles,b.level)?a:t)(T)}function v(T){const b={error:"red",warn:"yellow",info:"cyan",default:"unset"};return b[T]||b.default}return hr}var dr,Fi;function fs(){if(Fi)return dr;Fi=1;const s=Be,e=ae,n=$e;class i extends s{constructor({path:o,writeOptions:u={encoding:"utf8",flag:"a",mode:438},writeAsync:f=!1}){super();Z(this,"asyncWriteQueue",[]);Z(this,"bytesWritten",0);Z(this,"hasActiveAsyncWriting",!1);Z(this,"path",null);Z(this,"initialSize");Z(this,"writeOptions",null);Z(this,"writeAsync",!1);this.path=o,this.writeOptions=u,this.writeAsync=f}get size(){return this.getSize()}clear(){try{return e.writeFileSync(this.path,"",{mode:this.writeOptions.mode,flag:"w"}),this.reset(),!0}catch(o){return o.code==="ENOENT"?!0:(this.emit("error",o,this),!1)}}crop(o){try{const u=a(this.path,o||4096);this.clear(),this.writeLine(`[log cropped]${n.EOL}${u}`)}catch(u){this.emit("error",new Error(`Couldn't crop file ${this.path}. ${u.message}`),this)}}getSize(){if(this.initialSize===void 0)try{const o=e.statSync(this.path);this.initialSize=o.size}catch{this.initialSize=0}return this.initialSize+this.bytesWritten}increaseBytesWrittenCounter(o){this.bytesWritten+=Buffer.byteLength(o,this.writeOptions.encoding)}isNull(){return!1}nextAsyncWrite(){const o=this;if(this.hasActiveAsyncWriting||this.asyncWriteQueue.length===0)return;const u=this.asyncWriteQueue.join("");this.asyncWriteQueue=[],this.hasActiveAsyncWriting=!0,e.writeFile(this.path,u,this.writeOptions,f=>{o.hasActiveAsyncWriting=!1,f?o.emit("error",new Error(`Couldn't write to ${o.path}. ${f.message}`),this):o.increaseBytesWrittenCounter(u),o.nextAsyncWrite()})}reset(){this.initialSize=void 0,this.bytesWritten=0}toString(){return this.path}writeLine(o){if(o+=n.EOL,this.writeAsync){this.asyncWriteQueue.push(o),this.nextAsyncWrite();return}try{e.writeFileSync(this.path,o,this.writeOptions),this.increaseBytesWrittenCounter(o)}catch(u){this.emit("error",new Error(`Couldn't write to ${this.path}. ${u.message}`),this)}}}dr=i;function a(t,r){const o=Buffer.alloc(r),u=e.statSync(t),f=Math.min(u.size,r),l=Math.max(0,u.size-r),p=e.openSync(t,"r"),c=e.readSync(p,o,0,f,l);return e.closeSync(p),o.toString("utf8",0,c)}return dr}var mr,Si;function ja(){if(Si)return mr;Si=1;const s=fs();class e extends s{clear(){}crop(){}getSize(){return 0}isNull(){return!0}writeLine(){}}return mr=e,mr}var gr,Pi;function qa(){if(Pi)return gr;Pi=1;const s=Be,e=ae,n=Q,i=fs(),a=ja();class t extends s{constructor(){super();Z(this,"store",{});this.emitError=this.emitError.bind(this)}provide({filePath:u,writeOptions:f={},writeAsync:l=!1}){let p;try{if(u=n.resolve(u),this.store[u])return this.store[u];p=this.createFile({filePath:u,writeOptions:f,writeAsync:l})}catch(c){p=new a({path:u}),this.emitError(c,p)}return p.on("error",this.emitError),this.store[u]=p,p}createFile({filePath:u,writeOptions:f,writeAsync:l}){return this.testFileWriting({filePath:u,writeOptions:f}),new i({path:u,writeOptions:f,writeAsync:l})}emitError(u,f){this.emit("error",u,f)}testFileWriting({filePath:u,writeOptions:f}){e.mkdirSync(n.dirname(u),{recursive:!0}),e.writeFileSync(u,"",{flag:"a",mode:f.mode})}}return gr=t,gr}var yr,Li;function $a(){if(Li)return yr;Li=1;const s=ae,e=$e,n=Q,i=qa(),{transform:a}=Ue(),{removeStyles:t}=Fn(),{format:r,concatFirstStringElements:o}=cs(),{toString:u}=bt();yr=l;const f=new i;function l(c,{registry:m=f,externalApi:v}={}){let T;return m.listenerCount("error")<1&&m.on("error",(N,E)=>{y(`Can't write to ${E}`,N)}),Object.assign(b,{fileName:p(c.variables.processType),format:"[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}]{scope} {text}",getFile:g,inspectOptions:{depth:5},level:"silly",maxSize:1024**2,readAllLogs:A,sync:!0,transforms:[t,r,o,u],writeOptions:{flag:"a",mode:438,encoding:"utf8"},archiveLogFn(N){const E=N.toString(),D=n.parse(E);try{s.renameSync(E,n.join(D.dir,`${D.name}.old${D.ext}`))}catch(O){y("Could not rotate log",O);const h=Math.round(b.maxSize/4);N.crop(Math.min(h,256*1024))}},resolvePathFn(N){return n.join(N.libraryDefaultDir,N.fileName)},setAppName(N){c.dependencies.externalApi.setAppName(N)}});function b(N){const E=g(N);b.maxSize>0&&E.size>b.maxSize&&(b.archiveLogFn(E),E.reset());const O=a({logger:c,message:N,transport:b});E.writeLine(O)}function x(){T||(T=Object.create(Object.prototype,{...Object.getOwnPropertyDescriptors(v.getPathVariables()),fileName:{get(){return b.fileName},enumerable:!0}}),typeof b.archiveLog=="function"&&(b.archiveLogFn=b.archiveLog,y("archiveLog is deprecated. Use archiveLogFn instead")),typeof b.resolvePath=="function"&&(b.resolvePathFn=b.resolvePath,y("resolvePath is deprecated. Use resolvePathFn instead")))}function y(N,E=null,D="error"){const O=[`electron-log.transports.file: ${N}`];E&&O.push(E),c.transports.console({data:O,date:new Date,level:D})}function g(N){x();const E=b.resolvePathFn(T,N);return m.provide({filePath:E,writeAsync:!b.sync,writeOptions:b.writeOptions})}function A({fileFilter:N=E=>E.endsWith(".log")}={}){x();const E=n.dirname(b.resolvePathFn(T));return s.existsSync(E)?s.readdirSync(E).map(D=>n.join(E,D)).filter(N).map(D=>{try{return{path:D,lines:s.readFileSync(D,"utf8").split(e.EOL)}}catch{return null}}).filter(Boolean):[]}}function p(c=process.type){switch(c){case"renderer":return"renderer.log";case"worker":return"worker.log";default:return"main.log"}}return yr}var vr,Mi;function ka(){if(Mi)return vr;Mi=1;const{maxDepth:s,toJSON:e}=bt(),{transform:n}=Ue();vr=i;function i(a,{externalApi:t}){return Object.assign(r,{depth:3,eventId:"__ELECTRON_LOG_IPC__",level:a.isDev?"silly":!1,transforms:[e,s]}),t!=null&&t.isElectron()?r:void 0;function r(o){var u;((u=o==null?void 0:o.variables)==null?void 0:u.processType)!=="renderer"&&(t==null||t.sendIpc(r.eventId,{...o,data:n({logger:a,message:o,transport:r})}))}}return vr}var wr,Ri;function Ba(){if(Ri)return wr;Ri=1;const s=wt,e=Et,{transform:n}=Ue(),{removeStyles:i}=Fn(),{toJSON:a,maxDepth:t}=bt();wr=r;function r(o){return Object.assign(u,{client:{name:"electron-application"},depth:6,level:!1,requestOptions:{},transforms:[i,a,t],makeBodyFn({message:f}){return JSON.stringify({client:u.client,data:f.data,date:f.date.getTime(),level:f.level,scope:f.scope,variables:f.variables})},processErrorFn({error:f}){o.processMessage({data:[`electron-log: can't POST ${u.url}`,f],level:"warn"},{transports:["console","file"]})},sendRequestFn({serverUrl:f,requestOptions:l,body:p}){const m=(f.startsWith("https:")?e:s).request(f,{method:"POST",...l,headers:{"Content-Type":"application/json","Content-Length":p.length,...l.headers}});return m.write(p),m.end(),m}});function u(f){if(!u.url)return;const l=u.makeBodyFn({logger:o,message:{...f,data:n({logger:o,message:f,transport:u})},transport:u}),p=u.sendRequestFn({serverUrl:u.url,requestOptions:u.requestOptions,body:Buffer.from(l,"utf8")});p.on("error",c=>u.processErrorFn({error:c,logger:o,message:f,request:p,transport:u}))}}return wr}var Er,ji;function ls(){if(ji)return Er;ji=1;const s=as(),e=La(),n=Ma(),i=Ra(),a=$a(),t=ka(),r=Ba();Er=o;function o({dependencies:u,initializeFn:f}){var p;const l=new s({dependencies:u,errorHandler:new e,eventLogger:new n,initializeFn:f,isDev:(p=u.externalApi)==null?void 0:p.isDev(),logId:"default",transportFactories:{console:i,file:a,ipc:t,remote:r},variables:{processType:"main"}});return l.default=l,l.Logger=s,l.processInternalErrorFn=c=>{l.transports.console.writeFn({message:{data:["Unhandled electron-log error",c],level:"error"}})},l}return Er}var Tr,qi;function Ua(){if(qi)return Tr;qi=1;const s=re,e=Sa(),{initialize:n}=Pa(),i=ls(),a=new e({electron:s}),t=i({dependencies:{externalApi:a},initializeFn:n});Tr=t,a.onIpc("__ELECTRON_LOG__",(o,u)=>{u.scope&&t.Logger.getInstance(u).scope(u.scope);const f=new Date(u.date);r({...u,date:f.getTime()?f:new Date})}),a.onIpcInvoke("__ELECTRON_LOG__",(o,{cmd:u="",logId:f})=>{switch(u){case"getOptions":return{levels:t.Logger.getInstance({logId:f}).levels,logId:f};default:return r({data:[`Unknown cmd '${u}'`],level:"error"}),{}}});function r(o){var u;(u=t.Logger.getInstance(o))==null||u.processMessage(o)}return Tr}var br,$i;function Xa(){if($i)return br;$i=1;const s=us(),e=ls(),n=new s;return br=e({dependencies:{externalApi:n}}),br}const Va=typeof process>"u"||process.type==="renderer"||process.type==="worker",za=typeof process=="object"&&process.type==="browser";Va?(ss(),mt.exports=xa()):za?mt.exports=Ua():mt.exports=Xa();var Wa=mt.exports;const oe=Tt(Wa),ki=require("iconv-lite");function Ha(s){try{const e=ki.decode(Buffer.from(s,"binary"),"gbk");return/[^\u0000-\uFFFF]/.test(e)?s.split(Q.sep).map(n=>{try{return ki.decode(Buffer.from(n,"binary"),"gbk")}catch{return n}}).join(Q.sep):e}catch{return s}}async function Bi(s){const e=Ha(s),n=Q.normalize(e);if(console.log(n),!ae.existsSync(n)){if(s!==n&&ae.existsSync(s))return s;throw new Error(`文件不存在: ${n}
原始路径: ${s}`)}return n}function En(s){return Buffer.from(s,"base64").toString("utf-8")}function gt(s){switch(Q.extname(s).toLowerCase()){case".mp4":return"video/mp4";case".webm":return"video/webm";case".mov":return"video/quicktime";case".avi":return"video/x-msvideo";case".mkv":return"video/x-matroska";case".mp3":return"audio/mpeg";case".wav":return"audio/wav";case".ogg":return"audio/ogg";case".aac":return"audio/aac";case".flac":return"audio/flac";case".jpg":case".jpeg":return"image/jpeg";case".png":return"image/png";default:return"application/octet-stream"}}function Ui(s){return new ReadableStream({start(e){s.on("data",n=>{e.enqueue(n)}),s.on("end",()=>{e.close()}),s.on("error",n=>{e.error(n)})},cancel(){s.destroy()}})}function Ga(){try{let s,e;if(re.app.isPackaged){const n=Q.join(process.resourcesPath,"app.asar.unpacked","bin");s=Q.join(n,process.platform==="win32"?"ffmpeg.exe":"ffmpeg"),e=Q.join(n,process.platform==="win32"?"ffprobe.exe":"ffprobe")}else{const n=require("ffmpeg-static"),i=require("ffprobe-static");s=n,e=i.path}return console.log("FFmpeg路径:",s),console.log("FFprobe路径:",e),Ze.setFfmpegPath(s),Ze.setFfprobePath(e),{ffmpegPath:s,ffprobePath:e}}catch(s){throw console.error("FFmpeg初始化失败:",s),new Error(`视频处理引擎初始化失败: ${s.message}`)}}function Ka(){re.ipcMain.handle("merge-media",async(s,e)=>{const{videoPaths:n,audioPaths:i,outputPath:a,audioVolumes:t=[]}=e,r=[...await Promise.all(n.map(Bi)),...await Promise.all(i.map(Bi))];return new Promise((o,u)=>{const f=Ze();r.forEach(T=>f.input(T));const l=[],p=n.map((T,b)=>`[${b}:v]scale=1280:720,setsar=1[v${b}]`);l.push(p.join(";"));const c=n.map((T,b)=>`[v${b}]`).join("");l.push(`${c}concat=n=${n.length}:v=1:a=0[vout]`);const m=i.map((T,b)=>`[${b+n.length}:a]aformat=sample_fmts=fltp[a${b}]`);l.push(m.join(";"));const v=i.map((T,b)=>`[a${b}]`).join("");l.push(`${v}amix=inputs=${i.length}:duration=longest[aout]`),oe.log(l.join(";")),f.complexFilter(l.join(";")).outputOptions(["-map [vout]","-map [aout]","-c:v libx264","-preset fast","-crf 22","-c:a aac","-b:a 192k","-shortest"]).save(a).on("progress",T=>{const b=T.percent?Math.min(100,T.percent):0;s.sender.send("merge-progress",b)}).on("end",()=>o(a)).on("error",(T,b,x)=>{console.error("FFmpeg Error:",T.message),console.error("FFmpeg Stderr:",x),u(T)})})})}function Ya(){re.ipcMain.handle("open-file",async(s,e)=>{const{shell:n}=require("electron");await n.openPath(e)})}var st,Ja=new Uint8Array(16);function ps(){if(!st&&(st=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!st))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return st(Ja)}const Qa=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ot(s){return typeof s=="string"&&Qa.test(s)}var de=[];for(var Or=0;Or<256;++Or)de.push((Or+256).toString(16).substr(1));function Ct(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(de[s[e+0]]+de[s[e+1]]+de[s[e+2]]+de[s[e+3]]+"-"+de[s[e+4]]+de[s[e+5]]+"-"+de[s[e+6]]+de[s[e+7]]+"-"+de[s[e+8]]+de[s[e+9]]+"-"+de[s[e+10]]+de[s[e+11]]+de[s[e+12]]+de[s[e+13]]+de[s[e+14]]+de[s[e+15]]).toLowerCase();if(!Ot(n))throw TypeError("Stringified UUID is invalid");return n}var Xi,Cr,Ar=0,Dr=0;function Za(s,e,n){var i=e&&n||0,a=e||new Array(16);s=s||{};var t=s.node||Xi,r=s.clockseq!==void 0?s.clockseq:Cr;if(t==null||r==null){var o=s.random||(s.rng||ps)();t==null&&(t=Xi=[o[0]|1,o[1],o[2],o[3],o[4],o[5]]),r==null&&(r=Cr=(o[6]<<8|o[7])&16383)}var u=s.msecs!==void 0?s.msecs:Date.now(),f=s.nsecs!==void 0?s.nsecs:Dr+1,l=u-Ar+(f-Dr)/1e4;if(l<0&&s.clockseq===void 0&&(r=r+1&16383),(l<0||u>Ar)&&s.nsecs===void 0&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ar=u,Dr=f,Cr=r,u+=122192928e5;var p=((u&268435455)*1e4+f)%4294967296;a[i++]=p>>>24&255,a[i++]=p>>>16&255,a[i++]=p>>>8&255,a[i++]=p&255;var c=u/4294967296*1e4&268435455;a[i++]=c>>>8&255,a[i++]=c&255,a[i++]=c>>>24&15|16,a[i++]=c>>>16&255,a[i++]=r>>>8|128,a[i++]=r&255;for(var m=0;m<6;++m)a[i+m]=t[m];return e||Ct(a)}function hs(s){if(!Ot(s))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(s.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(s.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(s.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(s.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(s.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}function eu(s){s=unescape(encodeURIComponent(s));for(var e=[],n=0;n<s.length;++n)e.push(s.charCodeAt(n));return e}var tu="6ba7b810-9dad-11d1-80b4-00c04fd430c8",ru="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ds(s,e,n){function i(a,t,r,o){if(typeof a=="string"&&(a=eu(a)),typeof t=="string"&&(t=hs(t)),t.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+a.length);if(u.set(t),u.set(a,t.length),u=n(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,r){o=o||0;for(var f=0;f<16;++f)r[o+f]=u[f];return r}return Ct(u)}try{i.name=s}catch{}return i.DNS=tu,i.URL=ru,i}function nu(s){if(typeof s=="string"){var e=unescape(encodeURIComponent(s));s=new Uint8Array(e.length);for(var n=0;n<e.length;++n)s[n]=e.charCodeAt(n)}return iu(ou(su(s),s.length*8))}function iu(s){for(var e=[],n=s.length*32,i="0123456789abcdef",a=0;a<n;a+=8){var t=s[a>>5]>>>a%32&255,r=parseInt(i.charAt(t>>>4&15)+i.charAt(t&15),16);e.push(r)}return e}function ms(s){return(s+64>>>9<<4)+14+1}function ou(s,e){s[e>>5]|=128<<e%32,s[ms(e)-1]=e;for(var n=1732584193,i=-271733879,a=-1732584194,t=271733878,r=0;r<s.length;r+=16){var o=n,u=i,f=a,l=t;n=ge(n,i,a,t,s[r],7,-680876936),t=ge(t,n,i,a,s[r+1],12,-389564586),a=ge(a,t,n,i,s[r+2],17,606105819),i=ge(i,a,t,n,s[r+3],22,-1044525330),n=ge(n,i,a,t,s[r+4],7,-176418897),t=ge(t,n,i,a,s[r+5],12,1200080426),a=ge(a,t,n,i,s[r+6],17,-1473231341),i=ge(i,a,t,n,s[r+7],22,-45705983),n=ge(n,i,a,t,s[r+8],7,1770035416),t=ge(t,n,i,a,s[r+9],12,-1958414417),a=ge(a,t,n,i,s[r+10],17,-42063),i=ge(i,a,t,n,s[r+11],22,-1990404162),n=ge(n,i,a,t,s[r+12],7,1804603682),t=ge(t,n,i,a,s[r+13],12,-40341101),a=ge(a,t,n,i,s[r+14],17,-1502002290),i=ge(i,a,t,n,s[r+15],22,1236535329),n=ye(n,i,a,t,s[r+1],5,-165796510),t=ye(t,n,i,a,s[r+6],9,-1069501632),a=ye(a,t,n,i,s[r+11],14,643717713),i=ye(i,a,t,n,s[r],20,-373897302),n=ye(n,i,a,t,s[r+5],5,-701558691),t=ye(t,n,i,a,s[r+10],9,38016083),a=ye(a,t,n,i,s[r+15],14,-660478335),i=ye(i,a,t,n,s[r+4],20,-405537848),n=ye(n,i,a,t,s[r+9],5,568446438),t=ye(t,n,i,a,s[r+14],9,-1019803690),a=ye(a,t,n,i,s[r+3],14,-187363961),i=ye(i,a,t,n,s[r+8],20,1163531501),n=ye(n,i,a,t,s[r+13],5,-1444681467),t=ye(t,n,i,a,s[r+2],9,-51403784),a=ye(a,t,n,i,s[r+7],14,1735328473),i=ye(i,a,t,n,s[r+12],20,-1926607734),n=ve(n,i,a,t,s[r+5],4,-378558),t=ve(t,n,i,a,s[r+8],11,-2022574463),a=ve(a,t,n,i,s[r+11],16,1839030562),i=ve(i,a,t,n,s[r+14],23,-35309556),n=ve(n,i,a,t,s[r+1],4,-1530992060),t=ve(t,n,i,a,s[r+4],11,1272893353),a=ve(a,t,n,i,s[r+7],16,-155497632),i=ve(i,a,t,n,s[r+10],23,-1094730640),n=ve(n,i,a,t,s[r+13],4,681279174),t=ve(t,n,i,a,s[r],11,-358537222),a=ve(a,t,n,i,s[r+3],16,-722521979),i=ve(i,a,t,n,s[r+6],23,76029189),n=ve(n,i,a,t,s[r+9],4,-640364487),t=ve(t,n,i,a,s[r+12],11,-421815835),a=ve(a,t,n,i,s[r+15],16,530742520),i=ve(i,a,t,n,s[r+2],23,-995338651),n=we(n,i,a,t,s[r],6,-198630844),t=we(t,n,i,a,s[r+7],10,1126891415),a=we(a,t,n,i,s[r+14],15,-1416354905),i=we(i,a,t,n,s[r+5],21,-57434055),n=we(n,i,a,t,s[r+12],6,1700485571),t=we(t,n,i,a,s[r+3],10,-1894986606),a=we(a,t,n,i,s[r+10],15,-1051523),i=we(i,a,t,n,s[r+1],21,-2054922799),n=we(n,i,a,t,s[r+8],6,1873313359),t=we(t,n,i,a,s[r+15],10,-30611744),a=we(a,t,n,i,s[r+6],15,-1560198380),i=we(i,a,t,n,s[r+13],21,1309151649),n=we(n,i,a,t,s[r+4],6,-145523070),t=we(t,n,i,a,s[r+11],10,-1120210379),a=we(a,t,n,i,s[r+2],15,718787259),i=we(i,a,t,n,s[r+9],21,-343485551),n=qe(n,o),i=qe(i,u),a=qe(a,f),t=qe(t,l)}return[n,i,a,t]}function su(s){if(s.length===0)return[];for(var e=s.length*8,n=new Uint32Array(ms(e)),i=0;i<e;i+=8)n[i>>5]|=(s[i/8]&255)<<i%32;return n}function qe(s,e){var n=(s&65535)+(e&65535),i=(s>>16)+(e>>16)+(n>>16);return i<<16|n&65535}function au(s,e){return s<<e|s>>>32-e}function At(s,e,n,i,a,t){return qe(au(qe(qe(e,s),qe(i,t)),a),n)}function ge(s,e,n,i,a,t,r){return At(e&n|~e&i,s,e,a,t,r)}function ye(s,e,n,i,a,t,r){return At(e&i|n&~i,s,e,a,t,r)}function ve(s,e,n,i,a,t,r){return At(e^n^i,s,e,a,t,r)}function we(s,e,n,i,a,t,r){return At(n^(e|~i),s,e,a,t,r)}var uu=ds("v3",48,nu);const cu=uu;function fu(s,e,n){s=s||{};var i=s.random||(s.rng||ps)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(var a=0;a<16;++a)e[n+a]=i[a];return e}return Ct(i)}function lu(s,e,n,i){switch(s){case 0:return e&n^~e&i;case 1:return e^n^i;case 2:return e&n^e&i^n&i;case 3:return e^n^i}}function Nr(s,e){return s<<e|s>>>32-e}function pu(s){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof s=="string"){var i=unescape(encodeURIComponent(s));s=[];for(var a=0;a<i.length;++a)s.push(i.charCodeAt(a))}else Array.isArray(s)||(s=Array.prototype.slice.call(s));s.push(128);for(var t=s.length/4+2,r=Math.ceil(t/16),o=new Array(r),u=0;u<r;++u){for(var f=new Uint32Array(16),l=0;l<16;++l)f[l]=s[u*64+l*4]<<24|s[u*64+l*4+1]<<16|s[u*64+l*4+2]<<8|s[u*64+l*4+3];o[u]=f}o[r-1][14]=(s.length-1)*8/Math.pow(2,32),o[r-1][14]=Math.floor(o[r-1][14]),o[r-1][15]=(s.length-1)*8&4294967295;for(var p=0;p<r;++p){for(var c=new Uint32Array(80),m=0;m<16;++m)c[m]=o[p][m];for(var v=16;v<80;++v)c[v]=Nr(c[v-3]^c[v-8]^c[v-14]^c[v-16],1);for(var T=n[0],b=n[1],x=n[2],y=n[3],g=n[4],A=0;A<80;++A){var N=Math.floor(A/20),E=Nr(T,5)+lu(N,b,x,y)+g+e[N]+c[A]>>>0;g=y,y=x,x=Nr(b,30)>>>0,b=T,T=E}n[0]=n[0]+T>>>0,n[1]=n[1]+b>>>0,n[2]=n[2]+x>>>0,n[3]=n[3]+y>>>0,n[4]=n[4]+g>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var hu=ds("v5",80,pu);const du=hu,mu="00000000-0000-0000-0000-000000000000";function gu(s){if(!Ot(s))throw TypeError("Invalid UUID");return parseInt(s.substr(14,1),16)}const yu=Object.freeze(Object.defineProperty({__proto__:null,NIL:mu,parse:hs,stringify:Ct,v1:Za,v3:cu,v4:fu,v5:du,validate:Ot,version:gu},Symbol.toStringTag,{value:"Module"})),vu=Zs(yu),wu=Ws,at=Dn,{v1:af,v4:Eu}=vu;let Tu=class{constructor(e){at(e,'must pass "config"'),at(e.url,'must pass "url"'),at(e.appkey,'must pass "appkey"'),at(e.token,"must first get token from cache or getToken interface"),this._config=e}start(e,n){if(typeof e!="function")throw new Error("expect function onmessage");if(typeof n!="function")throw new Error("expect function onclose");return this._ws=new wu(this._config.url,{headers:{"X-NLS-Token":this._config.token},perMessageDeflate:!1}),this._ws.on("message",(i,a)=>{e(i,a)}),this._ws.on("close",()=>{n()}),new Promise((i,a)=>{this._ws.on("open",()=>{i()}),this._ws.on("error",t=>{a(t)})})}send(e,n){this._ws!=null&&this._ws.send(e,{binary:n})}setPing(e,n){this._ping=setInterval(()=>{this._ws.ping(n)},e)}clearPing(){this._ping&&clearInterval(this._ping)}shutdown(){this._ws!=null&&(this._ping!=null&&clearInterval(this._ping),this._ws.terminate())}uuid(){return Eu().split("-").join("")}defaultContext(){return{sdk:{name:"nls-nodejs-sdk",version:"0.0.1",language:"nodejs"}}}};var bu=Tu;Be.EventEmitter;Be.EventEmitter;const Ou=bu,Cu=Be.EventEmitter;class Au{constructor(e,n=!1){this._event=new Cu,this._config=e,n?this._namespace="SpeechLongSynthesizer":this._namespace="SpeechSynthesizer"}defaultStartParams(e){return{voice:e,format:"wav",sample_rate:16e3,volume:50,speech_rate:0,pitch_rate:0,enable_subtitle:!1}}on(e,n){this._event.on(e,n)}async start(e,n,i){this._client=new Ou(this._config),this._taskid=this._client.uuid();let a={header:{message_id:this._client.uuid(),task_id:this._taskid,namespace:this._namespace,name:"StartSynthesis",appkey:this._config.appkey},payload:e,context:this._client.defaultContext()};return new Promise(async(t,r)=>{try{await this._client.start((o,u)=>{if(u)this._event.emit("data",o);else{let f=o.toString(),l=JSON.parse(f);l.header.name==="MetaInfo"?this._event.emit("meta",f):l.header.name==="SynthesisCompleted"?(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("completed",f),t(f)):l.header.name==="TaskFailed"&&(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("TaskFailed",f),this._event.emit("failed",f),r(f))}},()=>{this._event.emit("closed")}),n&&(i||(i=6e3),this._client.setPing(i)),this._client.send(JSON.stringify(a),!1)}catch(o){r(o)}})}shutdown(){this._client!=null&&this._client.shutdown()}}var Du=Au;const Nu=Tt(Du),vt={accessKeyId:"LTAI5tFCh5eoiNZX4n2wEy7Y",accessKeySecret:"XWYRzwspo5z4Ukuo8lKxZX4pUSgQ86",appkey:"JbBUqMYRUt0DrMcK",endpoint:"https://nls-gateway.aliyuncs.com",regionId:"cn-shanghai",ttsUrl:"wss://nls-gateway-cn-shanghai.aliyuncs.com/ws/v1"};var Dt={exports:{}},ze={},Tn={exports:{}},ut={exports:{}},_r,Vi;function gs(){if(Vi)return _r;Vi=1;var s=1e3,e=s*60,n=e*60,i=n*24,a=i*7,t=i*365.25;_r=function(l,p){p=p||{};var c=typeof l;if(c==="string"&&l.length>0)return r(l);if(c==="number"&&isFinite(l))return p.long?u(l):o(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))};function r(l){if(l=String(l),!(l.length>100)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(p){var c=parseFloat(p[1]),m=(p[2]||"ms").toLowerCase();switch(m){case"years":case"year":case"yrs":case"yr":case"y":return c*t;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*e;case"seconds":case"second":case"secs":case"sec":case"s":return c*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function o(l){var p=Math.abs(l);return p>=i?Math.round(l/i)+"d":p>=n?Math.round(l/n)+"h":p>=e?Math.round(l/e)+"m":p>=s?Math.round(l/s)+"s":l+"ms"}function u(l){var p=Math.abs(l);return p>=i?f(l,p,i,"day"):p>=n?f(l,p,n,"hour"):p>=e?f(l,p,e,"minute"):p>=s?f(l,p,s,"second"):l+" ms"}function f(l,p,c,m){var v=p>=c*1.5;return Math.round(l/c)+" "+m+(v?"s":"")}return _r}var Ir,zi;function ys(){if(zi)return Ir;zi=1;function s(e){i.debug=i,i.default=i,i.coerce=f,i.disable=o,i.enable=t,i.enabled=u,i.humanize=gs(),i.destroy=l,Object.keys(e).forEach(p=>{i[p]=e[p]}),i.names=[],i.skips=[],i.formatters={};function n(p){let c=0;for(let m=0;m<p.length;m++)c=(c<<5)-c+p.charCodeAt(m),c|=0;return i.colors[Math.abs(c)%i.colors.length]}i.selectColor=n;function i(p){let c,m=null,v,T;function b(...x){if(!b.enabled)return;const y=b,g=Number(new Date),A=g-(c||g);y.diff=A,y.prev=c,y.curr=g,c=g,x[0]=i.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let N=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(D,O)=>{if(D==="%%")return"%";N++;const h=i.formatters[O];if(typeof h=="function"){const C=x[N];D=h.call(y,C),x.splice(N,1),N--}return D}),i.formatArgs.call(y,x),(y.log||i.log).apply(y,x)}return b.namespace=p,b.useColors=i.useColors(),b.color=i.selectColor(p),b.extend=a,b.destroy=i.destroy,Object.defineProperty(b,"enabled",{enumerable:!0,configurable:!1,get:()=>m!==null?m:(v!==i.namespaces&&(v=i.namespaces,T=i.enabled(p)),T),set:x=>{m=x}}),typeof i.init=="function"&&i.init(b),b}function a(p,c){const m=i(this.namespace+(typeof c>"u"?":":c)+p);return m.log=this.log,m}function t(p){i.save(p),i.namespaces=p,i.names=[],i.skips=[];const c=(typeof p=="string"?p:"").trim().replace(" ",",").split(",").filter(Boolean);for(const m of c)m[0]==="-"?i.skips.push(m.slice(1)):i.names.push(m)}function r(p,c){let m=0,v=0,T=-1,b=0;for(;m<p.length;)if(v<c.length&&(c[v]===p[m]||c[v]==="*"))c[v]==="*"?(T=v,b=m,v++):(m++,v++);else if(T!==-1)v=T+1,b++,m=b;else return!1;for(;v<c.length&&c[v]==="*";)v++;return v===c.length}function o(){const p=[...i.names,...i.skips.map(c=>"-"+c)].join(",");return i.enable(""),p}function u(p){for(const c of i.skips)if(r(p,c))return!1;for(const c of i.names)if(r(p,c))return!0;return!1}function f(p){return p instanceof Error?p.stack||p.message:p}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return i.enable(i.load()),i}return Ir=s,Ir}var Wi;function _u(){return Wi||(Wi=1,function(s,e){e.formatArgs=i,e.save=a,e.load=t,e.useColors=n,e.storage=r(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let u;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(u=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(u[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;u.splice(1,0,f,"color: inherit");let l=0,p=0;u[0].replace(/%[a-zA-Z%]/g,c=>{c!=="%%"&&(l++,c==="%c"&&(p=l))}),u.splice(p,0,f)}e.log=console.debug||console.log||(()=>{});function a(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function t(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=process.env.DEBUG),u}function r(){try{return localStorage}catch{}}s.exports=ys()(e);const{formatters:o}=s.exports;o.j=function(u){try{return JSON.stringify(u)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}(ut,ut.exports)),ut.exports}var ct={exports:{}},xr,Hi;function Iu(){return Hi||(Hi=1,xr=(s,e=process.argv)=>{const n=s.startsWith("-")?"":s.length===1?"-":"--",i=e.indexOf(n+s),a=e.indexOf("--");return i!==-1&&(a===-1||i<a)}),xr}var Fr,Gi;function vs(){if(Gi)return Fr;Gi=1;const s=$e,e=_n,n=Iu(),{env:i}=process;let a;n("no-color")||n("no-colors")||n("color=false")||n("color=never")?a=0:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(a=1),"FORCE_COLOR"in i&&(i.FORCE_COLOR==="true"?a=1:i.FORCE_COLOR==="false"?a=0:a=i.FORCE_COLOR.length===0?1:Math.min(parseInt(i.FORCE_COLOR,10),3));function t(u){return u===0?!1:{level:u,hasBasic:!0,has256:u>=2,has16m:u>=3}}function r(u,f){if(a===0)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(u&&!f&&a===void 0)return 0;const l=a||0;if(i.TERM==="dumb")return l;if(process.platform==="win32"){const p=s.release().split(".");return Number(p[0])>=10&&Number(p[2])>=10586?Number(p[2])>=14931?3:2:1}if("CI"in i)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(p=>p in i)||i.CI_NAME==="codeship"?1:l;if("TEAMCITY_VERSION"in i)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(i.TEAMCITY_VERSION)?1:0;if(i.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in i){const p=parseInt((i.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(i.TERM_PROGRAM){case"iTerm.app":return p>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(i.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(i.TERM)||"COLORTERM"in i?1:l}function o(u){const f=r(u,u&&u.isTTY);return t(f)}return Fr={supportsColor:o,stdout:t(r(!0,e.isatty(1))),stderr:t(r(!0,e.isatty(2)))},Fr}var Ki;function xu(){return Ki||(Ki=1,function(s,e){const n=_n,i=tt;e.init=l,e.log=o,e.formatArgs=t,e.save=u,e.load=f,e.useColors=a,e.destroy=i.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),e.colors=[6,2,3,4,5,1];try{const c=vs();c&&(c.stderr||c).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(c=>/^debug_/i.test(c)).reduce((c,m)=>{const v=m.substring(6).toLowerCase().replace(/_([a-z])/g,(b,x)=>x.toUpperCase());let T=process.env[m];return/^(yes|on|true|enabled)$/i.test(T)?T=!0:/^(no|off|false|disabled)$/i.test(T)?T=!1:T==="null"?T=null:T=Number(T),c[v]=T,c},{});function a(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:n.isatty(process.stderr.fd)}function t(c){const{namespace:m,useColors:v}=this;if(v){const T=this.color,b="\x1B[3"+(T<8?T:"8;5;"+T),x=`  ${b};1m${m} \x1B[0m`;c[0]=x+c[0].split(`
`).join(`
`+x),c.push(b+"m+"+s.exports.humanize(this.diff)+"\x1B[0m")}else c[0]=r()+m+" "+c[0]}function r(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function o(...c){return process.stderr.write(i.formatWithOptions(e.inspectOpts,...c)+`
`)}function u(c){c?process.env.DEBUG=c:delete process.env.DEBUG}function f(){return process.env.DEBUG}function l(c){c.inspectOpts={};const m=Object.keys(e.inspectOpts);for(let v=0;v<m.length;v++)c.inspectOpts[m[v]]=e.inspectOpts[m[v]]}s.exports=ys()(e);const{formatters:p}=s.exports;p.o=function(c){return this.inspectOpts.colors=this.useColors,i.inspect(c,this.inspectOpts).split(`
`).map(m=>m.trim()).join(" ")},p.O=function(c){return this.inspectOpts.colors=this.useColors,i.inspect(c,this.inspectOpts)}}(ct,ct.exports)),ct.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Tn.exports=_u():Tn.exports=xu();var ws=Tn.exports;const Yi=Hs,Es=wt,Ts=Et,Fu=Nn.parse,Su=Nn.format,Ie=ws("httpx:body"),ft=ws("httpx:header"),Pu=new Es.Agent({keepAlive:!0}),Lu=new Ts.Agent({keepAlive:!0}),Sr=3e3,Re=Symbol("TIMER::READ_TIMER"),bn=Symbol("TIMER::READ_TIME_OUT"),bs=Symbol("TIMER::READ_TIMER_START_AT");function Os(s){switch(s.headers["content-encoding"]){case"gzip":return s.pipe(Yi.createGunzip());case"deflate":return s.pipe(Yi.createInflate());default:return s}}var Ji=function(s,e,n){return s.name=e+s.name,s.message=`${n}. ${s.message}`,s};const Ge=function(s){return s!==null&&!isNaN(s)};ze.request=function(s,e){e||(e={});const n=typeof s=="string"?Fu(s):s;let i,a;Ge(e.readTimeout)||Ge(e.connectTimeout)?(i=Ge(e.readTimeout)?Number(e.readTimeout):Sr,a=Ge(e.connectTimeout)?Number(e.connectTimeout):Sr):Ge(e.timeout)?i=a=Number(e.timeout):i=a=Sr;const t=n.protocol==="https:",r=(e.method||"GET").toUpperCase(),o=t?Lu:Pu,u=e.agent||o;var f={host:n.hostname||"localhost",path:n.path||"/",method:r,port:n.port||(n.protocol==="https:"?443:80),agent:u,headers:e.headers||{},key:e.key||"",cert:e.cert||"",ca:e.ca||"",timeout:a};t&&typeof e.rejectUnauthorized<"u"&&(f.rejectUnauthorized=e.rejectUnauthorized),e.compression&&(f.headers["accept-encoding"]="gzip,deflate");const l=t?Ts:Es;return typeof e.beforeRequest=="function"&&(f=e.beforeRequest(f)),new Promise((p,c)=>{const m=l.request(f),v=e.data;var T=g=>{ft.enabled&&(g.req._header.split(`\r
`).forEach(N=>{ft("> %s",N)}),ft("< HTTP/%s %s %s",g.httpVersion,g.statusCode,g.statusMessage),Object.keys(g.headers).forEach(N=>{ft("< %s: %s",N,g.headers[N])})),p(g)},b=g=>{g.message+=`${r} ${Su(n)} failed.`,m.socket&&m.socket[Re]&&clearTimeout(m.socket[Re]),c(g)},x=g=>{m.abort(),b(g)};const y=function(g){const A=setTimeout(()=>{g[Re]&&(clearTimeout(g[Re]),g[Re]=null);var N=new Error,E=`ReadTimeout(${i})`;x(Ji(N,"RequestTimeout",E))},i);g[bn]=i,g[Re]=A,g[bs]=Date.now(),A.unref()};!v||typeof v=="string"||v instanceof Buffer?(Ie.enabled&&Ie(v?typeof v=="string"?v:`Buffer <ignored>, Buffer length: ${v.length}`:"<no request body>"),m.end(v)):typeof v.pipe=="function"&&(v.pipe(m),Ie.enabled&&Ie("<request body is a stream>"),v.once("error",g=>{x(Ji(g,"HttpX","Stream occor error"))})),m.on("timeout",()=>{var g=new Error;g.name="RequestTimeoutError",g.message=`ConnectTimeout: Connect ${s} failed.`,m.destroy(),c(g)}),m.on("response",T),m.on("error",b),m.once("socket",function(g){g.readyState==="opening"?g.once("connect",function(){y(g)}):y(g)})})};ze.read=function(s,e){const n=Os(s);return new Promise((i,a)=>{const t=s.socket||s.client,r=()=>{const b=s.req;var x=new Error;return x.name="RequestTimeoutError",x.message=`ReadTimeout: ${t[bn]}. ${b.method} ${b.path} failed.`,x};let o;const u=t[Re];if(!u){a(r());return}const f=t[bn]-(Date.now()-t[bs]);if(clearTimeout(u),f<=0){a(r());return}o=setTimeout(function(){a(r())},f);var l,p,c,m=function(){n.removeListener("error",l),n.removeListener("data",p),n.removeListener("end",c),o&&clearTimeout(o)};const v=[];var T=0;p=function(b){v.push(b),T+=b.length},l=function(b){m(),a(b)},c=function(){m();var b=Buffer.concat(v,T);if(Ie(""),e){const x=b.toString(e);return Ie(x),i(x)}Ie.enabled&&Ie(b.toString()),i(b)},n.on("error",l),n.on("data",p),n.on("end",c)})};function Mu(s){return new Promise((e,n)=>{var i,a,t,r=function(){s.removeListener("error",t),s.removeListener("end",a),s.removeListener("readable",i)};i=function(){r(),e(!1)},a=function(){r(),e(!0)},t=function(o){r(),n(o)},s.once("readable",i),s.once("end",a),s.once("error",t)})}class Cs{constructor(e,n,i,a){this.id=e,this.event=n,this.data=i,this.retry=a}}ze.Event=Cs;const Qi="data:",Zi="event:",eo="id:",to="retry:";function Ru(s){for(let e=0;e<s.length;e++){const n=s.charAt(e);if(n<"0"||n>"9")return!1}return s.length>0}function ju(s,e){const n=s+e;let i=0;const a=[];for(let r=0;r<n.length-1;r++){const o=n[r],u=n[r+1];if(o===`
`&&u===`
`){const l=n.substring(i,r).split(`
`),p=new Cs;l.forEach(c=>{if(c.startsWith(Qi))p.data=c.substring(Qi.length).trim();else if(c.startsWith(Zi))p.event=c.substring(Zi.length).trim();else if(c.startsWith(eo))p.id=c.substring(eo.length).trim();else if(c.startsWith(to)){const m=c.substring(to.length).trim();Ru(m)&&(p.retry=parseInt(m,10))}else c.startsWith(":")}),a.push(p),i=r+2}}const t=n.substring(i);return[a,t]}ze.readAsSSE=async function*(s){const e=Os(s),n=s.socket||s.client;clearTimeout(n[Re]);let i="";for(;;){if(await Mu(e))return;let t;for(;(t=e.read())!==null;){const[r,o]=ju(i,t.toString());if(i=o,r&&r.length>0)for(const u of r)yield u}}};var Sn={};(function(s){const e=ae,n=$e,i=De;s.loadJSONSync=function(a){var t=e.readFileSync(a,"utf8");t.charCodeAt(0)===65279&&(t=t.slice(1));try{return JSON.parse(t)}catch(r){throw r.message=a+": "+r.message,r}},s.encode=function(a,t){return typeof a!="string"&&(a=""+a),new Buffer(a,t)},s.makeHasher=function(a){return function(t,r){var o=i.createHash(a);return o.update(t),o.digest(r)}},s.createHash=s.makeHasher,s.md5=s.makeHasher("md5"),s.createHmac=function(a){return function(t,r,o){return i.createHmac(a,r).update(t).digest(o)}},s.sha1=s.createHmac("sha1"),s.random=function(a,t){return Math.floor(a+Math.random()*(t-a))},s.makeNonce=function(){var a=0,t;const r=n.hostname(),o=process.pid;return function(){var u=Math.floor(Math.random()*1e12);u===t?a++:a=0,t=u;var f=`${r}${o}${u}${a}`;return s.md5(f,"hex")}}(),s.pad2=function(a){return a<10?"0"+a:""+a},s.pad3=function(a){return a<10?"00"+a:a<100?"0"+a:""+a},s.getYYYYMMDD=function(a){var t=a.getFullYear(),r=s.pad2(a.getMonth()+1),o=s.pad2(a.getDate());return""+t+r+o},s.sleep=function(a){return new Promise(t=>{setTimeout(t,a)})},s.getIPv4=function(){for(var a=n.networkInterfaces(),t=Object.keys(a),r=0;r<t.length;r++)for(var o=t[r],u=a[o],f=0;f<u.length;f++){var l=u[f];if(!l.internal&&l.family==="IPv4")return l.address}return""},s.getMac=function(){for(var a=n.networkInterfaces(),t=Object.keys(a),r=0;r<t.length;r++)for(var o=t[r],u=a[o],f=0;f<u.length;f++){var l=u[f];if(!l.internal&&l.family==="IPv4")return l.mac}return"00:00:00:00:00:00"}})(Sn);var Nt={exports:{}},As={exports:{}},Ds={exports:{}};(function(s){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,t=Math.floor,r="[BigNumber Error] ",o=r+"Number primitive has more than 15 significant digits: ",u=1e14,f=14,l=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],c=1e7,m=1e9;function v(E){var D,O,h,C=z.prototype={constructor:z,toString:null,valueOf:null},F=new z(1),M=20,U=4,W=-7,H=21,J=-1e7,Y=1e7,be=!1,Oe=1,he=0,le={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Ee="0123456789abcdefghijklmnopqrstuvwxyz",Le=!0;function z(d,I){var S,q,L,R,B,P,j,k,$=this;if(!($ instanceof z))return new z(d,I);if(I==null){if(d&&d._isBigNumber===!0){$.s=d.s,!d.c||d.e>Y?$.c=$.e=null:d.e<J?$.c=[$.e=0]:($.e=d.e,$.c=d.c.slice());return}if((P=typeof d=="number")&&d*0==0){if($.s=1/d<0?(d=-d,-1):1,d===~~d){for(R=0,B=d;B>=10;B/=10,R++);R>Y?$.c=$.e=null:($.e=R,$.c=[d]);return}k=String(d)}else{if(!i.test(k=String(d)))return h($,k,P);$.s=k.charCodeAt(0)==45?(k=k.slice(1),-1):1}(R=k.indexOf("."))>-1&&(k=k.replace(".","")),(B=k.search(/e/i))>0?(R<0&&(R=B),R+=+k.slice(B+1),k=k.substring(0,B)):R<0&&(R=k.length)}else{if(y(I,2,Ee.length,"Base"),I==10&&Le)return $=new z(d),w($,M+$.e+1,U);if(k=String(d),P=typeof d=="number"){if(d*0!=0)return h($,k,P,I);if($.s=1/d<0?(k=k.slice(1),-1):1,z.DEBUG&&k.replace(/^0\.0*|\./,"").length>15)throw Error(o+d)}else $.s=k.charCodeAt(0)===45?(k=k.slice(1),-1):1;for(S=Ee.slice(0,I),R=B=0,j=k.length;B<j;B++)if(S.indexOf(q=k.charAt(B))<0){if(q=="."){if(B>R){R=j;continue}}else if(!L&&(k==k.toUpperCase()&&(k=k.toLowerCase())||k==k.toLowerCase()&&(k=k.toUpperCase()))){L=!0,B=-1,R=0;continue}return h($,String(d),P,I)}P=!1,k=O(k,I,10,$.s),(R=k.indexOf("."))>-1?k=k.replace(".",""):R=k.length}for(B=0;k.charCodeAt(B)===48;B++);for(j=k.length;k.charCodeAt(--j)===48;);if(k=k.slice(B,++j)){if(j-=B,P&&z.DEBUG&&j>15&&(d>l||d!==t(d)))throw Error(o+$.s*d);if((R=R-B-1)>Y)$.c=$.e=null;else if(R<J)$.c=[$.e=0];else{if($.e=R,$.c=[],B=(R+1)%f,R<0&&(B+=f),B<j){for(B&&$.c.push(+k.slice(0,B)),j-=f;B<j;)$.c.push(+k.slice(B,B+=f));B=f-(k=k.slice(B)).length}else B-=j;for(;B--;k+="0");$.c.push(+k)}}else $.c=[$.e=0]}z.clone=v,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(d){var I,S;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(I="DECIMAL_PLACES")&&(S=d[I],y(S,0,m,I),M=S),d.hasOwnProperty(I="ROUNDING_MODE")&&(S=d[I],y(S,0,8,I),U=S),d.hasOwnProperty(I="EXPONENTIAL_AT")&&(S=d[I],S&&S.pop?(y(S[0],-m,0,I),y(S[1],0,m,I),W=S[0],H=S[1]):(y(S,-m,m,I),W=-(H=S<0?-S:S))),d.hasOwnProperty(I="RANGE"))if(S=d[I],S&&S.pop)y(S[0],-m,-1,I),y(S[1],1,m,I),J=S[0],Y=S[1];else if(y(S,-m,m,I),S)J=-(Y=S<0?-S:S);else throw Error(r+I+" cannot be zero: "+S);if(d.hasOwnProperty(I="CRYPTO"))if(S=d[I],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))be=S;else throw be=!S,Error(r+"crypto unavailable");else be=S;else throw Error(r+I+" not true or false: "+S);if(d.hasOwnProperty(I="MODULO_MODE")&&(S=d[I],y(S,0,9,I),Oe=S),d.hasOwnProperty(I="POW_PRECISION")&&(S=d[I],y(S,0,m,I),he=S),d.hasOwnProperty(I="FORMAT"))if(S=d[I],typeof S=="object")le=S;else throw Error(r+I+" not an object: "+S);if(d.hasOwnProperty(I="ALPHABET"))if(S=d[I],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))Le=S.slice(0,10)=="0123456789",Ee=S;else throw Error(r+I+" invalid: "+S)}else throw Error(r+"Object expected: "+d);return{DECIMAL_PLACES:M,ROUNDING_MODE:U,EXPONENTIAL_AT:[W,H],RANGE:[J,Y],CRYPTO:be,MODULO_MODE:Oe,POW_PRECISION:he,FORMAT:le,ALPHABET:Ee}},z.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!z.DEBUG)return!0;var I,S,q=d.c,L=d.e,R=d.s;e:if({}.toString.call(q)=="[object Array]"){if((R===1||R===-1)&&L>=-m&&L<=m&&L===t(L)){if(q[0]===0){if(L===0&&q.length===1)return!0;break e}if(I=(L+1)%f,I<1&&(I+=f),String(q[0]).length==I){for(I=0;I<q.length;I++)if(S=q[I],S<0||S>=u||S!==t(S))break e;if(S!==0)return!0}}}else if(q===null&&L===null&&(R===null||R===1||R===-1))return!0;throw Error(r+"Invalid BigNumber: "+d)},z.maximum=z.max=function(){return nt(arguments,-1)},z.minimum=z.min=function(){return nt(arguments,1)},z.random=function(){var d=9007199254740992,I=Math.random()*d&2097151?function(){return t(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var q,L,R,B,P,j=0,k=[],$=new z(F);if(S==null?S=M:y(S,0,m),B=a(S/f),be)if(crypto.getRandomValues){for(q=crypto.getRandomValues(new Uint32Array(B*=2));j<B;)P=q[j]*131072+(q[j+1]>>>11),P>=9e15?(L=crypto.getRandomValues(new Uint32Array(2)),q[j]=L[0],q[j+1]=L[1]):(k.push(P%1e14),j+=2);j=B/2}else if(crypto.randomBytes){for(q=crypto.randomBytes(B*=7);j<B;)P=(q[j]&31)*281474976710656+q[j+1]*1099511627776+q[j+2]*4294967296+q[j+3]*16777216+(q[j+4]<<16)+(q[j+5]<<8)+q[j+6],P>=9e15?crypto.randomBytes(7).copy(q,j):(k.push(P%1e14),j+=7);j=B/7}else throw be=!1,Error(r+"crypto unavailable");if(!be)for(;j<B;)P=I(),P<9e15&&(k[j++]=P%1e14);for(B=k[--j],S%=f,B&&S&&(P=p[f-S],k[j]=t(B/P)*P);k[j]===0;k.pop(),j--);if(j<0)k=[R=0];else{for(R=-1;k[0]===0;k.splice(0,1),R-=f);for(j=1,P=k[0];P>=10;P/=10,j++);j<f&&(R-=f-j)}return $.e=R,$.c=k,$}}(),z.sum=function(){for(var d=1,I=arguments,S=new z(I[0]);d<I.length;)S=S.plus(I[d++]);return S},O=function(){var d="0123456789";function I(S,q,L,R){for(var B,P=[0],j,k=0,$=S.length;k<$;){for(j=P.length;j--;P[j]*=q);for(P[0]+=R.indexOf(S.charAt(k++)),B=0;B<P.length;B++)P[B]>L-1&&(P[B+1]==null&&(P[B+1]=0),P[B+1]+=P[B]/L|0,P[B]%=L)}return P.reverse()}return function(S,q,L,R,B){var P,j,k,$,V,G,K,ie,ue=S.indexOf("."),pe=M,ne=U;for(ue>=0&&($=he,he=0,S=S.replace(".",""),ie=new z(q),G=ie.pow(S.length-ue),he=$,ie.c=I(N(b(G.c),G.e,"0"),10,L,d),ie.e=ie.c.length),K=I(S,q,L,B?(P=Ee,d):(P=d,Ee)),k=$=K.length;K[--$]==0;K.pop());if(!K[0])return P.charAt(0);if(ue<0?--k:(G.c=K,G.e=k,G.s=R,G=D(G,ie,pe,ne,L),K=G.c,V=G.r,k=G.e),j=k+pe+1,ue=K[j],$=L/2,V=V||j<0||K[j+1]!=null,V=ne<4?(ue!=null||V)&&(ne==0||ne==(G.s<0?3:2)):ue>$||ue==$&&(ne==4||V||ne==6&&K[j-1]&1||ne==(G.s<0?8:7)),j<1||!K[0])S=V?N(P.charAt(1),-pe,P.charAt(0)):P.charAt(0);else{if(K.length=j,V)for(--L;++K[--j]>L;)K[j]=0,j||(++k,K=[1].concat(K));for($=K.length;!K[--$];);for(ue=0,S="";ue<=$;S+=P.charAt(K[ue++]));S=N(S,k,P.charAt(0))}return S}}(),D=function(){function d(q,L,R){var B,P,j,k,$=0,V=q.length,G=L%c,K=L/c|0;for(q=q.slice();V--;)j=q[V]%c,k=q[V]/c|0,B=K*j+k*G,P=G*j+B%c*c+$,$=(P/R|0)+(B/c|0)+K*k,q[V]=P%R;return $&&(q=[$].concat(q)),q}function I(q,L,R,B){var P,j;if(R!=B)j=R>B?1:-1;else for(P=j=0;P<R;P++)if(q[P]!=L[P]){j=q[P]>L[P]?1:-1;break}return j}function S(q,L,R,B){for(var P=0;R--;)q[R]-=P,P=q[R]<L[R]?1:0,q[R]=P*B+q[R]-L[R];for(;!q[0]&&q.length>1;q.splice(0,1));}return function(q,L,R,B,P){var j,k,$,V,G,K,ie,ue,pe,ne,se,me,it,St,Pt,Ne,We,Ce=q.s==L.s?1:-1,Te=q.c,ce=L.c;if(!Te||!Te[0]||!ce||!ce[0])return new z(!q.s||!L.s||(Te?ce&&Te[0]==ce[0]:!ce)?NaN:Te&&Te[0]==0||!ce?Ce*0:Ce/0);for(ue=new z(Ce),pe=ue.c=[],k=q.e-L.e,Ce=R+k+1,P||(P=u,k=T(q.e/f)-T(L.e/f),Ce=Ce/f|0),$=0;ce[$]==(Te[$]||0);$++);if(ce[$]>(Te[$]||0)&&k--,Ce<0)pe.push(1),V=!0;else{for(St=Te.length,Ne=ce.length,$=0,Ce+=2,G=t(P/(ce[0]+1)),G>1&&(ce=d(ce,G,P),Te=d(Te,G,P),Ne=ce.length,St=Te.length),it=Ne,ne=Te.slice(0,Ne),se=ne.length;se<Ne;ne[se++]=0);We=ce.slice(),We=[0].concat(We),Pt=ce[0],ce[1]>=P/2&&Pt++;do{if(G=0,j=I(ce,ne,Ne,se),j<0){if(me=ne[0],Ne!=se&&(me=me*P+(ne[1]||0)),G=t(me/Pt),G>1)for(G>=P&&(G=P-1),K=d(ce,G,P),ie=K.length,se=ne.length;I(K,ne,ie,se)==1;)G--,S(K,Ne<ie?We:ce,ie,P),ie=K.length,j=1;else G==0&&(j=G=1),K=ce.slice(),ie=K.length;if(ie<se&&(K=[0].concat(K)),S(ne,K,se,P),se=ne.length,j==-1)for(;I(ce,ne,Ne,se)<1;)G++,S(ne,Ne<se?We:ce,se,P),se=ne.length}else j===0&&(G++,ne=[0]);pe[$++]=G,ne[0]?ne[se++]=Te[it]||0:(ne=[Te[it]],se=1)}while((it++<St||ne[0]!=null)&&Ce--);V=ne[0]!=null,pe[0]||pe.splice(0,1)}if(P==u){for($=1,Ce=pe[0];Ce>=10;Ce/=10,$++);w(ue,R+(ue.e=$+k*f-1)+1,B,V)}else ue.e=k,ue.r=+V;return ue}}();function Xe(d,I,S,q){var L,R,B,P,j;if(S==null?S=U:y(S,0,8),!d.c)return d.toString();if(L=d.c[0],B=d.e,I==null)j=b(d.c),j=q==1||q==2&&(B<=W||B>=H)?A(j,B):N(j,B,"0");else if(d=w(new z(d),I,S),R=d.e,j=b(d.c),P=j.length,q==1||q==2&&(I<=R||R<=W)){for(;P<I;j+="0",P++);j=A(j,R)}else if(I-=B,j=N(j,R,"0"),R+1>P){if(--I>0)for(j+=".";I--;j+="0");}else if(I+=R-P,I>0)for(R+1==P&&(j+=".");I--;j+="0");return d.s<0&&L?"-"+j:j}function nt(d,I){for(var S,q,L=1,R=new z(d[0]);L<d.length;L++)q=new z(d[L]),(!q.s||(S=x(R,q))===I||S===0&&R.s===I)&&(R=q);return R}function _(d,I,S){for(var q=1,L=I.length;!I[--L];I.pop());for(L=I[0];L>=10;L/=10,q++);return(S=q+S*f-1)>Y?d.c=d.e=null:S<J?d.c=[d.e=0]:(d.e=S,d.c=I),d}h=function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,I=/^([^.]+)\.$/,S=/^\.([^.]+)$/,q=/^-?(Infinity|NaN)$/,L=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,B,P,j){var k,$=P?B:B.replace(L,"");if(q.test($))R.s=isNaN($)?null:$<0?-1:1;else{if(!P&&($=$.replace(d,function(V,G,K){return k=(K=K.toLowerCase())=="x"?16:K=="b"?2:8,!j||j==k?G:V}),j&&(k=j,$=$.replace(I,"$1").replace(S,"0.$1")),B!=$))return new z($,k);if(z.DEBUG)throw Error(r+"Not a"+(j?" base "+j:"")+" number: "+B);R.s=null}R.c=R.e=null}}();function w(d,I,S,q){var L,R,B,P,j,k,$,V=d.c,G=p;if(V){e:{for(L=1,P=V[0];P>=10;P/=10,L++);if(R=I-L,R<0)R+=f,B=I,j=V[k=0],$=t(j/G[L-B-1]%10);else if(k=a((R+1)/f),k>=V.length)if(q){for(;V.length<=k;V.push(0));j=$=0,L=1,R%=f,B=R-f+1}else break e;else{for(j=P=V[k],L=1;P>=10;P/=10,L++);R%=f,B=R-f+L,$=B<0?0:t(j/G[L-B-1]%10)}if(q=q||I<0||V[k+1]!=null||(B<0?j:j%G[L-B-1]),q=S<4?($||q)&&(S==0||S==(d.s<0?3:2)):$>5||$==5&&(S==4||q||S==6&&(R>0?B>0?j/G[L-B]:0:V[k-1])%10&1||S==(d.s<0?8:7)),I<1||!V[0])return V.length=0,q?(I-=d.e+1,V[0]=G[(f-I%f)%f],d.e=-I||0):V[0]=d.e=0,d;if(R==0?(V.length=k,P=1,k--):(V.length=k+1,P=G[f-R],V[k]=B>0?t(j/G[L-B]%G[B])*P:0),q)for(;;)if(k==0){for(R=1,B=V[0];B>=10;B/=10,R++);for(B=V[0]+=P,P=1;B>=10;B/=10,P++);R!=P&&(d.e++,V[0]==u&&(V[0]=1));break}else{if(V[k]+=P,V[k]!=u)break;V[k--]=0,P=1}for(R=V.length;V[--R]===0;V.pop());}d.e>Y?d.c=d.e=null:d.e<J&&(d.c=[d.e=0])}return d}function X(d){var I,S=d.e;return S===null?d.toString():(I=b(d.c),I=S<=W||S>=H?A(I,S):N(I,S,"0"),d.s<0?"-"+I:I)}return C.absoluteValue=C.abs=function(){var d=new z(this);return d.s<0&&(d.s=1),d},C.comparedTo=function(d,I){return x(this,new z(d,I))},C.decimalPlaces=C.dp=function(d,I){var S,q,L,R=this;if(d!=null)return y(d,0,m),I==null?I=U:y(I,0,8),w(new z(R),d+R.e+1,I);if(!(S=R.c))return null;if(q=((L=S.length-1)-T(this.e/f))*f,L=S[L])for(;L%10==0;L/=10,q--);return q<0&&(q=0),q},C.dividedBy=C.div=function(d,I){return D(this,new z(d,I),M,U)},C.dividedToIntegerBy=C.idiv=function(d,I){return D(this,new z(d,I),0,1)},C.exponentiatedBy=C.pow=function(d,I){var S,q,L,R,B,P,j,k,$,V=this;if(d=new z(d),d.c&&!d.isInteger())throw Error(r+"Exponent not an integer: "+X(d));if(I!=null&&(I=new z(I)),P=d.e>14,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!d.c||!d.c[0])return $=new z(Math.pow(+X(V),P?d.s*(2-g(d)):+X(d))),I?$.mod(I):$;if(j=d.s<0,I){if(I.c?!I.c[0]:!I.s)return new z(NaN);q=!j&&V.isInteger()&&I.isInteger(),q&&(V=V.mod(I))}else{if(d.e>9&&(V.e>0||V.e<-1||(V.e==0?V.c[0]>1||P&&V.c[1]>=24e7:V.c[0]<8e13||P&&V.c[0]<=9999975e7)))return R=V.s<0&&g(d)?-0:0,V.e>-1&&(R=1/R),new z(j?1/R:R);he&&(R=a(he/f+2))}for(P?(S=new z(.5),j&&(d.s=1),k=g(d)):(L=Math.abs(+X(d)),k=L%2),$=new z(F);;){if(k){if($=$.times(V),!$.c)break;R?$.c.length>R&&($.c.length=R):q&&($=$.mod(I))}if(L){if(L=t(L/2),L===0)break;k=L%2}else if(d=d.times(S),w(d,d.e+1,1),d.e>14)k=g(d);else{if(L=+X(d),L===0)break;k=L%2}V=V.times(V),R?V.c&&V.c.length>R&&(V.c.length=R):q&&(V=V.mod(I))}return q?$:(j&&($=F.div($)),I?$.mod(I):R?w($,he,U,B):$)},C.integerValue=function(d){var I=new z(this);return d==null?d=U:y(d,0,8),w(I,I.e+1,d)},C.isEqualTo=C.eq=function(d,I){return x(this,new z(d,I))===0},C.isFinite=function(){return!!this.c},C.isGreaterThan=C.gt=function(d,I){return x(this,new z(d,I))>0},C.isGreaterThanOrEqualTo=C.gte=function(d,I){return(I=x(this,new z(d,I)))===1||I===0},C.isInteger=function(){return!!this.c&&T(this.e/f)>this.c.length-2},C.isLessThan=C.lt=function(d,I){return x(this,new z(d,I))<0},C.isLessThanOrEqualTo=C.lte=function(d,I){return(I=x(this,new z(d,I)))===-1||I===0},C.isNaN=function(){return!this.s},C.isNegative=function(){return this.s<0},C.isPositive=function(){return this.s>0},C.isZero=function(){return!!this.c&&this.c[0]==0},C.minus=function(d,I){var S,q,L,R,B=this,P=B.s;if(d=new z(d,I),I=d.s,!P||!I)return new z(NaN);if(P!=I)return d.s=-I,B.plus(d);var j=B.e/f,k=d.e/f,$=B.c,V=d.c;if(!j||!k){if(!$||!V)return $?(d.s=-I,d):new z(V?B:NaN);if(!$[0]||!V[0])return V[0]?(d.s=-I,d):new z($[0]?B:U==3?-0:0)}if(j=T(j),k=T(k),$=$.slice(),P=j-k){for((R=P<0)?(P=-P,L=$):(k=j,L=V),L.reverse(),I=P;I--;L.push(0));L.reverse()}else for(q=(R=(P=$.length)<(I=V.length))?P:I,P=I=0;I<q;I++)if($[I]!=V[I]){R=$[I]<V[I];break}if(R&&(L=$,$=V,V=L,d.s=-d.s),I=(q=V.length)-(S=$.length),I>0)for(;I--;$[S++]=0);for(I=u-1;q>P;){if($[--q]<V[q]){for(S=q;S&&!$[--S];$[S]=I);--$[S],$[q]+=u}$[q]-=V[q]}for(;$[0]==0;$.splice(0,1),--k);return $[0]?_(d,$,k):(d.s=U==3?-1:1,d.c=[d.e=0],d)},C.modulo=C.mod=function(d,I){var S,q,L=this;return d=new z(d,I),!L.c||!d.s||d.c&&!d.c[0]?new z(NaN):!d.c||L.c&&!L.c[0]?new z(L):(Oe==9?(q=d.s,d.s=1,S=D(L,d,0,3),d.s=q,S.s*=q):S=D(L,d,0,Oe),d=L.minus(S.times(d)),!d.c[0]&&Oe==1&&(d.s=L.s),d)},C.multipliedBy=C.times=function(d,I){var S,q,L,R,B,P,j,k,$,V,G,K,ie,ue,pe,ne=this,se=ne.c,me=(d=new z(d,I)).c;if(!se||!me||!se[0]||!me[0])return!ne.s||!d.s||se&&!se[0]&&!me||me&&!me[0]&&!se?d.c=d.e=d.s=null:(d.s*=ne.s,!se||!me?d.c=d.e=null:(d.c=[0],d.e=0)),d;for(q=T(ne.e/f)+T(d.e/f),d.s*=ne.s,j=se.length,V=me.length,j<V&&(ie=se,se=me,me=ie,L=j,j=V,V=L),L=j+V,ie=[];L--;ie.push(0));for(ue=u,pe=c,L=V;--L>=0;){for(S=0,G=me[L]%pe,K=me[L]/pe|0,B=j,R=L+B;R>L;)k=se[--B]%pe,$=se[B]/pe|0,P=K*k+$*G,k=G*k+P%pe*pe+ie[R]+S,S=(k/ue|0)+(P/pe|0)+K*$,ie[R--]=k%ue;ie[R]=S}return S?++q:ie.splice(0,1),_(d,ie,q)},C.negated=function(){var d=new z(this);return d.s=-d.s||null,d},C.plus=function(d,I){var S,q=this,L=q.s;if(d=new z(d,I),I=d.s,!L||!I)return new z(NaN);if(L!=I)return d.s=-I,q.minus(d);var R=q.e/f,B=d.e/f,P=q.c,j=d.c;if(!R||!B){if(!P||!j)return new z(L/0);if(!P[0]||!j[0])return j[0]?d:new z(P[0]?q:L*0)}if(R=T(R),B=T(B),P=P.slice(),L=R-B){for(L>0?(B=R,S=j):(L=-L,S=P),S.reverse();L--;S.push(0));S.reverse()}for(L=P.length,I=j.length,L-I<0&&(S=j,j=P,P=S,I=L),L=0;I;)L=(P[--I]=P[I]+j[I]+L)/u|0,P[I]=u===P[I]?0:P[I]%u;return L&&(P=[L].concat(P),++B),_(d,P,B)},C.precision=C.sd=function(d,I){var S,q,L,R=this;if(d!=null&&d!==!!d)return y(d,1,m),I==null?I=U:y(I,0,8),w(new z(R),d,I);if(!(S=R.c))return null;if(L=S.length-1,q=L*f+1,L=S[L]){for(;L%10==0;L/=10,q--);for(L=S[0];L>=10;L/=10,q++);}return d&&R.e+1>q&&(q=R.e+1),q},C.shiftedBy=function(d){return y(d,-l,l),this.times("1e"+d)},C.squareRoot=C.sqrt=function(){var d,I,S,q,L,R=this,B=R.c,P=R.s,j=R.e,k=M+4,$=new z("0.5");if(P!==1||!B||!B[0])return new z(!P||P<0&&(!B||B[0])?NaN:B?R:1/0);if(P=Math.sqrt(+X(R)),P==0||P==1/0?(I=b(B),(I.length+j)%2==0&&(I+="0"),P=Math.sqrt(+I),j=T((j+1)/2)-(j<0||j%2),P==1/0?I="5e"+j:(I=P.toExponential(),I=I.slice(0,I.indexOf("e")+1)+j),S=new z(I)):S=new z(P+""),S.c[0]){for(j=S.e,P=j+k,P<3&&(P=0);;)if(L=S,S=$.times(L.plus(D(R,L,k,1))),b(L.c).slice(0,P)===(I=b(S.c)).slice(0,P))if(S.e<j&&--P,I=I.slice(P-3,P+1),I=="9999"||!q&&I=="4999"){if(!q&&(w(L,L.e+M+2,0),L.times(L).eq(R))){S=L;break}k+=4,P+=4,q=1}else{(!+I||!+I.slice(1)&&I.charAt(0)=="5")&&(w(S,S.e+M+2,1),d=!S.times(S).eq(R));break}}return w(S,S.e+M+1,U,d)},C.toExponential=function(d,I){return d!=null&&(y(d,0,m),d++),Xe(this,d,I,1)},C.toFixed=function(d,I){return d!=null&&(y(d,0,m),d=d+this.e+1),Xe(this,d,I)},C.toFormat=function(d,I,S){var q,L=this;if(S==null)d!=null&&I&&typeof I=="object"?(S=I,I=null):d&&typeof d=="object"?(S=d,d=I=null):S=le;else if(typeof S!="object")throw Error(r+"Argument not an object: "+S);if(q=L.toFixed(d,I),L.c){var R,B=q.split("."),P=+S.groupSize,j=+S.secondaryGroupSize,k=S.groupSeparator||"",$=B[0],V=B[1],G=L.s<0,K=G?$.slice(1):$,ie=K.length;if(j&&(R=P,P=j,j=R,ie-=R),P>0&&ie>0){for(R=ie%P||P,$=K.substr(0,R);R<ie;R+=P)$+=k+K.substr(R,P);j>0&&($+=k+K.slice(R)),G&&($="-"+$)}q=V?$+(S.decimalSeparator||"")+((j=+S.fractionGroupSize)?V.replace(new RegExp("\\d{"+j+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):V):$}return(S.prefix||"")+q+(S.suffix||"")},C.toFraction=function(d){var I,S,q,L,R,B,P,j,k,$,V,G,K=this,ie=K.c;if(d!=null&&(P=new z(d),!P.isInteger()&&(P.c||P.s!==1)||P.lt(F)))throw Error(r+"Argument "+(P.isInteger()?"out of range: ":"not an integer: ")+X(P));if(!ie)return new z(K);for(I=new z(F),k=S=new z(F),q=j=new z(F),G=b(ie),R=I.e=G.length-K.e-1,I.c[0]=p[(B=R%f)<0?f+B:B],d=!d||P.comparedTo(I)>0?R>0?I:k:P,B=Y,Y=1/0,P=new z(G),j.c[0]=0;$=D(P,I,0,1),L=S.plus($.times(q)),L.comparedTo(d)!=1;)S=q,q=L,k=j.plus($.times(L=k)),j=L,I=P.minus($.times(L=I)),P=L;return L=D(d.minus(S),q,0,1),j=j.plus(L.times(k)),S=S.plus(L.times(q)),j.s=k.s=K.s,R=R*2,V=D(k,q,R,U).minus(K).abs().comparedTo(D(j,S,R,U).minus(K).abs())<1?[k,q]:[j,S],Y=B,V},C.toNumber=function(){return+X(this)},C.toPrecision=function(d,I){return d!=null&&y(d,1,m),Xe(this,d,I,2)},C.toString=function(d){var I,S=this,q=S.s,L=S.e;return L===null?q?(I="Infinity",q<0&&(I="-"+I)):I="NaN":(d==null?I=L<=W||L>=H?A(b(S.c),L):N(b(S.c),L,"0"):d===10&&Le?(S=w(new z(S),M+L+1,U),I=N(b(S.c),S.e,"0")):(y(d,2,Ee.length,"Base"),I=O(N(b(S.c),L,"0"),10,d,q,!0)),q<0&&S.c[0]&&(I="-"+I)),I},C.valueOf=C.toJSON=function(){return X(this)},C._isBigNumber=!0,E!=null&&z.set(E),z}function T(E){var D=E|0;return E>0||E===D?D:D-1}function b(E){for(var D,O,h=1,C=E.length,F=E[0]+"";h<C;){for(D=E[h++]+"",O=f-D.length;O--;D="0"+D);F+=D}for(C=F.length;F.charCodeAt(--C)===48;);return F.slice(0,C+1||1)}function x(E,D){var O,h,C=E.c,F=D.c,M=E.s,U=D.s,W=E.e,H=D.e;if(!M||!U)return null;if(O=C&&!C[0],h=F&&!F[0],O||h)return O?h?0:-U:M;if(M!=U)return M;if(O=M<0,h=W==H,!C||!F)return h?0:!C^O?1:-1;if(!h)return W>H^O?1:-1;for(U=(W=C.length)<(H=F.length)?W:H,M=0;M<U;M++)if(C[M]!=F[M])return C[M]>F[M]^O?1:-1;return W==H?0:W>H^O?1:-1}function y(E,D,O,h){if(E<D||E>O||E!==t(E))throw Error(r+(h||"Argument")+(typeof E=="number"?E<D||E>O?" out of range: ":" not an integer: ":" not a primitive number: ")+String(E))}function g(E){var D=E.c.length-1;return T(E.e/f)==D&&E.c[D]%2!=0}function A(E,D){return(E.length>1?E.charAt(0)+"."+E.slice(1):E)+(D<0?"e":"e+")+D}function N(E,D,O){var h,C;if(D<0){for(C=O+".";++D;C+=O);E=C+E}else if(h=E.length,++D>h){for(C=O,D-=h;--D;C+=O);E+=C}else D<h&&(E=E.slice(0,D)+"."+E.slice(D));return E}n=v(),n.default=n.BigNumber=n,s.exports?s.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(ee)})(Ds);var Ns=Ds.exports;(function(s){var e=Ns,n=s.exports;(function(){var i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,t,r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o;function u(l){return i.lastIndex=0,i.test(l)?'"'+l.replace(i,function(p){var c=r[p];return typeof c=="string"?c:"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+l+'"'}function f(l,p){var c,m,v,T,b=a,x,y=p[l],g=y!=null&&(y instanceof e||e.isBigNumber(y));switch(y&&typeof y=="object"&&typeof y.toJSON=="function"&&(y=y.toJSON(l)),typeof o=="function"&&(y=o.call(p,l,y)),typeof y){case"string":return g?y:u(y);case"number":return isFinite(y)?String(y):"null";case"boolean":case"null":case"bigint":return String(y);case"object":if(!y)return"null";if(a+=t,x=[],Object.prototype.toString.apply(y)==="[object Array]"){for(T=y.length,c=0;c<T;c+=1)x[c]=f(c,y)||"null";return v=x.length===0?"[]":a?`[
`+a+x.join(`,
`+a)+`
`+b+"]":"["+x.join(",")+"]",a=b,v}if(o&&typeof o=="object")for(T=o.length,c=0;c<T;c+=1)typeof o[c]=="string"&&(m=o[c],v=f(m,y),v&&x.push(u(m)+(a?": ":":")+v));else Object.keys(y).forEach(function(A){var N=f(A,y);N&&x.push(u(A)+(a?": ":":")+N)});return v=x.length===0?"{}":a?`{
`+a+x.join(`,
`+a)+`
`+b+"}":"{"+x.join(",")+"}",a=b,v}}typeof n.stringify!="function"&&(n.stringify=function(l,p,c){var m;if(a="",t="",typeof c=="number")for(m=0;m<c;m+=1)t+=" ";else typeof c=="string"&&(t=c);if(o=p,p&&typeof p!="function"&&(typeof p!="object"||typeof p.length!="number"))throw new Error("JSON.stringify");return f("",{"":l})})})()})(As);var qu=As.exports,lt=null;const $u=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,ku=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;var Bu=function(s){var e={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(s!=null){if(s.strict===!0&&(e.strict=!0),s.storeAsString===!0&&(e.storeAsString=!0),e.alwaysParseAsBig=s.alwaysParseAsBig===!0?s.alwaysParseAsBig:!1,e.useNativeBigInt=s.useNativeBigInt===!0?s.useNativeBigInt:!1,typeof s.constructorAction<"u")if(s.constructorAction==="error"||s.constructorAction==="ignore"||s.constructorAction==="preserve")e.constructorAction=s.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${s.constructorAction}`);if(typeof s.protoAction<"u")if(s.protoAction==="error"||s.protoAction==="ignore"||s.protoAction==="preserve")e.protoAction=s.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${s.protoAction}`)}var n,i,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},t,r=function(T){throw{name:"SyntaxError",message:T,at:n,text:t}},o=function(T){return T&&T!==i&&r("Expected '"+T+"' instead of '"+i+"'"),i=t.charAt(n),n+=1,i},u=function(){var T,b="";for(i==="-"&&(b="-",o("-"));i>="0"&&i<="9";)b+=i,o();if(i===".")for(b+=".";o()&&i>="0"&&i<="9";)b+=i;if(i==="e"||i==="E")for(b+=i,o(),(i==="-"||i==="+")&&(b+=i,o());i>="0"&&i<="9";)b+=i,o();if(T=+b,!isFinite(T))r("Bad number");else return lt==null&&(lt=Ns),b.length>15?e.storeAsString?b:e.useNativeBigInt?BigInt(b):new lt(b):e.alwaysParseAsBig?e.useNativeBigInt?BigInt(T):new lt(T):T},f=function(){var T,b,x="",y;if(i==='"')for(var g=n;o();){if(i==='"')return n-1>g&&(x+=t.substring(g,n-1)),o(),x;if(i==="\\"){if(n-1>g&&(x+=t.substring(g,n-1)),o(),i==="u"){for(y=0,b=0;b<4&&(T=parseInt(o(),16),!!isFinite(T));b+=1)y=y*16+T;x+=String.fromCharCode(y)}else if(typeof a[i]=="string")x+=a[i];else break;g=n}}r("Bad string")},l=function(){for(;i&&i<=" ";)o()},p=function(){switch(i){case"t":return o("t"),o("r"),o("u"),o("e"),!0;case"f":return o("f"),o("a"),o("l"),o("s"),o("e"),!1;case"n":return o("n"),o("u"),o("l"),o("l"),null}r("Unexpected '"+i+"'")},c,m=function(){var T=[];if(i==="["){if(o("["),l(),i==="]")return o("]"),T;for(;i;){if(T.push(c()),l(),i==="]")return o("]"),T;o(","),l()}}r("Bad array")},v=function(){var T,b=Object.create(null);if(i==="{"){if(o("{"),l(),i==="}")return o("}"),b;for(;i;){if(T=f(),l(),o(":"),e.strict===!0&&Object.hasOwnProperty.call(b,T)&&r('Duplicate key "'+T+'"'),$u.test(T)===!0?e.protoAction==="error"?r("Object contains forbidden prototype property"):e.protoAction==="ignore"?c():b[T]=c():ku.test(T)===!0?e.constructorAction==="error"?r("Object contains forbidden constructor property"):e.constructorAction==="ignore"?c():b[T]=c():b[T]=c(),l(),i==="}")return o("}"),b;o(","),l()}}r("Bad object")};return c=function(){switch(l(),i){case"{":return v();case"[":return m();case'"':return f();case"-":return u();default:return i>="0"&&i<="9"?u():p()}},function(T,b){var x;return t=T+"",n=0,i=" ",x=c(),l(),i&&r("Syntax error"),typeof b=="function"?function y(g,A){var N,E=g[A];return E&&typeof E=="object"&&Object.keys(E).forEach(function(D){N=y(E,D),N!==void 0?E[D]=N:delete E[D]}),b.call(g,A,E)}({"":x},""):x}},Uu=Bu,_s=qu.stringify,Is=Uu;Nt.exports=function(s){return{parse:Is(s),stringify:_s}};Nt.exports.parse=Is();Nt.exports.stringify=_s;var xs=Nt.exports,_t={};const Xu="@alicloud/pop-core",Vu="1.8.0",zu="AliCloud POP SDK core",Wu="index.js",Hu="lib/rpc.d.ts",Gu={lint:"eslint --fix lib test",test:"mocha -R spec test/*.test.js","test-cov":"nyc -r=html -r=text -r=lcov mocha -t 3000 -R spec test/*.test.js","test-integration":"mocha -R spec test/*.integration.js",ci:"npm run lint && npm run test-cov"},Ku=["Aliyun","AliCloud","OpenAPI","POP","SDK","Core"],Yu="Jackson Tian",Ju="MIT",Qu={debug:"^3.1.0",httpx:"^2.1.2","json-bigint":"^1.0.0",kitx:"^1.2.1",xml2js:"^0.5.0"},Zu=["lib","index.js"],ec={eslint:"^6.6.0","expect.js":"^0.3.1",mocha:"^4",muk:"^0.5.3",nyc:"^12.0.2",rewire:"^4.0.1"},tc={test:"test"},rc={node:">=8.0.0"},nc={type:"git",url:"git+https://github.com/aliyun/openapi-core-nodejs-sdk.git"},ic={url:"https://github.com/aliyun/openapi-core-nodejs-sdk/issues"},oc="https://github.com/aliyun/openapi-core-nodejs-sdk#readme",sc={name:Xu,version:Vu,description:zu,main:Wu,types:Hu,scripts:Gu,keywords:Ku,author:Yu,license:Ju,dependencies:Qu,files:Zu,devDependencies:ec,directories:tc,engines:rc,repository:nc,bugs:ic,homepage:oc},ro=$e,On=sc;_t.DEFAULT_UA=`AlibabaCloud (${ro.platform()}; ${ro.arch()}) Node.js/${process.version} Core/${On.version}`;_t.DEFAULT_CLIENT=`Node.js(${process.version}), ${On.name}: ${On.version}`;const Ke=Dn,no=ze,je=Sn,ac=xs,io=_t;function Fs(s){return s.slice(0,1).toUpperCase()+s.slice(1)}function uc(s){for(var e=Object.keys(s),n={},i=0;i<e.length;i++){var a=e[i];n[Fs(a)]=s[a]}return n}function oo(){var s=new Date,e=s.getUTCFullYear(),n=je.pad2(s.getUTCMonth()+1),i=je.pad2(s.getUTCDate()),a=je.pad2(s.getUTCHours()),t=je.pad2(s.getUTCMinutes()),r=je.pad2(s.getUTCSeconds());return`${e}-${n}-${i}T${a}:${t}:${r}Z`}function Qe(s){var e=encodeURIComponent(s);return e.replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function Cn(s,e,n){for(var i=0;i<n.length;i++){var a=n[i];if(Array.isArray(a))Cn(s,`${e}.${i+1}`,a);else if(a&&typeof a=="object"){const r=Object.keys(a);for(var t=0;t<r.length;t++)Array.isArray(a[r[t]])?Cn(s,`${e}.${i+1}.${r[t]}`,a[r[t]]):s[`${e}.${i+1}.${r[t]}`]=a[r[t]]}else s[`${e}.${i+1}`]=a}}function cc(s){var e={},n=Object.keys(s);for(let t=0;t<n.length;t++){var i=n[t],a=s[i];Array.isArray(a)?Cn(e,i,a):e[i]=a}return e}function fc(s){var e=[],n=cc(s),i=Object.keys(n).sort();for(let r=0;r<i.length;r++){var a=i[r],t=n[a];e.push([Qe(a),Qe(t)])}return e}function Pr(s){for(var e=[],n=0;n<s.length;n++){var[i,a]=s[n];e.push(i+"="+a)}return e.join("&")}let lc=class{constructor(e,n){if(Ke(e,'must pass "config"'),Ke(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Ke(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else{Ke(e.accessKeyId,'must pass "config.accessKeyId"');var i=e.secretAccessKey||e.accessKeySecret;Ke(i,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=i,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:i,securityToken:e.securityToken})}}if(e.endpoint.endsWith("/")&&(e.endpoint=e.endpoint.slice(0,-1)),this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.verbose=n===!0,this.codes=new Set([200,"200","OK","Success","success"]),e.codes)for(var a of e.codes)this.codes.add(a);this.opts=e.opts||{};var t=this.endpoint.startsWith("https://")?Et:wt;this.keepAliveAgent=new t.Agent({keepAlive:!0,keepAliveMsecs:3e3})}async request(e,n={},i={}){const a=await this.credentialsProvider.getCredentials();i=Object.assign({headers:{"x-sdk-client":io.DEFAULT_CLIENT,"user-agent":io.DEFAULT_UA,"x-acs-action":e,"x-acs-version":this.apiVersion}},this.opts,i),i.formatAction!==!1&&(e=Fs(e)),i.formatParams!==!1&&(n=uc(n));const t={Format:"JSON",Timestamp:oo(),Version:this.apiVersion};a&&a.accessKeyId&&a.accessKeySecret&&(t.SignatureMethod="HMAC-SHA1",t.SignatureVersion="1.0",t.SignatureNonce=je.makeNonce(),t.AccessKeyId=a.accessKeyId,a.securityToken&&(t.SecurityToken=a.securityToken)),n=Object.assign({Action:e},t,n);const r=(i.method||"GET").toUpperCase(),o=fc(n);if(a&&a.accessKeyId&&a.accessKeySecret){const m=Pr(o),v=`${r}&${Qe("/")}&${Qe(m)}`,T=a.accessKeySecret+"&",b=je.sha1(v,T,"base64");o.push(["Signature",Qe(b)])}const u=i.method==="POST"?`${this.endpoint}/`:`${this.endpoint}/?${Pr(o)}`,f={url:u,request:null,response:null};i&&!i.agent&&(i.agent=this.keepAliveAgent),i.method==="POST"&&(i.headers=i.headers||{},i.headers["content-type"]="application/x-www-form-urlencoded",i.data=Pr(o));const l=await no.request(u,i);f.request={headers:l.req.getHeaders?l.req.getHeaders():l.req._headers},f.response={statusCode:l.statusCode,headers:l.headers};const p=await no.read(l),c=ac.parse(p);if(c.Code&&!this.codes.has(c.Code)){const m=new Error(`${c.Message}, URL: ${u}`);throw m.name=c.Code+"Error",m.data=c,m.code=c.Code,m.url=u,m.entry=f,m}return this.verbose?[c,f]:c}_buildParams(){const e={Format:"JSON",SignatureMethod:"HMAC-SHA1",SignatureNonce:je.makeNonce(),SignatureVersion:"1.0",Timestamp:oo(),AccessKeyId:this.accessKeyId,Version:this.apiVersion};return this.securityToken&&(e.SecurityToken=this.securityToken),e}};var Ss=lc,Me={},Lr={},so;function Pn(){return so||(so=1,(function(){Lr.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(ee)),Lr}var Mr={},xe={},Fe={},ao;function Pe(){return ao||(ao=1,(function(){var s,e,n,i,a,t,r,o=[].slice,u={}.hasOwnProperty;s=function(){var f,l,p,c,m,v;if(v=arguments[0],m=2<=arguments.length?o.call(arguments,1):[],a(Object.assign))Object.assign.apply(null,arguments);else for(f=0,p=m.length;f<p;f++)if(c=m[f],c!=null)for(l in c)u.call(c,l)&&(v[l]=c[l]);return v},a=function(f){return!!f&&Object.prototype.toString.call(f)==="[object Function]"},t=function(f){var l;return!!f&&((l=typeof f)=="function"||l==="object")},n=function(f){return a(Array.isArray)?Array.isArray(f):Object.prototype.toString.call(f)==="[object Array]"},i=function(f){var l;if(n(f))return!f.length;for(l in f)if(u.call(f,l))return!1;return!0},r=function(f){var l,p;return t(f)&&(p=Object.getPrototypeOf(f))&&(l=p.constructor)&&typeof l=="function"&&l instanceof l&&Function.prototype.toString.call(l)===Function.prototype.toString.call(Object)},e=function(f){return a(f.valueOf)?f.valueOf():f},Fe.assign=s,Fe.isFunction=a,Fe.isObject=t,Fe.isArray=n,Fe.isEmpty=i,Fe.isPlainObject=r,Fe.getValue=e}).call(ee)),Fe}var Rr={exports:{}},uo;function Ps(){return uo||(uo=1,(function(){Rr.exports=function(){function s(){}return s.prototype.hasFeature=function(e,n){return!0},s.prototype.createDocumentType=function(e,n,i){throw new Error("This DOM method is not implemented.")},s.prototype.createDocument=function(e,n,i){throw new Error("This DOM method is not implemented.")},s.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},s.prototype.getFeature=function(e,n){throw new Error("This DOM method is not implemented.")},s}()}).call(ee)),Rr.exports}var jr={exports:{}},qr={exports:{}},$r={exports:{}},co;function pc(){return co||(co=1,(function(){$r.exports=function(){function s(){}return s.prototype.handleError=function(e){throw new Error(e)},s}()}).call(ee)),$r.exports}var kr={exports:{}},fo;function hc(){return fo||(fo=1,(function(){kr.exports=function(){function s(e){this.arr=e||[]}return Object.defineProperty(s.prototype,"length",{get:function(){return this.arr.length}}),s.prototype.item=function(e){return this.arr[e]||null},s.prototype.contains=function(e){return this.arr.indexOf(e)!==-1},s}()}).call(ee)),kr.exports}var lo;function dc(){return lo||(lo=1,(function(){var s,e;s=pc(),e=hc(),qr.exports=function(){function n(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new s,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(n.prototype,"parameterNames",{get:function(){return new e(Object.keys(this.defaultParams))}}),n.prototype.getParameter=function(i){return this.params.hasOwnProperty(i)?this.params[i]:null},n.prototype.canSetParameter=function(i,a){return!0},n.prototype.setParameter=function(i,a){return a!=null?this.params[i]=a:delete this.params[i]},n}()}).call(ee)),qr.exports}var Br={exports:{}},Ur={exports:{}},Xr={exports:{}},po;function fe(){return po||(po=1,(function(){Xr.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(ee)),Xr.exports}var Vr={exports:{}},ho;function Ls(){return ho||(ho=1,(function(){var s;s=fe(),Ae(),Vr.exports=function(){function e(n,i,a){if(this.parent=n,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),i==null)throw new Error("Missing attribute name. "+this.debugInfo(i));this.name=this.stringify.name(i),this.value=this.stringify.attValue(a),this.type=s.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(n){return this.value=n||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(n){return this.options.writer.attribute(this,this.options.writer.filterOptions(n))},e.prototype.debugInfo=function(n){return n=n||this.name,n==null?"parent: <"+this.parent.name+">":"attribute: {"+n+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(n){return!(n.namespaceURI!==this.namespaceURI||n.prefix!==this.prefix||n.localName!==this.localName||n.value!==this.value)},e}()}).call(ee)),Vr.exports}var zr={exports:{}},mo;function Ln(){return mo||(mo=1,(function(){zr.exports=function(){function s(e){this.nodes=e}return Object.defineProperty(s.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),s.prototype.clone=function(){return this.nodes=null},s.prototype.getNamedItem=function(e){return this.nodes[e]},s.prototype.setNamedItem=function(e){var n;return n=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,n||null},s.prototype.removeNamedItem=function(e){var n;return n=this.nodes[e],delete this.nodes[e],n||null},s.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},s.prototype.getNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},s.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},s.prototype.removeNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},s}()}).call(ee)),zr.exports}var go;function Mn(){return go||(go=1,(function(){var s,e,n,i,a,t,r,o,u=function(l,p){for(var c in p)f.call(p,c)&&(l[c]=p[c]);function m(){this.constructor=l}return m.prototype=p.prototype,l.prototype=new m,l.__super__=p.prototype,l},f={}.hasOwnProperty;o=Pe(),r=o.isObject,t=o.isFunction,a=o.getValue,i=Ae(),s=fe(),e=Ls(),n=Ln(),Ur.exports=function(l){u(p,l);function p(c,m,v){var T,b,x,y;if(p.__super__.constructor.call(this,c),m==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(m),this.type=s.Element,this.attribs={},this.schemaTypeInfo=null,v!=null&&this.attribute(v),c.type===s.Document&&(this.isRoot=!0,this.documentObject=c,c.rootObject=this,c.children)){for(y=c.children,b=0,x=y.length;b<x;b++)if(T=y[b],T.type===s.DocType){T.name=this.name;break}}}return Object.defineProperty(p.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(p.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(p.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(p.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(p.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(p.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(p.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(p.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new n(this.attribs)),this.attributeMap}}),p.prototype.clone=function(){var c,m,v,T;v=Object.create(this),v.isRoot&&(v.documentObject=null),v.attribs={},T=this.attribs;for(m in T)f.call(T,m)&&(c=T[m],v.attribs[m]=c.clone());return v.children=[],this.children.forEach(function(b){var x;return x=b.clone(),x.parent=v,v.children.push(x)}),v},p.prototype.attribute=function(c,m){var v,T;if(c!=null&&(c=a(c)),r(c))for(v in c)f.call(c,v)&&(T=c[v],this.attribute(v,T));else t(m)&&(m=m.apply()),this.options.keepNullAttributes&&m==null?this.attribs[c]=new e(this,c,""):m!=null&&(this.attribs[c]=new e(this,c,m));return this},p.prototype.removeAttribute=function(c){var m,v,T;if(c==null)throw new Error("Missing attribute name. "+this.debugInfo());if(c=a(c),Array.isArray(c))for(v=0,T=c.length;v<T;v++)m=c[v],delete this.attribs[m];else delete this.attribs[c];return this},p.prototype.toString=function(c){return this.options.writer.element(this,this.options.writer.filterOptions(c))},p.prototype.att=function(c,m){return this.attribute(c,m)},p.prototype.a=function(c,m){return this.attribute(c,m)},p.prototype.getAttribute=function(c){return this.attribs.hasOwnProperty(c)?this.attribs[c].value:null},p.prototype.setAttribute=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getAttributeNode=function(c){return this.attribs.hasOwnProperty(c)?this.attribs[c]:null},p.prototype.setAttributeNode=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.removeAttributeNode=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getElementsByTagName=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getAttributeNS=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.setAttributeNS=function(c,m,v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.removeAttributeNS=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getAttributeNodeNS=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.setAttributeNodeNS=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getElementsByTagNameNS=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.hasAttribute=function(c){return this.attribs.hasOwnProperty(c)},p.prototype.hasAttributeNS=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.setIdAttribute=function(c,m){return this.attribs.hasOwnProperty(c)?this.attribs[c].isId:m},p.prototype.setIdAttributeNS=function(c,m,v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.setIdAttributeNode=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getElementsByTagName=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getElementsByTagNameNS=function(c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getElementsByClassName=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.isEqualNode=function(c){var m,v,T;if(!p.__super__.isEqualNode.apply(this,arguments).isEqualNode(c)||c.namespaceURI!==this.namespaceURI||c.prefix!==this.prefix||c.localName!==this.localName||c.attribs.length!==this.attribs.length)return!1;for(m=v=0,T=this.attribs.length-1;0<=T?v<=T:v>=T;m=0<=T?++v:--v)if(!this.attribs[m].isEqualNode(c.attribs[m]))return!1;return!0},p}(i)}).call(ee)),Ur.exports}var Wr={exports:{}},Hr={exports:{}},yo;function It(){return yo||(yo=1,(function(){var s,e=function(i,a){for(var t in a)n.call(a,t)&&(i[t]=a[t]);function r(){this.constructor=i}return r.prototype=a.prototype,i.prototype=new r,i.__super__=a.prototype,i},n={}.hasOwnProperty;s=Ae(),Hr.exports=function(i){e(a,i);function a(t){a.__super__.constructor.call(this,t),this.value=""}return Object.defineProperty(a.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(a.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(a.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),a.prototype.clone=function(){return Object.create(this)},a.prototype.substringData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.insertData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.deleteData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.replaceData=function(t,r,o){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.isEqualNode=function(t){return!(!a.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)||t.data!==this.data)},a}(s)}).call(ee)),Hr.exports}var vo;function Rn(){return vo||(vo=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;s=fe(),e=It(),Wr.exports=function(a){n(t,a);function t(r,o){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=s.CData,this.value=this.stringify.cdata(o)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.cdata(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Wr.exports}var Gr={exports:{}},wo;function jn(){return wo||(wo=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;s=fe(),e=It(),Gr.exports=function(a){n(t,a);function t(r,o){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=s.Comment,this.value=this.stringify.comment(o)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.comment(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Gr.exports}var Kr={exports:{}},Eo;function qn(){return Eo||(Eo=1,(function(){var s,e,n,i=function(t,r){for(var o in r)a.call(r,o)&&(t[o]=r[o]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;n=Pe().isObject,e=Ae(),s=fe(),Kr.exports=function(t){i(r,t);function r(o,u,f,l){var p;r.__super__.constructor.call(this,o),n(u)&&(p=u,u=p.version,f=p.encoding,l=p.standalone),u||(u="1.0"),this.type=s.Declaration,this.version=this.stringify.xmlVersion(u),f!=null&&(this.encoding=this.stringify.xmlEncoding(f)),l!=null&&(this.standalone=this.stringify.xmlStandalone(l))}return r.prototype.toString=function(o){return this.options.writer.declaration(this,this.options.writer.filterOptions(o))},r}(e)}).call(ee)),Kr.exports}var Yr={exports:{}},Jr={exports:{}},To;function $n(){return To||(To=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),s=fe(),Jr.exports=function(a){n(t,a);function t(r,o,u,f,l,p){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(u==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(o));if(!f)throw new Error("Missing DTD attribute type. "+this.debugInfo(o));if(!l)throw new Error("Missing DTD attribute default. "+this.debugInfo(o));if(l.indexOf("#")!==0&&(l="#"+l),!l.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(o));if(p&&!l.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(o));this.elementName=this.stringify.name(o),this.type=s.AttributeDeclaration,this.attributeName=this.stringify.name(u),this.attributeType=this.stringify.dtdAttType(f),p&&(this.defaultValue=this.stringify.dtdAttDefault(p)),this.defaultValueType=l}return t.prototype.toString=function(r){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Jr.exports}var Qr={exports:{}},bo;function kn(){return bo||(bo=1,(function(){var s,e,n,i=function(t,r){for(var o in r)a.call(r,o)&&(t[o]=r[o]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;n=Pe().isObject,e=Ae(),s=fe(),Qr.exports=function(t){i(r,t);function r(o,u,f,l){if(r.__super__.constructor.call(this,o),f==null)throw new Error("Missing DTD entity name. "+this.debugInfo(f));if(l==null)throw new Error("Missing DTD entity value. "+this.debugInfo(f));if(this.pe=!!u,this.name=this.stringify.name(f),this.type=s.EntityDeclaration,!n(l))this.value=this.stringify.dtdEntityValue(l),this.internal=!0;else{if(!l.pubID&&!l.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(f));if(l.pubID&&!l.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(f));if(this.internal=!1,l.pubID!=null&&(this.pubID=this.stringify.dtdPubID(l.pubID)),l.sysID!=null&&(this.sysID=this.stringify.dtdSysID(l.sysID)),l.nData!=null&&(this.nData=this.stringify.dtdNData(l.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(f))}}return Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(o){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(o))},r}(e)}).call(ee)),Qr.exports}var Zr={exports:{}},Oo;function Bn(){return Oo||(Oo=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),s=fe(),Zr.exports=function(a){n(t,a);function t(r,o,u){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing DTD element name. "+this.debugInfo());u||(u="(#PCDATA)"),Array.isArray(u)&&(u="("+u.join(",")+")"),this.name=this.stringify.name(o),this.type=s.ElementDeclaration,this.value=this.stringify.dtdElementValue(u)}return t.prototype.toString=function(r){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Zr.exports}var en={exports:{}},Co;function Un(){return Co||(Co=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),s=fe(),en.exports=function(a){n(t,a);function t(r,o,u){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing DTD notation name. "+this.debugInfo(o));if(!u.pubID&&!u.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(o));this.name=this.stringify.name(o),this.type=s.NotationDeclaration,u.pubID!=null&&(this.pubID=this.stringify.dtdPubID(u.pubID)),u.sysID!=null&&(this.sysID=this.stringify.dtdSysID(u.sysID))}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),t.prototype.toString=function(r){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),en.exports}var Ao;function Xn(){return Ao||(Ao=1,(function(){var s,e,n,i,a,t,r,o,u=function(l,p){for(var c in p)f.call(p,c)&&(l[c]=p[c]);function m(){this.constructor=l}return m.prototype=p.prototype,l.prototype=new m,l.__super__=p.prototype,l},f={}.hasOwnProperty;o=Pe().isObject,r=Ae(),s=fe(),e=$n(),i=kn(),n=Bn(),a=Un(),t=Ln(),Yr.exports=function(l){u(p,l);function p(c,m,v){var T,b,x,y,g,A;if(p.__super__.constructor.call(this,c),this.type=s.DocType,c.children){for(y=c.children,b=0,x=y.length;b<x;b++)if(T=y[b],T.type===s.Element){this.name=T.name;break}}this.documentObject=c,o(m)&&(g=m,m=g.pubID,v=g.sysID),v==null&&(A=[m,v],v=A[0],m=A[1]),m!=null&&(this.pubID=this.stringify.dtdPubID(m)),v!=null&&(this.sysID=this.stringify.dtdSysID(v))}return Object.defineProperty(p.prototype,"entities",{get:function(){var c,m,v,T,b;for(T={},b=this.children,m=0,v=b.length;m<v;m++)c=b[m],c.type===s.EntityDeclaration&&!c.pe&&(T[c.name]=c);return new t(T)}}),Object.defineProperty(p.prototype,"notations",{get:function(){var c,m,v,T,b;for(T={},b=this.children,m=0,v=b.length;m<v;m++)c=b[m],c.type===s.NotationDeclaration&&(T[c.name]=c);return new t(T)}}),Object.defineProperty(p.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(p.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(p.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),p.prototype.element=function(c,m){var v;return v=new n(this,c,m),this.children.push(v),this},p.prototype.attList=function(c,m,v,T,b){var x;return x=new e(this,c,m,v,T,b),this.children.push(x),this},p.prototype.entity=function(c,m){var v;return v=new i(this,!1,c,m),this.children.push(v),this},p.prototype.pEntity=function(c,m){var v;return v=new i(this,!0,c,m),this.children.push(v),this},p.prototype.notation=function(c,m){var v;return v=new a(this,c,m),this.children.push(v),this},p.prototype.toString=function(c){return this.options.writer.docType(this,this.options.writer.filterOptions(c))},p.prototype.ele=function(c,m){return this.element(c,m)},p.prototype.att=function(c,m,v,T,b){return this.attList(c,m,v,T,b)},p.prototype.ent=function(c,m){return this.entity(c,m)},p.prototype.pent=function(c,m){return this.pEntity(c,m)},p.prototype.not=function(c,m){return this.notation(c,m)},p.prototype.up=function(){return this.root()||this.documentObject},p.prototype.isEqualNode=function(c){return!(!p.__super__.isEqualNode.apply(this,arguments).isEqualNode(c)||c.name!==this.name||c.publicId!==this.publicId||c.systemId!==this.systemId)},p}(r)}).call(ee)),Yr.exports}var tn={exports:{}},Do;function Vn(){return Do||(Do=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;s=fe(),e=Ae(),tn.exports=function(a){n(t,a);function t(r,o){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=s.Raw,this.value=this.stringify.raw(o)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.raw(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),tn.exports}var rn={exports:{}},No;function zn(){return No||(No=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;s=fe(),e=It(),rn.exports=function(a){n(t,a);function t(r,o){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=s.Text,this.value=this.stringify.text(o)}return Object.defineProperty(t.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"wholeText",{get:function(){var r,o,u;for(u="",o=this.previousSibling;o;)u=o.data+u,o=o.previousSibling;for(u+=this.data,r=this.nextSibling;r;)u=u+r.data,r=r.nextSibling;return u}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.text(this,this.options.writer.filterOptions(r))},t.prototype.splitText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceWholeText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t}(e)}).call(ee)),rn.exports}var nn={exports:{}},_o;function Wn(){return _o||(_o=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;s=fe(),e=It(),nn.exports=function(a){n(t,a);function t(r,o,u){if(t.__super__.constructor.call(this,r),o==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=s.ProcessingInstruction,this.target=this.stringify.insTarget(o),this.name=this.target,u&&(this.value=this.stringify.insValue(u))}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(r))},t.prototype.isEqualNode=function(r){return!(!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(r)||r.target!==this.target)},t}(e)}).call(ee)),nn.exports}var on={exports:{}},Io;function Ms(){return Io||(Io=1,(function(){var s,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function o(){this.constructor=a}return o.prototype=t.prototype,a.prototype=new o,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),s=fe(),on.exports=function(a){n(t,a);function t(r){t.__super__.constructor.call(this,r),this.type=s.Dummy}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return""},t}(e)}).call(ee)),on.exports}var sn={exports:{}},xo;function mc(){return xo||(xo=1,(function(){sn.exports=function(){function s(e){this.nodes=e}return Object.defineProperty(s.prototype,"length",{get:function(){return this.nodes.length||0}}),s.prototype.clone=function(){return this.nodes=null},s.prototype.item=function(e){return this.nodes[e]||null},s}()}).call(ee)),sn.exports}var an={exports:{}},Fo;function gc(){return Fo||(Fo=1,(function(){an.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(ee)),an.exports}var So;function Ae(){return So||(So=1,(function(){var s,e,n,i,a,t,r,o,u,f,l,p,c,m,v,T,b,x={}.hasOwnProperty;b=Pe(),T=b.isObject,v=b.isFunction,m=b.isEmpty,c=b.getValue,o=null,n=null,i=null,a=null,t=null,l=null,p=null,f=null,r=null,e=null,u=null,s=null,Br.exports=function(){function y(g){this.parent=g,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,o||(o=Mn(),n=Rn(),i=jn(),a=qn(),t=Xn(),l=Vn(),p=zn(),f=Wn(),r=Ms(),e=fe(),u=mc(),Ln(),s=gc())}return Object.defineProperty(y.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(y.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(y.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(y.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(y.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(y.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(y.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(y.prototype,"previousSibling",{get:function(){var g;return g=this.parent.children.indexOf(this),this.parent.children[g-1]||null}}),Object.defineProperty(y.prototype,"nextSibling",{get:function(){var g;return g=this.parent.children.indexOf(this),this.parent.children[g+1]||null}}),Object.defineProperty(y.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(y.prototype,"textContent",{get:function(){var g,A,N,E,D;if(this.nodeType===e.Element||this.nodeType===e.DocumentFragment){for(D="",E=this.children,A=0,N=E.length;A<N;A++)g=E[A],g.textContent&&(D+=g.textContent);return D}else return null},set:function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),y.prototype.setParent=function(g){var A,N,E,D,O;for(this.parent=g,g&&(this.options=g.options,this.stringify=g.stringify),D=this.children,O=[],N=0,E=D.length;N<E;N++)A=D[N],O.push(A.setParent(this));return O},y.prototype.element=function(g,A,N){var E,D,O,h,C,F,M,U,W,H,J;if(F=null,A===null&&N==null&&(W=[{},null],A=W[0],N=W[1]),A==null&&(A={}),A=c(A),T(A)||(H=[A,N],N=H[0],A=H[1]),g!=null&&(g=c(g)),Array.isArray(g))for(O=0,M=g.length;O<M;O++)D=g[O],F=this.element(D);else if(v(g))F=this.element(g.apply());else if(T(g)){for(C in g)if(x.call(g,C))if(J=g[C],v(J)&&(J=J.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&C.indexOf(this.stringify.convertAttKey)===0)F=this.attribute(C.substr(this.stringify.convertAttKey.length),J);else if(!this.options.separateArrayItems&&Array.isArray(J)&&m(J))F=this.dummy();else if(T(J)&&m(J))F=this.element(C);else if(!this.options.keepNullNodes&&J==null)F=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(J))for(h=0,U=J.length;h<U;h++)D=J[h],E={},E[C]=D,F=this.element(E);else T(J)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&C.indexOf(this.stringify.convertTextKey)===0?F=this.element(J):(F=this.element(C),F.element(J)):F=this.element(C,J)}else!this.options.keepNullNodes&&N===null?F=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&g.indexOf(this.stringify.convertTextKey)===0?F=this.text(N):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&g.indexOf(this.stringify.convertCDataKey)===0?F=this.cdata(N):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&g.indexOf(this.stringify.convertCommentKey)===0?F=this.comment(N):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&g.indexOf(this.stringify.convertRawKey)===0?F=this.raw(N):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&g.indexOf(this.stringify.convertPIKey)===0?F=this.instruction(g.substr(this.stringify.convertPIKey.length),N):F=this.node(g,A,N);if(F==null)throw new Error("Could not create any elements with: "+g+". "+this.debugInfo());return F},y.prototype.insertBefore=function(g,A,N){var E,D,O,h,C;if(g!=null&&g.type)return O=g,h=A,O.setParent(this),h?(D=children.indexOf(h),C=children.splice(D),children.push(O),Array.prototype.push.apply(children,C)):children.push(O),O;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return D=this.parent.children.indexOf(this),C=this.parent.children.splice(D),E=this.parent.element(g,A,N),Array.prototype.push.apply(this.parent.children,C),E},y.prototype.insertAfter=function(g,A,N){var E,D,O;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return D=this.parent.children.indexOf(this),O=this.parent.children.splice(D+1),E=this.parent.element(g,A,N),Array.prototype.push.apply(this.parent.children,O),E},y.prototype.remove=function(){var g;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return g=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[g,g-g+1].concat([])),this.parent},y.prototype.node=function(g,A,N){var E,D;return g!=null&&(g=c(g)),A||(A={}),A=c(A),T(A)||(D=[A,N],N=D[0],A=D[1]),E=new o(this,g,A),N!=null&&E.text(N),this.children.push(E),E},y.prototype.text=function(g){var A;return T(g)&&this.element(g),A=new p(this,g),this.children.push(A),this},y.prototype.cdata=function(g){var A;return A=new n(this,g),this.children.push(A),this},y.prototype.comment=function(g){var A;return A=new i(this,g),this.children.push(A),this},y.prototype.commentBefore=function(g){var A,N;return A=this.parent.children.indexOf(this),N=this.parent.children.splice(A),this.parent.comment(g),Array.prototype.push.apply(this.parent.children,N),this},y.prototype.commentAfter=function(g){var A,N;return A=this.parent.children.indexOf(this),N=this.parent.children.splice(A+1),this.parent.comment(g),Array.prototype.push.apply(this.parent.children,N),this},y.prototype.raw=function(g){var A;return A=new l(this,g),this.children.push(A),this},y.prototype.dummy=function(){var g;return g=new r(this),g},y.prototype.instruction=function(g,A){var N,E,D,O,h;if(g!=null&&(g=c(g)),A!=null&&(A=c(A)),Array.isArray(g))for(O=0,h=g.length;O<h;O++)N=g[O],this.instruction(N);else if(T(g))for(N in g)x.call(g,N)&&(E=g[N],this.instruction(N,E));else v(A)&&(A=A.apply()),D=new f(this,g,A),this.children.push(D);return this},y.prototype.instructionBefore=function(g,A){var N,E;return N=this.parent.children.indexOf(this),E=this.parent.children.splice(N),this.parent.instruction(g,A),Array.prototype.push.apply(this.parent.children,E),this},y.prototype.instructionAfter=function(g,A){var N,E;return N=this.parent.children.indexOf(this),E=this.parent.children.splice(N+1),this.parent.instruction(g,A),Array.prototype.push.apply(this.parent.children,E),this},y.prototype.declaration=function(g,A,N){var E,D;return E=this.document(),D=new a(E,g,A,N),E.children.length===0?E.children.unshift(D):E.children[0].type===e.Declaration?E.children[0]=D:E.children.unshift(D),E.root()||E},y.prototype.dtd=function(g,A){var N,E,D,O,h,C,F,M,U,W;for(E=this.document(),D=new t(E,g,A),U=E.children,O=h=0,F=U.length;h<F;O=++h)if(N=U[O],N.type===e.DocType)return E.children[O]=D,D;for(W=E.children,O=C=0,M=W.length;C<M;O=++C)if(N=W[O],N.isRoot)return E.children.splice(O,0,D),D;return E.children.push(D),D},y.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},y.prototype.root=function(){var g;for(g=this;g;){if(g.type===e.Document)return g.rootObject;if(g.isRoot)return g;g=g.parent}},y.prototype.document=function(){var g;for(g=this;g;){if(g.type===e.Document)return g;g=g.parent}},y.prototype.end=function(g){return this.document().end(g)},y.prototype.prev=function(){var g;if(g=this.parent.children.indexOf(this),g<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[g-1]},y.prototype.next=function(){var g;if(g=this.parent.children.indexOf(this),g===-1||g===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[g+1]},y.prototype.importDocument=function(g){var A;return A=g.root().clone(),A.parent=this,A.isRoot=!1,this.children.push(A),this},y.prototype.debugInfo=function(g){var A,N;return g=g||this.name,g==null&&!((A=this.parent)!=null&&A.name)?"":g==null?"parent: <"+this.parent.name+">":(N=this.parent)!=null&&N.name?"node: <"+g+">, parent: <"+this.parent.name+">":"node: <"+g+">"},y.prototype.ele=function(g,A,N){return this.element(g,A,N)},y.prototype.nod=function(g,A,N){return this.node(g,A,N)},y.prototype.txt=function(g){return this.text(g)},y.prototype.dat=function(g){return this.cdata(g)},y.prototype.com=function(g){return this.comment(g)},y.prototype.ins=function(g,A){return this.instruction(g,A)},y.prototype.doc=function(){return this.document()},y.prototype.dec=function(g,A,N){return this.declaration(g,A,N)},y.prototype.e=function(g,A,N){return this.element(g,A,N)},y.prototype.n=function(g,A,N){return this.node(g,A,N)},y.prototype.t=function(g){return this.text(g)},y.prototype.d=function(g){return this.cdata(g)},y.prototype.c=function(g){return this.comment(g)},y.prototype.r=function(g){return this.raw(g)},y.prototype.i=function(g,A){return this.instruction(g,A)},y.prototype.u=function(){return this.up()},y.prototype.importXMLBuilder=function(g){return this.importDocument(g)},y.prototype.replaceChild=function(g,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.removeChild=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.appendChild=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.hasChildNodes=function(){return this.children.length!==0},y.prototype.cloneNode=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.isSupported=function(g,A){return!0},y.prototype.hasAttributes=function(){return this.attribs.length!==0},y.prototype.compareDocumentPosition=function(g){var A,N;return A=this,A===g?0:this.document()!==g.document()?(N=s.Disconnected|s.ImplementationSpecific,Math.random()<.5?N|=s.Preceding:N|=s.Following,N):A.isAncestor(g)?s.Contains|s.Preceding:A.isDescendant(g)?s.Contains|s.Following:A.isPreceding(g)?s.Preceding:s.Following},y.prototype.isSameNode=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.lookupPrefix=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.isDefaultNamespace=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.lookupNamespaceURI=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.isEqualNode=function(g){var A,N,E;if(g.nodeType!==this.nodeType||g.children.length!==this.children.length)return!1;for(A=N=0,E=this.children.length-1;0<=E?N<=E:N>=E;A=0<=E?++N:--N)if(!this.children[A].isEqualNode(g.children[A]))return!1;return!0},y.prototype.getFeature=function(g,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.setUserData=function(g,A,N){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.getUserData=function(g){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.contains=function(g){return g?g===this||this.isDescendant(g):!1},y.prototype.isDescendant=function(g){var A,N,E,D,O;for(O=this.children,E=0,D=O.length;E<D;E++)if(A=O[E],g===A||(N=A.isDescendant(g),N))return!0;return!1},y.prototype.isAncestor=function(g){return g.isDescendant(this)},y.prototype.isPreceding=function(g){var A,N;return A=this.treePosition(g),N=this.treePosition(this),A===-1||N===-1?!1:A<N},y.prototype.isFollowing=function(g){var A,N;return A=this.treePosition(g),N=this.treePosition(this),A===-1||N===-1?!1:A>N},y.prototype.treePosition=function(g){var A,N;return N=0,A=!1,this.foreachTreeNode(this.document(),function(E){if(N++,!A&&E===g)return A=!0}),A?N:-1},y.prototype.foreachTreeNode=function(g,A){var N,E,D,O,h;for(g||(g=this.document()),O=g.children,E=0,D=O.length;E<D;E++){if(N=O[E],h=A(N))return h;if(h=this.foreachTreeNode(N,A),h)return h}},y}()}).call(ee)),Br.exports}var un={exports:{}},Po;function Rs(){return Po||(Po=1,(function(){var s=function(n,i){return function(){return n.apply(i,arguments)}},e={}.hasOwnProperty;un.exports=function(){function n(i){this.assertLegalName=s(this.assertLegalName,this),this.assertLegalChar=s(this.assertLegalChar,this);var a,t,r;i||(i={}),this.options=i,this.options.version||(this.options.version="1.0"),t=i.stringify||{};for(a in t)e.call(t,a)&&(r=t[a],this[a]=r)}return n.prototype.name=function(i){return this.options.noValidation?i:this.assertLegalName(""+i||"")},n.prototype.text=function(i){return this.options.noValidation?i:this.assertLegalChar(this.textEscape(""+i||""))},n.prototype.cdata=function(i){return this.options.noValidation?i:(i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i))},n.prototype.comment=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},n.prototype.raw=function(i){return this.options.noValidation?i:""+i||""},n.prototype.attValue=function(i){return this.options.noValidation?i:this.assertLegalChar(this.attEscape(i=""+i||""))},n.prototype.insTarget=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.insValue=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return this.assertLegalChar(i)},n.prototype.xmlVersion=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},n.prototype.xmlEncoding=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return this.assertLegalChar(i)},n.prototype.xmlStandalone=function(i){return this.options.noValidation?i:i?"yes":"no"},n.prototype.dtdPubID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdSysID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdElementValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttType=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttDefault=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdEntityValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdNData=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.convertAttKey="@",n.prototype.convertPIKey="?",n.prototype.convertTextKey="#text",n.prototype.convertCDataKey="#cdata",n.prototype.convertCommentKey="#comment",n.prototype.convertRawKey="#raw",n.prototype.assertLegalChar=function(i){var a,t;if(this.options.noValidation)return i;if(a="",this.options.version==="1.0"){if(a=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,t=i.match(a))throw new Error("Invalid character in string: "+i+" at index "+t.index)}else if(this.options.version==="1.1"&&(a=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,t=i.match(a)))throw new Error("Invalid character in string: "+i+" at index "+t.index);return i},n.prototype.assertLegalName=function(i){var a;if(this.options.noValidation)return i;if(this.assertLegalChar(i),a=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!i.match(a))throw new Error("Invalid character in name");return i},n.prototype.textEscape=function(i){var a;return this.options.noValidation?i:(a=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(a,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},n.prototype.attEscape=function(i){var a;return this.options.noValidation?i:(a=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(a,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},n}()}).call(ee)),un.exports}var cn={exports:{}},fn={exports:{}},ln={exports:{}},Lo;function xt(){return Lo||(Lo=1,(function(){ln.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(ee)),ln.exports}var Mo;function js(){return Mo||(Mo=1,(function(){var s,e,n,i={}.hasOwnProperty;n=Pe().assign,s=fe(),qn(),Xn(),Rn(),jn(),Mn(),Vn(),zn(),Wn(),Ms(),$n(),Bn(),kn(),Un(),e=xt(),fn.exports=function(){function a(t){var r,o,u;t||(t={}),this.options=t,o=t.writer||{};for(r in o)i.call(o,r)&&(u=o[r],this["_"+r]=this[r],this[r]=u)}return a.prototype.filterOptions=function(t){var r,o,u,f,l,p,c,m;return t||(t={}),t=n({},this.options,t),r={writer:this},r.pretty=t.pretty||!1,r.allowEmpty=t.allowEmpty||!1,r.indent=(o=t.indent)!=null?o:"  ",r.newline=(u=t.newline)!=null?u:`
`,r.offset=(f=t.offset)!=null?f:0,r.dontPrettyTextNodes=(l=(p=t.dontPrettyTextNodes)!=null?p:t.dontprettytextnodes)!=null?l:0,r.spaceBeforeSlash=(c=(m=t.spaceBeforeSlash)!=null?m:t.spacebeforeslash)!=null?c:"",r.spaceBeforeSlash===!0&&(r.spaceBeforeSlash=" "),r.suppressPrettyCount=0,r.user={},r.state=e.None,r},a.prototype.indent=function(t,r,o){var u;return!r.pretty||r.suppressPrettyCount?"":r.pretty&&(u=(o||0)+r.offset+1,u>0)?new Array(u).join(r.indent):""},a.prototype.endline=function(t,r,o){return!r.pretty||r.suppressPrettyCount?"":r.newline},a.prototype.attribute=function(t,r,o){var u;return this.openAttribute(t,r,o),u=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,r,o),u},a.prototype.cdata=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<![CDATA[",r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+="]]>"+this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.comment=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<!-- ",r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=" -->"+this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.declaration=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<?xml",r.state=e.InsideTag,u+=' version="'+t.version+'"',t.encoding!=null&&(u+=' encoding="'+t.encoding+'"'),t.standalone!=null&&(u+=' standalone="'+t.standalone+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+"?>",u+=this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.docType=function(t,r,o){var u,f,l,p,c;if(o||(o=0),this.openNode(t,r,o),r.state=e.OpenTag,p=this.indent(t,r,o),p+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?p+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(p+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(p+=" [",p+=this.endline(t,r,o),r.state=e.InsideTag,c=t.children,f=0,l=c.length;f<l;f++)u=c[f],p+=this.writeChildNode(u,r,o+1);r.state=e.CloseTag,p+="]"}return r.state=e.CloseTag,p+=r.spaceBeforeSlash+">",p+=this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),p},a.prototype.element=function(t,r,o){var u,f,l,p,c,m,v,T,b,x,y,g,A,N;o||(o=0),x=!1,y="",this.openNode(t,r,o),r.state=e.OpenTag,y+=this.indent(t,r,o)+"<"+t.name,g=t.attribs;for(b in g)i.call(g,b)&&(u=g[b],y+=this.attribute(u,r,o));if(l=t.children.length,p=l===0?null:t.children[0],l===0||t.children.every(function(E){return(E.type===s.Text||E.type===s.Raw)&&E.value===""}))r.allowEmpty?(y+=">",r.state=e.CloseTag,y+="</"+t.name+">"+this.endline(t,r,o)):(r.state=e.CloseTag,y+=r.spaceBeforeSlash+"/>"+this.endline(t,r,o));else if(r.pretty&&l===1&&(p.type===s.Text||p.type===s.Raw)&&p.value!=null)y+=">",r.state=e.InsideTag,r.suppressPrettyCount++,x=!0,y+=this.writeChildNode(p,r,o+1),r.suppressPrettyCount--,x=!1,r.state=e.CloseTag,y+="</"+t.name+">"+this.endline(t,r,o);else{if(r.dontPrettyTextNodes){for(A=t.children,c=0,v=A.length;c<v;c++)if(f=A[c],(f.type===s.Text||f.type===s.Raw)&&f.value!=null){r.suppressPrettyCount++,x=!0;break}}for(y+=">"+this.endline(t,r,o),r.state=e.InsideTag,N=t.children,m=0,T=N.length;m<T;m++)f=N[m],y+=this.writeChildNode(f,r,o+1);r.state=e.CloseTag,y+=this.indent(t,r,o)+"</"+t.name+">",x&&r.suppressPrettyCount--,y+=this.endline(t,r,o),r.state=e.None}return this.closeNode(t,r,o),y},a.prototype.writeChildNode=function(t,r,o){switch(t.type){case s.CData:return this.cdata(t,r,o);case s.Comment:return this.comment(t,r,o);case s.Element:return this.element(t,r,o);case s.Raw:return this.raw(t,r,o);case s.Text:return this.text(t,r,o);case s.ProcessingInstruction:return this.processingInstruction(t,r,o);case s.Dummy:return"";case s.Declaration:return this.declaration(t,r,o);case s.DocType:return this.docType(t,r,o);case s.AttributeDeclaration:return this.dtdAttList(t,r,o);case s.ElementDeclaration:return this.dtdElement(t,r,o);case s.EntityDeclaration:return this.dtdEntity(t,r,o);case s.NotationDeclaration:return this.dtdNotation(t,r,o);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},a.prototype.processingInstruction=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<?",r.state=e.InsideTag,u+=t.target,t.value&&(u+=" "+t.value),r.state=e.CloseTag,u+=r.spaceBeforeSlash+"?>",u+=this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.raw=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o),r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.text=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o),r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.dtdAttList=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<!ATTLIST",r.state=e.InsideTag,u+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,t.defaultValueType!=="#DEFAULT"&&(u+=" "+t.defaultValueType),t.defaultValue&&(u+=' "'+t.defaultValue+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.dtdElement=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<!ELEMENT",r.state=e.InsideTag,u+=" "+t.name+" "+t.value,r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.dtdEntity=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<!ENTITY",r.state=e.InsideTag,t.pe&&(u+=" %"),u+=" "+t.name,t.value?u+=' "'+t.value+'"':(t.pubID&&t.sysID?u+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(u+=' SYSTEM "'+t.sysID+'"'),t.nData&&(u+=" NDATA "+t.nData)),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.dtdNotation=function(t,r,o){var u;return this.openNode(t,r,o),r.state=e.OpenTag,u=this.indent(t,r,o)+"<!NOTATION",r.state=e.InsideTag,u+=" "+t.name,t.pubID&&t.sysID?u+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?u+=' PUBLIC "'+t.pubID+'"':t.sysID&&(u+=' SYSTEM "'+t.sysID+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,o),r.state=e.None,this.closeNode(t,r,o),u},a.prototype.openNode=function(t,r,o){},a.prototype.closeNode=function(t,r,o){},a.prototype.openAttribute=function(t,r,o){},a.prototype.closeAttribute=function(t,r,o){},a}()}).call(ee)),fn.exports}var Ro;function Hn(){return Ro||(Ro=1,(function(){var s,e=function(i,a){for(var t in a)n.call(a,t)&&(i[t]=a[t]);function r(){this.constructor=i}return r.prototype=a.prototype,i.prototype=new r,i.__super__=a.prototype,i},n={}.hasOwnProperty;s=js(),cn.exports=function(i){e(a,i);function a(t){a.__super__.constructor.call(this,t)}return a.prototype.document=function(t,r){var o,u,f,l,p;for(r=this.filterOptions(r),l="",p=t.children,u=0,f=p.length;u<f;u++)o=p[u],l+=this.writeChildNode(o,r,0);return r.pretty&&l.slice(-r.newline.length)===r.newline&&(l=l.slice(0,-r.newline.length)),l},a}(s)}).call(ee)),cn.exports}var jo;function qs(){return jo||(jo=1,(function(){var s,e,n,i,a,t,r,o=function(f,l){for(var p in l)u.call(l,p)&&(f[p]=l[p]);function c(){this.constructor=f}return c.prototype=l.prototype,f.prototype=new c,f.__super__=l.prototype,f},u={}.hasOwnProperty;r=Pe().isPlainObject,n=Ps(),e=dc(),i=Ae(),s=fe(),t=Rs(),a=Hn(),jr.exports=function(f){o(l,f);function l(p){l.__super__.constructor.call(this,null),this.name="#document",this.type=s.Document,this.documentURI=null,this.domConfig=new e,p||(p={}),p.writer||(p.writer=new a),this.options=p,this.stringify=new t(p)}return Object.defineProperty(l.prototype,"implementation",{value:new n}),Object.defineProperty(l.prototype,"doctype",{get:function(){var p,c,m,v;for(v=this.children,c=0,m=v.length;c<m;c++)if(p=v[c],p.type===s.DocType)return p;return null}}),Object.defineProperty(l.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(l.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(l.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(l.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===s.Declaration?this.children[0].encoding:null}}),Object.defineProperty(l.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===s.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(l.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===s.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(l.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(l.prototype,"origin",{get:function(){return null}}),Object.defineProperty(l.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(l.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(l.prototype,"contentType",{get:function(){return null}}),l.prototype.end=function(p){var c;return c={},p?r(p)&&(c=p,p=this.options.writer):p=this.options.writer,p.document(this,p.filterOptions(c))},l.prototype.toString=function(p){return this.options.writer.document(this,this.options.writer.filterOptions(p))},l.prototype.createElement=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createTextNode=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createComment=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createCDATASection=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createProcessingInstruction=function(p,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createAttribute=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createEntityReference=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementsByTagName=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.importNode=function(p,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createElementNS=function(p,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createAttributeNS=function(p,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementsByTagNameNS=function(p,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementById=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.adoptNode=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.renameNode=function(p,c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementsByClassName=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createEvent=function(p){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createNodeIterator=function(p,c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createTreeWalker=function(p,c,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},l}(i)}).call(ee)),jr.exports}var pn={exports:{}},qo;function yc(){return qo||(qo=1,(function(){var s,e,n,i,a,t,r,o,u,f,l,p,c,m,v,T,b,x,y,g,A,N,E,D={}.hasOwnProperty;E=Pe(),A=E.isObject,g=E.isFunction,N=E.isPlainObject,y=E.getValue,s=fe(),p=qs(),c=Mn(),i=Rn(),a=jn(),v=Vn(),x=zn(),m=Wn(),f=qn(),l=Xn(),t=$n(),o=kn(),r=Bn(),u=Un(),n=Ls(),b=Rs(),T=Hn(),e=xt(),pn.exports=function(){function O(h,C,F){var M;this.name="?xml",this.type=s.Document,h||(h={}),M={},h.writer?N(h.writer)&&(M=h.writer,h.writer=new T):h.writer=new T,this.options=h,this.writer=h.writer,this.writerOptions=this.writer.filterOptions(M),this.stringify=new b(h),this.onDataCallback=C||function(){},this.onEndCallback=F||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return O.prototype.createChildNode=function(h){var C,F,M,U,W,H,J,Y;switch(h.type){case s.CData:this.cdata(h.value);break;case s.Comment:this.comment(h.value);break;case s.Element:M={},J=h.attribs;for(F in J)D.call(J,F)&&(C=J[F],M[F]=C.value);this.node(h.name,M);break;case s.Dummy:this.dummy();break;case s.Raw:this.raw(h.value);break;case s.Text:this.text(h.value);break;case s.ProcessingInstruction:this.instruction(h.target,h.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+h.constructor.name)}for(Y=h.children,W=0,H=Y.length;W<H;W++)U=Y[W],this.createChildNode(U),U.type===s.Element&&this.up();return this},O.prototype.dummy=function(){return this},O.prototype.node=function(h,C,F){var M;if(h==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(h));return this.openCurrent(),h=y(h),C==null&&(C={}),C=y(C),A(C)||(M=[C,F],F=M[0],C=M[1]),this.currentNode=new c(this,h,C),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,F!=null&&this.text(F),this},O.prototype.element=function(h,C,F){var M,U,W,H,J,Y;if(this.currentNode&&this.currentNode.type===s.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(h)||A(h)||g(h))for(H=this.options.noValidation,this.options.noValidation=!0,Y=new p(this.options).element("TEMP_ROOT"),Y.element(h),this.options.noValidation=H,J=Y.children,U=0,W=J.length;U<W;U++)M=J[U],this.createChildNode(M),M.type===s.Element&&this.up();else this.node(h,C,F);return this},O.prototype.attribute=function(h,C){var F,M;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(h));if(h!=null&&(h=y(h)),A(h))for(F in h)D.call(h,F)&&(M=h[F],this.attribute(F,M));else g(C)&&(C=C.apply()),this.options.keepNullAttributes&&C==null?this.currentNode.attribs[h]=new n(this,h,""):C!=null&&(this.currentNode.attribs[h]=new n(this,h,C));return this},O.prototype.text=function(h){var C;return this.openCurrent(),C=new x(this,h),this.onData(this.writer.text(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.cdata=function(h){var C;return this.openCurrent(),C=new i(this,h),this.onData(this.writer.cdata(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.comment=function(h){var C;return this.openCurrent(),C=new a(this,h),this.onData(this.writer.comment(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.raw=function(h){var C;return this.openCurrent(),C=new v(this,h),this.onData(this.writer.raw(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.instruction=function(h,C){var F,M,U,W,H;if(this.openCurrent(),h!=null&&(h=y(h)),C!=null&&(C=y(C)),Array.isArray(h))for(F=0,W=h.length;F<W;F++)M=h[F],this.instruction(M);else if(A(h))for(M in h)D.call(h,M)&&(U=h[M],this.instruction(M,U));else g(C)&&(C=C.apply()),H=new m(this,h,C),this.onData(this.writer.processingInstruction(H,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},O.prototype.declaration=function(h,C,F){var M;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return M=new f(this,h,C,F),this.onData(this.writer.declaration(M,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.doctype=function(h,C,F){if(this.openCurrent(),h==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,C,F),this.currentNode.rootNodeName=h,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},O.prototype.dtdElement=function(h,C){var F;return this.openCurrent(),F=new r(this,h,C),this.onData(this.writer.dtdElement(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.attList=function(h,C,F,M,U){var W;return this.openCurrent(),W=new t(this,h,C,F,M,U),this.onData(this.writer.dtdAttList(W,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.entity=function(h,C){var F;return this.openCurrent(),F=new o(this,!1,h,C),this.onData(this.writer.dtdEntity(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.pEntity=function(h,C){var F;return this.openCurrent(),F=new o(this,!0,h,C),this.onData(this.writer.dtdEntity(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.notation=function(h,C){var F;return this.openCurrent(),F=new u(this,h,C),this.onData(this.writer.dtdNotation(F,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},O.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},O.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},O.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},O.prototype.openNode=function(h){var C,F,M,U;if(!h.isOpen){if(!this.root&&this.currentLevel===0&&h.type===s.Element&&(this.root=h),F="",h.type===s.Element){this.writerOptions.state=e.OpenTag,F=this.writer.indent(h,this.writerOptions,this.currentLevel)+"<"+h.name,U=h.attribs;for(M in U)D.call(U,M)&&(C=U[M],F+=this.writer.attribute(C,this.writerOptions,this.currentLevel));F+=(h.children?">":"/>")+this.writer.endline(h,this.writerOptions,this.currentLevel),this.writerOptions.state=e.InsideTag}else this.writerOptions.state=e.OpenTag,F=this.writer.indent(h,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+h.rootNodeName,h.pubID&&h.sysID?F+=' PUBLIC "'+h.pubID+'" "'+h.sysID+'"':h.sysID&&(F+=' SYSTEM "'+h.sysID+'"'),h.children?(F+=" [",this.writerOptions.state=e.InsideTag):(this.writerOptions.state=e.CloseTag,F+=">"),F+=this.writer.endline(h,this.writerOptions,this.currentLevel);return this.onData(F,this.currentLevel),h.isOpen=!0}},O.prototype.closeNode=function(h){var C;if(!h.isClosed)return C="",this.writerOptions.state=e.CloseTag,h.type===s.Element?C=this.writer.indent(h,this.writerOptions,this.currentLevel)+"</"+h.name+">"+this.writer.endline(h,this.writerOptions,this.currentLevel):C=this.writer.indent(h,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(h,this.writerOptions,this.currentLevel),this.writerOptions.state=e.None,this.onData(C,this.currentLevel),h.isClosed=!0},O.prototype.onData=function(h,C){return this.documentStarted=!0,this.onDataCallback(h,C+1)},O.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},O.prototype.debugInfo=function(h){return h==null?"":"node: <"+h+">"},O.prototype.ele=function(){return this.element.apply(this,arguments)},O.prototype.nod=function(h,C,F){return this.node(h,C,F)},O.prototype.txt=function(h){return this.text(h)},O.prototype.dat=function(h){return this.cdata(h)},O.prototype.com=function(h){return this.comment(h)},O.prototype.ins=function(h,C){return this.instruction(h,C)},O.prototype.dec=function(h,C,F){return this.declaration(h,C,F)},O.prototype.dtd=function(h,C,F){return this.doctype(h,C,F)},O.prototype.e=function(h,C,F){return this.element(h,C,F)},O.prototype.n=function(h,C,F){return this.node(h,C,F)},O.prototype.t=function(h){return this.text(h)},O.prototype.d=function(h){return this.cdata(h)},O.prototype.c=function(h){return this.comment(h)},O.prototype.r=function(h){return this.raw(h)},O.prototype.i=function(h,C){return this.instruction(h,C)},O.prototype.att=function(){return this.currentNode&&this.currentNode.type===s.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},O.prototype.a=function(){return this.currentNode&&this.currentNode.type===s.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},O.prototype.ent=function(h,C){return this.entity(h,C)},O.prototype.pent=function(h,C){return this.pEntity(h,C)},O.prototype.not=function(h,C){return this.notation(h,C)},O}()}).call(ee)),pn.exports}var hn={exports:{}},$o;function vc(){return $o||($o=1,(function(){var s,e,n,i=function(t,r){for(var o in r)a.call(r,o)&&(t[o]=r[o]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;s=fe(),n=js(),e=xt(),hn.exports=function(t){i(r,t);function r(o,u){this.stream=o,r.__super__.constructor.call(this,u)}return r.prototype.endline=function(o,u,f){return o.isLastRootNode&&u.state===e.CloseTag?"":r.__super__.endline.call(this,o,u,f)},r.prototype.document=function(o,u){var f,l,p,c,m,v,T,b,x;for(T=o.children,l=p=0,m=T.length;p<m;l=++p)f=T[l],f.isLastRootNode=l===o.children.length-1;for(u=this.filterOptions(u),b=o.children,x=[],c=0,v=b.length;c<v;c++)f=b[c],x.push(this.writeChildNode(f,u,0));return x},r.prototype.attribute=function(o,u,f){return this.stream.write(r.__super__.attribute.call(this,o,u,f))},r.prototype.cdata=function(o,u,f){return this.stream.write(r.__super__.cdata.call(this,o,u,f))},r.prototype.comment=function(o,u,f){return this.stream.write(r.__super__.comment.call(this,o,u,f))},r.prototype.declaration=function(o,u,f){return this.stream.write(r.__super__.declaration.call(this,o,u,f))},r.prototype.docType=function(o,u,f){var l,p,c,m;if(f||(f=0),this.openNode(o,u,f),u.state=e.OpenTag,this.stream.write(this.indent(o,u,f)),this.stream.write("<!DOCTYPE "+o.root().name),o.pubID&&o.sysID?this.stream.write(' PUBLIC "'+o.pubID+'" "'+o.sysID+'"'):o.sysID&&this.stream.write(' SYSTEM "'+o.sysID+'"'),o.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(o,u,f)),u.state=e.InsideTag,m=o.children,p=0,c=m.length;p<c;p++)l=m[p],this.writeChildNode(l,u,f+1);u.state=e.CloseTag,this.stream.write("]")}return u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+">"),this.stream.write(this.endline(o,u,f)),u.state=e.None,this.closeNode(o,u,f)},r.prototype.element=function(o,u,f){var l,p,c,m,v,T,b,x,y;f||(f=0),this.openNode(o,u,f),u.state=e.OpenTag,this.stream.write(this.indent(o,u,f)+"<"+o.name),x=o.attribs;for(b in x)a.call(x,b)&&(l=x[b],this.attribute(l,u,f));if(c=o.children.length,m=c===0?null:o.children[0],c===0||o.children.every(function(g){return(g.type===s.Text||g.type===s.Raw)&&g.value===""}))u.allowEmpty?(this.stream.write(">"),u.state=e.CloseTag,this.stream.write("</"+o.name+">")):(u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+"/>"));else if(u.pretty&&c===1&&(m.type===s.Text||m.type===s.Raw)&&m.value!=null)this.stream.write(">"),u.state=e.InsideTag,u.suppressPrettyCount++,this.writeChildNode(m,u,f+1),u.suppressPrettyCount--,u.state=e.CloseTag,this.stream.write("</"+o.name+">");else{for(this.stream.write(">"+this.endline(o,u,f)),u.state=e.InsideTag,y=o.children,v=0,T=y.length;v<T;v++)p=y[v],this.writeChildNode(p,u,f+1);u.state=e.CloseTag,this.stream.write(this.indent(o,u,f)+"</"+o.name+">")}return this.stream.write(this.endline(o,u,f)),u.state=e.None,this.closeNode(o,u,f)},r.prototype.processingInstruction=function(o,u,f){return this.stream.write(r.__super__.processingInstruction.call(this,o,u,f))},r.prototype.raw=function(o,u,f){return this.stream.write(r.__super__.raw.call(this,o,u,f))},r.prototype.text=function(o,u,f){return this.stream.write(r.__super__.text.call(this,o,u,f))},r.prototype.dtdAttList=function(o,u,f){return this.stream.write(r.__super__.dtdAttList.call(this,o,u,f))},r.prototype.dtdElement=function(o,u,f){return this.stream.write(r.__super__.dtdElement.call(this,o,u,f))},r.prototype.dtdEntity=function(o,u,f){return this.stream.write(r.__super__.dtdEntity.call(this,o,u,f))},r.prototype.dtdNotation=function(o,u,f){return this.stream.write(r.__super__.dtdNotation.call(this,o,u,f))},r}(n)}).call(ee)),hn.exports}var ko;function wc(){return ko||(ko=1,(function(){var s,e,n,i,a,t,r,o,u,f;f=Pe(),o=f.assign,u=f.isFunction,n=Ps(),i=qs(),a=yc(),r=Hn(),t=vc(),s=fe(),e=xt(),xe.create=function(l,p,c,m){var v,T;if(l==null)throw new Error("Root element needs a name.");return m=o({},p,c,m),v=new i(m),T=v.element(l),m.headless||(v.declaration(m),(m.pubID!=null||m.sysID!=null)&&v.dtd(m)),T},xe.begin=function(l,p,c){var m;return u(l)&&(m=[l,p],p=m[0],c=m[1],l={}),p?new a(l,p,c):new i(l)},xe.stringWriter=function(l){return new r(l)},xe.streamWriter=function(l,p){return new t(l,p)},xe.implementation=new n,xe.nodeType=s,xe.writerState=e}).call(ee)),xe}var Bo;function Ec(){return Bo||(Bo=1,(function(){var s,e,n,i,a,t={}.hasOwnProperty;s=wc(),e=Pn().defaults,i=function(r){return typeof r=="string"&&(r.indexOf("&")>=0||r.indexOf(">")>=0||r.indexOf("<")>=0)},a=function(r){return"<![CDATA["+n(r)+"]]>"},n=function(r){return r.replace("]]>","]]]]><![CDATA[>")},Mr.Builder=function(){function r(o){var u,f,l;this.options={},f=e["0.2"];for(u in f)t.call(f,u)&&(l=f[u],this.options[u]=l);for(u in o)t.call(o,u)&&(l=o[u],this.options[u]=l)}return r.prototype.buildObject=function(o){var u,f,l,p,c;return u=this.options.attrkey,f=this.options.charkey,Object.keys(o).length===1&&this.options.rootName===e["0.2"].rootName?(c=Object.keys(o)[0],o=o[c]):c=this.options.rootName,l=function(m){return function(v,T){var b,x,y,g,A,N;if(typeof T!="object")m.options.cdata&&i(T)?v.raw(a(T)):v.txt(T);else if(Array.isArray(T)){for(g in T)if(t.call(T,g)){x=T[g];for(A in x)y=x[A],v=l(v.ele(A),y).up()}}else for(A in T)if(t.call(T,A))if(x=T[A],A===u){if(typeof x=="object")for(b in x)N=x[b],v=v.att(b,N)}else if(A===f)m.options.cdata&&i(x)?v=v.raw(a(x)):v=v.txt(x);else if(Array.isArray(x))for(g in x)t.call(x,g)&&(y=x[g],typeof y=="string"?m.options.cdata&&i(y)?v=v.ele(A).raw(a(y)).up():v=v.ele(A,y).up():v=l(v.ele(A),y).up());else typeof x=="object"?v=l(v.ele(A),x).up():typeof x=="string"&&m.options.cdata&&i(x)?v=v.ele(A).raw(a(x)).up():(x==null&&(x=""),v=v.ele(A,x.toString()).up());return v}}(this),p=s.create(c,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),l(p,o).end(this.options.renderOpts)},r}()}).call(ee)),Mr}var dn={},mn={},Uo;function Tc(){return Uo||(Uo=1,function(s){(function(e){e.parser=function(_,w){return new i(_,w)},e.SAXParser=i,e.SAXStream=l,e.createStream=f,e.MAX_BUFFER_LENGTH=64*1024;var n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function i(_,w){if(!(this instanceof i))return new i(_,w);var X=this;t(X),X.q=X.c="",X.bufferCheckPosition=e.MAX_BUFFER_LENGTH,X.opt=w||{},X.opt.lowercase=X.opt.lowercase||X.opt.lowercasetags,X.looseCase=X.opt.lowercase?"toLowerCase":"toUpperCase",X.tags=[],X.closed=X.closedRoot=X.sawRoot=!1,X.tag=X.error=null,X.strict=!!_,X.noscript=!!(_||X.opt.noscript),X.state=h.BEGIN,X.strictEntities=X.opt.strictEntities,X.ENTITIES=X.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),X.attribList=[],X.opt.xmlns&&(X.ns=Object.create(T)),X.opt.unquotedAttributeValues===void 0&&(X.opt.unquotedAttributeValues=!_),X.trackPosition=X.opt.position!==!1,X.trackPosition&&(X.position=X.line=X.column=0),F(X,"onready")}Object.create||(Object.create=function(_){function w(){}w.prototype=_;var X=new w;return X}),Object.keys||(Object.keys=function(_){var w=[];for(var X in _)_.hasOwnProperty(X)&&w.push(X);return w});function a(_){for(var w=Math.max(e.MAX_BUFFER_LENGTH,10),X=0,d=0,I=n.length;d<I;d++){var S=_[n[d]].length;if(S>w)switch(n[d]){case"textNode":U(_);break;case"cdata":M(_,"oncdata",_.cdata),_.cdata="";break;case"script":M(_,"onscript",_.script),_.script="";break;default:H(_,"Max buffer length exceeded: "+n[d])}X=Math.max(X,S)}var q=e.MAX_BUFFER_LENGTH-X;_.bufferCheckPosition=q+_.position}function t(_){for(var w=0,X=n.length;w<X;w++)_[n[w]]=""}function r(_){U(_),_.cdata!==""&&(M(_,"oncdata",_.cdata),_.cdata=""),_.script!==""&&(M(_,"onscript",_.script),_.script="")}i.prototype={end:function(){J(this)},write:nt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){r(this)}};var o;try{o=require("stream").Stream}catch{o=function(){}}o||(o=function(){});var u=e.EVENTS.filter(function(_){return _!=="error"&&_!=="end"});function f(_,w){return new l(_,w)}function l(_,w){if(!(this instanceof l))return new l(_,w);o.apply(this),this._parser=new i(_,w),this.writable=!0,this.readable=!0;var X=this;this._parser.onend=function(){X.emit("end")},this._parser.onerror=function(d){X.emit("error",d),X._parser.error=null},this._decoder=null,u.forEach(function(d){Object.defineProperty(X,"on"+d,{get:function(){return X._parser["on"+d]},set:function(I){if(!I)return X.removeAllListeners(d),X._parser["on"+d]=I,I;X.on(d,I)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(o.prototype,{constructor:{value:l}}),l.prototype.write=function(_){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(_)){if(!this._decoder){var w=Ks.StringDecoder;this._decoder=new w("utf8")}_=this._decoder.write(_)}return this._parser.write(_.toString()),this.emit("data",_),!0},l.prototype.end=function(_){return _&&_.length&&this.write(_),this._parser.end(),!0},l.prototype.on=function(_,w){var X=this;return!X._parser["on"+_]&&u.indexOf(_)!==-1&&(X._parser["on"+_]=function(){var d=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);d.splice(0,0,_),X.emit.apply(X,d)}),o.prototype.on.call(X,_,w)};var p="[CDATA[",c="DOCTYPE",m="http://www.w3.org/XML/1998/namespace",v="http://www.w3.org/2000/xmlns/",T={xml:m,xmlns:v},b=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,x=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,g=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function A(_){return _===" "||_===`
`||_==="\r"||_==="	"}function N(_){return _==='"'||_==="'"}function E(_){return _===">"||A(_)}function D(_,w){return _.test(w)}function O(_,w){return!D(_,w)}var h=0;e.STATE={BEGIN:h++,BEGIN_WHITESPACE:h++,TEXT:h++,TEXT_ENTITY:h++,OPEN_WAKA:h++,SGML_DECL:h++,SGML_DECL_QUOTED:h++,DOCTYPE:h++,DOCTYPE_QUOTED:h++,DOCTYPE_DTD:h++,DOCTYPE_DTD_QUOTED:h++,COMMENT_STARTING:h++,COMMENT:h++,COMMENT_ENDING:h++,COMMENT_ENDED:h++,CDATA:h++,CDATA_ENDING:h++,CDATA_ENDING_2:h++,PROC_INST:h++,PROC_INST_BODY:h++,PROC_INST_ENDING:h++,OPEN_TAG:h++,OPEN_TAG_SLASH:h++,ATTRIB:h++,ATTRIB_NAME:h++,ATTRIB_NAME_SAW_WHITE:h++,ATTRIB_VALUE:h++,ATTRIB_VALUE_QUOTED:h++,ATTRIB_VALUE_CLOSED:h++,ATTRIB_VALUE_UNQUOTED:h++,ATTRIB_VALUE_ENTITY_Q:h++,ATTRIB_VALUE_ENTITY_U:h++,CLOSE_TAG:h++,CLOSE_TAG_SAW_WHITE:h++,SCRIPT:h++,SCRIPT_ENDING:h++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(_){var w=e.ENTITIES[_],X=typeof w=="number"?String.fromCharCode(w):w;e.ENTITIES[_]=X});for(var C in e.STATE)e.STATE[e.STATE[C]]=C;h=e.STATE;function F(_,w,X){_[w]&&_[w](X)}function M(_,w,X){_.textNode&&U(_),F(_,w,X)}function U(_){_.textNode=W(_.opt,_.textNode),_.textNode&&F(_,"ontext",_.textNode),_.textNode=""}function W(_,w){return _.trim&&(w=w.trim()),_.normalize&&(w=w.replace(/\s+/g," ")),w}function H(_,w){return U(_),_.trackPosition&&(w+=`
Line: `+_.line+`
Column: `+_.column+`
Char: `+_.c),w=new Error(w),_.error=w,F(_,"onerror",w),_}function J(_){return _.sawRoot&&!_.closedRoot&&Y(_,"Unclosed root tag"),_.state!==h.BEGIN&&_.state!==h.BEGIN_WHITESPACE&&_.state!==h.TEXT&&H(_,"Unexpected end"),U(_),_.c="",_.closed=!0,F(_,"onend"),i.call(_,_.strict,_.opt),_}function Y(_,w){if(typeof _!="object"||!(_ instanceof i))throw new Error("bad call to strictFail");_.strict&&H(_,w)}function be(_){_.strict||(_.tagName=_.tagName[_.looseCase]());var w=_.tags[_.tags.length-1]||_,X=_.tag={name:_.tagName,attributes:{}};_.opt.xmlns&&(X.ns=w.ns),_.attribList.length=0,M(_,"onopentagstart",X)}function Oe(_,w){var X=_.indexOf(":"),d=X<0?["",_]:_.split(":"),I=d[0],S=d[1];return w&&_==="xmlns"&&(I="xmlns",S=""),{prefix:I,local:S}}function he(_){if(_.strict||(_.attribName=_.attribName[_.looseCase]()),_.attribList.indexOf(_.attribName)!==-1||_.tag.attributes.hasOwnProperty(_.attribName)){_.attribName=_.attribValue="";return}if(_.opt.xmlns){var w=Oe(_.attribName,!0),X=w.prefix,d=w.local;if(X==="xmlns")if(d==="xml"&&_.attribValue!==m)Y(_,"xml: prefix must be bound to "+m+`
Actual: `+_.attribValue);else if(d==="xmlns"&&_.attribValue!==v)Y(_,"xmlns: prefix must be bound to "+v+`
Actual: `+_.attribValue);else{var I=_.tag,S=_.tags[_.tags.length-1]||_;I.ns===S.ns&&(I.ns=Object.create(S.ns)),I.ns[d]=_.attribValue}_.attribList.push([_.attribName,_.attribValue])}else _.tag.attributes[_.attribName]=_.attribValue,M(_,"onattribute",{name:_.attribName,value:_.attribValue});_.attribName=_.attribValue=""}function le(_,w){if(_.opt.xmlns){var X=_.tag,d=Oe(_.tagName);X.prefix=d.prefix,X.local=d.local,X.uri=X.ns[d.prefix]||"",X.prefix&&!X.uri&&(Y(_,"Unbound namespace prefix: "+JSON.stringify(_.tagName)),X.uri=d.prefix);var I=_.tags[_.tags.length-1]||_;X.ns&&I.ns!==X.ns&&Object.keys(X.ns).forEach(function(G){M(_,"onopennamespace",{prefix:G,uri:X.ns[G]})});for(var S=0,q=_.attribList.length;S<q;S++){var L=_.attribList[S],R=L[0],B=L[1],P=Oe(R,!0),j=P.prefix,k=P.local,$=j===""?"":X.ns[j]||"",V={name:R,value:B,prefix:j,local:k,uri:$};j&&j!=="xmlns"&&!$&&(Y(_,"Unbound namespace prefix: "+JSON.stringify(j)),V.uri=j),_.tag.attributes[R]=V,M(_,"onattribute",V)}_.attribList.length=0}_.tag.isSelfClosing=!!w,_.sawRoot=!0,_.tags.push(_.tag),M(_,"onopentag",_.tag),w||(!_.noscript&&_.tagName.toLowerCase()==="script"?_.state=h.SCRIPT:_.state=h.TEXT,_.tag=null,_.tagName=""),_.attribName=_.attribValue="",_.attribList.length=0}function Ee(_){if(!_.tagName){Y(_,"Weird empty close tag."),_.textNode+="</>",_.state=h.TEXT;return}if(_.script){if(_.tagName!=="script"){_.script+="</"+_.tagName+">",_.tagName="",_.state=h.SCRIPT;return}M(_,"onscript",_.script),_.script=""}var w=_.tags.length,X=_.tagName;_.strict||(X=X[_.looseCase]());for(var d=X;w--;){var I=_.tags[w];if(I.name!==d)Y(_,"Unexpected close tag");else break}if(w<0){Y(_,"Unmatched closing tag: "+_.tagName),_.textNode+="</"+_.tagName+">",_.state=h.TEXT;return}_.tagName=X;for(var S=_.tags.length;S-- >w;){var q=_.tag=_.tags.pop();_.tagName=_.tag.name,M(_,"onclosetag",_.tagName);var L={};for(var R in q.ns)L[R]=q.ns[R];var B=_.tags[_.tags.length-1]||_;_.opt.xmlns&&q.ns!==B.ns&&Object.keys(q.ns).forEach(function(P){var j=q.ns[P];M(_,"onclosenamespace",{prefix:P,uri:j})})}w===0&&(_.closedRoot=!0),_.tagName=_.attribValue=_.attribName="",_.attribList.length=0,_.state=h.TEXT}function Le(_){var w=_.entity,X=w.toLowerCase(),d,I="";return _.ENTITIES[w]?_.ENTITIES[w]:_.ENTITIES[X]?_.ENTITIES[X]:(w=X,w.charAt(0)==="#"&&(w.charAt(1)==="x"?(w=w.slice(2),d=parseInt(w,16),I=d.toString(16)):(w=w.slice(1),d=parseInt(w,10),I=d.toString(10))),w=w.replace(/^0+/,""),isNaN(d)||I.toLowerCase()!==w?(Y(_,"Invalid character entity"),"&"+_.entity+";"):String.fromCodePoint(d))}function z(_,w){w==="<"?(_.state=h.OPEN_WAKA,_.startTagPosition=_.position):A(w)||(Y(_,"Non-whitespace before first tag."),_.textNode=w,_.state=h.TEXT)}function Xe(_,w){var X="";return w<_.length&&(X=_.charAt(w)),X}function nt(_){var w=this;if(this.error)throw this.error;if(w.closed)return H(w,"Cannot write after close. Assign an onready handler.");if(_===null)return J(w);typeof _=="object"&&(_=_.toString());for(var X=0,d="";d=Xe(_,X++),w.c=d,!!d;)switch(w.trackPosition&&(w.position++,d===`
`?(w.line++,w.column=0):w.column++),w.state){case h.BEGIN:if(w.state=h.BEGIN_WHITESPACE,d==="\uFEFF")continue;z(w,d);continue;case h.BEGIN_WHITESPACE:z(w,d);continue;case h.TEXT:if(w.sawRoot&&!w.closedRoot){for(var I=X-1;d&&d!=="<"&&d!=="&";)d=Xe(_,X++),d&&w.trackPosition&&(w.position++,d===`
`?(w.line++,w.column=0):w.column++);w.textNode+=_.substring(I,X-1)}d==="<"&&!(w.sawRoot&&w.closedRoot&&!w.strict)?(w.state=h.OPEN_WAKA,w.startTagPosition=w.position):(!A(d)&&(!w.sawRoot||w.closedRoot)&&Y(w,"Text data outside of root node."),d==="&"?w.state=h.TEXT_ENTITY:w.textNode+=d);continue;case h.SCRIPT:d==="<"?w.state=h.SCRIPT_ENDING:w.script+=d;continue;case h.SCRIPT_ENDING:d==="/"?w.state=h.CLOSE_TAG:(w.script+="<"+d,w.state=h.SCRIPT);continue;case h.OPEN_WAKA:if(d==="!")w.state=h.SGML_DECL,w.sgmlDecl="";else if(!A(d))if(D(b,d))w.state=h.OPEN_TAG,w.tagName=d;else if(d==="/")w.state=h.CLOSE_TAG,w.tagName="";else if(d==="?")w.state=h.PROC_INST,w.procInstName=w.procInstBody="";else{if(Y(w,"Unencoded <"),w.startTagPosition+1<w.position){var S=w.position-w.startTagPosition;d=new Array(S).join(" ")+d}w.textNode+="<"+d,w.state=h.TEXT}continue;case h.SGML_DECL:if(w.sgmlDecl+d==="--"){w.state=h.COMMENT,w.comment="",w.sgmlDecl="";continue}w.doctype&&w.doctype!==!0&&w.sgmlDecl?(w.state=h.DOCTYPE_DTD,w.doctype+="<!"+w.sgmlDecl+d,w.sgmlDecl=""):(w.sgmlDecl+d).toUpperCase()===p?(M(w,"onopencdata"),w.state=h.CDATA,w.sgmlDecl="",w.cdata=""):(w.sgmlDecl+d).toUpperCase()===c?(w.state=h.DOCTYPE,(w.doctype||w.sawRoot)&&Y(w,"Inappropriately located doctype declaration"),w.doctype="",w.sgmlDecl=""):d===">"?(M(w,"onsgmldeclaration",w.sgmlDecl),w.sgmlDecl="",w.state=h.TEXT):(N(d)&&(w.state=h.SGML_DECL_QUOTED),w.sgmlDecl+=d);continue;case h.SGML_DECL_QUOTED:d===w.q&&(w.state=h.SGML_DECL,w.q=""),w.sgmlDecl+=d;continue;case h.DOCTYPE:d===">"?(w.state=h.TEXT,M(w,"ondoctype",w.doctype),w.doctype=!0):(w.doctype+=d,d==="["?w.state=h.DOCTYPE_DTD:N(d)&&(w.state=h.DOCTYPE_QUOTED,w.q=d));continue;case h.DOCTYPE_QUOTED:w.doctype+=d,d===w.q&&(w.q="",w.state=h.DOCTYPE);continue;case h.DOCTYPE_DTD:d==="]"?(w.doctype+=d,w.state=h.DOCTYPE):d==="<"?(w.state=h.OPEN_WAKA,w.startTagPosition=w.position):N(d)?(w.doctype+=d,w.state=h.DOCTYPE_DTD_QUOTED,w.q=d):w.doctype+=d;continue;case h.DOCTYPE_DTD_QUOTED:w.doctype+=d,d===w.q&&(w.state=h.DOCTYPE_DTD,w.q="");continue;case h.COMMENT:d==="-"?w.state=h.COMMENT_ENDING:w.comment+=d;continue;case h.COMMENT_ENDING:d==="-"?(w.state=h.COMMENT_ENDED,w.comment=W(w.opt,w.comment),w.comment&&M(w,"oncomment",w.comment),w.comment=""):(w.comment+="-"+d,w.state=h.COMMENT);continue;case h.COMMENT_ENDED:d!==">"?(Y(w,"Malformed comment"),w.comment+="--"+d,w.state=h.COMMENT):w.doctype&&w.doctype!==!0?w.state=h.DOCTYPE_DTD:w.state=h.TEXT;continue;case h.CDATA:d==="]"?w.state=h.CDATA_ENDING:w.cdata+=d;continue;case h.CDATA_ENDING:d==="]"?w.state=h.CDATA_ENDING_2:(w.cdata+="]"+d,w.state=h.CDATA);continue;case h.CDATA_ENDING_2:d===">"?(w.cdata&&M(w,"oncdata",w.cdata),M(w,"onclosecdata"),w.cdata="",w.state=h.TEXT):d==="]"?w.cdata+="]":(w.cdata+="]]"+d,w.state=h.CDATA);continue;case h.PROC_INST:d==="?"?w.state=h.PROC_INST_ENDING:A(d)?w.state=h.PROC_INST_BODY:w.procInstName+=d;continue;case h.PROC_INST_BODY:if(!w.procInstBody&&A(d))continue;d==="?"?w.state=h.PROC_INST_ENDING:w.procInstBody+=d;continue;case h.PROC_INST_ENDING:d===">"?(M(w,"onprocessinginstruction",{name:w.procInstName,body:w.procInstBody}),w.procInstName=w.procInstBody="",w.state=h.TEXT):(w.procInstBody+="?"+d,w.state=h.PROC_INST_BODY);continue;case h.OPEN_TAG:D(x,d)?w.tagName+=d:(be(w),d===">"?le(w):d==="/"?w.state=h.OPEN_TAG_SLASH:(A(d)||Y(w,"Invalid character in tag name"),w.state=h.ATTRIB));continue;case h.OPEN_TAG_SLASH:d===">"?(le(w,!0),Ee(w)):(Y(w,"Forward-slash in opening tag not followed by >"),w.state=h.ATTRIB);continue;case h.ATTRIB:if(A(d))continue;d===">"?le(w):d==="/"?w.state=h.OPEN_TAG_SLASH:D(b,d)?(w.attribName=d,w.attribValue="",w.state=h.ATTRIB_NAME):Y(w,"Invalid attribute name");continue;case h.ATTRIB_NAME:d==="="?w.state=h.ATTRIB_VALUE:d===">"?(Y(w,"Attribute without value"),w.attribValue=w.attribName,he(w),le(w)):A(d)?w.state=h.ATTRIB_NAME_SAW_WHITE:D(x,d)?w.attribName+=d:Y(w,"Invalid attribute name");continue;case h.ATTRIB_NAME_SAW_WHITE:if(d==="=")w.state=h.ATTRIB_VALUE;else{if(A(d))continue;Y(w,"Attribute without value"),w.tag.attributes[w.attribName]="",w.attribValue="",M(w,"onattribute",{name:w.attribName,value:""}),w.attribName="",d===">"?le(w):D(b,d)?(w.attribName=d,w.state=h.ATTRIB_NAME):(Y(w,"Invalid attribute name"),w.state=h.ATTRIB)}continue;case h.ATTRIB_VALUE:if(A(d))continue;N(d)?(w.q=d,w.state=h.ATTRIB_VALUE_QUOTED):(w.opt.unquotedAttributeValues||H(w,"Unquoted attribute value"),w.state=h.ATTRIB_VALUE_UNQUOTED,w.attribValue=d);continue;case h.ATTRIB_VALUE_QUOTED:if(d!==w.q){d==="&"?w.state=h.ATTRIB_VALUE_ENTITY_Q:w.attribValue+=d;continue}he(w),w.q="",w.state=h.ATTRIB_VALUE_CLOSED;continue;case h.ATTRIB_VALUE_CLOSED:A(d)?w.state=h.ATTRIB:d===">"?le(w):d==="/"?w.state=h.OPEN_TAG_SLASH:D(b,d)?(Y(w,"No whitespace between attributes"),w.attribName=d,w.attribValue="",w.state=h.ATTRIB_NAME):Y(w,"Invalid attribute name");continue;case h.ATTRIB_VALUE_UNQUOTED:if(!E(d)){d==="&"?w.state=h.ATTRIB_VALUE_ENTITY_U:w.attribValue+=d;continue}he(w),d===">"?le(w):w.state=h.ATTRIB;continue;case h.CLOSE_TAG:if(w.tagName)d===">"?Ee(w):D(x,d)?w.tagName+=d:w.script?(w.script+="</"+w.tagName,w.tagName="",w.state=h.SCRIPT):(A(d)||Y(w,"Invalid tagname in closing tag"),w.state=h.CLOSE_TAG_SAW_WHITE);else{if(A(d))continue;O(b,d)?w.script?(w.script+="</"+d,w.state=h.SCRIPT):Y(w,"Invalid tagname in closing tag."):w.tagName=d}continue;case h.CLOSE_TAG_SAW_WHITE:if(A(d))continue;d===">"?Ee(w):Y(w,"Invalid characters in closing tag");continue;case h.TEXT_ENTITY:case h.ATTRIB_VALUE_ENTITY_Q:case h.ATTRIB_VALUE_ENTITY_U:var q,L;switch(w.state){case h.TEXT_ENTITY:q=h.TEXT,L="textNode";break;case h.ATTRIB_VALUE_ENTITY_Q:q=h.ATTRIB_VALUE_QUOTED,L="attribValue";break;case h.ATTRIB_VALUE_ENTITY_U:q=h.ATTRIB_VALUE_UNQUOTED,L="attribValue";break}if(d===";"){var R=Le(w);w.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(R)?(w.entity="",w.state=q,w.write(R)):(w[L]+=R,w.entity="",w.state=q)}else D(w.entity.length?g:y,d)?w.entity+=d:(Y(w,"Invalid character in entity name"),w[L]+="&"+w.entity+d,w.entity="",w.state=q);continue;default:throw new Error(w,"Unknown state: "+w.state)}return w.position>=w.bufferCheckPosition&&a(w),w}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var _=String.fromCharCode,w=Math.floor,X=function(){var d=16384,I=[],S,q,L=-1,R=arguments.length;if(!R)return"";for(var B="";++L<R;){var P=Number(arguments[L]);if(!isFinite(P)||P<0||P>1114111||w(P)!==P)throw RangeError("Invalid code point: "+P);P<=65535?I.push(P):(P-=65536,S=(P>>10)+55296,q=P%1024+56320,I.push(S,q)),(L+1===R||I.length>d)&&(B+=_.apply(null,I),I.length=0)}return B};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:X,configurable:!0,writable:!0}):String.fromCodePoint=X}()})(s)}(mn)),mn}var gn={},Xo;function bc(){return Xo||(Xo=1,(function(){gn.stripBOM=function(s){return s[0]==="\uFEFF"?s.substring(1):s}}).call(ee)),gn}var ke={},Vo;function $s(){return Vo||(Vo=1,(function(){var s;s=new RegExp(/(?!xmlns)^.*:/),ke.normalize=function(e){return e.toLowerCase()},ke.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},ke.stripPrefix=function(e){return e.replace(s,"")},ke.parseNumbers=function(e){return isNaN(e)||(e=e%1===0?parseInt(e,10):parseFloat(e)),e},ke.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e=e.toLowerCase()==="true"),e}}).call(ee)),ke}var zo;function Oc(){return zo||(zo=1,function(s){(function(){var e,n,i,a,t,r,o,u,f=function(c,m){return function(){return c.apply(m,arguments)}},l=function(c,m){for(var v in m)p.call(m,v)&&(c[v]=m[v]);function T(){this.constructor=c}return T.prototype=m.prototype,c.prototype=new T,c.__super__=m.prototype,c},p={}.hasOwnProperty;o=Tc(),i=Be,e=bc(),r=$s(),u=Ys.setImmediate,n=Pn().defaults,a=function(c){return typeof c=="object"&&c!=null&&Object.keys(c).length===0},t=function(c,m,v){var T,b,x;for(T=0,b=c.length;T<b;T++)x=c[T],m=x(m,v);return m},s.Parser=function(c){l(m,c);function m(v){this.parseStringPromise=f(this.parseStringPromise,this),this.parseString=f(this.parseString,this),this.reset=f(this.reset,this),this.assignOrPush=f(this.assignOrPush,this),this.processAsync=f(this.processAsync,this);var T,b,x;if(!(this instanceof s.Parser))return new s.Parser(v);this.options={},b=n["0.2"];for(T in b)p.call(b,T)&&(x=b[T],this.options[T]=x);for(T in v)p.call(v,T)&&(x=v[T],this.options[T]=x);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(r.normalize)),this.reset()}return m.prototype.processAsync=function(){var v,T;try{return this.remaining.length<=this.options.chunkSize?(v=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(v),this.saxParser.close()):(v=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(v),u(this.processAsync))}catch(b){if(T=b,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(T)}},m.prototype.assignOrPush=function(v,T,b){return T in v?(v[T]instanceof Array||(v[T]=[v[T]]),v[T].push(b)):this.options.explicitArray?v[T]=[b]:v[T]=b},m.prototype.reset=function(){var v,T,b,x;return this.removeAllListeners(),this.saxParser=o.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(y){return function(g){if(y.saxParser.resume(),!y.saxParser.errThrown)return y.saxParser.errThrown=!0,y.emit("error",g)}}(this),this.saxParser.onend=function(y){return function(){if(!y.saxParser.ended)return y.saxParser.ended=!0,y.emit("end",y.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,x=[],v=this.options.attrkey,T=this.options.charkey,this.saxParser.onopentag=function(y){return function(g){var A,N,E,D,O;if(E=Object.create(null),E[T]="",!y.options.ignoreAttrs){O=g.attributes;for(A in O)p.call(O,A)&&(!(v in E)&&!y.options.mergeAttrs&&(E[v]=Object.create(null)),N=y.options.attrValueProcessors?t(y.options.attrValueProcessors,g.attributes[A],A):g.attributes[A],D=y.options.attrNameProcessors?t(y.options.attrNameProcessors,A):A,y.options.mergeAttrs?y.assignOrPush(E,D,N):E[v][D]=N)}return E["#name"]=y.options.tagNameProcessors?t(y.options.tagNameProcessors,g.name):g.name,y.options.xmlns&&(E[y.options.xmlnskey]={uri:g.uri,local:g.local}),x.push(E)}}(this),this.saxParser.onclosetag=function(y){return function(){var g,A,N,E,D,O,h,C,F,M;if(O=x.pop(),D=O["#name"],(!y.options.explicitChildren||!y.options.preserveChildrenOrder)&&delete O["#name"],O.cdata===!0&&(g=O.cdata,delete O.cdata),F=x[x.length-1],O[T].match(/^\s*$/)&&!g?(A=O[T],delete O[T]):(y.options.trim&&(O[T]=O[T].trim()),y.options.normalize&&(O[T]=O[T].replace(/\s{2,}/g," ").trim()),O[T]=y.options.valueProcessors?t(y.options.valueProcessors,O[T],D):O[T],Object.keys(O).length===1&&T in O&&!y.EXPLICIT_CHARKEY&&(O=O[T])),a(O)&&(typeof y.options.emptyTag=="function"?O=y.options.emptyTag():O=y.options.emptyTag!==""?y.options.emptyTag:A),y.options.validator!=null&&(M="/"+function(){var U,W,H;for(H=[],U=0,W=x.length;U<W;U++)E=x[U],H.push(E["#name"]);return H}().concat(D).join("/"),function(){var U;try{return O=y.options.validator(M,F&&F[D],O)}catch(W){return U=W,y.emit("error",U)}}()),y.options.explicitChildren&&!y.options.mergeAttrs&&typeof O=="object"){if(!y.options.preserveChildrenOrder)E=Object.create(null),y.options.attrkey in O&&(E[y.options.attrkey]=O[y.options.attrkey],delete O[y.options.attrkey]),!y.options.charsAsChildren&&y.options.charkey in O&&(E[y.options.charkey]=O[y.options.charkey],delete O[y.options.charkey]),Object.getOwnPropertyNames(O).length>0&&(E[y.options.childkey]=O),O=E;else if(F){F[y.options.childkey]=F[y.options.childkey]||[],h=Object.create(null);for(N in O)p.call(O,N)&&(h[N]=O[N]);F[y.options.childkey].push(h),delete O["#name"],Object.keys(O).length===1&&T in O&&!y.EXPLICIT_CHARKEY&&(O=O[T])}}return x.length>0?y.assignOrPush(F,D,O):(y.options.explicitRoot&&(C=O,O=Object.create(null),O[D]=C),y.resultObject=O,y.saxParser.ended=!0,y.emit("end",y.resultObject))}}(this),b=function(y){return function(g){var A,N;if(N=x[x.length-1],N)return N[T]+=g,y.options.explicitChildren&&y.options.preserveChildrenOrder&&y.options.charsAsChildren&&(y.options.includeWhiteChars||g.replace(/\\n/g,"").trim()!=="")&&(N[y.options.childkey]=N[y.options.childkey]||[],A={"#name":"__text__"},A[T]=g,y.options.normalize&&(A[T]=A[T].replace(/\s{2,}/g," ").trim()),N[y.options.childkey].push(A)),N}}(this),this.saxParser.ontext=b,this.saxParser.oncdata=function(y){return function(g){var A;if(A=b(g),A)return A.cdata=!0}}()},m.prototype.parseString=function(v,T){var b;T!=null&&typeof T=="function"&&(this.on("end",function(x){return this.reset(),T(null,x)}),this.on("error",function(x){return this.reset(),T(x)}));try{return v=v.toString(),v.trim()===""?(this.emit("end",null),!0):(v=e.stripBOM(v),this.options.async?(this.remaining=v,u(this.processAsync),this.saxParser):this.saxParser.write(v).close())}catch(x){if(b=x,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw b}else return this.emit("error",b),this.saxParser.errThrown=!0}},m.prototype.parseStringPromise=function(v){return new Promise(function(T){return function(b,x){return T.parseString(v,function(y,g){return y?x(y):b(g)})}}(this))},m}(i),s.parseString=function(c,m,v){var T,b,x;return v!=null?(typeof v=="function"&&(T=v),typeof m=="object"&&(b=m)):(typeof m=="function"&&(T=m),b={}),x=new s.Parser(b),x.parseString(c,T)},s.parseStringPromise=function(c,m){var v,T;return typeof m=="object"&&(v=m),T=new s.Parser(v),T.parseStringPromise(c)}}).call(ee)}(dn)),dn}(function(){var s,e,n,i,a=function(r,o){for(var u in o)t.call(o,u)&&(r[u]=o[u]);function f(){this.constructor=r}return f.prototype=o.prototype,r.prototype=new f,r.__super__=o.prototype,r},t={}.hasOwnProperty;e=Pn(),s=Ec(),n=Oc(),i=$s(),Me.defaults=e.defaults,Me.processors=i,Me.ValidationError=function(r){a(o,r);function o(u){this.message=u}return o}(Error),Me.Builder=s.Builder,Me.Parser=n.Parser,Me.parseString=n.parseString,Me.parseStringPromise=n.parseStringPromise}).call(ee);var An={exports:{}},pt={exports:{}},yn,Wo;function ks(){if(Wo)return yn;Wo=1;function s(e){i.debug=i,i.default=i,i.coerce=f,i.disable=o,i.enable=r,i.enabled=u,i.humanize=gs(),Object.keys(e).forEach(function(l){i[l]=e[l]}),i.instances=[],i.names=[],i.skips=[],i.formatters={};function n(l){for(var p=0,c=0;c<l.length;c++)p=(p<<5)-p+l.charCodeAt(c),p|=0;return i.colors[Math.abs(p)%i.colors.length]}i.selectColor=n;function i(l){var p;function c(){if(c.enabled){for(var m=arguments.length,v=new Array(m),T=0;T<m;T++)v[T]=arguments[T];var b=c,x=Number(new Date),y=x-(p||x);b.diff=y,b.prev=p,b.curr=x,p=x,v[0]=i.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");var g=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,function(N,E){if(N==="%%")return N;g++;var D=i.formatters[E];if(typeof D=="function"){var O=v[g];N=D.call(b,O),v.splice(g,1),g--}return N}),i.formatArgs.call(b,v);var A=b.log||i.log;A.apply(b,v)}}return c.namespace=l,c.enabled=i.enabled(l),c.useColors=i.useColors(),c.color=n(l),c.destroy=a,c.extend=t,typeof i.init=="function"&&i.init(c),i.instances.push(c),c}function a(){var l=i.instances.indexOf(this);return l!==-1?(i.instances.splice(l,1),!0):!1}function t(l,p){return i(this.namespace+(typeof p>"u"?":":p)+l)}function r(l){i.save(l),i.names=[],i.skips=[];var p,c=(typeof l=="string"?l:"").split(/[\s,]+/),m=c.length;for(p=0;p<m;p++)c[p]&&(l=c[p].replace(/\*/g,".*?"),l[0]==="-"?i.skips.push(new RegExp("^"+l.substr(1)+"$")):i.names.push(new RegExp("^"+l+"$")));for(p=0;p<i.instances.length;p++){var v=i.instances[p];v.enabled=i.enabled(v.namespace)}}function o(){i.enable("")}function u(l){if(l[l.length-1]==="*")return!0;var p,c;for(p=0,c=i.skips.length;p<c;p++)if(i.skips[p].test(l))return!1;for(p=0,c=i.names.length;p<c;p++)if(i.names[p].test(l))return!0;return!1}function f(l){return l instanceof Error?l.stack||l.message:l}return i.enable(i.load()),i}return yn=s,yn}var Ho;function Cc(){return Ho||(Ho=1,function(s,e){function n(l){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(c){return typeof c}:n=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},n(l)}e.log=t,e.formatArgs=a,e.save=r,e.load=o,e.useColors=i,e.storage=u(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+s.exports.humanize(this.diff),!!this.useColors){var p="color: "+this.color;l.splice(1,0,p,"color: inherit");var c=0,m=0;l[0].replace(/%[a-zA-Z%]/g,function(v){v!=="%%"&&(c++,v==="%c"&&(m=c))}),l.splice(m,0,p)}}function t(){var l;return(typeof console>"u"?"undefined":n(console))==="object"&&console.log&&(l=console).log.apply(l,arguments)}function r(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function o(){var l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=process.env.DEBUG),l}function u(){try{return localStorage}catch{}}s.exports=ks()(e);var f=s.exports.formatters;f.j=function(l){try{return JSON.stringify(l)}catch(p){return"[UnexpectedJSONParseError]: "+p.message}}}(pt,pt.exports)),pt.exports}var ht={exports:{}},Go;function Ac(){return Go||(Go=1,function(s,e){var n=_n,i=tt;e.init=p,e.log=u,e.formatArgs=r,e.save=f,e.load=l,e.useColors=t,e.colors=[6,2,3,4,5,1];try{var a=vs();a&&(a.stderr||a).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(function(m){return/^debug_/i.test(m)}).reduce(function(m,v){var T=v.substring(6).toLowerCase().replace(/_([a-z])/g,function(x,y){return y.toUpperCase()}),b=process.env[v];return/^(yes|on|true|enabled)$/i.test(b)?b=!0:/^(no|off|false|disabled)$/i.test(b)?b=!1:b==="null"?b=null:b=Number(b),m[T]=b,m},{});function t(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:n.isatty(process.stderr.fd)}function r(m){var v=this.namespace,T=this.useColors;if(T){var b=this.color,x="\x1B[3"+(b<8?b:"8;5;"+b),y="  ".concat(x,";1m").concat(v," \x1B[0m");m[0]=y+m[0].split(`
`).join(`
`+y),m.push(x+"m+"+s.exports.humanize(this.diff)+"\x1B[0m")}else m[0]=o()+v+" "+m[0]}function o(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function u(){return process.stderr.write(i.format.apply(i,arguments)+`
`)}function f(m){m?process.env.DEBUG=m:delete process.env.DEBUG}function l(){return process.env.DEBUG}function p(m){m.inspectOpts={};for(var v=Object.keys(e.inspectOpts),T=0;T<v.length;T++)m.inspectOpts[v[T]]=e.inspectOpts[v[T]]}s.exports=ks()(e);var c=s.exports.formatters;c.o=function(m){return this.inspectOpts.colors=this.useColors,i.inspect(m,this.inspectOpts).split(`
`).map(function(v){return v.trim()}).join(" ")},c.O=function(m){return this.inspectOpts.colors=this.useColors,i.inspect(m,this.inspectOpts)}}(ht,ht.exports)),ht.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?An.exports=Cc():An.exports=Ac();var Dc=An.exports;const Ye=Dn,Nc=Nn,_c=Gs,Je=Sn,Ko=ze,Ic=Me,xc=xs,Fc=Dc("roa"),dt=_t;function Sc(s){return s.replace(/[\t\n\r\f]/g," ")}function Pc(s){const e=Object.keys(s),n={};for(let i=0;i<e.length;i++){const a=e[i];n[a.toLowerCase()]=s[a]}return n}function Lc(s){const e="x-acs-",n=Object.keys(s),i=[];for(let t=0;t<n.length;t++){const r=n[t];r.startsWith(e)&&i.push(r)}i.sort();var a="";for(let t=0;t<i.length;t++){const r=i[t];a+=`${r}:${Sc(s[r]).trim()}
`}return a}function Mc(s,e){const n=Object.keys(e).sort();if(n.length===0)return s;for(var i=[],a=0;a<n.length;a++){const t=n[a];i.push(`${t}=${e[t]}`)}return`${s}?${i.join("&")}`}function Rc(s,e,n,i){const a=n.accept,t=n["content-md5"]||"",r=n["content-type"]||"",o=n.date||"",u=`${s}
${a}
${t}
${r}
${o}
`,f=Lc(n),l=Mc(e,i);return`${u}${f}${l}`}function jc(s){const e=new Ic.Parser({});return new Promise((n,i)=>{e.parseString(s,(a,t)=>{if(a)return i(a);n(t)})})}class qc extends Error{constructor(e){const n=e.Message[0],i=e.Code[0],a=e.HostId[0],t=e.RequestId[0];super(`${n} hostid: ${a}, requestid: ${t}`),this.code=i}}class $c{constructor(e){if(Ye(e,'must pass "config"'),Ye(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Ye(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else Ye(e.accessKeyId,'must pass "config.accessKeyId"'),Ye(e.accessKeySecret,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=e.accessKeySecret,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:e.accessKeySecret,securityToken:e.securityToken})};this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.host=Nc.parse(this.endpoint).hostname,this.opts=e.opts;var n=this.endpoint.startsWith("https://")?Et:wt;this.keepAliveAgent=new n.Agent({keepAlive:!0,keepAliveMsecs:3e3})}buildHeaders(){var n={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Je.makeNonce(),"x-acs-signature-method":"HMAC-SHA1","x-acs-signature-version":"1.0","x-acs-version":this.apiVersion,"user-agent":dt.DEFAULT_UA,"x-sdk-client":dt.DEFAULT_CLIENT};return this.securityToken&&(n["x-acs-accesskey-id"]=this.accessKeyId,n["x-acs-security-token"]=this.securityToken),n}signature(e){const n=Buffer.from(e,"utf8");return Je.sha1(n,this.accessKeySecret,"base64")}buildAuthorization(e){return`acs ${this.accessKeyId}:${this.signature(e)}`}async request(e,n,i={},a="",t={},r={}){const o=await this.credentialsProvider.getCredentials();var f={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Je.makeNonce(),"x-acs-version":this.apiVersion,"user-agent":dt.DEFAULT_UA,"x-sdk-client":dt.DEFAULT_CLIENT};o&&o.accessKeyId&&o.accessKeySecret&&(f["x-acs-signature-method"]="HMAC-SHA1",f["x-acs-signature-version"]="1.0",o.securityToken&&(f["x-acs-accesskey-id"]=o.accessKeyId,f["x-acs-security-token"]=o.securityToken));var l=Object.assign(f,Pc(t)),p=null;p=Buffer.from(a,"utf8"),l["content-md5"]=Je.md5(p,"base64"),l["content-length"]=p.length;var c=`${this.endpoint}${n}`;if(Object.keys(i).length&&(c+=`?${_c.stringify(i)}`),o&&o.accessKeyId&&o.accessKeySecret){const g=Rc(e,n,l,i);Fc("stringToSign: %s",g);const A=Buffer.from(g,"utf8"),N=Je.sha1(A,o.accessKeySecret,"base64");l.authorization=`acs ${o.accessKeyId}:${N}`}const m=Object.assign({method:e,agent:this.keepAliveAgent,headers:l,data:p},this.opts,r),v=await Ko.request(c,m),T=await Ko.read(v,"utf8");if(r.rawBody)return T;const b=v.headers["content-type"]||"";if(b.startsWith("application/json")){const g=v.statusCode;if(g===204)return T;var x;try{x=xc.parse(T)}catch(A){throw A.name="FormatError",A.message="parse response to json error",A.body=T,A}if(g>=400){const A=x.Message||x.errorMsg||"",N=x.Code||x.errorCode||"",E=x.RequestId||"";var y=new Error(`code: ${g}, ${A}, requestid: ${E}`);throw y.name=`${N}Error`,y.statusCode=g,y.result=x,y.code=N,y}return x}if(b.startsWith("text/xml")){const g=await jc(T);if(g.Error)throw new qc(g.Error);return g}return T}put(e,n,i,a,t){return this.request("PUT",e,n,i,a,t)}post(e,n,i,a,t){return this.request("POST",e,n,i,a,t)}get(e,n,i,a){return this.request("GET",e,n,"",i,a)}delete(e,n,i,a){return this.request("DELETE",e,n,"",i,a)}}var kc=$c;Dt.exports=Ss;Dt.exports.ROAClient=kc;Dt.exports.RPCClient=Ss;var Bc=Dt.exports;const Uc=Tt(Bc);async function Xc(){const s=new Uc({accessKeyId:vt.accessKeyId,accessKeySecret:vt.accessKeySecret,endpoint:"http://nls-meta.cn-shanghai.aliyuncs.com",apiVersion:"2019-02-28"});try{return(await s.request("CreateToken")).Token.Id}catch(e){return console.error("Error creating token:",e),null}}function et(s){return new Promise((e,n)=>{os.ffprobe(s,(i,a)=>{if(i)return n(i);e(a.format.duration||0)})})}async function Vc(s){try{const e=tt.promisify(rt.exec),{stdout:n}=await e(`ffprobe -v error -show_streams -select_streams a "${s}"`);return n.includes("codec_type=audio")}catch(e){return console.error(`hasAudio error: ${e}`),!1}}function zc(s,e){let n="";e.forEach((i,a)=>{const t=Yo(i.start),r=Yo(i.start+i.duration);n+=`${a+1}
${t} --> ${r}
${i.text}

`}),ae.writeFileSync(s,n)}function Yo(s){const e=new Date(0);return e.setSeconds(s),e.toISOString().slice(11,23).replace(".",",")}const Ve="zhushou";function Ft(){switch(process.platform){case"win32":return Q.join(re.app.getPath("appData"),Ve);case"darwin":return Q.join(re.app.getPath("appData"),Ve);case"linux":return Q.join(re.app.getPath("appData"),Ve);default:return Q.join(re.app.getPath("documents"),Ve)}}function Gn(){try{const s=Ft();ae.existsSync(s)||(ae.mkdirSync(s),console.log("Created zhushou directory at:",s));try{ae.accessSync(s,ae.constants.W_OK)}catch{return console.error("No write permission for zhushou directory, falling back to documents"),Q.join(re.app.getPath("documents"),Ve)}return s}catch(s){return console.error("Failed to create zhushou directory:",s),Q.join(re.app.getPath("documents"),Ve)}}function Wc(){re.ipcMain.handle("get-default-save-path",()=>Gn())}function Hc(){re.ipcMain.handle("text2voice",async(s,e)=>{try{const n=JSON.parse(En(e));oe.log("accept params:"),oe.log(JSON.stringify(n));const i=n,a=n.outputDir||Ft(),t=n.outputFileName||`tts_${Date.now()}`,r=await Xc();Lt.existsSync(a)||Lt.mkdirSync(a,{recursive:!0});const o=new Nu({url:vt.ttsUrl,appkey:vt.appkey,token:r}),u=Q.join(a,`${t}.${i.format||"mp3"}`),f=Lt.createWriteStream(u);return oe.log(u),new Promise((l,p)=>{o.on("meta",c=>{oe.info("接收到元信息:",c)}),o.on("data",c=>{try{f.write(c),oe.debug(`接收到数据块，大小: ${c.length} bytes`)}catch(m){oe.error("写入文件失败:",m),p(m)}}),o.on("completed",async()=>{f.end(),oe.info("语音合成完成");const c=await et(u);oe.info(`语音合成完成，时长: ${c}秒`),l({success:!0,outputFile:u,duration:c})}),o.on("closed",()=>{oe.info("连接已关闭")}),o.on("failed",c=>{f.end(),oe.error("语音合成失败:",c),p(c)}),o.start(i,!0,6e3)})}catch(n){throw oe.error("语音合成初始化失败:",n),n}})}const Gc={...De.webcrypto.subtle,generateKey:async(s,e,n)=>De.webcrypto.subtle.generateKey(s,e,n)},Kc={getRandomValues:s=>{if(!s)return s;switch(!0){case s instanceof Int8Array:return De.webcrypto.getRandomValues(s);case s instanceof Uint8Array:return De.webcrypto.getRandomValues(s);case s instanceof Uint8ClampedArray:return De.webcrypto.getRandomValues(s);case s instanceof Int16Array:return De.webcrypto.getRandomValues(s);case s instanceof Uint16Array:return De.webcrypto.getRandomValues(s);case s instanceof Int32Array:return De.webcrypto.getRandomValues(s);case s instanceof Uint32Array:return De.webcrypto.getRandomValues(s);default:throw new Error("Unsupported ArrayBufferView type")}},randomUUID:()=>De.webcrypto.randomUUID(),subtle:Gc};function Bs(){oe.transports.file.encoding="utf8",oe.transports.file.level="info",oe.transports.file.maxSize=5*1024*1024,oe.transports.file.format="[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}] {text}";const s=oe.transports.file.getFile().path;if(oe.transports.file.stream=ae.createWriteStream(s,{flags:"a",encoding:"utf8"}),process.platform==="win32"){process.env.CHCP="65001";try{require("child_process").execSync("chcp 65001")}catch{}}const e=global.console;return global.console=oe,{restore:()=>{global.console=e}}}Bs();async function Yc(s,e,n=!0,i,a,t,r){return new Promise(async(o,u)=>{const f=Q.join(Q.dirname(t),"subtitles.srt");zc(f,r);const l=Ze().input(s).input(e);n&&await Vc(s)?l.complexFilter([`[0:v]trim=start=${i}:duration=${a},setpts=PTS-STARTPTS[v]`,`[0:a]atrim=start=${i}:duration=${a},setpts=PTS-STARTPTS,volume=1.0[original]`,`[1:a]start=0:duration=${a},asetpts=PTS-STARTPTS,volume=1.0[newaudio]`,"[original][newaudio]amix=inputs=2:duration=longest[a]"]).outputOptions(["-map [v]","-map [a]","-c:v libx264","-c:a aac"]):l.complexFilter([`[0:v]trim=start=${i}:duration=${a},setpts=PTS-STARTPTS[v]`,`[1:a]atrim=start=0:duration=${a},asetpts=PTS-STARTPTS,volume=1.0[newaudio]`]).outputOptions(["-map [v]","-map [newaudio]","-c:v libx264","-c:a aac"]),l.on("start",p=>{console.log("start to execute command: "+p)}).on("progress",p=>{console.log(`processing: ${Math.round(p.percent)}%`)}).on("end",()=>{console.log(`segment process done: ${t}`),o()}).on("error",p=>{console.error(`segment process error: ${p.message}`),u(p)}).save(t)})}async function Jc(s,e,n){const i=s.zimuConfig.datas[0],a=i.path;let t=i.duration??await et(a);t=Math.ceil(t*100)/100;const r=s.videoList,o=s.isOpenOriginAudio??!0,u=[],f=`${n}_${s.name}_`;for(const l of r){const p=l.path,c=l.duration??await et(p),m=t,v=Math.ceil(c/m),T=f+Q.basename(p,Q.extname(p));for(let b=0;b<v;b++){const x=b*m,y=l.duration-x,g=Math.min(m,y),A=Q.join(e,`${T}_part${b+1}_${x}-${x+g}.mp4`);u.push({videoPath:p,audioPath:a,outputPath:A,startTime:x,currentDuration:g,isOpenOriginAudio:o})}}return u}async function Qc(s,e){return new Promise((n,i)=>{const a=Ze();s.forEach(o=>{a.input(o)});const t=[];for(let o=0;o<s.length;o++)t.push(`[${o}:v]scale=1280:720:force_original_aspect_ratio=decrease,pad=1280:720:(ow-iw)/2:(oh-ih)/2,setsar=1[v${o}]`),t.push(`[${o}:a]aformat=sample_fmts=fltp:sample_rates=44100:channel_layouts=stereo[a${o}]`);const r=s.map((o,u)=>`[v${u}][a${u}]`).join("");t.push(`${r} concat=n=${s.length}:v=1:a=1[v][a]`),a.complexFilter(t).outputOptions(["-map [v]","-map [a]","-c:v libx264","-preset fast","-crf 23","-c:a aac","-b:a 128k","-movflags +faststart"]).on("start",o=>console.log("执行命令:",o)).on("progress",o=>console.log(`处理进度: ${Math.round(o.percent)}%`)).on("end",n).on("error",i).save(e)})}async function Zc(s){oe.log("accept params："),oe.log(JSON.stringify(s));const e=s.clips,n=s.outputFileName,i=s.outputDir??Gn();for(const f of e)f.segments=await Jc(f,i,n);oe.log("split clip to segments done："),oe.log(JSON.stringify(e));const a=e.flatMap(f=>f.segments),t=a.map(f=>Yc(f.videoPath,f.audioPath,f.isOpenOriginAudio,f.startTime,f.currentDuration,f.outputPath));await Promise.all(t),oe.log("segment process done："),oe.log(JSON.stringify(a));let r=1;for(const f of e)(r===1||f.segments.length>1&&f.segments.length<r)&&(r=f.segments.length);oe.log(`we can generate ${r} videos`);const o=[];for(let f=0;f<r;f++){const l=[];let p=0;for(const c of e){const m=c.segments;let v;m.length===1?v=m[0]:v=m[f],l.push(v.outputPath),p+=v.currentDuration}o.push({videos:l,outputPath:Q.join(i,`${n}_${f+1}.mp4`),duration:p})}oe.log("concat videos start"),oe.log(JSON.stringify(o));const u=o.map(f=>Qc(f.videos,f.outputPath));return await Promise.all(u),oe.log("concat videos done："),oe.log(JSON.stringify(o)),o.map(f=>({outputPath:f.outputPath,duration:f.duration}))}function ef(){re.ipcMain.handle("video-mix-and-cut",async(s,e)=>{const n=JSON.parse(En(e));return Zc(n)}),re.ipcMain.handle("get-media-duration",async(s,e)=>{const n=JSON.parse(En(e));return et(n.path)})}function tf(s){re.ipcMain.handle("open-file-dialog",async(e,n)=>{if(!s)return null;const i=(n==null?void 0:n.defaultPath)||Ft(),a=(n==null?void 0:n.properties)||["openFile"],t=(n==null?void 0:n.title)||"选择文件",r=(n==null?void 0:n.buttonLabel)||"选择",o=(n==null?void 0:n.filters)||[{name:"All Files",extensions:["*"]}];n!=null&&n.multiple&&!a.includes("multiSelections")&&a.push("multiSelections");const u=await re.dialog.showOpenDialog(s,{title:t,defaultPath:i,buttonLabel:r,filters:o,properties:a});if(u.canceled)return[];{const f=u.filePaths.map(async l=>{const p=await et(l),c=`media://${encodeURIComponent(l)}`;return{path:Q.normalize(l),name:Q.basename(l),ext:Q.extname(l),mimeType:gt(l),duration:p,url:c}});return await Promise.all(f)}})}async function rf(s){const e=Q.normalize(s);if(e!==s||e.includes("..")||![re.app.getPath("documents"),re.app.getPath("downloads"),re.app.getPath("videos"),Ft()].map(a=>Q.normalize(a)).some(a=>e.startsWith(a+Q.sep)))return!1;try{return await ae.promises.access(e,ae.constants.R_OK),!0}catch{return!1}}function nf(){re.protocol.handle("media",async s=>{try{const e=s.url.slice(8),n=decodeURIComponent(e).replace(/\//g,"\\").replace(/^\\/,""),i=Q.normalize(n);if(!await rf(i))return new Response("Access Denied",{status:403});const a=await ae.promises.stat(i);if(!a.isFile())return new Response("Not a file",{status:400});const t=s.headers.get("range"),r=a.size,o={"Content-Type":gt(i),"Cache-Control":"public, max-age=31536000"};if(t){const u=t.replace(/bytes=/,"").split("-"),f=parseInt(u[0],10),l=u[1]?parseInt(u[1],10):r-1,p=l-f+1,c=ae.createReadStream(i,{start:f,end:l}),m=Ui(c);return new Response(m,{status:206,headers:{"Content-Range":`bytes ${f}-${l}/${r}`,"Accept-Ranges":"bytes","Content-Length":p.toString(),"Content-Type":await gt(i),"Cache-Control":"public, max-age=31536000"}})}else{const u=ae.createReadStream(i),f=Ui(u);return new Response(f,{headers:{"Content-Length":r.toString(),"Content-Type":await gt(i),"Cache-Control":"public, max-age=31536000"}})}}catch{return new Response("Not Found",{status:404})}})}function of(s){re.globalShortcut.register("CommandOrControl+R",()=>{s&&s.reload()})}global.crypto=Kc;process.env.LANG="zh_CN.UTF-8";process.env.LC_ALL="zh_CN.UTF-8";process.platform==="win32"&&(process.env.CHCP="65001");process.env.DIST=Q.join(__dirname,"../dist");process.env.VITE_PUBLIC=re.app.isPackaged?process.env.DIST:Q.join(process.env.DIST,"../public");let _e;const Jo=process.env.VITE_DEV_SERVER_URL;function Us(){_e=new re.BrowserWindow({icon:Q.join(process.env.VITE_PUBLIC,"electron-vite.svg"),webPreferences:{nodeIntegration:!0,contextIsolation:!0,preload:Q.join(__dirname,"preload.js")}}),_e.webContents.on("did-finish-load",()=>{_e==null||_e.webContents.send("main-process-message",new Date().toLocaleString())}),Jo?_e.loadURL(Jo):_e.loadFile(Q.join(process.env.DIST,"index.html"))}Bs();Ka();Qs();Ya();Hc();Wc();ef();re.app.whenReady().then(()=>{Gn(),Ga(),nf(),Us(),tf(_e),of(_e)});re.app.on("window-all-closed",()=>{process.platform!=="darwin"&&(re.app.quit(),_e=null)});re.app.on("activate",()=>{re.BrowserWindow.getAllWindows().length===0&&Us()});re.app.on("will-quit",()=>{re.globalShortcut.unregisterAll()});
//# sourceMappingURL=main.js.map
