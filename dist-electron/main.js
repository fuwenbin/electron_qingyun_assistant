"use strict";var Vs=Object.defineProperty;var zs=(o,e,n)=>e in o?Vs(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n;var Z=(o,e,n)=>(zs(o,typeof e!="symbol"?e+"":e,n),n);const re=require("electron"),Q=require("path"),rt=require("util"),Ue=require("events"),nt=require("child_process"),ke=require("os"),ae=require("fs"),Ws=require("stream"),Et=require("http"),bt=require("https"),Hs=require("ws"),_n=require("assert"),Gs=require("zlib"),Nn=require("url"),xn=require("tty"),De=require("crypto"),Ks=require("querystring"),Ys=require("string_decoder"),Js=require("timers");function Qs(o){const e=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(o){for(const n in o)if(n!=="default"){const i=Object.getOwnPropertyDescriptor(o,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:()=>o[n]})}}return e.default=o,Object.freeze(e)}const Mt=Qs(ae);function Zs(){re.ipcMain.handle("show-save-dialog",async(o,e)=>await re.dialog.showSaveDialog({title:e.title||"保存文件",defaultPath:e.defaultPath||re.app.getPath("documents"),filters:e.filters||[{name:"MP4 Videos",extensions:["mp4"]},{name:"All Files",extensions:["*"]}]})),re.ipcMain.handle("select-directory",async()=>{const o=await re.dialog.showOpenDialog({properties:["openDirectory"],title:"选择保存目录",defaultPath:re.app.getPath("documents")});return!o.canceled&&o.filePaths.length>0?o.filePaths[0]:null})}var ee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Tt(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}function ea(o){if(o.__esModule)return o;var e=o.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(o).forEach(function(i){var a=Object.getOwnPropertyDescriptor(o,i);Object.defineProperty(n,i,a.get?a:{enumerable:!0,get:function(){return o[i]}})}),n}var Zo={exports:{}},Rt,Yn;function ta(){if(Yn)return Rt;Yn=1,Rt=i,i.sync=a;var o=ae;function e(t,r){var s=r.pathExt!==void 0?r.pathExt:process.env.PATHEXT;if(!s||(s=s.split(";"),s.indexOf("")!==-1))return!0;for(var u=0;u<s.length;u++){var f=s[u].toLowerCase();if(f&&t.substr(-f.length).toLowerCase()===f)return!0}return!1}function n(t,r,s){return!t.isSymbolicLink()&&!t.isFile()?!1:e(r,s)}function i(t,r,s){o.stat(t,function(u,f){s(u,u?!1:n(f,t,r))})}function a(t,r){return n(o.statSync(t),t,r)}return Rt}var jt,Jn;function ra(){if(Jn)return jt;Jn=1,jt=e,e.sync=n;var o=ae;function e(t,r,s){o.stat(t,function(u,f){s(u,u?!1:i(f,r))})}function n(t,r){return i(o.statSync(t),r)}function i(t,r){return t.isFile()&&a(t,r)}function a(t,r){var s=t.mode,u=t.uid,f=t.gid,l=r.uid!==void 0?r.uid:process.getuid&&process.getuid(),h=r.gid!==void 0?r.gid:process.getgid&&process.getgid(),c=parseInt("100",8),g=parseInt("010",8),w=parseInt("001",8),b=c|g,C=s&w||s&g&&f===h||s&c&&u===l||s&b&&l===0;return C}return jt}var vt;process.platform==="win32"||ee.TESTING_WINDOWS?vt=ta():vt=ra();var na=In;In.sync=ia;function In(o,e,n){if(typeof e=="function"&&(n=e,e={}),!n){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(i,a){In(o,e||{},function(t,r){t?a(t):i(r)})})}vt(o,e||{},function(i,a){i&&(i.code==="EACCES"||e&&e.ignoreErrors)&&(i=null,a=!1),n(i,a)})}function ia(o,e){try{return vt.sync(o,e||{})}catch(n){if(e&&e.ignoreErrors||n.code==="EACCES")return!1;throw n}}var oa=is;is.sync=aa;var wn=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",es=Q,sa=wn?";":":",ts=na;function rs(o){var e=new Error("not found: "+o);return e.code="ENOENT",e}function ns(o,e){var n=e.colon||sa,i=e.path||process.env.PATH||"",a=[""];i=i.split(n);var t="";return wn&&(i.unshift(process.cwd()),t=e.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM",a=t.split(n),o.indexOf(".")!==-1&&a[0]!==""&&a.unshift("")),(o.match(/\//)||wn&&o.match(/\\/))&&(i=[""]),{env:i,ext:a,extExe:t}}function is(o,e,n){typeof e=="function"&&(n=e,e={});var i=ns(o,e),a=i.env,t=i.ext,r=i.extExe,s=[];(function u(f,l){if(f===l)return e.all&&s.length?n(null,s):n(rs(o));var h=a[f];h.charAt(0)==='"'&&h.slice(-1)==='"'&&(h=h.slice(1,-1));var c=es.join(h,o);!h&&/^\.[\\\/]/.test(o)&&(c=o.slice(0,2)+c),function g(w,b){if(w===b)return u(f+1,l);var C=t[w];ts(c+C,{pathExt:r},function(F,y){if(!F&&y)if(e.all)s.push(c+C);else return n(null,c+C);return g(w+1,b)})}(0,t.length)})(0,a.length)}function aa(o,e){e=e||{};for(var n=ns(o,e),i=n.env,a=n.ext,t=n.extExe,r=[],s=0,u=i.length;s<u;s++){var f=i[s];f.charAt(0)==='"'&&f.slice(-1)==='"'&&(f=f.slice(1,-1));var l=es.join(f,o);!f&&/^\.[\\\/]/.test(o)&&(l=o.slice(0,2)+l);for(var h=0,c=a.length;h<c;h++){var g=l+a[h],w;try{if(w=ts.sync(g,{pathExt:t}),w)if(e.all)r.push(g);else return g}catch{}}}if(e.all&&r.length)return r;if(e.nothrow)return null;throw rs(o)}nt.exec;var ua=ke.platform().match(/win(32|64)/),ca=oa,Qn=/\r\n|\r|\n/g,Ge=/^\[?(.*?)\]?$/,Zn=/[,]/,st={};function la(o){var e={};o=o.replace(/=\s+/g,"=").trim();for(var n=o.split(" "),i=0;i<n.length;i++){var a=n[i].split("=",2),t=a[0],r=a[1];if(typeof r>"u")return null;e[t]=r}return e}var ei=Zo.exports={isWindows:ua,streamRegexp:Ge,copy:function(o,e){Object.keys(o).forEach(function(n){e[n]=o[n]})},args:function(){var o=[],e=function(){arguments.length===1&&Array.isArray(arguments[0])?o=o.concat(arguments[0]):o=o.concat([].slice.call(arguments))};return e.clear=function(){o=[]},e.get=function(){return o},e.find=function(n,i){var a=o.indexOf(n);if(a!==-1)return o.slice(a+1,a+1+(i||0))},e.remove=function(n,i){var a=o.indexOf(n);a!==-1&&o.splice(a,(i||0)+1)},e.clone=function(){var n=ei.args();return n(o),n},e},makeFilterStrings:function(o){return o.map(function(e){if(typeof e=="string")return e;var n="";return Array.isArray(e.inputs)?n+=e.inputs.map(function(i){return i.replace(Ge,"[$1]")}).join(""):typeof e.inputs=="string"&&(n+=e.inputs.replace(Ge,"[$1]")),n+=e.filter,e.options&&(typeof e.options=="string"||typeof e.options=="number"?n+="="+e.options:Array.isArray(e.options)?n+="="+e.options.map(function(i){return typeof i=="string"&&i.match(Zn)?"'"+i+"'":i}).join(":"):Object.keys(e.options).length&&(n+="="+Object.keys(e.options).map(function(i){var a=e.options[i];return typeof a=="string"&&a.match(Zn)&&(a="'"+a+"'"),i+"="+a}).join(":"))),Array.isArray(e.outputs)?n+=e.outputs.map(function(i){return i.replace(Ge,"[$1]")}).join(""):typeof e.outputs=="string"&&(n+=e.outputs.replace(Ge,"[$1]")),n})},which:function(o,e){if(o in st)return e(null,st[o]);ca(o,function(n,i){if(n)return e(null,st[o]="");e(null,st[o]=i)})},timemarkToSeconds:function(o){if(typeof o=="number")return o;if(o.indexOf(":")===-1&&o.indexOf(".")>=0)return Number(o);var e=o.split(":"),n=Number(e.pop());return e.length&&(n+=Number(e.pop())*60),e.length&&(n+=Number(e.pop())*3600),n},extractCodecData:function(o,e,n){var i=/Input #[0-9]+, ([^ ]+),/,a=/Duration\: ([^,]+)/,t=/Audio\: (.*)/,r=/Video\: (.*)/;"inputStack"in n||(n.inputStack=[],n.inputIndex=-1,n.inInput=!1);var s=n.inputStack,u=n.inputIndex,f=n.inInput,l,h,c,g;if(l=e.match(i))f=n.inInput=!0,u=n.inputIndex=n.inputIndex+1,s[u]={format:l[1],audio:"",video:"",duration:""};else if(f&&(h=e.match(a)))s[u].duration=h[1];else if(f&&(c=e.match(t)))c=c[1].split(", "),s[u].audio=c[0],s[u].audio_details=c;else if(f&&(g=e.match(r)))g=g[1].split(", "),s[u].video=g[0],s[u].video_details=g;else if(/Output #\d+/.test(e))f=n.inInput=!1;else if(/Stream mapping:|Press (\[q\]|ctrl-c) to stop/.test(e))return o.emit.apply(o,["codecData"].concat(s)),!0;return!1},extractProgress:function(o,e){var n=la(e);if(n){var i={frames:parseInt(n.frame,10),currentFps:parseInt(n.fps,10),currentKbps:n.bitrate?parseFloat(n.bitrate.replace("kbits/s","")):0,targetSize:parseInt(n.size||n.Lsize,10),timemark:n.time};if(o._ffprobeData&&o._ffprobeData.format&&o._ffprobeData.format.duration){var a=Number(o._ffprobeData.format.duration);isNaN(a)||(i.percent=ei.timemarkToSeconds(i.timemark)/a*100)}o.emit("progress",i)}},extractError:function(o){return o.split(Qn).reduce(function(e,n){return n.charAt(0)===" "||n.charAt(0)==="["?[]:(e.push(n),e)},[]).join(`
`)},linesRing:function(o){var e=[],n=[],i=null,a=!1,t=o-1;function r(s){e.forEach(function(u){u(s)})}return{callback:function(s){n.forEach(function(u){s(u)}),e.push(s)},append:function(s){if(!a&&(s instanceof Buffer&&(s=""+s),!(!s||s.length===0))){var u=s.split(Qn);u.length===1?i!==null?i=i+u.shift():i=u.shift():(i!==null&&(i=i+u.shift(),r(i),n.push(i)),i=u.pop(),u.forEach(function(f){r(f),n.push(f)}),t>-1&&n.length>t&&n.splice(0,n.length-t))}},get:function(){return i!==null?n.concat([i]).join(`
`):n.join(`
`)},close:function(){a||(i!==null&&(r(i),n.push(i),t>-1&&n.length>t&&n.shift(),i=null),a=!0)}}}},Se=Zo.exports,$t,ti;function fa(){if(ti)return $t;ti=1;var o=Se;return $t=function(e){e.mergeAdd=e.addInput=e.input=function(n){var i=!1,a=!1;if(typeof n!="string"){if(!("readable"in n)||!n.readable)throw new Error("Invalid input");var t=this._inputs.some(function(s){return s.isStream});if(t)throw new Error("Only one input stream is supported");a=!0,n.pause()}else{var r=n.match(/^([a-z]{2,}):/i);i=!r||r[0]==="file"}return this._inputs.push(this._currentInput={source:n,isFile:i,isStream:a,options:o.args()}),this},e.withInputFormat=e.inputFormat=e.fromFormat=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-f",n),this},e.withInputFps=e.withInputFPS=e.withFpsInput=e.withFPSInput=e.inputFPS=e.inputFps=e.fpsInput=e.FPSInput=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-r",n),this},e.nativeFramerate=e.withNativeFramerate=e.native=function(){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-re"),this},e.setStartTime=e.seekInput=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-ss",n),this},e.loop=function(n){if(!this._currentInput)throw new Error("No input specified");return this._currentInput.options("-loop","1"),typeof n<"u"&&this.duration(n),this}},$t}var qt,ri;function pa(){if(ri)return qt;ri=1;var o=Se;return qt=function(e){e.withNoAudio=e.noAudio=function(){return this._currentOutput.audio.clear(),this._currentOutput.audioFilters.clear(),this._currentOutput.audio("-an"),this},e.withAudioCodec=e.audioCodec=function(n){return this._currentOutput.audio("-acodec",n),this},e.withAudioBitrate=e.audioBitrate=function(n){return this._currentOutput.audio("-b:a",(""+n).replace(/k?$/,"k")),this},e.withAudioChannels=e.audioChannels=function(n){return this._currentOutput.audio("-ac",n),this},e.withAudioFrequency=e.audioFrequency=function(n){return this._currentOutput.audio("-ar",n),this},e.withAudioQuality=e.audioQuality=function(n){return this._currentOutput.audio("-aq",n),this},e.withAudioFilter=e.withAudioFilters=e.audioFilter=e.audioFilters=function(n){return arguments.length>1&&(n=[].slice.call(arguments)),Array.isArray(n)||(n=[n]),this._currentOutput.audioFilters(o.makeFilterStrings(n)),this}},qt}var kt,ni;function ha(){if(ni)return kt;ni=1;var o=Se;return kt=function(e){e.withNoVideo=e.noVideo=function(){return this._currentOutput.video.clear(),this._currentOutput.videoFilters.clear(),this._currentOutput.video("-vn"),this},e.withVideoCodec=e.videoCodec=function(n){return this._currentOutput.video("-vcodec",n),this},e.withVideoBitrate=e.videoBitrate=function(n,i){return n=(""+n).replace(/k?$/,"k"),this._currentOutput.video("-b:v",n),i&&this._currentOutput.video("-maxrate",n,"-minrate",n,"-bufsize","3M"),this},e.withVideoFilter=e.withVideoFilters=e.videoFilter=e.videoFilters=function(n){return arguments.length>1&&(n=[].slice.call(arguments)),Array.isArray(n)||(n=[n]),this._currentOutput.videoFilters(o.makeFilterStrings(n)),this},e.withOutputFps=e.withOutputFPS=e.withFpsOutput=e.withFPSOutput=e.withFps=e.withFPS=e.outputFPS=e.outputFps=e.fpsOutput=e.FPSOutput=e.fps=e.FPS=function(n){return this._currentOutput.video("-r",n),this},e.takeFrames=e.withFrames=e.frames=function(n){return this._currentOutput.video("-vframes",n),this}},kt}var Bt,ii;function da(){if(ii)return Bt;ii=1;function o(n,i,a,t){return[{filter:"scale",options:{w:"if(gt(a,"+a+"),"+n+",trunc("+i+"*a/2)*2)",h:"if(lt(a,"+a+"),"+i+",trunc("+n+"/a/2)*2)"}},{filter:"pad",options:{w:n,h:i,x:"if(gt(a,"+a+"),0,("+n+"-iw)/2)",y:"if(lt(a,"+a+"),0,("+i+"-ih)/2)",color:t}}]}function e(n,i,a){var t=n.sizeData=n.sizeData||{};if(t[i]=a,!("size"in t))return[];var r=t.size.match(/([0-9]+)x([0-9]+)/),s=t.size.match(/([0-9]+)x\?/),u=t.size.match(/\?x([0-9]+)/),f=t.size.match(/\b([0-9]{1,3})%/),l,h,c;if(f){var g=Number(f[1])/100;return[{filter:"scale",options:{w:"trunc(iw*"+g+"/2)*2",h:"trunc(ih*"+g+"/2)*2"}}]}else{if(r)return l=Math.round(Number(r[1])/2)*2,h=Math.round(Number(r[2])/2)*2,c=l/h,t.pad?o(l,h,c,t.pad):[{filter:"scale",options:{w:l,h}}];if(s||u)return"aspect"in t?(l=s?s[1]:Math.round(Number(u[1])*t.aspect),h=u?u[1]:Math.round(Number(s[1])/t.aspect),l=Math.round(l/2)*2,h=Math.round(h/2)*2,t.pad?o(l,h,t.aspect,t.pad):[{filter:"scale",options:{w:l,h}}]):s?[{filter:"scale",options:{w:Math.round(Number(s[1])/2)*2,h:"trunc(ow/a/2)*2"}}]:[{filter:"scale",options:{w:"trunc(oh*a/2)*2",h:Math.round(Number(u[1])/2)*2}}];throw new Error("Invalid size specified: "+t.size)}}return Bt=function(n){n.keepPixelAspect=n.keepDisplayAspect=n.keepDisplayAspectRatio=n.keepDAR=function(){return this.videoFilters([{filter:"scale",options:{w:"if(gt(sar,1),iw*sar,iw)",h:"if(lt(sar,1),ih/sar,ih)"}},{filter:"setsar",options:"1"}])},n.withSize=n.setSize=n.size=function(i){var a=e(this._currentOutput,"size",i);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(a),this},n.withAspect=n.withAspectRatio=n.setAspect=n.setAspectRatio=n.aspect=n.aspectRatio=function(i){var a=Number(i);if(isNaN(a)){var t=i.match(/^(\d+):(\d+)$/);if(t)a=Number(t[1])/Number(t[2]);else throw new Error("Invalid aspect ratio: "+i)}var r=e(this._currentOutput,"aspect",a);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(r),this},n.applyAutopadding=n.applyAutoPadding=n.applyAutopad=n.applyAutoPad=n.withAutopadding=n.withAutoPadding=n.withAutopad=n.withAutoPad=n.autoPad=n.autopad=function(i,a){typeof i=="string"&&(a=i,i=!0),typeof i>"u"&&(i=!0);var t=e(this._currentOutput,"pad",i?a||"black":!1);return this._currentOutput.sizeFilters.clear(),this._currentOutput.sizeFilters(t),this}},Bt}var Ut,oi;function ma(){if(oi)return Ut;oi=1;var o=Se;return Ut=function(e){e.addOutput=e.output=function(n,i){var a=!1;if(!n&&this._currentOutput)throw new Error("Invalid output");if(n&&typeof n!="string"){if(!("writable"in n)||!n.writable)throw new Error("Invalid output")}else if(typeof n=="string"){var t=n.match(/^([a-z]{2,}):/i);a=!t||t[0]==="file"}if(n&&!("target"in this._currentOutput))this._currentOutput.target=n,this._currentOutput.isFile=a,this._currentOutput.pipeopts=i||{};else{if(n&&typeof n!="string"){var r=this._outputs.some(function(u){return typeof u.target!="string"});if(r)throw new Error("Only one output stream is supported")}this._outputs.push(this._currentOutput={target:n,isFile:a,flags:{},pipeopts:i||{}});var s=this;["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(u){s._currentOutput[u]=o.args()}),n||delete this._currentOutput.target}return this},e.seekOutput=e.seek=function(n){return this._currentOutput.options("-ss",n),this},e.withDuration=e.setDuration=e.duration=function(n){return this._currentOutput.options("-t",n),this},e.toFormat=e.withOutputFormat=e.outputFormat=e.format=function(n){return this._currentOutput.options("-f",n),this},e.map=function(n){return this._currentOutput.options("-map",n.replace(o.streamRegexp,"[$1]")),this},e.updateFlvMetadata=e.flvmeta=function(){return this._currentOutput.flags.flvmeta=!0,this}},Ut}var Xt,si;function ga(){if(si)return Xt;si=1;var o=Se;return Xt=function(e){e.addInputOption=e.addInputOptions=e.withInputOption=e.withInputOptions=e.inputOption=e.inputOptions=function(n){if(!this._currentInput)throw new Error("No input specified");var i=!0;return arguments.length>1&&(n=[].slice.call(arguments),i=!1),Array.isArray(n)||(n=[n]),this._currentInput.options(n.reduce(function(a,t){var r=String(t).split(" ");return i&&r.length===2?a.push(r[0],r[1]):a.push(t),a},[])),this},e.addOutputOption=e.addOutputOptions=e.addOption=e.addOptions=e.withOutputOption=e.withOutputOptions=e.withOption=e.withOptions=e.outputOption=e.outputOptions=function(n){var i=!0;return arguments.length>1&&(n=[].slice.call(arguments),i=!1),Array.isArray(n)||(n=[n]),this._currentOutput.options(n.reduce(function(a,t){var r=String(t).split(" ");return i&&r.length===2?a.push(r[0],r[1]):a.push(t),a},[])),this},e.filterGraph=e.complexFilter=function(n,i){if(this._complexFilters.clear(),Array.isArray(n)||(n=[n]),this._complexFilters("-filter_complex",o.makeFilterStrings(n).join(";")),Array.isArray(i)){var a=this;i.forEach(function(t){a._complexFilters("-map",t.replace(o.streamRegexp,"[$1]"))})}else typeof i=="string"&&this._complexFilters("-map",i.replace(o.streamRegexp,"[$1]"));return this}},Xt}function ya(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Vt,ai;function va(){if(ai)return Vt;ai=1;var o=Q;return Vt=function(e){e.usingPreset=e.preset=function(n){if(typeof n=="function")n(this);else try{var i=o.join(this.options.presets,n),a=ya(i);if(typeof a.load=="function")a.load(this);else throw new Error("preset "+i+" has no load() function")}catch(t){throw new Error("preset "+i+" could not be loaded: "+t.message)}return this}},Vt}var zt={exports:{}},ui;function Fn(){return ui||(ui=1,function(o){(function(){var e={},n,i;n=this,n!=null&&(i=n.async),e.noConflict=function(){return n.async=i,e};function a(v){var A=!1;return function(){if(A)throw new Error("Callback was already called.");A=!0,v.apply(n,arguments)}}var t=function(v,A){if(v.forEach)return v.forEach(A);for(var T=0;T<v.length;T+=1)A(v[T],T,v)},r=function(v,A){if(v.map)return v.map(A);var T=[];return t(v,function(p,O,I){T.push(A(p,O,I))}),T},s=function(v,A,T){return v.reduce?v.reduce(A,T):(t(v,function(p,O,I){T=A(T,p,O,I)}),T)},u=function(v){if(Object.keys)return Object.keys(v);var A=[];for(var T in v)v.hasOwnProperty(T)&&A.push(T);return A};typeof process>"u"||!process.nextTick?typeof setImmediate=="function"?(e.nextTick=function(v){setImmediate(v)},e.setImmediate=e.nextTick):(e.nextTick=function(v){setTimeout(v,0)},e.setImmediate=e.nextTick):(e.nextTick=process.nextTick,typeof setImmediate<"u"?e.setImmediate=function(v){setImmediate(v)}:e.setImmediate=e.nextTick),e.each=function(v,A,T){if(T=T||function(){},!v.length)return T();var p=0;t(v,function(O){A(O,a(function(I){I?(T(I),T=function(){}):(p+=1,p>=v.length&&T(null))}))})},e.forEach=e.each,e.eachSeries=function(v,A,T){if(T=T||function(){},!v.length)return T();var p=0,O=function(){A(v[p],function(I){I?(T(I),T=function(){}):(p+=1,p>=v.length?T(null):O())})};O()},e.forEachSeries=e.eachSeries,e.eachLimit=function(v,A,T,p){var O=f(A);O.apply(null,[v,T,p])},e.forEachLimit=e.eachLimit;var f=function(v){return function(A,T,p){if(p=p||function(){},!A.length||v<=0)return p();var O=0,I=0,M=0;(function U(){if(O>=A.length)return p();for(;M<v&&I<A.length;)I+=1,M+=1,T(A[I-1],function(W){W?(p(W),p=function(){}):(O+=1,M-=1,O>=A.length?p():U())})})()}},l=function(v){return function(){var A=Array.prototype.slice.call(arguments);return v.apply(null,[e.each].concat(A))}},h=function(v,A){return function(){var T=Array.prototype.slice.call(arguments);return A.apply(null,[f(v)].concat(T))}},c=function(v){return function(){var A=Array.prototype.slice.call(arguments);return v.apply(null,[e.eachSeries].concat(A))}},g=function(v,A,T,p){var O=[];A=r(A,function(I,M){return{index:M,value:I}}),v(A,function(I,M){T(I.value,function(U,W){O[I.index]=W,M(U)})},function(I){p(I,O)})};e.map=l(g),e.mapSeries=c(g),e.mapLimit=function(v,A,T,p){return w(A)(v,T,p)};var w=function(v){return h(v,g)};e.reduce=function(v,A,T,p){e.eachSeries(v,function(O,I){T(A,O,function(M,U){A=U,I(M)})},function(O){p(O,A)})},e.inject=e.reduce,e.foldl=e.reduce,e.reduceRight=function(v,A,T,p){var O=r(v,function(I){return I}).reverse();e.reduce(O,A,T,p)},e.foldr=e.reduceRight;var b=function(v,A,T,p){var O=[];A=r(A,function(I,M){return{index:M,value:I}}),v(A,function(I,M){T(I.value,function(U){U&&O.push(I),M()})},function(I){p(r(O.sort(function(M,U){return M.index-U.index}),function(M){return M.value}))})};e.filter=l(b),e.filterSeries=c(b),e.select=e.filter,e.selectSeries=e.filterSeries;var C=function(v,A,T,p){var O=[];A=r(A,function(I,M){return{index:M,value:I}}),v(A,function(I,M){T(I.value,function(U){U||O.push(I),M()})},function(I){p(r(O.sort(function(M,U){return M.index-U.index}),function(M){return M.value}))})};e.reject=l(C),e.rejectSeries=c(C);var F=function(v,A,T,p){v(A,function(O,I){T(O,function(M){M?(p(O),p=function(){}):I()})},function(O){p()})};e.detect=l(F),e.detectSeries=c(F),e.some=function(v,A,T){e.each(v,function(p,O){A(p,function(I){I&&(T(!0),T=function(){}),O()})},function(p){T(!1)})},e.any=e.some,e.every=function(v,A,T){e.each(v,function(p,O){A(p,function(I){I||(T(!1),T=function(){}),O()})},function(p){T(!0)})},e.all=e.every,e.sortBy=function(v,A,T){e.map(v,function(p,O){A(p,function(I,M){I?O(I):O(null,{value:p,criteria:M})})},function(p,O){if(p)return T(p);var I=function(M,U){var W=M.criteria,H=U.criteria;return W<H?-1:W>H?1:0};T(null,r(O.sort(I),function(M){return M.value}))})},e.auto=function(v,A){A=A||function(){};var T=u(v);if(!T.length)return A(null);var p={},O=[],I=function(W){O.unshift(W)},M=function(W){for(var H=0;H<O.length;H+=1)if(O[H]===W){O.splice(H,1);return}},U=function(){t(O.slice(0),function(W){W()})};I(function(){u(p).length===T.length&&(A(null,p),A=function(){})}),t(T,function(W){var H=v[W]instanceof Function?[v[W]]:v[W],J=function(he){var fe=Array.prototype.slice.call(arguments,1);if(fe.length<=1&&(fe=fe[0]),he){var Ee={};t(u(p),function(Le){Ee[Le]=p[Le]}),Ee[W]=fe,A(he,Ee),A=function(){}}else p[W]=fe,e.setImmediate(U)},Y=H.slice(0,Math.abs(H.length-1))||[],Te=function(){return s(Y,function(he,fe){return he&&p.hasOwnProperty(fe)},!0)&&!p.hasOwnProperty(W)};if(Te())H[H.length-1](J,p);else{var Ce=function(){Te()&&(M(Ce),H[H.length-1](J,p))};I(Ce)}})},e.waterfall=function(v,A){if(A=A||function(){},v.constructor!==Array){var T=new Error("First argument to waterfall must be an array of functions");return A(T)}if(!v.length)return A();var p=function(O){return function(I){if(I)A.apply(null,arguments),A=function(){};else{var M=Array.prototype.slice.call(arguments,1),U=O.next();U?M.push(p(U)):M.push(A),e.setImmediate(function(){O.apply(null,M)})}}};p(e.iterator(v))()};var y=function(v,A,T){if(T=T||function(){},A.constructor===Array)v.map(A,function(O,I){O&&O(function(M){var U=Array.prototype.slice.call(arguments,1);U.length<=1&&(U=U[0]),I.call(null,M,U)})},T);else{var p={};v.each(u(A),function(O,I){A[O](function(M){var U=Array.prototype.slice.call(arguments,1);U.length<=1&&(U=U[0]),p[O]=U,I(M)})},function(O){T(O,p)})}};e.parallel=function(v,A){y({map:e.map,each:e.each},v,A)},e.parallelLimit=function(v,A,T){y({map:w(A),each:f(A)},v,T)},e.series=function(v,A){if(A=A||function(){},v.constructor===Array)e.mapSeries(v,function(p,O){p&&p(function(I){var M=Array.prototype.slice.call(arguments,1);M.length<=1&&(M=M[0]),O.call(null,I,M)})},A);else{var T={};e.eachSeries(u(v),function(p,O){v[p](function(I){var M=Array.prototype.slice.call(arguments,1);M.length<=1&&(M=M[0]),T[p]=M,O(I)})},function(p){A(p,T)})}},e.iterator=function(v){var A=function(T){var p=function(){return v.length&&v[T].apply(null,arguments),p.next()};return p.next=function(){return T<v.length-1?A(T+1):null},p};return A(0)},e.apply=function(v){var A=Array.prototype.slice.call(arguments,1);return function(){return v.apply(null,A.concat(Array.prototype.slice.call(arguments)))}};var m=function(v,A,T,p){var O=[];v(A,function(I,M){T(I,function(U,W){O=O.concat(W||[]),M(U)})},function(I){p(I,O)})};e.concat=l(m),e.concatSeries=c(m),e.whilst=function(v,A,T){v()?A(function(p){if(p)return T(p);e.whilst(v,A,T)}):T()},e.doWhilst=function(v,A,T){v(function(p){if(p)return T(p);A()?e.doWhilst(v,A,T):T()})},e.until=function(v,A,T){v()?T():A(function(p){if(p)return T(p);e.until(v,A,T)})},e.doUntil=function(v,A,T){v(function(p){if(p)return T(p);A()?T():e.doUntil(v,A,T)})},e.queue=function(v,A){A===void 0&&(A=1);function T(I,M,U,W){M.constructor!==Array&&(M=[M]),t(M,function(H){var J={data:H,callback:typeof W=="function"?W:null};U?I.tasks.unshift(J):I.tasks.push(J),I.saturated&&I.tasks.length===A&&I.saturated(),e.setImmediate(I.process)})}var p=0,O={tasks:[],concurrency:A,saturated:null,empty:null,drain:null,push:function(I,M){T(O,I,!1,M)},unshift:function(I,M){T(O,I,!0,M)},process:function(){if(p<O.concurrency&&O.tasks.length){var I=O.tasks.shift();O.empty&&O.tasks.length===0&&O.empty(),p+=1;var M=function(){p-=1,I.callback&&I.callback.apply(I,arguments),O.drain&&O.tasks.length+p===0&&O.drain(),O.process()},U=a(M);v(I.data,U)}},length:function(){return O.tasks.length},running:function(){return p}};return O},e.cargo=function(v,A){var T=!1,p=[],O={tasks:p,payload:A,saturated:null,empty:null,drain:null,push:function(I,M){I.constructor!==Array&&(I=[I]),t(I,function(U){p.push({data:U,callback:typeof M=="function"?M:null}),O.saturated&&p.length===A&&O.saturated()}),e.setImmediate(O.process)},process:function I(){if(!T){if(p.length===0){O.drain&&O.drain();return}var M=typeof A=="number"?p.splice(0,A):p.splice(0),U=r(M,function(W){return W.data});O.empty&&O.empty(),T=!0,v(U,function(){T=!1;var W=arguments;t(M,function(H){H.callback&&H.callback.apply(null,W)}),I()})}},length:function(){return p.length},running:function(){return T}};return O};var D=function(v){return function(A){var T=Array.prototype.slice.call(arguments,1);A.apply(null,T.concat([function(p){var O=Array.prototype.slice.call(arguments,1);typeof console<"u"&&(p?console.error&&console.error(p):console[v]&&t(O,function(I){console[v](I)}))}]))}};e.log=D("log"),e.dir=D("dir"),e.memoize=function(v,A){var T={},p={};A=A||function(I){return I};var O=function(){var I=Array.prototype.slice.call(arguments),M=I.pop(),U=A.apply(null,I);U in T?M.apply(null,T[U]):U in p?p[U].push(M):(p[U]=[M],v.apply(null,I.concat([function(){T[U]=arguments;var W=p[U];delete p[U];for(var H=0,J=W.length;H<J;H++)W[H].apply(null,arguments)}])))};return O.memo=T,O.unmemoized=v,O},e.unmemoize=function(v){return function(){return(v.unmemoized||v).apply(null,arguments)}},e.times=function(v,A,T){for(var p=[],O=0;O<v;O++)p.push(O);return e.map(p,A,T)},e.timesSeries=function(v,A,T){for(var p=[],O=0;O<v;O++)p.push(O);return e.mapSeries(p,A,T)},e.compose=function(){var v=Array.prototype.reverse.call(arguments);return function(){var A=this,T=Array.prototype.slice.call(arguments),p=T.pop();e.reduce(v,T,function(O,I,M){I.apply(A,O.concat([function(){var U=arguments[0],W=Array.prototype.slice.call(arguments,1);M(U,W)}]))},function(O,I){p.apply(A,[O].concat(I))})}};var _=function(v,A){var T=function(){var O=this,I=Array.prototype.slice.call(arguments),M=I.pop();return v(A,function(U,W){U.apply(O,I.concat([W]))},M)};if(arguments.length>2){var p=Array.prototype.slice.call(arguments,2);return T.apply(this,p)}else return T};e.applyEach=l(_),e.applyEachSeries=c(_),e.forever=function(v,A){function T(p){if(p){if(A)return A(p);throw p}v(T)}T()},o.exports?o.exports=e:n.async=e})()}(zt)),zt.exports}var Wt,ci;function wa(){if(ci)return Wt;ci=1;var o=nt.spawn,e=Fn(),n=Se;function i(a){a._inputs[0].isStream||a.ffprobe(0,function(r,s){a._ffprobeData=s})}return Wt=function(a){a._spawnFfmpeg=function(t,r,s,u){typeof r=="function"&&(u=s,s=r,r={}),typeof u>"u"&&(u=s,s=function(){});var f="stdoutLines"in r?r.stdoutLines:this.options.stdoutLines;this._getFfmpegPath(function(l,h){if(l)return u(l);if(!h||h.length===0)return u(new Error("Cannot find ffmpeg"));r.niceness&&r.niceness!==0&&!n.isWindows&&(t.unshift("-n",r.niceness,h),h="nice");var c=n.linesRing(f),g=!1,w=n.linesRing(f),b=!1,C=o(h,t,r);C.stderr&&C.stderr.setEncoding("utf8"),C.on("error",function(D){u(D)});var F=null;function y(D){D&&(F=D),m&&(g||!r.captureStdout)&&b&&u(F,c,w)}var m=!1;C.on("exit",function(D,_){m=!0,_?y(new Error("ffmpeg was killed with signal "+_)):D?y(new Error("ffmpeg exited with code "+D)):y()}),r.captureStdout&&(C.stdout.on("data",function(D){c.append(D)}),C.stdout.on("close",function(){c.close(),g=!0,y()})),C.stderr.on("data",function(D){w.append(D)}),C.stderr.on("close",function(){w.close(),b=!0,y()}),s(C,c,w)})},a._getArguments=function(){var t=this._complexFilters.get(),r=this._outputs.some(function(s){return s.isFile});return[].concat(this._inputs.reduce(function(s,u){var f=typeof u.source=="string"?u.source:"pipe:0";return s.concat(u.options.get(),["-i",f])},[]),this._global.get(),r?["-y"]:[],t,this._outputs.reduce(function(s,u){var f=n.makeFilterStrings(u.sizeFilters.get()),l=u.audioFilters.get(),h=u.videoFilters.get().concat(f),c;return u.target?typeof u.target=="string"?c=[u.target]:c=["pipe:1"]:c=[],s.concat(u.audio.get(),l.length?["-filter:a",l.join(",")]:[],u.video.get(),h.length?["-filter:v",h.join(",")]:[],u.options.get(),c)},[]))},a._prepare=function(t,r){var s=this;e.waterfall([function(u){s._checkCapabilities(u)},function(u){if(!r)return u();s.ffprobe(0,function(f,l){f||(s._ffprobeData=l),u()})},function(u){var f=s._outputs.some(function(l){return l.flags.flvmeta&&!l.isFile&&(s.logger.warn("Updating flv metadata is only supported for files"),l.flags.flvmeta=!1),l.flags.flvmeta});f?s._getFlvtoolPath(function(l){u(l)}):u()},function(u){var f;try{f=s._getArguments()}catch(l){return u(l)}u(null,f)},function(u,f){s.availableEncoders(function(l,h){for(var c=0;c<u.length;c++)(u[c]==="-acodec"||u[c]==="-vcodec")&&(c++,u[c]in h&&h[u[c]].experimental&&(u.splice(c+1,0,"-strict","experimental"),c+=2));f(null,u)})}],t),r||(this.listeners("progress").length>0?i(this):this.once("newListener",function(u){u==="progress"&&i(this)}))},a.exec=a.execute=a.run=function(){var t=this,r=this._outputs.some(function(h){return"target"in h});if(!r)throw new Error("No output specified");var s=this._outputs.filter(function(h){return typeof h.target!="string"})[0],u=this._inputs.filter(function(h){return typeof h.source!="string"})[0],f=!1;function l(h,c,g){f||(f=!0,h?t.emit("error",h,c,g):t.emit("end",c,g))}return t._prepare(function(h,c){if(h)return l(h);t._spawnFfmpeg(c,{captureStdout:!s,niceness:t.options.niceness,cwd:t.options.cwd,windowsHide:!0},function(w,b,C){if(t.ffmpegProc=w,t.emit("start","ffmpeg "+c.join(" ")),u&&(u.source.on("error",function(m){var D=new Error("Input stream error: "+m.message);D.inputStreamError=m,l(D),w.kill()}),u.source.resume(),u.source.pipe(w.stdin),w.stdin.on("error",function(){})),t.options.timeout&&(t.processTimer=setTimeout(function(){var m="process ran into a timeout ("+t.options.timeout+"s)";l(new Error(m),b.get(),C.get()),w.kill()},t.options.timeout*1e3)),s&&(w.stdout.pipe(s.target,s.pipeopts),s.target.on("close",function(){t.logger.debug("Output stream closed, scheduling kill for ffmpeg process"),setTimeout(function(){l(new Error("Output stream closed")),w.kill()},20)}),s.target.on("error",function(m){t.logger.debug("Output stream error, killing ffmpeg process");var D=new Error("Output stream error: "+m.message);D.outputStreamError=m,l(D,b.get(),C.get()),w.kill("SIGKILL")})),C){if(t.listeners("stderr").length&&C.callback(function(m){t.emit("stderr",m)}),t.listeners("codecData").length){var F=!1,y={};C.callback(function(m){F||(F=n.extractCodecData(t,m,y))})}t.listeners("progress").length&&C.callback(function(m){n.extractProgress(t,m)})}},function(w,b,C){if(clearTimeout(t.processTimer),delete t.ffmpegProc,w)w.message.match(/ffmpeg exited with code/)&&(w.message+=": "+n.extractError(C.get())),l(w,b.get(),C.get());else{var F=t._outputs.filter(function(y){return y.flags.flvmeta});F.length?t._getFlvtoolPath(function(y,m){if(y)return l(y);e.each(F,function(D,_){o(m,["-U",D.target],{windowsHide:!0}).on("error",function(v){_(new Error("Error running "+m+" on "+D.target+": "+v.message))}).on("exit",function(v,A){v!==0||A?_(new Error(m+" "+(A?"received signal "+A:"exited with code "+v))+" when running on "+D.target):_()})},function(D){D?l(D):l(null,b.get(),C.get())})}):l(null,b.get(),C.get())}})}),this},a.renice=function(t){if(!n.isWindows&&(t=t||0,(t<-20||t>20)&&this.logger.warn("Invalid niceness value: "+t+", must be between -20 and 20"),t=Math.min(20,Math.max(-20,t)),this.options.niceness=t,this.ffmpegProc)){var r=this.logger,s=this.ffmpegProc.pid,u=o("renice",[t,"-p",s],{windowsHide:!0});u.on("error",function(f){r.warn("could not renice process "+s+": "+f.message)}),u.on("exit",function(f,l){l?r.warn("could not renice process "+s+": renice was killed by signal "+l):f?r.warn("could not renice process "+s+": renice exited with "+f):r.info("successfully reniced process "+s+" to "+t+" niceness")})}return this},a.kill=function(t){return this.ffmpegProc?this.ffmpegProc.kill(t||"SIGKILL"):this.logger.warn("No running ffmpeg process, cannot send signal"),this}},Wt}var Ht,li;function Ea(){if(li)return Ht;li=1;var o=ae,e=Q,n=Fn(),i=Se,a=/^\s*([D ])([E ])([VAS])([S ])([D ])([T ]) ([^ ]+) +(.*)$/,t=/^\s*([D\.])([E\.])([VAS])([I\.])([L\.])([S\.]) ([^ ]+) +(.*)$/,r=/\(encoders:([^\)]+)\)/,s=/\(decoders:([^\)]+)\)/,u=/^\s*([VAS\.])([F\.])([S\.])([X\.])([B\.])([D\.]) ([^ ]+) +(.*)$/,f=/^\s*([D ])([E ])\s+([^ ]+)\s+(.*)$/,l=/\r\n|\r|\n/,h=/^(?: [T\.][S\.][C\.] )?([^ ]+) +(AA?|VV?|\|)->(AA?|VV?|\|) +(.*)$/,c={};return Ht=function(g){g.setFfmpegPath=function(w){return c.ffmpegPath=w,this},g.setFfprobePath=function(w){return c.ffprobePath=w,this},g.setFlvtoolPath=function(w){return c.flvtoolPath=w,this},g._forgetPaths=function(){delete c.ffmpegPath,delete c.ffprobePath,delete c.flvtoolPath},g._getFfmpegPath=function(w){if("ffmpegPath"in c)return w(null,c.ffmpegPath);n.waterfall([function(b){process.env.FFMPEG_PATH?o.exists(process.env.FFMPEG_PATH,function(C){C?b(null,process.env.FFMPEG_PATH):b(null,"")}):b(null,"")},function(b,C){if(b.length)return C(null,b);i.which("ffmpeg",function(F,y){C(F,y)})}],function(b,C){b?w(b):w(null,c.ffmpegPath=C||"")})},g._getFfprobePath=function(w){var b=this;if("ffprobePath"in c)return w(null,c.ffprobePath);n.waterfall([function(C){process.env.FFPROBE_PATH?o.exists(process.env.FFPROBE_PATH,function(F){C(null,F?process.env.FFPROBE_PATH:"")}):C(null,"")},function(C,F){if(C.length)return F(null,C);i.which("ffprobe",function(y,m){F(y,m)})},function(C,F){if(C.length)return F(null,C);b._getFfmpegPath(function(y,m){if(y)F(y);else if(m.length){var D=i.isWindows?"ffprobe.exe":"ffprobe",_=e.join(e.dirname(m),D);o.exists(_,function(v){F(null,v?_:"")})}else F(null,"")})}],function(C,F){C?w(C):w(null,c.ffprobePath=F||"")})},g._getFlvtoolPath=function(w){if("flvtoolPath"in c)return w(null,c.flvtoolPath);n.waterfall([function(b){process.env.FLVMETA_PATH?o.exists(process.env.FLVMETA_PATH,function(C){b(null,C?process.env.FLVMETA_PATH:"")}):b(null,"")},function(b,C){if(b.length)return C(null,b);process.env.FLVTOOL2_PATH?o.exists(process.env.FLVTOOL2_PATH,function(F){C(null,F?process.env.FLVTOOL2_PATH:"")}):C(null,"")},function(b,C){if(b.length)return C(null,b);i.which("flvmeta",function(F,y){C(F,y)})},function(b,C){if(b.length)return C(null,b);i.which("flvtool2",function(F,y){C(F,y)})}],function(b,C){b?w(b):w(null,c.flvtoolPath=C||"")})},g.availableFilters=g.getAvailableFilters=function(w){if("filters"in c)return w(null,c.filters);this._spawnFfmpeg(["-filters"],{captureStdout:!0,stdoutLines:0},function(b,C){if(b)return w(b);var F=C.get(),y=F.split(`
`),m={},D={A:"audio",V:"video","|":"none"};y.forEach(function(_){var v=_.match(h);v&&(m[v[1]]={description:v[4],input:D[v[2].charAt(0)],multipleInputs:v[2].length>1,output:D[v[3].charAt(0)],multipleOutputs:v[3].length>1})}),w(null,c.filters=m)})},g.availableCodecs=g.getAvailableCodecs=function(w){if("codecs"in c)return w(null,c.codecs);this._spawnFfmpeg(["-codecs"],{captureStdout:!0,stdoutLines:0},function(b,C){if(b)return w(b);var F=C.get(),y=F.split(l),m={};y.forEach(function(D){var _=D.match(a);if(_&&_[7]!=="="&&(m[_[7]]={type:{V:"video",A:"audio",S:"subtitle"}[_[3]],description:_[8],canDecode:_[1]==="D",canEncode:_[2]==="E",drawHorizBand:_[4]==="S",directRendering:_[5]==="D",weirdFrameTruncation:_[6]==="T"}),_=D.match(t),_&&_[7]!=="="){var v=m[_[7]]={type:{V:"video",A:"audio",S:"subtitle"}[_[3]],description:_[8],canDecode:_[1]==="D",canEncode:_[2]==="E",intraFrameOnly:_[4]==="I",isLossy:_[5]==="L",isLossless:_[6]==="S"},A=v.description.match(r);A=A?A[1].trim().split(" "):[];var T=v.description.match(s);if(T=T?T[1].trim().split(" "):[],A.length||T.length){var p={};i.copy(v,p),delete p.canEncode,delete p.canDecode,A.forEach(function(O){m[O]={},i.copy(p,m[O]),m[O].canEncode=!0}),T.forEach(function(O){O in m||(m[O]={},i.copy(p,m[O])),m[O].canDecode=!0})}}}),w(null,c.codecs=m)})},g.availableEncoders=g.getAvailableEncoders=function(w){if("encoders"in c)return w(null,c.encoders);this._spawnFfmpeg(["-encoders"],{captureStdout:!0,stdoutLines:0},function(b,C){if(b)return w(b);var F=C.get(),y=F.split(l),m={};y.forEach(function(D){var _=D.match(u);_&&_[7]!=="="&&(m[_[7]]={type:{V:"video",A:"audio",S:"subtitle"}[_[1]],description:_[8],frameMT:_[2]==="F",sliceMT:_[3]==="S",experimental:_[4]==="X",drawHorizBand:_[5]==="B",directRendering:_[6]==="D"})}),w(null,c.encoders=m)})},g.availableFormats=g.getAvailableFormats=function(w){if("formats"in c)return w(null,c.formats);this._spawnFfmpeg(["-formats"],{captureStdout:!0,stdoutLines:0},function(b,C){if(b)return w(b);var F=C.get(),y=F.split(l),m={};y.forEach(function(D){var _=D.match(f);_&&_[3].split(",").forEach(function(v){v in m||(m[v]={description:_[4],canDemux:!1,canMux:!1}),_[1]==="D"&&(m[v].canDemux=!0),_[2]==="E"&&(m[v].canMux=!0)})}),w(null,c.formats=m)})},g._checkCapabilities=function(w){var b=this;n.waterfall([function(C){b.availableFormats(C)},function(C,F){var y;if(y=b._outputs.reduce(function(m,D){var _=D.options.find("-f",1);return _&&(!(_[0]in C)||!C[_[0]].canMux)&&m.push(_),m},[]),y.length===1)return F(new Error("Output format "+y[0]+" is not available"));if(y.length>1)return F(new Error("Output formats "+y.join(", ")+" are not available"));if(y=b._inputs.reduce(function(m,D){var _=D.options.find("-f",1);return _&&(!(_[0]in C)||!C[_[0]].canDemux)&&m.push(_[0]),m},[]),y.length===1)return F(new Error("Input format "+y[0]+" is not available"));if(y.length>1)return F(new Error("Input formats "+y.join(", ")+" are not available"));F()},function(C){b.availableEncoders(C)},function(C,F){var y;if(y=b._outputs.reduce(function(m,D){var _=D.audio.find("-acodec",1);return _&&_[0]!=="copy"&&(!(_[0]in C)||C[_[0]].type!=="audio")&&m.push(_[0]),m},[]),y.length===1)return F(new Error("Audio codec "+y[0]+" is not available"));if(y.length>1)return F(new Error("Audio codecs "+y.join(", ")+" are not available"));if(y=b._outputs.reduce(function(m,D){var _=D.video.find("-vcodec",1);return _&&_[0]!=="copy"&&(!(_[0]in C)||C[_[0]].type!=="video")&&m.push(_[0]),m},[]),y.length===1)return F(new Error("Video codec "+y[0]+" is not available"));if(y.length>1)return F(new Error("Video codecs "+y.join(", ")+" are not available"));F()}],w)}},Ht}var Gt,fi;function ba(){if(fi)return Gt;fi=1;var o=nt.spawn;function e(a){return a.match(/^TAG:/)}function n(a){return a.match(/^DISPOSITION:/)}function i(a){var t=a.split(/\r\n|\r|\n/);t=t.filter(function(h){return h.length>0});var r={streams:[],format:{},chapters:[]};function s(h){for(var c={},g=t.shift();typeof g<"u";){if(g.toLowerCase()=="[/"+h+"]")return c;if(g.match(/^\[/)){g=t.shift();continue}var w=g.match(/^([^=]+)=(.*)$/);w&&(!w[1].match(/^TAG:/)&&w[2].match(/^[0-9]+(\.[0-9]+)?$/)?c[w[1]]=Number(w[2]):c[w[1]]=w[2]),g=t.shift()}return c}for(var u=t.shift();typeof u<"u";){if(u.match(/^\[stream/i)){var f=s("stream");r.streams.push(f)}else if(u.match(/^\[chapter/i)){var l=s("chapter");r.chapters.push(l)}else u.toLowerCase()==="[format]"&&(r.format=s("format"));u=t.shift()}return r}return Gt=function(a){a.ffprobe=function(){var t,r=null,s=[],u,u=arguments[arguments.length-1],f=!1;function l(h,c){f||(f=!0,u(h,c))}switch(arguments.length){case 3:r=arguments[0],s=arguments[1];break;case 2:typeof arguments[0]=="number"?r=arguments[0]:Array.isArray(arguments[0])&&(s=arguments[0]);break}if(r===null){if(!this._currentInput)return l(new Error("No input specified"));t=this._currentInput}else if(t=this._inputs[r],!t)return l(new Error("Invalid input index"));this._getFfprobePath(function(h,c){if(h)return l(h);if(!c)return l(new Error("Cannot find ffprobe"));var g="",w=!1,b="",C=!1,F=t.isStream?"pipe:0":t.source,y=o(c,["-show_streams","-show_format"].concat(s,F),{windowsHide:!0});t.isStream&&(y.stdin.on("error",function(v){["ECONNRESET","EPIPE","EOF"].indexOf(v.code)>=0||l(v)}),y.stdin.on("close",function(){t.source.pause(),t.source.unpipe(y.stdin)}),t.source.pipe(y.stdin)),y.on("error",u);var m=null;function D(v){if(v&&(m=v),_&&w&&C){if(m)return b&&(m.message+=`
`+b),l(m);var A=i(g);[A.format].concat(A.streams).forEach(function(T){if(T){var p=Object.keys(T).filter(e);p.length&&(T.tags=T.tags||{},p.forEach(function(I){T.tags[I.substr(4)]=T[I],delete T[I]}));var O=Object.keys(T).filter(n);O.length&&(T.disposition=T.disposition||{},O.forEach(function(I){T.disposition[I.substr(12)]=T[I],delete T[I]}))}}),l(null,A)}}var _=!1;y.on("exit",function(v,A){_=!0,v?D(new Error("ffprobe exited with code "+v)):A?D(new Error("ffprobe was killed with signal "+A)):D()}),y.stdout.on("data",function(v){g+=v}),y.stdout.on("close",function(){w=!0,D()}),y.stderr.on("data",function(v){b+=v}),y.stderr.on("close",function(){C=!0,D()})})}},Gt}var Kt,pi;function Ta(){if(pi)return Kt;pi=1;var o=ae,e=Q,n=Ws.PassThrough,i=Fn(),a=Se;return Kt=function(r){r.saveToFile=r.save=function(s){return this.output(s).run(),this},r.writeToStream=r.pipe=r.stream=function(s,u){if(s&&!("writable"in s)&&(u=s,s=void 0),!s){if(process.version.match(/v0\.8\./))throw new Error("PassThrough stream is not supported on node v0.8");s=new n}return this.output(s,u).run(),s},r.takeScreenshots=r.thumbnail=r.thumbnails=r.screenshot=r.screenshots=function(s,u){var f=this,l=this._currentInput.source;if(s=s||{count:1},typeof s=="number"&&(s={count:s}),"folder"in s||(s.folder=u||"."),"timestamps"in s&&(s.timemarks=s.timestamps),!("timemarks"in s)){if(!s.count)throw new Error("Cannot take screenshots: neither a count nor a timemark list are specified");var h=100/(1+s.count);s.timemarks=[];for(var c=0;c<s.count;c++)s.timemarks.push(h*(c+1)+"%")}if("size"in s){var g=s.size.match(/^(\d+)x(\d+)$/),w=s.size.match(/^(\d+)x\?$/),b=s.size.match(/^\?x(\d+)$/),C=s.size.match(/^(\d+)%$/);if(!g&&!w&&!b&&!C)throw new Error("Invalid size parameter: "+s.size)}var F;function y(m){F?m(null,F):f.ffprobe(function(D,_){F=_,m(D,_)})}return i.waterfall([function(D){if(s.timemarks.some(function(_){return(""+_).match(/^[\d.]+%$/)})){if(typeof l!="string")return D(new Error("Cannot compute screenshot timemarks with an input stream, please specify fixed timemarks"));y(function(_,v){if(_)D(_);else{var A=v.streams.reduce(function(p,O){return O.codec_type==="video"&&O.width*O.height>p.width*p.height?O:p},{width:0,height:0});if(A.width===0)return D(new Error("No video stream in input, cannot take screenshots"));var T=Number(A.duration);if(isNaN(T)&&(T=Number(v.format.duration)),isNaN(T))return D(new Error("Could not get input duration, please specify fixed timemarks"));s.timemarks=s.timemarks.map(function(p){return(""+p).match(/^([\d.]+)%$/)?T*parseFloat(p)/100:p}),D()}})}else D()},function(D){s.timemarks=s.timemarks.map(function(_){return a.timemarkToSeconds(_)}).sort(function(_,v){return _-v}),D()},function(D){var _=s.filename||"tn.png";if(_.indexOf(".")===-1&&(_+=".png"),s.timemarks.length>1&&!_.match(/%(s|0*i)/)){var v=e.extname(_);_=e.join(e.dirname(_),e.basename(_,v)+"_%i"+v)}D(null,_)},function(D,_){if(D.match(/%[bf]/)){if(typeof l!="string")return _(new Error("Cannot replace %f or %b when using an input stream"));D=D.replace(/%f/g,e.basename(l)).replace(/%b/g,e.basename(l,e.extname(l)))}_(null,D)},function(D,_){if(D.match(/%[whr]/)){if(g)return _(null,D,g[1],g[2]);y(function(v,A){if(v)return _(new Error("Could not determine video resolution to replace %w, %h or %r"));var T=A.streams.reduce(function(I,M){return M.codec_type==="video"&&M.width*M.height>I.width*I.height?M:I},{width:0,height:0});if(T.width===0)return _(new Error("No video stream in input, cannot replace %w, %h or %r"));var p=T.width,O=T.height;w?(O=O*Number(w[1])/p,p=Number(w[1])):b?(p=p*Number(b[1])/O,O=Number(b[1])):C&&(p=p*Number(C[1])/100,O=O*Number(C[1])/100),_(null,D,Math.round(p/2)*2,Math.round(O/2)*2)})}else _(null,D,-1,-1)},function(D,_,v,A){D=D.replace(/%r/g,"%wx%h").replace(/%w/g,_).replace(/%h/g,v),A(null,D)},function(D,_){var v=s.timemarks.map(function(A,T){return D.replace(/%s/g,a.timemarkToSeconds(A)).replace(/%(0*)i/g,function(p,O){var I=""+(T+1);return O.substr(0,Math.max(0,O.length+1-I.length))+I})});f.emit("filenames",v),_(null,v)},function(D,_){o.exists(s.folder,function(v){v?_(null,D):o.mkdir(s.folder,function(A){A?_(A):_(null,D)})})}],function(D,_){if(D)return f.emit("error",D);var v=s.timemarks.length,A,T=[A={filter:"split",options:v,outputs:[]}];if("size"in s){f.size(s.size);var p=f._currentOutput.sizeFilters.get().map(function(U,W){return W>0&&(U.inputs="size"+(W-1)),U.outputs="size"+W,U});A.inputs="size"+(p.length-1),T=p.concat(T),f._currentOutput.sizeFilters.clear()}for(var O=0,I=0;I<v;I++){var M="screen"+I;A.outputs.push(M),I===0&&(O=s.timemarks[I],f.seekInput(O)),f.output(e.join(s.folder,_[I])).frames(1).map(M),I>0&&f.seek(s.timemarks[I]-O)}f.complexFilter(T),f.run()}),this},r.mergeToFile=r.concatenate=r.concat=function(s,u){var f=this._inputs.filter(function(h){return!h.isStream})[0],l=this;return this.ffprobe(this._inputs.indexOf(f),function(h,c){if(h)return l.emit("error",h);var g=c.streams.some(function(b){return b.codec_type==="audio"}),w=c.streams.some(function(b){return b.codec_type==="video"});l.output(s,u).complexFilter({filter:"concat",options:{n:l._inputs.length,v:w?1:0,a:g?1:0}}).run()}),this}},Kt}var Ca=Q,Oa=rt,os=Ue.EventEmitter,En=Se;function te(o,e){if(!(this instanceof te))return new te(o,e);os.call(this),typeof o=="object"&&!("readable"in o)?e=o:(e=e||{},e.source=o),this._inputs=[],e.source&&this.input(e.source),this._outputs=[],this.output();var n=this;["_global","_complexFilters"].forEach(function(i){n[i]=En.args()}),e.stdoutLines="stdoutLines"in e?e.stdoutLines:100,e.presets=e.presets||e.preset||Ca.join(__dirname,"presets"),e.niceness=e.niceness||e.priority||0,this.options=e,this.logger=e.logger||{debug:function(){},info:function(){},warn:function(){},error:function(){}}}Oa.inherits(te,os);var Aa=te;te.prototype.clone=function(){var o=new te,e=this;return o.options=this.options,o.logger=this.logger,o._inputs=this._inputs.map(function(n){return{source:n.source,options:n.options.clone()}}),"target"in this._outputs[0]?(o._outputs=[],o.output()):(o._outputs=[o._currentOutput={flags:{}}],["audio","audioFilters","video","videoFilters","sizeFilters","options"].forEach(function(n){o._currentOutput[n]=e._currentOutput[n].clone()}),this._currentOutput.sizeData&&(o._currentOutput.sizeData={},En.copy(this._currentOutput.sizeData,o._currentOutput.sizeData)),En.copy(this._currentOutput.flags,o._currentOutput.flags)),["_global","_complexFilters"].forEach(function(n){o[n]=e[n].clone()}),o};fa()(te.prototype);pa()(te.prototype);ha()(te.prototype);da()(te.prototype);ma()(te.prototype);ga()(te.prototype);va()(te.prototype);wa()(te.prototype);Ea()(te.prototype);te.setFfmpegPath=function(o){new te().setFfmpegPath(o)};te.setFfprobePath=function(o){new te().setFfprobePath(o)};te.setFlvtoolPath=function(o){new te().setFlvtoolPath(o)};te.availableFilters=te.getAvailableFilters=function(o){new te().availableFilters(o)};te.availableCodecs=te.getAvailableCodecs=function(o){new te().availableCodecs(o)};te.availableFormats=te.getAvailableFormats=function(o){new te().availableFormats(o)};te.availableEncoders=te.getAvailableEncoders=function(o){new te().availableEncoders(o)};ba()(te.prototype);te.ffprobe=function(o){var e=new te(o);e.ffprobe.apply(e,Array.prototype.slice.call(arguments,1))};Ta()(te.prototype);var ss=Aa;const et=Tt(ss);var gt={exports:{}},Yt={exports:{}},hi;function as(){return hi||(hi=1,function(o){let e={};try{e=require("electron")}catch{}e.ipcRenderer&&n(e),o.exports=n;function n({contextBridge:i,ipcRenderer:a}){if(!a)return;a.on("__ELECTRON_LOG_IPC__",(r,s)=>{window.postMessage({cmd:"message",...s})}),a.invoke("__ELECTRON_LOG__",{cmd:"getOptions"}).catch(r=>console.error(new Error(`electron-log isn't initialized in the main process. Please call log.initialize() before. ${r.message}`)));const t={sendToMain(r){try{a.send("__ELECTRON_LOG__",r)}catch(s){console.error("electronLog.sendToMain ",s,"data:",r),a.send("__ELECTRON_LOG__",{cmd:"errorHandler",error:{message:s==null?void 0:s.message,stack:s==null?void 0:s.stack},errorName:"sendToMain"})}},log(...r){t.sendToMain({data:r,level:"info"})}};for(const r of["error","warn","info","verbose","debug","silly"])t[r]=(...s)=>t.sendToMain({data:s,level:r});if(i&&process.contextIsolated)try{i.exposeInMainWorld("__electronLog",t)}catch{}typeof window=="object"?window.__electronLog=t:__electronLog=t}}(Yt)),Yt.exports}var Jt={exports:{}},Qt,di;function Da(){if(di)return Qt;di=1,Qt=o;function o(e){return Object.defineProperties(n,{defaultLabel:{value:"",writable:!0},labelPadding:{value:!0,writable:!0},maxLabelLength:{value:0,writable:!0},labelLength:{get(){switch(typeof n.labelPadding){case"boolean":return n.labelPadding?n.maxLabelLength:0;case"number":return n.labelPadding;default:return 0}}}});function n(i){n.maxLabelLength=Math.max(n.maxLabelLength,i.length);const a={};for(const t of e.levels)a[t]=(...r)=>e.logData(r,{level:t,scope:i});return a.log=a.info,a}}return Qt}var Zt,mi;function _a(){if(mi)return Zt;mi=1;class o{constructor({processMessage:n}){this.processMessage=n,this.buffer=[],this.enabled=!1,this.begin=this.begin.bind(this),this.commit=this.commit.bind(this),this.reject=this.reject.bind(this)}addMessage(n){this.buffer.push(n)}begin(){this.enabled=[]}commit(){this.enabled=!1,this.buffer.forEach(n=>this.processMessage(n)),this.buffer=[]}reject(){this.enabled=!1,this.buffer=[]}}return Zt=o,Zt}var er,gi;function us(){if(gi)return er;gi=1;const o=Da(),e=_a(),i=class i{constructor({allowUnknownLevel:t=!1,dependencies:r={},errorHandler:s,eventLogger:u,initializeFn:f,isDev:l=!1,levels:h=["error","warn","info","verbose","debug","silly"],logId:c,transportFactories:g={},variables:w}={}){Z(this,"dependencies",{});Z(this,"errorHandler",null);Z(this,"eventLogger",null);Z(this,"functions",{});Z(this,"hooks",[]);Z(this,"isDev",!1);Z(this,"levels",null);Z(this,"logId",null);Z(this,"scope",null);Z(this,"transports",{});Z(this,"variables",{});this.addLevel=this.addLevel.bind(this),this.create=this.create.bind(this),this.initialize=this.initialize.bind(this),this.logData=this.logData.bind(this),this.processMessage=this.processMessage.bind(this),this.allowUnknownLevel=t,this.buffering=new e(this),this.dependencies=r,this.initializeFn=f,this.isDev=l,this.levels=h,this.logId=c,this.scope=o(this),this.transportFactories=g,this.variables=w||{};for(const b of this.levels)this.addLevel(b,!1);this.log=this.info,this.functions.log=this.log,this.errorHandler=s,s==null||s.setOptions({...r,logFn:this.error}),this.eventLogger=u,u==null||u.setOptions({...r,logger:this});for(const[b,C]of Object.entries(g))this.transports[b]=C(this,r);i.instances[c]=this}static getInstance({logId:t}){return this.instances[t]||this.instances.default}addLevel(t,r=this.levels.length){r!==!1&&this.levels.splice(r,0,t),this[t]=(...s)=>this.logData(s,{level:t}),this.functions[t]=this[t]}catchErrors(t){return this.processMessage({data:["log.catchErrors is deprecated. Use log.errorHandler instead"],level:"warn"},{transports:["console"]}),this.errorHandler.startCatching(t)}create(t){return typeof t=="string"&&(t={logId:t}),new i({dependencies:this.dependencies,errorHandler:this.errorHandler,initializeFn:this.initializeFn,isDev:this.isDev,transportFactories:this.transportFactories,variables:{...this.variables},...t})}compareLevels(t,r,s=this.levels){const u=s.indexOf(t),f=s.indexOf(r);return f===-1||u===-1?!0:f<=u}initialize(t={}){this.initializeFn({logger:this,...this.dependencies,...t})}logData(t,r={}){this.buffering.enabled?this.buffering.addMessage({data:t,date:new Date,...r}):this.processMessage({data:t,...r})}processMessage(t,{transports:r=this.transports}={}){if(t.cmd==="errorHandler"){this.errorHandler.handle(t.error,{errorName:t.errorName,processType:"renderer",showDialog:!!t.showDialog});return}let s=t.level;this.allowUnknownLevel||(s=this.levels.includes(t.level)?t.level:"info");const u={date:new Date,logId:this.logId,...t,level:s,variables:{...this.variables,...t.variables}};for(const[f,l]of this.transportEntries(r))if(!(typeof l!="function"||l.level===!1)&&this.compareLevels(l.level,t.level))try{const h=this.hooks.reduce((c,g)=>c&&g(c,l,f),u);h&&l({...h,data:[...h.data]})}catch(h){this.processInternalErrorFn(h)}}processInternalErrorFn(t){}transportEntries(t=this.transports){return(Array.isArray(t)?t:Object.entries(t)).map(s=>{switch(typeof s){case"string":return this.transports[s]?[s,this.transports[s]]:null;case"function":return[s.name,s];default:return Array.isArray(s)?s:null}}).filter(Boolean)}};Z(i,"instances",{});let n=i;return er=n,er}var tr,yi;function Na(){if(yi)return tr;yi=1;const o=console.error;class e{constructor({logFn:i=null}={}){Z(this,"logFn",null);Z(this,"onError",null);Z(this,"showDialog",!1);Z(this,"preventDefault",!0);this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.startCatching=this.startCatching.bind(this),this.logFn=i}handle(i,{logFn:a=this.logFn,errorName:t="",onError:r=this.onError,showDialog:s=this.showDialog}={}){try{(r==null?void 0:r({error:i,errorName:t,processType:"renderer"}))!==!1&&a({error:i,errorName:t,showDialog:s})}catch{o(i)}}setOptions({logFn:i,onError:a,preventDefault:t,showDialog:r}){typeof i=="function"&&(this.logFn=i),typeof a=="function"&&(this.onError=a),typeof t=="boolean"&&(this.preventDefault=t),typeof r=="boolean"&&(this.showDialog=r)}startCatching({onError:i,showDialog:a}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:i,showDialog:a}),window.addEventListener("error",t=>{var r;this.preventDefault&&((r=t.preventDefault)==null||r.call(t)),this.handleError(t.error||t)}),window.addEventListener("unhandledrejection",t=>{var r;this.preventDefault&&((r=t.preventDefault)==null||r.call(t)),this.handleRejection(t.reason||t)}))}handleError(i){this.handle(i,{errorName:"Unhandled"})}handleRejection(i){const a=i instanceof Error?i:new Error(JSON.stringify(i));this.handle(a,{errorName:"Unhandled rejection"})}}return tr=e,tr}var rr,vi;function Xe(){if(vi)return rr;vi=1,rr={transform:o};function o({logger:e,message:n,transport:i,initialData:a=(n==null?void 0:n.data)||[],transforms:t=i==null?void 0:i.transforms}){return t.reduce((r,s)=>typeof s=="function"?s({data:r,logger:e,message:n,transport:i}):r,a)}return rr}var nr,wi;function xa(){if(wi)return nr;wi=1;const{transform:o}=Xe();nr=n;const e={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};function n(a){return Object.assign(t,{format:"{h}:{i}:{s}.{ms}{scope} › {text}",transforms:[i],writeFn({message:{level:r,data:s}}){const u=e[r]||e.info;setTimeout(()=>u(...s))}});function t(r){t.writeFn({message:{...r,data:o({logger:a,message:r,transport:t})}})}}function i({data:a=[],logger:t={},message:r={},transport:s={}}){if(typeof s.format=="function")return s.format({data:a,level:(r==null?void 0:r.level)||"info",logger:t,message:r,transport:s});if(typeof s.format!="string")return a;a.unshift(s.format),typeof a[1]=="string"&&a[1].match(/%[1cdfiOos]/)&&(a=[`${a[0]} ${a[1]}`,...a.slice(2)]);const u=r.date||new Date;return a[0]=a[0].replace(/\{(\w+)}/g,(f,l)=>{var h,c;switch(l){case"level":return r.level;case"logId":return r.logId;case"scope":{const g=r.scope||((h=t.scope)==null?void 0:h.defaultLabel);return g?` (${g})`:""}case"text":return"";case"y":return u.getFullYear().toString(10);case"m":return(u.getMonth()+1).toString(10).padStart(2,"0");case"d":return u.getDate().toString(10).padStart(2,"0");case"h":return u.getHours().toString(10).padStart(2,"0");case"i":return u.getMinutes().toString(10).padStart(2,"0");case"s":return u.getSeconds().toString(10).padStart(2,"0");case"ms":return u.getMilliseconds().toString(10).padStart(3,"0");case"iso":return u.toISOString();default:return((c=r.variables)==null?void 0:c[l])||f}}).trim(),a}return nr}var ir,Ei;function Ia(){if(Ei)return ir;Ei=1;const{transform:o}=Xe();ir=n;const e=new Set([Promise,WeakMap,WeakSet]);function n(t){return Object.assign(r,{depth:5,transforms:[a]});function r(s){if(!window.__electronLog){t.processMessage({data:["electron-log: logger isn't initialized in the main process"],level:"error"},{transports:["console"]});return}try{const u=o({initialData:s,logger:t,message:s,transport:r});__electronLog.sendToMain(u)}catch(u){t.transports.console({data:["electronLog.transports.ipc",u,"data:",s.data],level:"error"})}}}function i(t){return Object(t)!==t}function a({data:t,depth:r,seen:s=new WeakSet,transport:u={}}={}){const f=r||u.depth||5;return s.has(t)?"[Circular]":f<1?i(t)?t:Array.isArray(t)?"[Array]":`[${typeof t}]`:["function","symbol"].includes(typeof t)?t.toString():i(t)?t:e.has(t.constructor)?`[${t.constructor.name}]`:Array.isArray(t)?t.map(l=>a({data:l,depth:f-1,seen:s})):t instanceof Date?t.toISOString():t instanceof Error?t.stack:t instanceof Map?new Map(Array.from(t).map(([l,h])=>[a({data:l,depth:f-1,seen:s}),a({data:h,depth:f-1,seen:s})])):t instanceof Set?new Set(Array.from(t).map(l=>a({data:l,depth:f-1,seen:s}))):(s.add(t),Object.fromEntries(Object.entries(t).map(([l,h])=>[l,a({data:h,depth:f-1,seen:s})])))}return ir}var bi;function Fa(){return bi||(bi=1,function(o){const e=us(),n=Na(),i=xa(),a=Ia();o.exports=t(),o.exports.Logger=e,o.exports.default=o.exports;function t(){const r=new e({allowUnknownLevel:!0,errorHandler:new n,initializeFn:()=>{},logId:"default",transportFactories:{console:i,ipc:a},variables:{processType:"renderer"}});return r.errorHandler.setOptions({logFn({error:s,errorName:u,showDialog:f}){r.transports.console({data:[u,s].filter(Boolean),level:"error"}),r.transports.ipc({cmd:"errorHandler",error:{cause:s==null?void 0:s.cause,code:s==null?void 0:s.code,name:s==null?void 0:s.name,message:s==null?void 0:s.message,stack:s==null?void 0:s.stack},errorName:u,logId:r.logId,showDialog:f})}}),typeof window=="object"&&window.addEventListener("message",s=>{const{cmd:u,logId:f,...l}=s.data||{},h=e.getInstance({logId:f});u==="message"&&h.processMessage(l,{transports:["console"]})}),new Proxy(r,{get(s,u){return typeof s[u]<"u"?s[u]:(...f)=>r.logData(f,{level:u})}})}}(Jt)),Jt.exports}var or,Ti;function Sa(){if(Ti)return or;Ti=1;const o=ae,e=Q;or={findAndReadPackageJson:n,tryReadJsonAt:i};function n(){return i(r())||i(t())||i(process.resourcesPath,"app.asar")||i(process.resourcesPath,"app")||i(process.cwd())||{name:void 0,version:void 0}}function i(...s){if(s[0])try{const u=e.join(...s),f=a("package.json",u);if(!f)return;const l=JSON.parse(o.readFileSync(f,"utf8")),h=(l==null?void 0:l.productName)||(l==null?void 0:l.name);return!h||h.toLowerCase()==="electron"?void 0:h?{name:h,version:l==null?void 0:l.version}:void 0}catch{return}}function a(s,u){let f=u;for(;;){const l=e.parse(f),h=l.root,c=l.dir;if(o.existsSync(e.join(f,s)))return e.resolve(e.join(f,s));if(f===h)return null;f=c}}function t(){const s=process.argv.filter(f=>f.indexOf("--user-data-dir=")===0);return s.length===0||typeof s[0]!="string"?null:s[0].replace("--user-data-dir=","")}function r(){var s;try{return(s=require.main)==null?void 0:s.filename}catch{return}}return or}var sr,Ci;function cs(){if(Ci)return sr;Ci=1;const o=nt,e=ke,n=Q,i=Sa();class a{constructor(){Z(this,"appName");Z(this,"appPackageJson");Z(this,"platform",process.platform)}getAppLogPath(r=this.getAppName()){return this.platform==="darwin"?n.join(this.getSystemPathHome(),"Library/Logs",r):n.join(this.getAppUserDataPath(r),"logs")}getAppName(){var s;const r=this.appName||((s=this.getAppPackageJson())==null?void 0:s.name);if(!r)throw new Error("electron-log can't determine the app name. It tried these methods:\n1. Use `electron.app.name`\n2. Use productName or name from the nearest package.json`\nYou can also set it through log.transports.file.setAppName()");return r}getAppPackageJson(){return typeof this.appPackageJson!="object"&&(this.appPackageJson=i.findAndReadPackageJson()),this.appPackageJson}getAppUserDataPath(r=this.getAppName()){return r?n.join(this.getSystemPathAppData(),r):void 0}getAppVersion(){var r;return(r=this.getAppPackageJson())==null?void 0:r.version}getElectronLogPath(){return this.getAppLogPath()}getMacOsVersion(){const r=Number(e.release().split(".")[0]);return r<=19?`10.${r-4}`:r-9}getOsVersion(){let r=e.type().replace("_"," "),s=e.release();return r==="Darwin"&&(r="macOS",s=this.getMacOsVersion()),`${r} ${s}`}getPathVariables(){const r=this.getAppName(),s=this.getAppVersion(),u=this;return{appData:this.getSystemPathAppData(),appName:r,appVersion:s,get electronDefaultDir(){return u.getElectronLogPath()},home:this.getSystemPathHome(),libraryDefaultDir:this.getAppLogPath(r),libraryTemplate:this.getAppLogPath("{appName}"),temp:this.getSystemPathTemp(),userData:this.getAppUserDataPath(r)}}getSystemPathAppData(){const r=this.getSystemPathHome();switch(this.platform){case"darwin":return n.join(r,"Library/Application Support");case"win32":return process.env.APPDATA||n.join(r,"AppData/Roaming");default:return process.env.XDG_CONFIG_HOME||n.join(r,".config")}}getSystemPathHome(){var r;return((r=e.homedir)==null?void 0:r.call(e))||process.env.HOME}getSystemPathTemp(){return e.tmpdir()}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:void 0,os:this.getOsVersion()}}isDev(){return process.env.NODE_ENV==="development"||process.env.ELECTRON_IS_DEV==="1"}isElectron(){return!!process.versions.electron}onAppEvent(r,s){}onAppReady(r){r()}onEveryWebContentsEvent(r,s){}onIpc(r,s){}onIpcInvoke(r,s){}openUrl(r,s=console.error){const f={darwin:"open",win32:"start",linux:"xdg-open"}[process.platform]||"xdg-open";o.exec(`${f} ${r}`,{},l=>{l&&s(l)})}setAppName(r){this.appName=r}setPlatform(r){this.platform=r}setPreloadFileForSessions({filePath:r,includeFutureSession:s=!0,getSessions:u=()=>[]}){}sendIpc(r,s){}showErrorBox(r,s){}}return sr=a,sr}var ar,Oi;function Pa(){if(Oi)return ar;Oi=1;const o=Q,e=cs();class n extends e{constructor({electron:t}={}){super();Z(this,"electron");this.electron=t}getAppName(){var r,s;let t;try{t=this.appName||((r=this.electron.app)==null?void 0:r.name)||((s=this.electron.app)==null?void 0:s.getName())}catch{}return t||super.getAppName()}getAppUserDataPath(t){return this.getPath("userData")||super.getAppUserDataPath(t)}getAppVersion(){var r;let t;try{t=(r=this.electron.app)==null?void 0:r.getVersion()}catch{}return t||super.getAppVersion()}getElectronLogPath(){return this.getPath("logs")||super.getElectronLogPath()}getPath(t){var r;try{return(r=this.electron.app)==null?void 0:r.getPath(t)}catch{return}}getVersions(){return{app:`${this.getAppName()} ${this.getAppVersion()}`,electron:`Electron ${process.versions.electron}`,os:this.getOsVersion()}}getSystemPathAppData(){return this.getPath("appData")||super.getSystemPathAppData()}isDev(){var t;return((t=this.electron.app)==null?void 0:t.isPackaged)!==void 0?!this.electron.app.isPackaged:typeof process.execPath=="string"?o.basename(process.execPath).toLowerCase().startsWith("electron"):super.isDev()}onAppEvent(t,r){var s;return(s=this.electron.app)==null||s.on(t,r),()=>{var u;(u=this.electron.app)==null||u.off(t,r)}}onAppReady(t){var r,s,u;(r=this.electron.app)!=null&&r.isReady()?t():(s=this.electron.app)!=null&&s.once?(u=this.electron.app)==null||u.once("ready",t):t()}onEveryWebContentsEvent(t,r){var u,f,l;return(f=(u=this.electron.webContents)==null?void 0:u.getAllWebContents())==null||f.forEach(h=>{h.on(t,r)}),(l=this.electron.app)==null||l.on("web-contents-created",s),()=>{var h,c;(h=this.electron.webContents)==null||h.getAllWebContents().forEach(g=>{g.off(t,r)}),(c=this.electron.app)==null||c.off("web-contents-created",s)};function s(h,c){c.on(t,r)}}onIpc(t,r){var s;(s=this.electron.ipcMain)==null||s.on(t,r)}onIpcInvoke(t,r){var s,u;(u=(s=this.electron.ipcMain)==null?void 0:s.handle)==null||u.call(s,t,r)}openUrl(t,r=console.error){var s;(s=this.electron.shell)==null||s.openExternal(t).catch(r)}setPreloadFileForSessions({filePath:t,includeFutureSession:r=!0,getSessions:s=()=>{var u;return[(u=this.electron.session)==null?void 0:u.defaultSession]}}){for(const f of s().filter(Boolean))u(f);r&&this.onAppEvent("session-created",f=>{u(f)});function u(f){typeof f.registerPreloadScript=="function"?f.registerPreloadScript({filePath:t,id:"electron-log-preload",type:"frame"}):f.setPreloads([...f.getPreloads(),t])}}sendIpc(t,r){var s,u;(u=(s=this.electron.BrowserWindow)==null?void 0:s.getAllWindows())==null||u.forEach(f=>{var l,h;((l=f.webContents)==null?void 0:l.isDestroyed())===!1&&((h=f.webContents)==null?void 0:h.isCrashed())===!1&&f.webContents.send(t,r)})}showErrorBox(t,r){var s;(s=this.electron.dialog)==null||s.showErrorBox(t,r)}}return ar=n,ar}var ur,Ai;function La(){if(Ai)return ur;Ai=1;const o=ae,e=ke,n=Q,i=as();ur={initialize({externalApi:r,getSessions:s,includeFutureSession:u,logger:f,preload:l=!0,spyRendererConsole:h=!1}){r.onAppReady(()=>{try{l&&a({externalApi:r,getSessions:s,includeFutureSession:u,preloadOption:l}),h&&t({externalApi:r,logger:f})}catch(c){f.warn(c)}})}};function a({externalApi:r,getSessions:s,includeFutureSession:u,preloadOption:f}){let l=typeof f=="string"?f:void 0;try{l=n.resolve(__dirname,"../renderer/electron-log-preload.js")}catch{}if(!l||!o.existsSync(l)){l=n.join(r.getAppUserDataPath()||e.tmpdir(),"electron-log-preload.js");const h=`
      try {
        (${i.toString()})(require('electron'));
      } catch(e) {
        console.error(e);
      }
    `;o.writeFileSync(l,h,"utf8")}r.setPreloadFileForSessions({filePath:l,includeFutureSession:u,getSessions:s})}function t({externalApi:r,logger:s}){const u=["debug","info","warn","error"];r.onEveryWebContentsEvent("console-message",(f,l,h)=>{s.processMessage({data:[h],level:u[l],variables:{processType:"renderer"}})})}return ur}var cr,Di;function Ma(){if(Di)return cr;Di=1;class o{constructor({externalApi:i,logFn:a=void 0,onError:t=void 0,showDialog:r=void 0}={}){Z(this,"externalApi");Z(this,"isActive",!1);Z(this,"logFn");Z(this,"onError");Z(this,"showDialog",!0);this.createIssue=this.createIssue.bind(this),this.handleError=this.handleError.bind(this),this.handleRejection=this.handleRejection.bind(this),this.setOptions({externalApi:i,logFn:a,onError:t,showDialog:r}),this.startCatching=this.startCatching.bind(this),this.stopCatching=this.stopCatching.bind(this)}handle(i,{logFn:a=this.logFn,onError:t=this.onError,processType:r="browser",showDialog:s=this.showDialog,errorName:u=""}={}){var f;i=e(i);try{if(typeof t=="function"){const l=((f=this.externalApi)==null?void 0:f.getVersions())||{},h=this.createIssue;if(t({createIssue:h,error:i,errorName:u,processType:r,versions:l})===!1)return}u?a(u,i):a(i),s&&!u.includes("rejection")&&this.externalApi&&this.externalApi.showErrorBox(`A JavaScript error occurred in the ${r} process`,i.stack)}catch{console.error(i)}}setOptions({externalApi:i,logFn:a,onError:t,showDialog:r}){typeof i=="object"&&(this.externalApi=i),typeof a=="function"&&(this.logFn=a),typeof t=="function"&&(this.onError=t),typeof r=="boolean"&&(this.showDialog=r)}startCatching({onError:i,showDialog:a}={}){this.isActive||(this.isActive=!0,this.setOptions({onError:i,showDialog:a}),process.on("uncaughtException",this.handleError),process.on("unhandledRejection",this.handleRejection))}stopCatching(){this.isActive=!1,process.removeListener("uncaughtException",this.handleError),process.removeListener("unhandledRejection",this.handleRejection)}createIssue(i,a){var t;(t=this.externalApi)==null||t.openUrl(`${i}?${new URLSearchParams(a).toString()}`)}handleError(i){this.handle(i,{errorName:"Unhandled"})}handleRejection(i){const a=i instanceof Error?i:new Error(JSON.stringify(i));this.handle(a,{errorName:"Unhandled rejection"})}}function e(n){if(n instanceof Error)return n;if(n&&typeof n=="object"){if(n.message)return Object.assign(new Error(n.message),n);try{return new Error(JSON.stringify(n))}catch(i){return new Error(`Couldn't normalize error ${String(n)}: ${i}`)}}return new Error(`Can't normalize error ${String(n)}`)}return cr=o,cr}var lr,_i;function Ra(){if(_i)return lr;_i=1;class o{constructor(n={}){Z(this,"disposers",[]);Z(this,"format","{eventSource}#{eventName}:");Z(this,"formatters",{app:{"certificate-error":({args:n})=>this.arrayToObject(n.slice(1,4),["url","error","certificate"]),"child-process-gone":({args:n})=>n.length===1?n[0]:n,"render-process-gone":({args:[n,i]})=>i&&typeof i=="object"?{...i,...this.getWebContentsDetails(n)}:[]},webContents:{"console-message":({args:[n,i,a,t]})=>{if(!(n<3))return{message:i,source:`${t}:${a}`}},"did-fail-load":({args:n})=>this.arrayToObject(n,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"did-fail-provisional-load":({args:n})=>this.arrayToObject(n,["errorCode","errorDescription","validatedURL","isMainFrame","frameProcessId","frameRoutingId"]),"plugin-crashed":({args:n})=>this.arrayToObject(n,["name","version"]),"preload-error":({args:n})=>this.arrayToObject(n,["preloadPath","error"])}});Z(this,"events",{app:{"certificate-error":!0,"child-process-gone":!0,"render-process-gone":!0},webContents:{"did-fail-load":!0,"did-fail-provisional-load":!0,"plugin-crashed":!0,"preload-error":!0,unresponsive:!0}});Z(this,"externalApi");Z(this,"level","error");Z(this,"scope","");this.setOptions(n)}setOptions({events:n,externalApi:i,level:a,logger:t,format:r,formatters:s,scope:u}){typeof n=="object"&&(this.events=n),typeof i=="object"&&(this.externalApi=i),typeof a=="string"&&(this.level=a),typeof t=="object"&&(this.logger=t),(typeof r=="string"||typeof r=="function")&&(this.format=r),typeof s=="object"&&(this.formatters=s),typeof u=="string"&&(this.scope=u)}startLogging(n={}){this.setOptions(n),this.disposeListeners();for(const i of this.getEventNames(this.events.app))this.disposers.push(this.externalApi.onAppEvent(i,(...a)=>{this.handleEvent({eventSource:"app",eventName:i,handlerArgs:a})}));for(const i of this.getEventNames(this.events.webContents))this.disposers.push(this.externalApi.onEveryWebContentsEvent(i,(...a)=>{this.handleEvent({eventSource:"webContents",eventName:i,handlerArgs:a})}))}stopLogging(){this.disposeListeners()}arrayToObject(n,i){const a={};return i.forEach((t,r)=>{a[t]=n[r]}),n.length>i.length&&(a.unknownArgs=n.slice(i.length)),a}disposeListeners(){this.disposers.forEach(n=>n()),this.disposers=[]}formatEventLog({eventName:n,eventSource:i,handlerArgs:a}){var h;const[t,...r]=a;if(typeof this.format=="function")return this.format({args:r,event:t,eventName:n,eventSource:i});const s=(h=this.formatters[i])==null?void 0:h[n];let u=r;if(typeof s=="function"&&(u=s({args:r,event:t,eventName:n,eventSource:i})),!u)return;const f={};return Array.isArray(u)?f.args=u:typeof u=="object"&&Object.assign(f,u),i==="webContents"&&Object.assign(f,this.getWebContentsDetails(t==null?void 0:t.sender)),[this.format.replace("{eventSource}",i==="app"?"App":"WebContents").replace("{eventName}",n),f]}getEventNames(n){return!n||typeof n!="object"?[]:Object.entries(n).filter(([i,a])=>a).map(([i])=>i)}getWebContentsDetails(n){if(!(n!=null&&n.loadURL))return{};try{return{webContents:{id:n.id,url:n.getURL()}}}catch{return{}}}handleEvent({eventName:n,eventSource:i,handlerArgs:a}){var r;const t=this.formatEventLog({eventName:n,eventSource:i,handlerArgs:a});if(t){const s=this.scope?this.logger.scope(this.scope):this.logger;(r=s==null?void 0:s[this.level])==null||r.call(s,...t)}}}return lr=o,lr}var fr,Ni;function ls(){if(Ni)return fr;Ni=1;const{transform:o}=Xe();fr={concatFirstStringElements:e,formatScope:i,formatText:t,formatVariables:a,timeZoneFromOffset:n,format({message:r,logger:s,transport:u,data:f=r==null?void 0:r.data}){switch(typeof u.format){case"string":return o({message:r,logger:s,transforms:[a,i,t],transport:u,initialData:[u.format,...f]});case"function":return u.format({data:f,level:(r==null?void 0:r.level)||"info",logger:s,message:r,transport:u});default:return f}}};function e({data:r}){return typeof r[0]!="string"||typeof r[1]!="string"||r[0].match(/%[1cdfiOos]/)?r:[`${r[0]} ${r[1]}`,...r.slice(2)]}function n(r){const s=Math.abs(r),u=r>0?"-":"+",f=Math.floor(s/60).toString().padStart(2,"0"),l=(s%60).toString().padStart(2,"0");return`${u}${f}:${l}`}function i({data:r,logger:s,message:u}){const{defaultLabel:f,labelLength:l}=(s==null?void 0:s.scope)||{},h=r[0];let c=u.scope;c||(c=f);let g;return c===""?g=l>0?"".padEnd(l+3):"":typeof c=="string"?g=` (${c})`.padEnd(l+3):g="",r[0]=h.replace("{scope}",g),r}function a({data:r,message:s}){let u=r[0];if(typeof u!="string")return r;u=u.replace("{level}]",`${s.level}]`.padEnd(6," "));const f=s.date||new Date;return r[0]=u.replace(/\{(\w+)}/g,(l,h)=>{var c;switch(h){case"level":return s.level||"info";case"logId":return s.logId;case"y":return f.getFullYear().toString(10);case"m":return(f.getMonth()+1).toString(10).padStart(2,"0");case"d":return f.getDate().toString(10).padStart(2,"0");case"h":return f.getHours().toString(10).padStart(2,"0");case"i":return f.getMinutes().toString(10).padStart(2,"0");case"s":return f.getSeconds().toString(10).padStart(2,"0");case"ms":return f.getMilliseconds().toString(10).padStart(3,"0");case"z":return n(f.getTimezoneOffset());case"iso":return f.toISOString();default:return((c=s.variables)==null?void 0:c[h])||l}}).trim(),r}function t({data:r}){const s=r[0];if(typeof s!="string")return r;if(s.lastIndexOf("{text}")===s.length-6)return r[0]=s.replace(/\s?{text}/,""),r[0]===""&&r.shift(),r;const f=s.split("{text}");let l=[];return f[0]!==""&&l.push(f[0]),l=l.concat(r.slice(1)),f[1]!==""&&l.push(f[1]),l}return fr}var pr={exports:{}},xi;function Ct(){return xi||(xi=1,function(o){const e=rt;o.exports={serialize:i,maxDepth({data:a,transport:t,depth:r=(t==null?void 0:t.depth)??6}){if(!a)return a;if(r<1)return Array.isArray(a)?"[array]":typeof a=="object"&&a?"[object]":a;if(Array.isArray(a))return a.map(u=>o.exports.maxDepth({data:u,depth:r-1}));if(typeof a!="object"||a&&typeof a.toISOString=="function")return a;if(a===null)return null;if(a instanceof Error)return a;const s={};for(const u in a)Object.prototype.hasOwnProperty.call(a,u)&&(s[u]=o.exports.maxDepth({data:a[u],depth:r-1}));return s},toJSON({data:a}){return JSON.parse(JSON.stringify(a,n()))},toString({data:a,transport:t}){const r=(t==null?void 0:t.inspectOptions)||{},s=a.map(u=>{if(u!==void 0)try{const f=JSON.stringify(u,n(),"  ");return f===void 0?void 0:JSON.parse(f)}catch{return u}});return e.formatWithOptions(r,...s)}};function n(a={}){const t=new WeakSet;return function(r,s){if(typeof s=="object"&&s!==null){if(t.has(s))return;t.add(s)}return i(r,s,a)}}function i(a,t,r={}){const s=(r==null?void 0:r.serializeMapAndSet)!==!1;return t instanceof Error?t.stack:t&&(typeof t=="function"?`[function] ${t.toString()}`:t instanceof Date?t.toISOString():s&&t instanceof Map&&Object.fromEntries?Object.fromEntries(t):s&&t instanceof Set&&Array.from?Array.from(t):t)}}(pr)),pr.exports}var hr,Ii;function Sn(){if(Ii)return hr;Ii=1,hr={transformStyles:i,applyAnsiStyles({data:a}){return i(a,e,n)},removeStyles({data:a}){return i(a,()=>"")}};const o={unset:"\x1B[0m",black:"\x1B[30m",red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m",cyan:"\x1B[36m",white:"\x1B[37m"};function e(a){const t=a.replace(/color:\s*(\w+).*/,"$1").toLowerCase();return o[t]||""}function n(a){return a+o.unset}function i(a,t,r){const s={};return a.reduce((u,f,l,h)=>{if(s[l])return u;if(typeof f=="string"){let c=l,g=!1;f=f.replace(/%[1cdfiOos]/g,w=>{if(c+=1,w!=="%c")return w;const b=h[c];return typeof b=="string"?(s[c]=!0,g=!0,t(b,f)):w}),g&&r&&(f=r(f))}return u.push(f),u},[])}return hr}var dr,Fi;function ja(){if(Fi)return dr;Fi=1;const{concatFirstStringElements:o,format:e}=ls(),{maxDepth:n,toJSON:i}=Ct(),{applyAnsiStyles:a,removeStyles:t}=Sn(),{transform:r}=Xe(),s={error:console.error,warn:console.warn,info:console.info,verbose:console.info,debug:console.debug,silly:console.debug,log:console.log};dr=l;const f=`%c{h}:{i}:{s}.{ms}{scope}%c ${process.platform==="win32"?">":"›"} {text}`;Object.assign(l,{DEFAULT_FORMAT:f});function l(b){return Object.assign(C,{format:f,level:"silly",transforms:[h,e,g,o,n,i],useStyles:process.env.FORCE_STYLES,writeFn({message:F}){(s[F.level]||s.info)(...F.data)}});function C(F){const y=r({logger:b,message:F,transport:C});C.writeFn({message:{...F,data:y}})}}function h({data:b,message:C,transport:F}){return F.format!==f?b:[`color:${w(C.level)}`,"color:unset",...b]}function c(b,C){if(typeof b=="boolean")return b;const y=C==="error"||C==="warn"?process.stderr:process.stdout;return y&&y.isTTY}function g(b){const{message:C,transport:F}=b;return(c(F.useStyles,C.level)?a:t)(b)}function w(b){const C={error:"red",warn:"yellow",info:"cyan",default:"unset"};return C[b]||C.default}return dr}var mr,Si;function fs(){if(Si)return mr;Si=1;const o=Ue,e=ae,n=ke;class i extends o{constructor({path:s,writeOptions:u={encoding:"utf8",flag:"a",mode:438},writeAsync:f=!1}){super();Z(this,"asyncWriteQueue",[]);Z(this,"bytesWritten",0);Z(this,"hasActiveAsyncWriting",!1);Z(this,"path",null);Z(this,"initialSize");Z(this,"writeOptions",null);Z(this,"writeAsync",!1);this.path=s,this.writeOptions=u,this.writeAsync=f}get size(){return this.getSize()}clear(){try{return e.writeFileSync(this.path,"",{mode:this.writeOptions.mode,flag:"w"}),this.reset(),!0}catch(s){return s.code==="ENOENT"?!0:(this.emit("error",s,this),!1)}}crop(s){try{const u=a(this.path,s||4096);this.clear(),this.writeLine(`[log cropped]${n.EOL}${u}`)}catch(u){this.emit("error",new Error(`Couldn't crop file ${this.path}. ${u.message}`),this)}}getSize(){if(this.initialSize===void 0)try{const s=e.statSync(this.path);this.initialSize=s.size}catch{this.initialSize=0}return this.initialSize+this.bytesWritten}increaseBytesWrittenCounter(s){this.bytesWritten+=Buffer.byteLength(s,this.writeOptions.encoding)}isNull(){return!1}nextAsyncWrite(){const s=this;if(this.hasActiveAsyncWriting||this.asyncWriteQueue.length===0)return;const u=this.asyncWriteQueue.join("");this.asyncWriteQueue=[],this.hasActiveAsyncWriting=!0,e.writeFile(this.path,u,this.writeOptions,f=>{s.hasActiveAsyncWriting=!1,f?s.emit("error",new Error(`Couldn't write to ${s.path}. ${f.message}`),this):s.increaseBytesWrittenCounter(u),s.nextAsyncWrite()})}reset(){this.initialSize=void 0,this.bytesWritten=0}toString(){return this.path}writeLine(s){if(s+=n.EOL,this.writeAsync){this.asyncWriteQueue.push(s),this.nextAsyncWrite();return}try{e.writeFileSync(this.path,s,this.writeOptions),this.increaseBytesWrittenCounter(s)}catch(u){this.emit("error",new Error(`Couldn't write to ${this.path}. ${u.message}`),this)}}}mr=i;function a(t,r){const s=Buffer.alloc(r),u=e.statSync(t),f=Math.min(u.size,r),l=Math.max(0,u.size-r),h=e.openSync(t,"r"),c=e.readSync(h,s,0,f,l);return e.closeSync(h),s.toString("utf8",0,c)}return mr}var gr,Pi;function $a(){if(Pi)return gr;Pi=1;const o=fs();class e extends o{clear(){}crop(){}getSize(){return 0}isNull(){return!0}writeLine(){}}return gr=e,gr}var yr,Li;function qa(){if(Li)return yr;Li=1;const o=Ue,e=ae,n=Q,i=fs(),a=$a();class t extends o{constructor(){super();Z(this,"store",{});this.emitError=this.emitError.bind(this)}provide({filePath:u,writeOptions:f={},writeAsync:l=!1}){let h;try{if(u=n.resolve(u),this.store[u])return this.store[u];h=this.createFile({filePath:u,writeOptions:f,writeAsync:l})}catch(c){h=new a({path:u}),this.emitError(c,h)}return h.on("error",this.emitError),this.store[u]=h,h}createFile({filePath:u,writeOptions:f,writeAsync:l}){return this.testFileWriting({filePath:u,writeOptions:f}),new i({path:u,writeOptions:f,writeAsync:l})}emitError(u,f){this.emit("error",u,f)}testFileWriting({filePath:u,writeOptions:f}){e.mkdirSync(n.dirname(u),{recursive:!0}),e.writeFileSync(u,"",{flag:"a",mode:f.mode})}}return yr=t,yr}var vr,Mi;function ka(){if(Mi)return vr;Mi=1;const o=ae,e=ke,n=Q,i=qa(),{transform:a}=Xe(),{removeStyles:t}=Sn(),{format:r,concatFirstStringElements:s}=ls(),{toString:u}=Ct();vr=l;const f=new i;function l(c,{registry:g=f,externalApi:w}={}){let b;return g.listenerCount("error")<1&&g.on("error",(_,v)=>{y(`Can't write to ${v}`,_)}),Object.assign(C,{fileName:h(c.variables.processType),format:"[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}]{scope} {text}",getFile:m,inspectOptions:{depth:5},level:"silly",maxSize:1024**2,readAllLogs:D,sync:!0,transforms:[t,r,s,u],writeOptions:{flag:"a",mode:438,encoding:"utf8"},archiveLogFn(_){const v=_.toString(),A=n.parse(v);try{o.renameSync(v,n.join(A.dir,`${A.name}.old${A.ext}`))}catch(T){y("Could not rotate log",T);const p=Math.round(C.maxSize/4);_.crop(Math.min(p,256*1024))}},resolvePathFn(_){return n.join(_.libraryDefaultDir,_.fileName)},setAppName(_){c.dependencies.externalApi.setAppName(_)}});function C(_){const v=m(_);C.maxSize>0&&v.size>C.maxSize&&(C.archiveLogFn(v),v.reset());const T=a({logger:c,message:_,transport:C});v.writeLine(T)}function F(){b||(b=Object.create(Object.prototype,{...Object.getOwnPropertyDescriptors(w.getPathVariables()),fileName:{get(){return C.fileName},enumerable:!0}}),typeof C.archiveLog=="function"&&(C.archiveLogFn=C.archiveLog,y("archiveLog is deprecated. Use archiveLogFn instead")),typeof C.resolvePath=="function"&&(C.resolvePathFn=C.resolvePath,y("resolvePath is deprecated. Use resolvePathFn instead")))}function y(_,v=null,A="error"){const T=[`electron-log.transports.file: ${_}`];v&&T.push(v),c.transports.console({data:T,date:new Date,level:A})}function m(_){F();const v=C.resolvePathFn(b,_);return g.provide({filePath:v,writeAsync:!C.sync,writeOptions:C.writeOptions})}function D({fileFilter:_=v=>v.endsWith(".log")}={}){F();const v=n.dirname(C.resolvePathFn(b));return o.existsSync(v)?o.readdirSync(v).map(A=>n.join(v,A)).filter(_).map(A=>{try{return{path:A,lines:o.readFileSync(A,"utf8").split(e.EOL)}}catch{return null}}).filter(Boolean):[]}}function h(c=process.type){switch(c){case"renderer":return"renderer.log";case"worker":return"worker.log";default:return"main.log"}}return vr}var wr,Ri;function Ba(){if(Ri)return wr;Ri=1;const{maxDepth:o,toJSON:e}=Ct(),{transform:n}=Xe();wr=i;function i(a,{externalApi:t}){return Object.assign(r,{depth:3,eventId:"__ELECTRON_LOG_IPC__",level:a.isDev?"silly":!1,transforms:[e,o]}),t!=null&&t.isElectron()?r:void 0;function r(s){var u;((u=s==null?void 0:s.variables)==null?void 0:u.processType)!=="renderer"&&(t==null||t.sendIpc(r.eventId,{...s,data:n({logger:a,message:s,transport:r})}))}}return wr}var Er,ji;function Ua(){if(ji)return Er;ji=1;const o=Et,e=bt,{transform:n}=Xe(),{removeStyles:i}=Sn(),{toJSON:a,maxDepth:t}=Ct();Er=r;function r(s){return Object.assign(u,{client:{name:"electron-application"},depth:6,level:!1,requestOptions:{},transforms:[i,a,t],makeBodyFn({message:f}){return JSON.stringify({client:u.client,data:f.data,date:f.date.getTime(),level:f.level,scope:f.scope,variables:f.variables})},processErrorFn({error:f}){s.processMessage({data:[`electron-log: can't POST ${u.url}`,f],level:"warn"},{transports:["console","file"]})},sendRequestFn({serverUrl:f,requestOptions:l,body:h}){const g=(f.startsWith("https:")?e:o).request(f,{method:"POST",...l,headers:{"Content-Type":"application/json","Content-Length":h.length,...l.headers}});return g.write(h),g.end(),g}});function u(f){if(!u.url)return;const l=u.makeBodyFn({logger:s,message:{...f,data:n({logger:s,message:f,transport:u})},transport:u}),h=u.sendRequestFn({serverUrl:u.url,requestOptions:u.requestOptions,body:Buffer.from(l,"utf8")});h.on("error",c=>u.processErrorFn({error:c,logger:s,message:f,request:h,transport:u}))}}return Er}var br,$i;function ps(){if($i)return br;$i=1;const o=us(),e=Ma(),n=Ra(),i=ja(),a=ka(),t=Ba(),r=Ua();br=s;function s({dependencies:u,initializeFn:f}){var h;const l=new o({dependencies:u,errorHandler:new e,eventLogger:new n,initializeFn:f,isDev:(h=u.externalApi)==null?void 0:h.isDev(),logId:"default",transportFactories:{console:i,file:a,ipc:t,remote:r},variables:{processType:"main"}});return l.default=l,l.Logger=o,l.processInternalErrorFn=c=>{l.transports.console.writeFn({message:{data:["Unhandled electron-log error",c],level:"error"}})},l}return br}var Tr,qi;function Xa(){if(qi)return Tr;qi=1;const o=re,e=Pa(),{initialize:n}=La(),i=ps(),a=new e({electron:o}),t=i({dependencies:{externalApi:a},initializeFn:n});Tr=t,a.onIpc("__ELECTRON_LOG__",(s,u)=>{u.scope&&t.Logger.getInstance(u).scope(u.scope);const f=new Date(u.date);r({...u,date:f.getTime()?f:new Date})}),a.onIpcInvoke("__ELECTRON_LOG__",(s,{cmd:u="",logId:f})=>{switch(u){case"getOptions":return{levels:t.Logger.getInstance({logId:f}).levels,logId:f};default:return r({data:[`Unknown cmd '${u}'`],level:"error"}),{}}});function r(s){var u;(u=t.Logger.getInstance(s))==null||u.processMessage(s)}return Tr}var Cr,ki;function Va(){if(ki)return Cr;ki=1;const o=cs(),e=ps(),n=new o;return Cr=e({dependencies:{externalApi:n}}),Cr}const za=typeof process>"u"||process.type==="renderer"||process.type==="worker",Wa=typeof process=="object"&&process.type==="browser";za?(as(),gt.exports=Fa()):Wa?gt.exports=Xa():gt.exports=Va();var Ha=gt.exports;const oe=Tt(Ha),Bi=require("iconv-lite");function Ga(o){try{const e=Bi.decode(Buffer.from(o,"binary"),"gbk");return/[^\u0000-\uFFFF]/.test(e)?o.split(Q.sep).map(n=>{try{return Bi.decode(Buffer.from(n,"binary"),"gbk")}catch{return n}}).join(Q.sep):e}catch{return o}}async function Ui(o){const e=Ga(o),n=Q.normalize(e);if(console.log(n),!ae.existsSync(n)){if(o!==n&&ae.existsSync(o))return o;throw new Error(`文件不存在: ${n}
原始路径: ${o}`)}return n}function bn(o){return Buffer.from(o,"base64").toString("utf-8")}function yt(o){switch(Q.extname(o).toLowerCase()){case".mp4":return"video/mp4";case".webm":return"video/webm";case".mov":return"video/quicktime";case".avi":return"video/x-msvideo";case".mkv":return"video/x-matroska";case".mp3":return"audio/mpeg";case".wav":return"audio/wav";case".ogg":return"audio/ogg";case".aac":return"audio/aac";case".flac":return"audio/flac";case".jpg":case".jpeg":return"image/jpeg";case".png":return"image/png";default:return"application/octet-stream"}}function Xi(o){return new ReadableStream({start(e){o.on("data",n=>{e.enqueue(n)}),o.on("end",()=>{e.close()}),o.on("error",n=>{e.error(n)})},cancel(){o.destroy()}})}function Ka(){try{let o,e;if(re.app.isPackaged){const n=Q.join(process.resourcesPath,"app.asar.unpacked","bin");o=Q.join(n,process.platform==="win32"?"ffmpeg.exe":"ffmpeg"),e=Q.join(n,process.platform==="win32"?"ffprobe.exe":"ffprobe")}else{const n=require("ffmpeg-static"),i=require("ffprobe-static");o=n,e=i.path}return console.log("FFmpeg路径:",o),console.log("FFprobe路径:",e),et.setFfmpegPath(o),et.setFfprobePath(e),{ffmpegPath:o,ffprobePath:e}}catch(o){throw console.error("FFmpeg初始化失败:",o),new Error(`视频处理引擎初始化失败: ${o.message}`)}}function Ya(){re.ipcMain.handle("merge-media",async(o,e)=>{const{videoPaths:n,audioPaths:i,outputPath:a,audioVolumes:t=[]}=e,r=[...await Promise.all(n.map(Ui)),...await Promise.all(i.map(Ui))];return new Promise((s,u)=>{const f=et();r.forEach(b=>f.input(b));const l=[],h=n.map((b,C)=>`[${C}:v]scale=1280:720,setsar=1[v${C}]`);l.push(h.join(";"));const c=n.map((b,C)=>`[v${C}]`).join("");l.push(`${c}concat=n=${n.length}:v=1:a=0[vout]`);const g=i.map((b,C)=>`[${C+n.length}:a]aformat=sample_fmts=fltp[a${C}]`);l.push(g.join(";"));const w=i.map((b,C)=>`[a${C}]`).join("");l.push(`${w}amix=inputs=${i.length}:duration=longest[aout]`),oe.log(l.join(";")),f.complexFilter(l.join(";")).outputOptions(["-map [vout]","-map [aout]","-c:v libx264","-preset fast","-crf 22","-c:a aac","-b:a 192k","-shortest"]).save(a).on("progress",b=>{const C=b.percent?Math.min(100,b.percent):0;o.sender.send("merge-progress",C)}).on("end",()=>s(a)).on("error",(b,C,F)=>{console.error("FFmpeg Error:",b.message),console.error("FFmpeg Stderr:",F),u(b)})})})}function Ja(){re.ipcMain.handle("open-file",async(o,e)=>{const{shell:n}=require("electron");await n.openPath(e)})}var at,Qa=new Uint8Array(16);function hs(){if(!at&&(at=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!at))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return at(Qa)}const Za=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Ot(o){return typeof o=="string"&&Za.test(o)}var de=[];for(var Or=0;Or<256;++Or)de.push((Or+256).toString(16).substr(1));function At(o){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(de[o[e+0]]+de[o[e+1]]+de[o[e+2]]+de[o[e+3]]+"-"+de[o[e+4]]+de[o[e+5]]+"-"+de[o[e+6]]+de[o[e+7]]+"-"+de[o[e+8]]+de[o[e+9]]+"-"+de[o[e+10]]+de[o[e+11]]+de[o[e+12]]+de[o[e+13]]+de[o[e+14]]+de[o[e+15]]).toLowerCase();if(!Ot(n))throw TypeError("Stringified UUID is invalid");return n}var Vi,Ar,Dr=0,_r=0;function eu(o,e,n){var i=e&&n||0,a=e||new Array(16);o=o||{};var t=o.node||Vi,r=o.clockseq!==void 0?o.clockseq:Ar;if(t==null||r==null){var s=o.random||(o.rng||hs)();t==null&&(t=Vi=[s[0]|1,s[1],s[2],s[3],s[4],s[5]]),r==null&&(r=Ar=(s[6]<<8|s[7])&16383)}var u=o.msecs!==void 0?o.msecs:Date.now(),f=o.nsecs!==void 0?o.nsecs:_r+1,l=u-Dr+(f-_r)/1e4;if(l<0&&o.clockseq===void 0&&(r=r+1&16383),(l<0||u>Dr)&&o.nsecs===void 0&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Dr=u,_r=f,Ar=r,u+=122192928e5;var h=((u&268435455)*1e4+f)%4294967296;a[i++]=h>>>24&255,a[i++]=h>>>16&255,a[i++]=h>>>8&255,a[i++]=h&255;var c=u/4294967296*1e4&268435455;a[i++]=c>>>8&255,a[i++]=c&255,a[i++]=c>>>24&15|16,a[i++]=c>>>16&255,a[i++]=r>>>8|128,a[i++]=r&255;for(var g=0;g<6;++g)a[i+g]=t[g];return e||At(a)}function ds(o){if(!Ot(o))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(o.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=e&255,n[4]=(e=parseInt(o.slice(9,13),16))>>>8,n[5]=e&255,n[6]=(e=parseInt(o.slice(14,18),16))>>>8,n[7]=e&255,n[8]=(e=parseInt(o.slice(19,23),16))>>>8,n[9]=e&255,n[10]=(e=parseInt(o.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=e&255,n}function tu(o){o=unescape(encodeURIComponent(o));for(var e=[],n=0;n<o.length;++n)e.push(o.charCodeAt(n));return e}var ru="6ba7b810-9dad-11d1-80b4-00c04fd430c8",nu="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function ms(o,e,n){function i(a,t,r,s){if(typeof a=="string"&&(a=tu(a)),typeof t=="string"&&(t=ds(t)),t.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+a.length);if(u.set(t),u.set(a,t.length),u=n(u),u[6]=u[6]&15|e,u[8]=u[8]&63|128,r){s=s||0;for(var f=0;f<16;++f)r[s+f]=u[f];return r}return At(u)}try{i.name=o}catch{}return i.DNS=ru,i.URL=nu,i}function iu(o){if(typeof o=="string"){var e=unescape(encodeURIComponent(o));o=new Uint8Array(e.length);for(var n=0;n<e.length;++n)o[n]=e.charCodeAt(n)}return ou(su(au(o),o.length*8))}function ou(o){for(var e=[],n=o.length*32,i="0123456789abcdef",a=0;a<n;a+=8){var t=o[a>>5]>>>a%32&255,r=parseInt(i.charAt(t>>>4&15)+i.charAt(t&15),16);e.push(r)}return e}function gs(o){return(o+64>>>9<<4)+14+1}function su(o,e){o[e>>5]|=128<<e%32,o[gs(e)-1]=e;for(var n=1732584193,i=-271733879,a=-1732584194,t=271733878,r=0;r<o.length;r+=16){var s=n,u=i,f=a,l=t;n=ge(n,i,a,t,o[r],7,-680876936),t=ge(t,n,i,a,o[r+1],12,-389564586),a=ge(a,t,n,i,o[r+2],17,606105819),i=ge(i,a,t,n,o[r+3],22,-1044525330),n=ge(n,i,a,t,o[r+4],7,-176418897),t=ge(t,n,i,a,o[r+5],12,1200080426),a=ge(a,t,n,i,o[r+6],17,-1473231341),i=ge(i,a,t,n,o[r+7],22,-45705983),n=ge(n,i,a,t,o[r+8],7,1770035416),t=ge(t,n,i,a,o[r+9],12,-1958414417),a=ge(a,t,n,i,o[r+10],17,-42063),i=ge(i,a,t,n,o[r+11],22,-1990404162),n=ge(n,i,a,t,o[r+12],7,1804603682),t=ge(t,n,i,a,o[r+13],12,-40341101),a=ge(a,t,n,i,o[r+14],17,-1502002290),i=ge(i,a,t,n,o[r+15],22,1236535329),n=ye(n,i,a,t,o[r+1],5,-165796510),t=ye(t,n,i,a,o[r+6],9,-1069501632),a=ye(a,t,n,i,o[r+11],14,643717713),i=ye(i,a,t,n,o[r],20,-373897302),n=ye(n,i,a,t,o[r+5],5,-701558691),t=ye(t,n,i,a,o[r+10],9,38016083),a=ye(a,t,n,i,o[r+15],14,-660478335),i=ye(i,a,t,n,o[r+4],20,-405537848),n=ye(n,i,a,t,o[r+9],5,568446438),t=ye(t,n,i,a,o[r+14],9,-1019803690),a=ye(a,t,n,i,o[r+3],14,-187363961),i=ye(i,a,t,n,o[r+8],20,1163531501),n=ye(n,i,a,t,o[r+13],5,-1444681467),t=ye(t,n,i,a,o[r+2],9,-51403784),a=ye(a,t,n,i,o[r+7],14,1735328473),i=ye(i,a,t,n,o[r+12],20,-1926607734),n=ve(n,i,a,t,o[r+5],4,-378558),t=ve(t,n,i,a,o[r+8],11,-2022574463),a=ve(a,t,n,i,o[r+11],16,1839030562),i=ve(i,a,t,n,o[r+14],23,-35309556),n=ve(n,i,a,t,o[r+1],4,-1530992060),t=ve(t,n,i,a,o[r+4],11,1272893353),a=ve(a,t,n,i,o[r+7],16,-155497632),i=ve(i,a,t,n,o[r+10],23,-1094730640),n=ve(n,i,a,t,o[r+13],4,681279174),t=ve(t,n,i,a,o[r],11,-358537222),a=ve(a,t,n,i,o[r+3],16,-722521979),i=ve(i,a,t,n,o[r+6],23,76029189),n=ve(n,i,a,t,o[r+9],4,-640364487),t=ve(t,n,i,a,o[r+12],11,-421815835),a=ve(a,t,n,i,o[r+15],16,530742520),i=ve(i,a,t,n,o[r+2],23,-995338651),n=we(n,i,a,t,o[r],6,-198630844),t=we(t,n,i,a,o[r+7],10,1126891415),a=we(a,t,n,i,o[r+14],15,-1416354905),i=we(i,a,t,n,o[r+5],21,-57434055),n=we(n,i,a,t,o[r+12],6,1700485571),t=we(t,n,i,a,o[r+3],10,-1894986606),a=we(a,t,n,i,o[r+10],15,-1051523),i=we(i,a,t,n,o[r+1],21,-2054922799),n=we(n,i,a,t,o[r+8],6,1873313359),t=we(t,n,i,a,o[r+15],10,-30611744),a=we(a,t,n,i,o[r+6],15,-1560198380),i=we(i,a,t,n,o[r+13],21,1309151649),n=we(n,i,a,t,o[r+4],6,-145523070),t=we(t,n,i,a,o[r+11],10,-1120210379),a=we(a,t,n,i,o[r+2],15,718787259),i=we(i,a,t,n,o[r+9],21,-343485551),n=qe(n,s),i=qe(i,u),a=qe(a,f),t=qe(t,l)}return[n,i,a,t]}function au(o){if(o.length===0)return[];for(var e=o.length*8,n=new Uint32Array(gs(e)),i=0;i<e;i+=8)n[i>>5]|=(o[i/8]&255)<<i%32;return n}function qe(o,e){var n=(o&65535)+(e&65535),i=(o>>16)+(e>>16)+(n>>16);return i<<16|n&65535}function uu(o,e){return o<<e|o>>>32-e}function Dt(o,e,n,i,a,t){return qe(uu(qe(qe(e,o),qe(i,t)),a),n)}function ge(o,e,n,i,a,t,r){return Dt(e&n|~e&i,o,e,a,t,r)}function ye(o,e,n,i,a,t,r){return Dt(e&i|n&~i,o,e,a,t,r)}function ve(o,e,n,i,a,t,r){return Dt(e^n^i,o,e,a,t,r)}function we(o,e,n,i,a,t,r){return Dt(n^(e|~i),o,e,a,t,r)}var cu=ms("v3",48,iu);const lu=cu;function fu(o,e,n){o=o||{};var i=o.random||(o.rng||hs)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){n=n||0;for(var a=0;a<16;++a)e[n+a]=i[a];return e}return At(i)}function pu(o,e,n,i){switch(o){case 0:return e&n^~e&i;case 1:return e^n^i;case 2:return e&n^e&i^n&i;case 3:return e^n^i}}function Nr(o,e){return o<<e|o>>>32-e}function hu(o){var e=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof o=="string"){var i=unescape(encodeURIComponent(o));o=[];for(var a=0;a<i.length;++a)o.push(i.charCodeAt(a))}else Array.isArray(o)||(o=Array.prototype.slice.call(o));o.push(128);for(var t=o.length/4+2,r=Math.ceil(t/16),s=new Array(r),u=0;u<r;++u){for(var f=new Uint32Array(16),l=0;l<16;++l)f[l]=o[u*64+l*4]<<24|o[u*64+l*4+1]<<16|o[u*64+l*4+2]<<8|o[u*64+l*4+3];s[u]=f}s[r-1][14]=(o.length-1)*8/Math.pow(2,32),s[r-1][14]=Math.floor(s[r-1][14]),s[r-1][15]=(o.length-1)*8&4294967295;for(var h=0;h<r;++h){for(var c=new Uint32Array(80),g=0;g<16;++g)c[g]=s[h][g];for(var w=16;w<80;++w)c[w]=Nr(c[w-3]^c[w-8]^c[w-14]^c[w-16],1);for(var b=n[0],C=n[1],F=n[2],y=n[3],m=n[4],D=0;D<80;++D){var _=Math.floor(D/20),v=Nr(b,5)+pu(_,C,F,y)+m+e[_]+c[D]>>>0;m=y,y=F,F=Nr(C,30)>>>0,C=b,b=v}n[0]=n[0]+b>>>0,n[1]=n[1]+C>>>0,n[2]=n[2]+F>>>0,n[3]=n[3]+y>>>0,n[4]=n[4]+m>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var du=ms("v5",80,hu);const mu=du,gu="00000000-0000-0000-0000-000000000000";function yu(o){if(!Ot(o))throw TypeError("Invalid UUID");return parseInt(o.substr(14,1),16)}const vu=Object.freeze(Object.defineProperty({__proto__:null,NIL:gu,parse:ds,stringify:At,v1:eu,v3:lu,v4:fu,v5:mu,validate:Ot,version:yu},Symbol.toStringTag,{value:"Module"})),wu=ea(vu),Eu=Hs,ut=_n,{v1:cl,v4:bu}=wu;let Tu=class{constructor(e){ut(e,'must pass "config"'),ut(e.url,'must pass "url"'),ut(e.appkey,'must pass "appkey"'),ut(e.token,"must first get token from cache or getToken interface"),this._config=e}start(e,n){if(typeof e!="function")throw new Error("expect function onmessage");if(typeof n!="function")throw new Error("expect function onclose");return this._ws=new Eu(this._config.url,{headers:{"X-NLS-Token":this._config.token},perMessageDeflate:!1}),this._ws.on("message",(i,a)=>{e(i,a)}),this._ws.on("close",()=>{n()}),new Promise((i,a)=>{this._ws.on("open",()=>{i()}),this._ws.on("error",t=>{a(t)})})}send(e,n){this._ws!=null&&this._ws.send(e,{binary:n})}setPing(e,n){this._ping=setInterval(()=>{this._ws.ping(n)},e)}clearPing(){this._ping&&clearInterval(this._ping)}shutdown(){this._ws!=null&&(this._ping!=null&&clearInterval(this._ping),this._ws.terminate())}uuid(){return bu().split("-").join("")}defaultContext(){return{sdk:{name:"nls-nodejs-sdk",version:"0.0.1",language:"nodejs"}}}};var Cu=Tu;Ue.EventEmitter;Ue.EventEmitter;const Ou=Cu,Au=Ue.EventEmitter;class Du{constructor(e,n=!1){this._event=new Au,this._config=e,n?this._namespace="SpeechLongSynthesizer":this._namespace="SpeechSynthesizer"}defaultStartParams(e){return{voice:e,format:"wav",sample_rate:16e3,volume:50,speech_rate:0,pitch_rate:0,enable_subtitle:!1}}on(e,n){this._event.on(e,n)}async start(e,n,i){this._client=new Ou(this._config),this._taskid=this._client.uuid();let a={header:{message_id:this._client.uuid(),task_id:this._taskid,namespace:this._namespace,name:"StartSynthesis",appkey:this._config.appkey},payload:e,context:this._client.defaultContext()};return new Promise(async(t,r)=>{try{await this._client.start((s,u)=>{if(u)this._event.emit("data",s);else{let f=s.toString(),l=JSON.parse(f);l.header.name==="MetaInfo"?this._event.emit("meta",f):l.header.name==="SynthesisCompleted"?(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("completed",f),t(f)):l.header.name==="TaskFailed"&&(this._client.clearPing(),this._client.shutdown(),this._client=null,this._event.emit("TaskFailed",f),this._event.emit("failed",f),r(f))}},()=>{this._event.emit("closed")}),n&&(i||(i=6e3),this._client.setPing(i)),this._client.send(JSON.stringify(a),!1)}catch(s){r(s)}})}shutdown(){this._client!=null&&this._client.shutdown()}}var _u=Du;const Nu=Tt(_u),wt={accessKeyId:"LTAI5tFCh5eoiNZX4n2wEy7Y",accessKeySecret:"XWYRzwspo5z4Ukuo8lKxZX4pUSgQ86",appkey:"JbBUqMYRUt0DrMcK",endpoint:"https://nls-gateway.aliyuncs.com",regionId:"cn-shanghai",ttsUrl:"wss://nls-gateway-cn-shanghai.aliyuncs.com/ws/v1"};var _t={exports:{}},We={},Tn={exports:{}},ct={exports:{}},xr,zi;function ys(){if(zi)return xr;zi=1;var o=1e3,e=o*60,n=e*60,i=n*24,a=i*7,t=i*365.25;xr=function(l,h){h=h||{};var c=typeof l;if(c==="string"&&l.length>0)return r(l);if(c==="number"&&isFinite(l))return h.long?u(l):s(l);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(l))};function r(l){if(l=String(l),!(l.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(l);if(h){var c=parseFloat(h[1]),g=(h[2]||"ms").toLowerCase();switch(g){case"years":case"year":case"yrs":case"yr":case"y":return c*t;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*e;case"seconds":case"second":case"secs":case"sec":case"s":return c*o;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}function s(l){var h=Math.abs(l);return h>=i?Math.round(l/i)+"d":h>=n?Math.round(l/n)+"h":h>=e?Math.round(l/e)+"m":h>=o?Math.round(l/o)+"s":l+"ms"}function u(l){var h=Math.abs(l);return h>=i?f(l,h,i,"day"):h>=n?f(l,h,n,"hour"):h>=e?f(l,h,e,"minute"):h>=o?f(l,h,o,"second"):l+" ms"}function f(l,h,c,g){var w=h>=c*1.5;return Math.round(l/c)+" "+g+(w?"s":"")}return xr}var Ir,Wi;function vs(){if(Wi)return Ir;Wi=1;function o(e){i.debug=i,i.default=i,i.coerce=f,i.disable=s,i.enable=t,i.enabled=u,i.humanize=ys(),i.destroy=l,Object.keys(e).forEach(h=>{i[h]=e[h]}),i.names=[],i.skips=[],i.formatters={};function n(h){let c=0;for(let g=0;g<h.length;g++)c=(c<<5)-c+h.charCodeAt(g),c|=0;return i.colors[Math.abs(c)%i.colors.length]}i.selectColor=n;function i(h){let c,g=null,w,b;function C(...F){if(!C.enabled)return;const y=C,m=Number(new Date),D=m-(c||m);y.diff=D,y.prev=c,y.curr=m,c=m,F[0]=i.coerce(F[0]),typeof F[0]!="string"&&F.unshift("%O");let _=0;F[0]=F[0].replace(/%([a-zA-Z%])/g,(A,T)=>{if(A==="%%")return"%";_++;const p=i.formatters[T];if(typeof p=="function"){const O=F[_];A=p.call(y,O),F.splice(_,1),_--}return A}),i.formatArgs.call(y,F),(y.log||i.log).apply(y,F)}return C.namespace=h,C.useColors=i.useColors(),C.color=i.selectColor(h),C.extend=a,C.destroy=i.destroy,Object.defineProperty(C,"enabled",{enumerable:!0,configurable:!1,get:()=>g!==null?g:(w!==i.namespaces&&(w=i.namespaces,b=i.enabled(h)),b),set:F=>{g=F}}),typeof i.init=="function"&&i.init(C),C}function a(h,c){const g=i(this.namespace+(typeof c>"u"?":":c)+h);return g.log=this.log,g}function t(h){i.save(h),i.namespaces=h,i.names=[],i.skips=[];const c=(typeof h=="string"?h:"").trim().replace(" ",",").split(",").filter(Boolean);for(const g of c)g[0]==="-"?i.skips.push(g.slice(1)):i.names.push(g)}function r(h,c){let g=0,w=0,b=-1,C=0;for(;g<h.length;)if(w<c.length&&(c[w]===h[g]||c[w]==="*"))c[w]==="*"?(b=w,C=g,w++):(g++,w++);else if(b!==-1)w=b+1,C++,g=C;else return!1;for(;w<c.length&&c[w]==="*";)w++;return w===c.length}function s(){const h=[...i.names,...i.skips.map(c=>"-"+c)].join(",");return i.enable(""),h}function u(h){for(const c of i.skips)if(r(h,c))return!1;for(const c of i.names)if(r(h,c))return!0;return!1}function f(h){return h instanceof Error?h.stack||h.message:h}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return i.enable(i.load()),i}return Ir=o,Ir}var Hi;function xu(){return Hi||(Hi=1,function(o,e){e.formatArgs=i,e.save=a,e.load=t,e.useColors=n,e.storage=r(),e.destroy=(()=>{let u=!1;return()=>{u||(u=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let u;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(u=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(u[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function i(u){if(u[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+u[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),!this.useColors)return;const f="color: "+this.color;u.splice(1,0,f,"color: inherit");let l=0,h=0;u[0].replace(/%[a-zA-Z%]/g,c=>{c!=="%%"&&(l++,c==="%c"&&(h=l))}),u.splice(h,0,f)}e.log=console.debug||console.log||(()=>{});function a(u){try{u?e.storage.setItem("debug",u):e.storage.removeItem("debug")}catch{}}function t(){let u;try{u=e.storage.getItem("debug")}catch{}return!u&&typeof process<"u"&&"env"in process&&(u=process.env.DEBUG),u}function r(){try{return localStorage}catch{}}o.exports=vs()(e);const{formatters:s}=o.exports;s.j=function(u){try{return JSON.stringify(u)}catch(f){return"[UnexpectedJSONParseError]: "+f.message}}}(ct,ct.exports)),ct.exports}var lt={exports:{}},Fr,Gi;function Iu(){return Gi||(Gi=1,Fr=(o,e=process.argv)=>{const n=o.startsWith("-")?"":o.length===1?"-":"--",i=e.indexOf(n+o),a=e.indexOf("--");return i!==-1&&(a===-1||i<a)}),Fr}var Sr,Ki;function ws(){if(Ki)return Sr;Ki=1;const o=ke,e=xn,n=Iu(),{env:i}=process;let a;n("no-color")||n("no-colors")||n("color=false")||n("color=never")?a=0:(n("color")||n("colors")||n("color=true")||n("color=always"))&&(a=1),"FORCE_COLOR"in i&&(i.FORCE_COLOR==="true"?a=1:i.FORCE_COLOR==="false"?a=0:a=i.FORCE_COLOR.length===0?1:Math.min(parseInt(i.FORCE_COLOR,10),3));function t(u){return u===0?!1:{level:u,hasBasic:!0,has256:u>=2,has16m:u>=3}}function r(u,f){if(a===0)return 0;if(n("color=16m")||n("color=full")||n("color=truecolor"))return 3;if(n("color=256"))return 2;if(u&&!f&&a===void 0)return 0;const l=a||0;if(i.TERM==="dumb")return l;if(process.platform==="win32"){const h=o.release().split(".");return Number(h[0])>=10&&Number(h[2])>=10586?Number(h[2])>=14931?3:2:1}if("CI"in i)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(h=>h in i)||i.CI_NAME==="codeship"?1:l;if("TEAMCITY_VERSION"in i)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(i.TEAMCITY_VERSION)?1:0;if(i.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in i){const h=parseInt((i.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(i.TERM_PROGRAM){case"iTerm.app":return h>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(i.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(i.TERM)||"COLORTERM"in i?1:l}function s(u){const f=r(u,u&&u.isTTY);return t(f)}return Sr={supportsColor:s,stdout:t(r(!0,e.isatty(1))),stderr:t(r(!0,e.isatty(2)))},Sr}var Yi;function Fu(){return Yi||(Yi=1,function(o,e){const n=xn,i=rt;e.init=l,e.log=s,e.formatArgs=t,e.save=u,e.load=f,e.useColors=a,e.destroy=i.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),e.colors=[6,2,3,4,5,1];try{const c=ws();c&&(c.stderr||c).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(c=>/^debug_/i.test(c)).reduce((c,g)=>{const w=g.substring(6).toLowerCase().replace(/_([a-z])/g,(C,F)=>F.toUpperCase());let b=process.env[g];return/^(yes|on|true|enabled)$/i.test(b)?b=!0:/^(no|off|false|disabled)$/i.test(b)?b=!1:b==="null"?b=null:b=Number(b),c[w]=b,c},{});function a(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:n.isatty(process.stderr.fd)}function t(c){const{namespace:g,useColors:w}=this;if(w){const b=this.color,C="\x1B[3"+(b<8?b:"8;5;"+b),F=`  ${C};1m${g} \x1B[0m`;c[0]=F+c[0].split(`
`).join(`
`+F),c.push(C+"m+"+o.exports.humanize(this.diff)+"\x1B[0m")}else c[0]=r()+g+" "+c[0]}function r(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function s(...c){return process.stderr.write(i.formatWithOptions(e.inspectOpts,...c)+`
`)}function u(c){c?process.env.DEBUG=c:delete process.env.DEBUG}function f(){return process.env.DEBUG}function l(c){c.inspectOpts={};const g=Object.keys(e.inspectOpts);for(let w=0;w<g.length;w++)c.inspectOpts[g[w]]=e.inspectOpts[g[w]]}o.exports=vs()(e);const{formatters:h}=o.exports;h.o=function(c){return this.inspectOpts.colors=this.useColors,i.inspect(c,this.inspectOpts).split(`
`).map(g=>g.trim()).join(" ")},h.O=function(c){return this.inspectOpts.colors=this.useColors,i.inspect(c,this.inspectOpts)}}(lt,lt.exports)),lt.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Tn.exports=xu():Tn.exports=Fu();var Es=Tn.exports;const Ji=Gs,bs=Et,Ts=bt,Su=Nn.parse,Pu=Nn.format,xe=Es("httpx:body"),ft=Es("httpx:header"),Lu=new bs.Agent({keepAlive:!0}),Mu=new Ts.Agent({keepAlive:!0}),Pr=3e3,je=Symbol("TIMER::READ_TIMER"),Cn=Symbol("TIMER::READ_TIME_OUT"),Cs=Symbol("TIMER::READ_TIMER_START_AT");function Os(o){switch(o.headers["content-encoding"]){case"gzip":return o.pipe(Ji.createGunzip());case"deflate":return o.pipe(Ji.createInflate());default:return o}}var Qi=function(o,e,n){return o.name=e+o.name,o.message=`${n}. ${o.message}`,o};const Ke=function(o){return o!==null&&!isNaN(o)};We.request=function(o,e){e||(e={});const n=typeof o=="string"?Su(o):o;let i,a;Ke(e.readTimeout)||Ke(e.connectTimeout)?(i=Ke(e.readTimeout)?Number(e.readTimeout):Pr,a=Ke(e.connectTimeout)?Number(e.connectTimeout):Pr):Ke(e.timeout)?i=a=Number(e.timeout):i=a=Pr;const t=n.protocol==="https:",r=(e.method||"GET").toUpperCase(),s=t?Mu:Lu,u=e.agent||s;var f={host:n.hostname||"localhost",path:n.path||"/",method:r,port:n.port||(n.protocol==="https:"?443:80),agent:u,headers:e.headers||{},key:e.key||"",cert:e.cert||"",ca:e.ca||"",timeout:a};t&&typeof e.rejectUnauthorized<"u"&&(f.rejectUnauthorized=e.rejectUnauthorized),e.compression&&(f.headers["accept-encoding"]="gzip,deflate");const l=t?Ts:bs;return typeof e.beforeRequest=="function"&&(f=e.beforeRequest(f)),new Promise((h,c)=>{const g=l.request(f),w=e.data;var b=m=>{ft.enabled&&(m.req._header.split(`\r
`).forEach(_=>{ft("> %s",_)}),ft("< HTTP/%s %s %s",m.httpVersion,m.statusCode,m.statusMessage),Object.keys(m.headers).forEach(_=>{ft("< %s: %s",_,m.headers[_])})),h(m)},C=m=>{m.message+=`${r} ${Pu(n)} failed.`,g.socket&&g.socket[je]&&clearTimeout(g.socket[je]),c(m)},F=m=>{g.abort(),C(m)};const y=function(m){const D=setTimeout(()=>{m[je]&&(clearTimeout(m[je]),m[je]=null);var _=new Error,v=`ReadTimeout(${i})`;F(Qi(_,"RequestTimeout",v))},i);m[Cn]=i,m[je]=D,m[Cs]=Date.now(),D.unref()};!w||typeof w=="string"||w instanceof Buffer?(xe.enabled&&xe(w?typeof w=="string"?w:`Buffer <ignored>, Buffer length: ${w.length}`:"<no request body>"),g.end(w)):typeof w.pipe=="function"&&(w.pipe(g),xe.enabled&&xe("<request body is a stream>"),w.once("error",m=>{F(Qi(m,"HttpX","Stream occor error"))})),g.on("timeout",()=>{var m=new Error;m.name="RequestTimeoutError",m.message=`ConnectTimeout: Connect ${o} failed.`,g.destroy(),c(m)}),g.on("response",b),g.on("error",C),g.once("socket",function(m){m.readyState==="opening"?m.once("connect",function(){y(m)}):y(m)})})};We.read=function(o,e){const n=Os(o);return new Promise((i,a)=>{const t=o.socket||o.client,r=()=>{const C=o.req;var F=new Error;return F.name="RequestTimeoutError",F.message=`ReadTimeout: ${t[Cn]}. ${C.method} ${C.path} failed.`,F};let s;const u=t[je];if(!u){a(r());return}const f=t[Cn]-(Date.now()-t[Cs]);if(clearTimeout(u),f<=0){a(r());return}s=setTimeout(function(){a(r())},f);var l,h,c,g=function(){n.removeListener("error",l),n.removeListener("data",h),n.removeListener("end",c),s&&clearTimeout(s)};const w=[];var b=0;h=function(C){w.push(C),b+=C.length},l=function(C){g(),a(C)},c=function(){g();var C=Buffer.concat(w,b);if(xe(""),e){const F=C.toString(e);return xe(F),i(F)}xe.enabled&&xe(C.toString()),i(C)},n.on("error",l),n.on("data",h),n.on("end",c)})};function Ru(o){return new Promise((e,n)=>{var i,a,t,r=function(){o.removeListener("error",t),o.removeListener("end",a),o.removeListener("readable",i)};i=function(){r(),e(!1)},a=function(){r(),e(!0)},t=function(s){r(),n(s)},o.once("readable",i),o.once("end",a),o.once("error",t)})}class As{constructor(e,n,i,a){this.id=e,this.event=n,this.data=i,this.retry=a}}We.Event=As;const Zi="data:",eo="event:",to="id:",ro="retry:";function ju(o){for(let e=0;e<o.length;e++){const n=o.charAt(e);if(n<"0"||n>"9")return!1}return o.length>0}function $u(o,e){const n=o+e;let i=0;const a=[];for(let r=0;r<n.length-1;r++){const s=n[r],u=n[r+1];if(s===`
`&&u===`
`){const l=n.substring(i,r).split(`
`),h=new As;l.forEach(c=>{if(c.startsWith(Zi))h.data=c.substring(Zi.length).trim();else if(c.startsWith(eo))h.event=c.substring(eo.length).trim();else if(c.startsWith(to))h.id=c.substring(to.length).trim();else if(c.startsWith(ro)){const g=c.substring(ro.length).trim();ju(g)&&(h.retry=parseInt(g,10))}else c.startsWith(":")}),a.push(h),i=r+2}}const t=n.substring(i);return[a,t]}We.readAsSSE=async function*(o){const e=Os(o),n=o.socket||o.client;clearTimeout(n[je]);let i="";for(;;){if(await Ru(e))return;let t;for(;(t=e.read())!==null;){const[r,s]=$u(i,t.toString());if(i=s,r&&r.length>0)for(const u of r)yield u}}};var Pn={};(function(o){const e=ae,n=ke,i=De;o.loadJSONSync=function(a){var t=e.readFileSync(a,"utf8");t.charCodeAt(0)===65279&&(t=t.slice(1));try{return JSON.parse(t)}catch(r){throw r.message=a+": "+r.message,r}},o.encode=function(a,t){return typeof a!="string"&&(a=""+a),new Buffer(a,t)},o.makeHasher=function(a){return function(t,r){var s=i.createHash(a);return s.update(t),s.digest(r)}},o.createHash=o.makeHasher,o.md5=o.makeHasher("md5"),o.createHmac=function(a){return function(t,r,s){return i.createHmac(a,r).update(t).digest(s)}},o.sha1=o.createHmac("sha1"),o.random=function(a,t){return Math.floor(a+Math.random()*(t-a))},o.makeNonce=function(){var a=0,t;const r=n.hostname(),s=process.pid;return function(){var u=Math.floor(Math.random()*1e12);u===t?a++:a=0,t=u;var f=`${r}${s}${u}${a}`;return o.md5(f,"hex")}}(),o.pad2=function(a){return a<10?"0"+a:""+a},o.pad3=function(a){return a<10?"00"+a:a<100?"0"+a:""+a},o.getYYYYMMDD=function(a){var t=a.getFullYear(),r=o.pad2(a.getMonth()+1),s=o.pad2(a.getDate());return""+t+r+s},o.sleep=function(a){return new Promise(t=>{setTimeout(t,a)})},o.getIPv4=function(){for(var a=n.networkInterfaces(),t=Object.keys(a),r=0;r<t.length;r++)for(var s=t[r],u=a[s],f=0;f<u.length;f++){var l=u[f];if(!l.internal&&l.family==="IPv4")return l.address}return""},o.getMac=function(){for(var a=n.networkInterfaces(),t=Object.keys(a),r=0;r<t.length;r++)for(var s=t[r],u=a[s],f=0;f<u.length;f++){var l=u[f];if(!l.internal&&l.family==="IPv4")return l.mac}return"00:00:00:00:00:00"}})(Pn);var Nt={exports:{}},Ds={exports:{}},_s={exports:{}};(function(o){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,a=Math.ceil,t=Math.floor,r="[BigNumber Error] ",s=r+"Number primitive has more than 15 significant digits: ",u=1e14,f=14,l=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],c=1e7,g=1e9;function w(v){var A,T,p,O=z.prototype={constructor:z,toString:null,valueOf:null},I=new z(1),M=20,U=4,W=-7,H=21,J=-1e7,Y=1e7,Te=!1,Ce=1,he=0,fe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},Ee="0123456789abcdefghijklmnopqrstuvwxyz",Le=!0;function z(d,x){var S,$,L,R,B,P,j,k,q=this;if(!(q instanceof z))return new z(d,x);if(x==null){if(d&&d._isBigNumber===!0){q.s=d.s,!d.c||d.e>Y?q.c=q.e=null:d.e<J?q.c=[q.e=0]:(q.e=d.e,q.c=d.c.slice());return}if((P=typeof d=="number")&&d*0==0){if(q.s=1/d<0?(d=-d,-1):1,d===~~d){for(R=0,B=d;B>=10;B/=10,R++);R>Y?q.c=q.e=null:(q.e=R,q.c=[d]);return}k=String(d)}else{if(!i.test(k=String(d)))return p(q,k,P);q.s=k.charCodeAt(0)==45?(k=k.slice(1),-1):1}(R=k.indexOf("."))>-1&&(k=k.replace(".","")),(B=k.search(/e/i))>0?(R<0&&(R=B),R+=+k.slice(B+1),k=k.substring(0,B)):R<0&&(R=k.length)}else{if(y(x,2,Ee.length,"Base"),x==10&&Le)return q=new z(d),E(q,M+q.e+1,U);if(k=String(d),P=typeof d=="number"){if(d*0!=0)return p(q,k,P,x);if(q.s=1/d<0?(k=k.slice(1),-1):1,z.DEBUG&&k.replace(/^0\.0*|\./,"").length>15)throw Error(s+d)}else q.s=k.charCodeAt(0)===45?(k=k.slice(1),-1):1;for(S=Ee.slice(0,x),R=B=0,j=k.length;B<j;B++)if(S.indexOf($=k.charAt(B))<0){if($=="."){if(B>R){R=j;continue}}else if(!L&&(k==k.toUpperCase()&&(k=k.toLowerCase())||k==k.toLowerCase()&&(k=k.toUpperCase()))){L=!0,B=-1,R=0;continue}return p(q,String(d),P,x)}P=!1,k=T(k,x,10,q.s),(R=k.indexOf("."))>-1?k=k.replace(".",""):R=k.length}for(B=0;k.charCodeAt(B)===48;B++);for(j=k.length;k.charCodeAt(--j)===48;);if(k=k.slice(B,++j)){if(j-=B,P&&z.DEBUG&&j>15&&(d>l||d!==t(d)))throw Error(s+q.s*d);if((R=R-B-1)>Y)q.c=q.e=null;else if(R<J)q.c=[q.e=0];else{if(q.e=R,q.c=[],B=(R+1)%f,R<0&&(B+=f),B<j){for(B&&q.c.push(+k.slice(0,B)),j-=f;B<j;)q.c.push(+k.slice(B,B+=f));B=f-(k=k.slice(B)).length}else B-=j;for(;B--;k+="0");q.c.push(+k)}}else q.c=[q.e=0]}z.clone=w,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(d){var x,S;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(x="DECIMAL_PLACES")&&(S=d[x],y(S,0,g,x),M=S),d.hasOwnProperty(x="ROUNDING_MODE")&&(S=d[x],y(S,0,8,x),U=S),d.hasOwnProperty(x="EXPONENTIAL_AT")&&(S=d[x],S&&S.pop?(y(S[0],-g,0,x),y(S[1],0,g,x),W=S[0],H=S[1]):(y(S,-g,g,x),W=-(H=S<0?-S:S))),d.hasOwnProperty(x="RANGE"))if(S=d[x],S&&S.pop)y(S[0],-g,-1,x),y(S[1],1,g,x),J=S[0],Y=S[1];else if(y(S,-g,g,x),S)J=-(Y=S<0?-S:S);else throw Error(r+x+" cannot be zero: "+S);if(d.hasOwnProperty(x="CRYPTO"))if(S=d[x],S===!!S)if(S)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Te=S;else throw Te=!S,Error(r+"crypto unavailable");else Te=S;else throw Error(r+x+" not true or false: "+S);if(d.hasOwnProperty(x="MODULO_MODE")&&(S=d[x],y(S,0,9,x),Ce=S),d.hasOwnProperty(x="POW_PRECISION")&&(S=d[x],y(S,0,g,x),he=S),d.hasOwnProperty(x="FORMAT"))if(S=d[x],typeof S=="object")fe=S;else throw Error(r+x+" not an object: "+S);if(d.hasOwnProperty(x="ALPHABET"))if(S=d[x],typeof S=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(S))Le=S.slice(0,10)=="0123456789",Ee=S;else throw Error(r+x+" invalid: "+S)}else throw Error(r+"Object expected: "+d);return{DECIMAL_PLACES:M,ROUNDING_MODE:U,EXPONENTIAL_AT:[W,H],RANGE:[J,Y],CRYPTO:Te,MODULO_MODE:Ce,POW_PRECISION:he,FORMAT:fe,ALPHABET:Ee}},z.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!z.DEBUG)return!0;var x,S,$=d.c,L=d.e,R=d.s;e:if({}.toString.call($)=="[object Array]"){if((R===1||R===-1)&&L>=-g&&L<=g&&L===t(L)){if($[0]===0){if(L===0&&$.length===1)return!0;break e}if(x=(L+1)%f,x<1&&(x+=f),String($[0]).length==x){for(x=0;x<$.length;x++)if(S=$[x],S<0||S>=u||S!==t(S))break e;if(S!==0)return!0}}}else if($===null&&L===null&&(R===null||R===1||R===-1))return!0;throw Error(r+"Invalid BigNumber: "+d)},z.maximum=z.max=function(){return it(arguments,-1)},z.minimum=z.min=function(){return it(arguments,1)},z.random=function(){var d=9007199254740992,x=Math.random()*d&2097151?function(){return t(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(S){var $,L,R,B,P,j=0,k=[],q=new z(I);if(S==null?S=M:y(S,0,g),B=a(S/f),Te)if(crypto.getRandomValues){for($=crypto.getRandomValues(new Uint32Array(B*=2));j<B;)P=$[j]*131072+($[j+1]>>>11),P>=9e15?(L=crypto.getRandomValues(new Uint32Array(2)),$[j]=L[0],$[j+1]=L[1]):(k.push(P%1e14),j+=2);j=B/2}else if(crypto.randomBytes){for($=crypto.randomBytes(B*=7);j<B;)P=($[j]&31)*281474976710656+$[j+1]*1099511627776+$[j+2]*4294967296+$[j+3]*16777216+($[j+4]<<16)+($[j+5]<<8)+$[j+6],P>=9e15?crypto.randomBytes(7).copy($,j):(k.push(P%1e14),j+=7);j=B/7}else throw Te=!1,Error(r+"crypto unavailable");if(!Te)for(;j<B;)P=x(),P<9e15&&(k[j++]=P%1e14);for(B=k[--j],S%=f,B&&S&&(P=h[f-S],k[j]=t(B/P)*P);k[j]===0;k.pop(),j--);if(j<0)k=[R=0];else{for(R=-1;k[0]===0;k.splice(0,1),R-=f);for(j=1,P=k[0];P>=10;P/=10,j++);j<f&&(R-=f-j)}return q.e=R,q.c=k,q}}(),z.sum=function(){for(var d=1,x=arguments,S=new z(x[0]);d<x.length;)S=S.plus(x[d++]);return S},T=function(){var d="0123456789";function x(S,$,L,R){for(var B,P=[0],j,k=0,q=S.length;k<q;){for(j=P.length;j--;P[j]*=$);for(P[0]+=R.indexOf(S.charAt(k++)),B=0;B<P.length;B++)P[B]>L-1&&(P[B+1]==null&&(P[B+1]=0),P[B+1]+=P[B]/L|0,P[B]%=L)}return P.reverse()}return function(S,$,L,R,B){var P,j,k,q,V,G,K,ie,ue=S.indexOf("."),pe=M,ne=U;for(ue>=0&&(q=he,he=0,S=S.replace(".",""),ie=new z($),G=ie.pow(S.length-ue),he=q,ie.c=x(_(C(G.c),G.e,"0"),10,L,d),ie.e=ie.c.length),K=x(S,$,L,B?(P=Ee,d):(P=d,Ee)),k=q=K.length;K[--q]==0;K.pop());if(!K[0])return P.charAt(0);if(ue<0?--k:(G.c=K,G.e=k,G.s=R,G=A(G,ie,pe,ne,L),K=G.c,V=G.r,k=G.e),j=k+pe+1,ue=K[j],q=L/2,V=V||j<0||K[j+1]!=null,V=ne<4?(ue!=null||V)&&(ne==0||ne==(G.s<0?3:2)):ue>q||ue==q&&(ne==4||V||ne==6&&K[j-1]&1||ne==(G.s<0?8:7)),j<1||!K[0])S=V?_(P.charAt(1),-pe,P.charAt(0)):P.charAt(0);else{if(K.length=j,V)for(--L;++K[--j]>L;)K[j]=0,j||(++k,K=[1].concat(K));for(q=K.length;!K[--q];);for(ue=0,S="";ue<=q;S+=P.charAt(K[ue++]));S=_(S,k,P.charAt(0))}return S}}(),A=function(){function d($,L,R){var B,P,j,k,q=0,V=$.length,G=L%c,K=L/c|0;for($=$.slice();V--;)j=$[V]%c,k=$[V]/c|0,B=K*j+k*G,P=G*j+B%c*c+q,q=(P/R|0)+(B/c|0)+K*k,$[V]=P%R;return q&&($=[q].concat($)),$}function x($,L,R,B){var P,j;if(R!=B)j=R>B?1:-1;else for(P=j=0;P<R;P++)if($[P]!=L[P]){j=$[P]>L[P]?1:-1;break}return j}function S($,L,R,B){for(var P=0;R--;)$[R]-=P,P=$[R]<L[R]?1:0,$[R]=P*B+$[R]-L[R];for(;!$[0]&&$.length>1;$.splice(0,1));}return function($,L,R,B,P){var j,k,q,V,G,K,ie,ue,pe,ne,se,me,ot,Pt,Lt,_e,He,Oe=$.s==L.s?1:-1,be=$.c,ce=L.c;if(!be||!be[0]||!ce||!ce[0])return new z(!$.s||!L.s||(be?ce&&be[0]==ce[0]:!ce)?NaN:be&&be[0]==0||!ce?Oe*0:Oe/0);for(ue=new z(Oe),pe=ue.c=[],k=$.e-L.e,Oe=R+k+1,P||(P=u,k=b($.e/f)-b(L.e/f),Oe=Oe/f|0),q=0;ce[q]==(be[q]||0);q++);if(ce[q]>(be[q]||0)&&k--,Oe<0)pe.push(1),V=!0;else{for(Pt=be.length,_e=ce.length,q=0,Oe+=2,G=t(P/(ce[0]+1)),G>1&&(ce=d(ce,G,P),be=d(be,G,P),_e=ce.length,Pt=be.length),ot=_e,ne=be.slice(0,_e),se=ne.length;se<_e;ne[se++]=0);He=ce.slice(),He=[0].concat(He),Lt=ce[0],ce[1]>=P/2&&Lt++;do{if(G=0,j=x(ce,ne,_e,se),j<0){if(me=ne[0],_e!=se&&(me=me*P+(ne[1]||0)),G=t(me/Lt),G>1)for(G>=P&&(G=P-1),K=d(ce,G,P),ie=K.length,se=ne.length;x(K,ne,ie,se)==1;)G--,S(K,_e<ie?He:ce,ie,P),ie=K.length,j=1;else G==0&&(j=G=1),K=ce.slice(),ie=K.length;if(ie<se&&(K=[0].concat(K)),S(ne,K,se,P),se=ne.length,j==-1)for(;x(ce,ne,_e,se)<1;)G++,S(ne,_e<se?He:ce,se,P),se=ne.length}else j===0&&(G++,ne=[0]);pe[q++]=G,ne[0]?ne[se++]=be[ot]||0:(ne=[be[ot]],se=1)}while((ot++<Pt||ne[0]!=null)&&Oe--);V=ne[0]!=null,pe[0]||pe.splice(0,1)}if(P==u){for(q=1,Oe=pe[0];Oe>=10;Oe/=10,q++);E(ue,R+(ue.e=q+k*f-1)+1,B,V)}else ue.e=k,ue.r=+V;return ue}}();function Ve(d,x,S,$){var L,R,B,P,j;if(S==null?S=U:y(S,0,8),!d.c)return d.toString();if(L=d.c[0],B=d.e,x==null)j=C(d.c),j=$==1||$==2&&(B<=W||B>=H)?D(j,B):_(j,B,"0");else if(d=E(new z(d),x,S),R=d.e,j=C(d.c),P=j.length,$==1||$==2&&(x<=R||R<=W)){for(;P<x;j+="0",P++);j=D(j,R)}else if(x-=B,j=_(j,R,"0"),R+1>P){if(--x>0)for(j+=".";x--;j+="0");}else if(x+=R-P,x>0)for(R+1==P&&(j+=".");x--;j+="0");return d.s<0&&L?"-"+j:j}function it(d,x){for(var S,$,L=1,R=new z(d[0]);L<d.length;L++)$=new z(d[L]),(!$.s||(S=F(R,$))===x||S===0&&R.s===x)&&(R=$);return R}function N(d,x,S){for(var $=1,L=x.length;!x[--L];x.pop());for(L=x[0];L>=10;L/=10,$++);return(S=$+S*f-1)>Y?d.c=d.e=null:S<J?d.c=[d.e=0]:(d.e=S,d.c=x),d}p=function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,x=/^([^.]+)\.$/,S=/^\.([^.]+)$/,$=/^-?(Infinity|NaN)$/,L=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(R,B,P,j){var k,q=P?B:B.replace(L,"");if($.test(q))R.s=isNaN(q)?null:q<0?-1:1;else{if(!P&&(q=q.replace(d,function(V,G,K){return k=(K=K.toLowerCase())=="x"?16:K=="b"?2:8,!j||j==k?G:V}),j&&(k=j,q=q.replace(x,"$1").replace(S,"0.$1")),B!=q))return new z(q,k);if(z.DEBUG)throw Error(r+"Not a"+(j?" base "+j:"")+" number: "+B);R.s=null}R.c=R.e=null}}();function E(d,x,S,$){var L,R,B,P,j,k,q,V=d.c,G=h;if(V){e:{for(L=1,P=V[0];P>=10;P/=10,L++);if(R=x-L,R<0)R+=f,B=x,j=V[k=0],q=t(j/G[L-B-1]%10);else if(k=a((R+1)/f),k>=V.length)if($){for(;V.length<=k;V.push(0));j=q=0,L=1,R%=f,B=R-f+1}else break e;else{for(j=P=V[k],L=1;P>=10;P/=10,L++);R%=f,B=R-f+L,q=B<0?0:t(j/G[L-B-1]%10)}if($=$||x<0||V[k+1]!=null||(B<0?j:j%G[L-B-1]),$=S<4?(q||$)&&(S==0||S==(d.s<0?3:2)):q>5||q==5&&(S==4||$||S==6&&(R>0?B>0?j/G[L-B]:0:V[k-1])%10&1||S==(d.s<0?8:7)),x<1||!V[0])return V.length=0,$?(x-=d.e+1,V[0]=G[(f-x%f)%f],d.e=-x||0):V[0]=d.e=0,d;if(R==0?(V.length=k,P=1,k--):(V.length=k+1,P=G[f-R],V[k]=B>0?t(j/G[L-B]%G[B])*P:0),$)for(;;)if(k==0){for(R=1,B=V[0];B>=10;B/=10,R++);for(B=V[0]+=P,P=1;B>=10;B/=10,P++);R!=P&&(d.e++,V[0]==u&&(V[0]=1));break}else{if(V[k]+=P,V[k]!=u)break;V[k--]=0,P=1}for(R=V.length;V[--R]===0;V.pop());}d.e>Y?d.c=d.e=null:d.e<J&&(d.c=[d.e=0])}return d}function X(d){var x,S=d.e;return S===null?d.toString():(x=C(d.c),x=S<=W||S>=H?D(x,S):_(x,S,"0"),d.s<0?"-"+x:x)}return O.absoluteValue=O.abs=function(){var d=new z(this);return d.s<0&&(d.s=1),d},O.comparedTo=function(d,x){return F(this,new z(d,x))},O.decimalPlaces=O.dp=function(d,x){var S,$,L,R=this;if(d!=null)return y(d,0,g),x==null?x=U:y(x,0,8),E(new z(R),d+R.e+1,x);if(!(S=R.c))return null;if($=((L=S.length-1)-b(this.e/f))*f,L=S[L])for(;L%10==0;L/=10,$--);return $<0&&($=0),$},O.dividedBy=O.div=function(d,x){return A(this,new z(d,x),M,U)},O.dividedToIntegerBy=O.idiv=function(d,x){return A(this,new z(d,x),0,1)},O.exponentiatedBy=O.pow=function(d,x){var S,$,L,R,B,P,j,k,q,V=this;if(d=new z(d),d.c&&!d.isInteger())throw Error(r+"Exponent not an integer: "+X(d));if(x!=null&&(x=new z(x)),P=d.e>14,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!d.c||!d.c[0])return q=new z(Math.pow(+X(V),P?d.s*(2-m(d)):+X(d))),x?q.mod(x):q;if(j=d.s<0,x){if(x.c?!x.c[0]:!x.s)return new z(NaN);$=!j&&V.isInteger()&&x.isInteger(),$&&(V=V.mod(x))}else{if(d.e>9&&(V.e>0||V.e<-1||(V.e==0?V.c[0]>1||P&&V.c[1]>=24e7:V.c[0]<8e13||P&&V.c[0]<=9999975e7)))return R=V.s<0&&m(d)?-0:0,V.e>-1&&(R=1/R),new z(j?1/R:R);he&&(R=a(he/f+2))}for(P?(S=new z(.5),j&&(d.s=1),k=m(d)):(L=Math.abs(+X(d)),k=L%2),q=new z(I);;){if(k){if(q=q.times(V),!q.c)break;R?q.c.length>R&&(q.c.length=R):$&&(q=q.mod(x))}if(L){if(L=t(L/2),L===0)break;k=L%2}else if(d=d.times(S),E(d,d.e+1,1),d.e>14)k=m(d);else{if(L=+X(d),L===0)break;k=L%2}V=V.times(V),R?V.c&&V.c.length>R&&(V.c.length=R):$&&(V=V.mod(x))}return $?q:(j&&(q=I.div(q)),x?q.mod(x):R?E(q,he,U,B):q)},O.integerValue=function(d){var x=new z(this);return d==null?d=U:y(d,0,8),E(x,x.e+1,d)},O.isEqualTo=O.eq=function(d,x){return F(this,new z(d,x))===0},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(d,x){return F(this,new z(d,x))>0},O.isGreaterThanOrEqualTo=O.gte=function(d,x){return(x=F(this,new z(d,x)))===1||x===0},O.isInteger=function(){return!!this.c&&b(this.e/f)>this.c.length-2},O.isLessThan=O.lt=function(d,x){return F(this,new z(d,x))<0},O.isLessThanOrEqualTo=O.lte=function(d,x){return(x=F(this,new z(d,x)))===-1||x===0},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return this.s>0},O.isZero=function(){return!!this.c&&this.c[0]==0},O.minus=function(d,x){var S,$,L,R,B=this,P=B.s;if(d=new z(d,x),x=d.s,!P||!x)return new z(NaN);if(P!=x)return d.s=-x,B.plus(d);var j=B.e/f,k=d.e/f,q=B.c,V=d.c;if(!j||!k){if(!q||!V)return q?(d.s=-x,d):new z(V?B:NaN);if(!q[0]||!V[0])return V[0]?(d.s=-x,d):new z(q[0]?B:U==3?-0:0)}if(j=b(j),k=b(k),q=q.slice(),P=j-k){for((R=P<0)?(P=-P,L=q):(k=j,L=V),L.reverse(),x=P;x--;L.push(0));L.reverse()}else for($=(R=(P=q.length)<(x=V.length))?P:x,P=x=0;x<$;x++)if(q[x]!=V[x]){R=q[x]<V[x];break}if(R&&(L=q,q=V,V=L,d.s=-d.s),x=($=V.length)-(S=q.length),x>0)for(;x--;q[S++]=0);for(x=u-1;$>P;){if(q[--$]<V[$]){for(S=$;S&&!q[--S];q[S]=x);--q[S],q[$]+=u}q[$]-=V[$]}for(;q[0]==0;q.splice(0,1),--k);return q[0]?N(d,q,k):(d.s=U==3?-1:1,d.c=[d.e=0],d)},O.modulo=O.mod=function(d,x){var S,$,L=this;return d=new z(d,x),!L.c||!d.s||d.c&&!d.c[0]?new z(NaN):!d.c||L.c&&!L.c[0]?new z(L):(Ce==9?($=d.s,d.s=1,S=A(L,d,0,3),d.s=$,S.s*=$):S=A(L,d,0,Ce),d=L.minus(S.times(d)),!d.c[0]&&Ce==1&&(d.s=L.s),d)},O.multipliedBy=O.times=function(d,x){var S,$,L,R,B,P,j,k,q,V,G,K,ie,ue,pe,ne=this,se=ne.c,me=(d=new z(d,x)).c;if(!se||!me||!se[0]||!me[0])return!ne.s||!d.s||se&&!se[0]&&!me||me&&!me[0]&&!se?d.c=d.e=d.s=null:(d.s*=ne.s,!se||!me?d.c=d.e=null:(d.c=[0],d.e=0)),d;for($=b(ne.e/f)+b(d.e/f),d.s*=ne.s,j=se.length,V=me.length,j<V&&(ie=se,se=me,me=ie,L=j,j=V,V=L),L=j+V,ie=[];L--;ie.push(0));for(ue=u,pe=c,L=V;--L>=0;){for(S=0,G=me[L]%pe,K=me[L]/pe|0,B=j,R=L+B;R>L;)k=se[--B]%pe,q=se[B]/pe|0,P=K*k+q*G,k=G*k+P%pe*pe+ie[R]+S,S=(k/ue|0)+(P/pe|0)+K*q,ie[R--]=k%ue;ie[R]=S}return S?++$:ie.splice(0,1),N(d,ie,$)},O.negated=function(){var d=new z(this);return d.s=-d.s||null,d},O.plus=function(d,x){var S,$=this,L=$.s;if(d=new z(d,x),x=d.s,!L||!x)return new z(NaN);if(L!=x)return d.s=-x,$.minus(d);var R=$.e/f,B=d.e/f,P=$.c,j=d.c;if(!R||!B){if(!P||!j)return new z(L/0);if(!P[0]||!j[0])return j[0]?d:new z(P[0]?$:L*0)}if(R=b(R),B=b(B),P=P.slice(),L=R-B){for(L>0?(B=R,S=j):(L=-L,S=P),S.reverse();L--;S.push(0));S.reverse()}for(L=P.length,x=j.length,L-x<0&&(S=j,j=P,P=S,x=L),L=0;x;)L=(P[--x]=P[x]+j[x]+L)/u|0,P[x]=u===P[x]?0:P[x]%u;return L&&(P=[L].concat(P),++B),N(d,P,B)},O.precision=O.sd=function(d,x){var S,$,L,R=this;if(d!=null&&d!==!!d)return y(d,1,g),x==null?x=U:y(x,0,8),E(new z(R),d,x);if(!(S=R.c))return null;if(L=S.length-1,$=L*f+1,L=S[L]){for(;L%10==0;L/=10,$--);for(L=S[0];L>=10;L/=10,$++);}return d&&R.e+1>$&&($=R.e+1),$},O.shiftedBy=function(d){return y(d,-l,l),this.times("1e"+d)},O.squareRoot=O.sqrt=function(){var d,x,S,$,L,R=this,B=R.c,P=R.s,j=R.e,k=M+4,q=new z("0.5");if(P!==1||!B||!B[0])return new z(!P||P<0&&(!B||B[0])?NaN:B?R:1/0);if(P=Math.sqrt(+X(R)),P==0||P==1/0?(x=C(B),(x.length+j)%2==0&&(x+="0"),P=Math.sqrt(+x),j=b((j+1)/2)-(j<0||j%2),P==1/0?x="5e"+j:(x=P.toExponential(),x=x.slice(0,x.indexOf("e")+1)+j),S=new z(x)):S=new z(P+""),S.c[0]){for(j=S.e,P=j+k,P<3&&(P=0);;)if(L=S,S=q.times(L.plus(A(R,L,k,1))),C(L.c).slice(0,P)===(x=C(S.c)).slice(0,P))if(S.e<j&&--P,x=x.slice(P-3,P+1),x=="9999"||!$&&x=="4999"){if(!$&&(E(L,L.e+M+2,0),L.times(L).eq(R))){S=L;break}k+=4,P+=4,$=1}else{(!+x||!+x.slice(1)&&x.charAt(0)=="5")&&(E(S,S.e+M+2,1),d=!S.times(S).eq(R));break}}return E(S,S.e+M+1,U,d)},O.toExponential=function(d,x){return d!=null&&(y(d,0,g),d++),Ve(this,d,x,1)},O.toFixed=function(d,x){return d!=null&&(y(d,0,g),d=d+this.e+1),Ve(this,d,x)},O.toFormat=function(d,x,S){var $,L=this;if(S==null)d!=null&&x&&typeof x=="object"?(S=x,x=null):d&&typeof d=="object"?(S=d,d=x=null):S=fe;else if(typeof S!="object")throw Error(r+"Argument not an object: "+S);if($=L.toFixed(d,x),L.c){var R,B=$.split("."),P=+S.groupSize,j=+S.secondaryGroupSize,k=S.groupSeparator||"",q=B[0],V=B[1],G=L.s<0,K=G?q.slice(1):q,ie=K.length;if(j&&(R=P,P=j,j=R,ie-=R),P>0&&ie>0){for(R=ie%P||P,q=K.substr(0,R);R<ie;R+=P)q+=k+K.substr(R,P);j>0&&(q+=k+K.slice(R)),G&&(q="-"+q)}$=V?q+(S.decimalSeparator||"")+((j=+S.fractionGroupSize)?V.replace(new RegExp("\\d{"+j+"}\\B","g"),"$&"+(S.fractionGroupSeparator||"")):V):q}return(S.prefix||"")+$+(S.suffix||"")},O.toFraction=function(d){var x,S,$,L,R,B,P,j,k,q,V,G,K=this,ie=K.c;if(d!=null&&(P=new z(d),!P.isInteger()&&(P.c||P.s!==1)||P.lt(I)))throw Error(r+"Argument "+(P.isInteger()?"out of range: ":"not an integer: ")+X(P));if(!ie)return new z(K);for(x=new z(I),k=S=new z(I),$=j=new z(I),G=C(ie),R=x.e=G.length-K.e-1,x.c[0]=h[(B=R%f)<0?f+B:B],d=!d||P.comparedTo(x)>0?R>0?x:k:P,B=Y,Y=1/0,P=new z(G),j.c[0]=0;q=A(P,x,0,1),L=S.plus(q.times($)),L.comparedTo(d)!=1;)S=$,$=L,k=j.plus(q.times(L=k)),j=L,x=P.minus(q.times(L=x)),P=L;return L=A(d.minus(S),$,0,1),j=j.plus(L.times(k)),S=S.plus(L.times($)),j.s=k.s=K.s,R=R*2,V=A(k,$,R,U).minus(K).abs().comparedTo(A(j,S,R,U).minus(K).abs())<1?[k,$]:[j,S],Y=B,V},O.toNumber=function(){return+X(this)},O.toPrecision=function(d,x){return d!=null&&y(d,1,g),Ve(this,d,x,2)},O.toString=function(d){var x,S=this,$=S.s,L=S.e;return L===null?$?(x="Infinity",$<0&&(x="-"+x)):x="NaN":(d==null?x=L<=W||L>=H?D(C(S.c),L):_(C(S.c),L,"0"):d===10&&Le?(S=E(new z(S),M+L+1,U),x=_(C(S.c),S.e,"0")):(y(d,2,Ee.length,"Base"),x=T(_(C(S.c),L,"0"),10,d,$,!0)),$<0&&S.c[0]&&(x="-"+x)),x},O.valueOf=O.toJSON=function(){return X(this)},O._isBigNumber=!0,v!=null&&z.set(v),z}function b(v){var A=v|0;return v>0||v===A?A:A-1}function C(v){for(var A,T,p=1,O=v.length,I=v[0]+"";p<O;){for(A=v[p++]+"",T=f-A.length;T--;A="0"+A);I+=A}for(O=I.length;I.charCodeAt(--O)===48;);return I.slice(0,O+1||1)}function F(v,A){var T,p,O=v.c,I=A.c,M=v.s,U=A.s,W=v.e,H=A.e;if(!M||!U)return null;if(T=O&&!O[0],p=I&&!I[0],T||p)return T?p?0:-U:M;if(M!=U)return M;if(T=M<0,p=W==H,!O||!I)return p?0:!O^T?1:-1;if(!p)return W>H^T?1:-1;for(U=(W=O.length)<(H=I.length)?W:H,M=0;M<U;M++)if(O[M]!=I[M])return O[M]>I[M]^T?1:-1;return W==H?0:W>H^T?1:-1}function y(v,A,T,p){if(v<A||v>T||v!==t(v))throw Error(r+(p||"Argument")+(typeof v=="number"?v<A||v>T?" out of range: ":" not an integer: ":" not a primitive number: ")+String(v))}function m(v){var A=v.c.length-1;return b(v.e/f)==A&&v.c[A]%2!=0}function D(v,A){return(v.length>1?v.charAt(0)+"."+v.slice(1):v)+(A<0?"e":"e+")+A}function _(v,A,T){var p,O;if(A<0){for(O=T+".";++A;O+=T);v=O+v}else if(p=v.length,++A>p){for(O=T,A-=p;--A;O+=T);v+=O}else A<p&&(v=v.slice(0,A)+"."+v.slice(A));return v}n=w(),n.default=n.BigNumber=n,o.exports?o.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(ee)})(_s);var Ns=_s.exports;(function(o){var e=Ns,n=o.exports;(function(){var i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,a,t,r={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},s;function u(l){return i.lastIndex=0,i.test(l)?'"'+l.replace(i,function(h){var c=r[h];return typeof c=="string"?c:"\\u"+("0000"+h.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+l+'"'}function f(l,h){var c,g,w,b,C=a,F,y=h[l],m=y!=null&&(y instanceof e||e.isBigNumber(y));switch(y&&typeof y=="object"&&typeof y.toJSON=="function"&&(y=y.toJSON(l)),typeof s=="function"&&(y=s.call(h,l,y)),typeof y){case"string":return m?y:u(y);case"number":return isFinite(y)?String(y):"null";case"boolean":case"null":case"bigint":return String(y);case"object":if(!y)return"null";if(a+=t,F=[],Object.prototype.toString.apply(y)==="[object Array]"){for(b=y.length,c=0;c<b;c+=1)F[c]=f(c,y)||"null";return w=F.length===0?"[]":a?`[
`+a+F.join(`,
`+a)+`
`+C+"]":"["+F.join(",")+"]",a=C,w}if(s&&typeof s=="object")for(b=s.length,c=0;c<b;c+=1)typeof s[c]=="string"&&(g=s[c],w=f(g,y),w&&F.push(u(g)+(a?": ":":")+w));else Object.keys(y).forEach(function(D){var _=f(D,y);_&&F.push(u(D)+(a?": ":":")+_)});return w=F.length===0?"{}":a?`{
`+a+F.join(`,
`+a)+`
`+C+"}":"{"+F.join(",")+"}",a=C,w}}typeof n.stringify!="function"&&(n.stringify=function(l,h,c){var g;if(a="",t="",typeof c=="number")for(g=0;g<c;g+=1)t+=" ";else typeof c=="string"&&(t=c);if(s=h,h&&typeof h!="function"&&(typeof h!="object"||typeof h.length!="number"))throw new Error("JSON.stringify");return f("",{"":l})})})()})(Ds);var qu=Ds.exports,pt=null;const ku=/(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])/,Bu=/(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)/;var Uu=function(o){var e={strict:!1,storeAsString:!1,alwaysParseAsBig:!1,useNativeBigInt:!1,protoAction:"error",constructorAction:"error"};if(o!=null){if(o.strict===!0&&(e.strict=!0),o.storeAsString===!0&&(e.storeAsString=!0),e.alwaysParseAsBig=o.alwaysParseAsBig===!0?o.alwaysParseAsBig:!1,e.useNativeBigInt=o.useNativeBigInt===!0?o.useNativeBigInt:!1,typeof o.constructorAction<"u")if(o.constructorAction==="error"||o.constructorAction==="ignore"||o.constructorAction==="preserve")e.constructorAction=o.constructorAction;else throw new Error(`Incorrect value for constructorAction option, must be "error", "ignore" or undefined but passed ${o.constructorAction}`);if(typeof o.protoAction<"u")if(o.protoAction==="error"||o.protoAction==="ignore"||o.protoAction==="preserve")e.protoAction=o.protoAction;else throw new Error(`Incorrect value for protoAction option, must be "error", "ignore" or undefined but passed ${o.protoAction}`)}var n,i,a={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},t,r=function(b){throw{name:"SyntaxError",message:b,at:n,text:t}},s=function(b){return b&&b!==i&&r("Expected '"+b+"' instead of '"+i+"'"),i=t.charAt(n),n+=1,i},u=function(){var b,C="";for(i==="-"&&(C="-",s("-"));i>="0"&&i<="9";)C+=i,s();if(i===".")for(C+=".";s()&&i>="0"&&i<="9";)C+=i;if(i==="e"||i==="E")for(C+=i,s(),(i==="-"||i==="+")&&(C+=i,s());i>="0"&&i<="9";)C+=i,s();if(b=+C,!isFinite(b))r("Bad number");else return pt==null&&(pt=Ns),C.length>15?e.storeAsString?C:e.useNativeBigInt?BigInt(C):new pt(C):e.alwaysParseAsBig?e.useNativeBigInt?BigInt(b):new pt(b):b},f=function(){var b,C,F="",y;if(i==='"')for(var m=n;s();){if(i==='"')return n-1>m&&(F+=t.substring(m,n-1)),s(),F;if(i==="\\"){if(n-1>m&&(F+=t.substring(m,n-1)),s(),i==="u"){for(y=0,C=0;C<4&&(b=parseInt(s(),16),!!isFinite(b));C+=1)y=y*16+b;F+=String.fromCharCode(y)}else if(typeof a[i]=="string")F+=a[i];else break;m=n}}r("Bad string")},l=function(){for(;i&&i<=" ";)s()},h=function(){switch(i){case"t":return s("t"),s("r"),s("u"),s("e"),!0;case"f":return s("f"),s("a"),s("l"),s("s"),s("e"),!1;case"n":return s("n"),s("u"),s("l"),s("l"),null}r("Unexpected '"+i+"'")},c,g=function(){var b=[];if(i==="["){if(s("["),l(),i==="]")return s("]"),b;for(;i;){if(b.push(c()),l(),i==="]")return s("]"),b;s(","),l()}}r("Bad array")},w=function(){var b,C=Object.create(null);if(i==="{"){if(s("{"),l(),i==="}")return s("}"),C;for(;i;){if(b=f(),l(),s(":"),e.strict===!0&&Object.hasOwnProperty.call(C,b)&&r('Duplicate key "'+b+'"'),ku.test(b)===!0?e.protoAction==="error"?r("Object contains forbidden prototype property"):e.protoAction==="ignore"?c():C[b]=c():Bu.test(b)===!0?e.constructorAction==="error"?r("Object contains forbidden constructor property"):e.constructorAction==="ignore"?c():C[b]=c():C[b]=c(),l(),i==="}")return s("}"),C;s(","),l()}}r("Bad object")};return c=function(){switch(l(),i){case"{":return w();case"[":return g();case'"':return f();case"-":return u();default:return i>="0"&&i<="9"?u():h()}},function(b,C){var F;return t=b+"",n=0,i=" ",F=c(),l(),i&&r("Syntax error"),typeof C=="function"?function y(m,D){var _,v=m[D];return v&&typeof v=="object"&&Object.keys(v).forEach(function(A){_=y(v,A),_!==void 0?v[A]=_:delete v[A]}),C.call(m,D,v)}({"":F},""):F}},Xu=Uu,xs=qu.stringify,Is=Xu;Nt.exports=function(o){return{parse:Is(o),stringify:xs}};Nt.exports.parse=Is();Nt.exports.stringify=xs;var Fs=Nt.exports,xt={};const Vu="@alicloud/pop-core",zu="1.8.0",Wu="AliCloud POP SDK core",Hu="index.js",Gu="lib/rpc.d.ts",Ku={lint:"eslint --fix lib test",test:"mocha -R spec test/*.test.js","test-cov":"nyc -r=html -r=text -r=lcov mocha -t 3000 -R spec test/*.test.js","test-integration":"mocha -R spec test/*.integration.js",ci:"npm run lint && npm run test-cov"},Yu=["Aliyun","AliCloud","OpenAPI","POP","SDK","Core"],Ju="Jackson Tian",Qu="MIT",Zu={debug:"^3.1.0",httpx:"^2.1.2","json-bigint":"^1.0.0",kitx:"^1.2.1",xml2js:"^0.5.0"},ec=["lib","index.js"],tc={eslint:"^6.6.0","expect.js":"^0.3.1",mocha:"^4",muk:"^0.5.3",nyc:"^12.0.2",rewire:"^4.0.1"},rc={test:"test"},nc={node:">=8.0.0"},ic={type:"git",url:"git+https://github.com/aliyun/openapi-core-nodejs-sdk.git"},oc={url:"https://github.com/aliyun/openapi-core-nodejs-sdk/issues"},sc="https://github.com/aliyun/openapi-core-nodejs-sdk#readme",ac={name:Vu,version:zu,description:Wu,main:Hu,types:Gu,scripts:Ku,keywords:Yu,author:Ju,license:Qu,dependencies:Zu,files:ec,devDependencies:tc,directories:rc,engines:nc,repository:ic,bugs:oc,homepage:sc},no=ke,On=ac;xt.DEFAULT_UA=`AlibabaCloud (${no.platform()}; ${no.arch()}) Node.js/${process.version} Core/${On.version}`;xt.DEFAULT_CLIENT=`Node.js(${process.version}), ${On.name}: ${On.version}`;const Ye=_n,io=We,$e=Pn,uc=Fs,oo=xt;function Ss(o){return o.slice(0,1).toUpperCase()+o.slice(1)}function cc(o){for(var e=Object.keys(o),n={},i=0;i<e.length;i++){var a=e[i];n[Ss(a)]=o[a]}return n}function so(){var o=new Date,e=o.getUTCFullYear(),n=$e.pad2(o.getUTCMonth()+1),i=$e.pad2(o.getUTCDate()),a=$e.pad2(o.getUTCHours()),t=$e.pad2(o.getUTCMinutes()),r=$e.pad2(o.getUTCSeconds());return`${e}-${n}-${i}T${a}:${t}:${r}Z`}function Ze(o){var e=encodeURIComponent(o);return e.replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function An(o,e,n){for(var i=0;i<n.length;i++){var a=n[i];if(Array.isArray(a))An(o,`${e}.${i+1}`,a);else if(a&&typeof a=="object"){const r=Object.keys(a);for(var t=0;t<r.length;t++)Array.isArray(a[r[t]])?An(o,`${e}.${i+1}.${r[t]}`,a[r[t]]):o[`${e}.${i+1}.${r[t]}`]=a[r[t]]}else o[`${e}.${i+1}`]=a}}function lc(o){var e={},n=Object.keys(o);for(let t=0;t<n.length;t++){var i=n[t],a=o[i];Array.isArray(a)?An(e,i,a):e[i]=a}return e}function fc(o){var e=[],n=lc(o),i=Object.keys(n).sort();for(let r=0;r<i.length;r++){var a=i[r],t=n[a];e.push([Ze(a),Ze(t)])}return e}function Lr(o){for(var e=[],n=0;n<o.length;n++){var[i,a]=o[n];e.push(i+"="+a)}return e.join("&")}let pc=class{constructor(e,n){if(Ye(e,'must pass "config"'),Ye(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Ye(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else{Ye(e.accessKeyId,'must pass "config.accessKeyId"');var i=e.secretAccessKey||e.accessKeySecret;Ye(i,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=i,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:i,securityToken:e.securityToken})}}if(e.endpoint.endsWith("/")&&(e.endpoint=e.endpoint.slice(0,-1)),this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.verbose=n===!0,this.codes=new Set([200,"200","OK","Success","success"]),e.codes)for(var a of e.codes)this.codes.add(a);this.opts=e.opts||{};var t=this.endpoint.startsWith("https://")?bt:Et;this.keepAliveAgent=new t.Agent({keepAlive:!0,keepAliveMsecs:3e3})}async request(e,n={},i={}){const a=await this.credentialsProvider.getCredentials();i=Object.assign({headers:{"x-sdk-client":oo.DEFAULT_CLIENT,"user-agent":oo.DEFAULT_UA,"x-acs-action":e,"x-acs-version":this.apiVersion}},this.opts,i),i.formatAction!==!1&&(e=Ss(e)),i.formatParams!==!1&&(n=cc(n));const t={Format:"JSON",Timestamp:so(),Version:this.apiVersion};a&&a.accessKeyId&&a.accessKeySecret&&(t.SignatureMethod="HMAC-SHA1",t.SignatureVersion="1.0",t.SignatureNonce=$e.makeNonce(),t.AccessKeyId=a.accessKeyId,a.securityToken&&(t.SecurityToken=a.securityToken)),n=Object.assign({Action:e},t,n);const r=(i.method||"GET").toUpperCase(),s=fc(n);if(a&&a.accessKeyId&&a.accessKeySecret){const g=Lr(s),w=`${r}&${Ze("/")}&${Ze(g)}`,b=a.accessKeySecret+"&",C=$e.sha1(w,b,"base64");s.push(["Signature",Ze(C)])}const u=i.method==="POST"?`${this.endpoint}/`:`${this.endpoint}/?${Lr(s)}`,f={url:u,request:null,response:null};i&&!i.agent&&(i.agent=this.keepAliveAgent),i.method==="POST"&&(i.headers=i.headers||{},i.headers["content-type"]="application/x-www-form-urlencoded",i.data=Lr(s));const l=await io.request(u,i);f.request={headers:l.req.getHeaders?l.req.getHeaders():l.req._headers},f.response={statusCode:l.statusCode,headers:l.headers};const h=await io.read(l),c=uc.parse(h);if(c.Code&&!this.codes.has(c.Code)){const g=new Error(`${c.Message}, URL: ${u}`);throw g.name=c.Code+"Error",g.data=c,g.code=c.Code,g.url=u,g.entry=f,g}return this.verbose?[c,f]:c}_buildParams(){const e={Format:"JSON",SignatureMethod:"HMAC-SHA1",SignatureNonce:$e.makeNonce(),SignatureVersion:"1.0",Timestamp:so(),AccessKeyId:this.accessKeyId,Version:this.apiVersion};return this.securityToken&&(e.SecurityToken=this.securityToken),e}};var Ps=pc,Re={},Mr={},ao;function Ln(){return ao||(ao=1,(function(){Mr.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(ee)),Mr}var Rr={},Ie={},Fe={},uo;function Pe(){return uo||(uo=1,(function(){var o,e,n,i,a,t,r,s=[].slice,u={}.hasOwnProperty;o=function(){var f,l,h,c,g,w;if(w=arguments[0],g=2<=arguments.length?s.call(arguments,1):[],a(Object.assign))Object.assign.apply(null,arguments);else for(f=0,h=g.length;f<h;f++)if(c=g[f],c!=null)for(l in c)u.call(c,l)&&(w[l]=c[l]);return w},a=function(f){return!!f&&Object.prototype.toString.call(f)==="[object Function]"},t=function(f){var l;return!!f&&((l=typeof f)=="function"||l==="object")},n=function(f){return a(Array.isArray)?Array.isArray(f):Object.prototype.toString.call(f)==="[object Array]"},i=function(f){var l;if(n(f))return!f.length;for(l in f)if(u.call(f,l))return!1;return!0},r=function(f){var l,h;return t(f)&&(h=Object.getPrototypeOf(f))&&(l=h.constructor)&&typeof l=="function"&&l instanceof l&&Function.prototype.toString.call(l)===Function.prototype.toString.call(Object)},e=function(f){return a(f.valueOf)?f.valueOf():f},Fe.assign=o,Fe.isFunction=a,Fe.isObject=t,Fe.isArray=n,Fe.isEmpty=i,Fe.isPlainObject=r,Fe.getValue=e}).call(ee)),Fe}var jr={exports:{}},co;function Ls(){return co||(co=1,(function(){jr.exports=function(){function o(){}return o.prototype.hasFeature=function(e,n){return!0},o.prototype.createDocumentType=function(e,n,i){throw new Error("This DOM method is not implemented.")},o.prototype.createDocument=function(e,n,i){throw new Error("This DOM method is not implemented.")},o.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},o.prototype.getFeature=function(e,n){throw new Error("This DOM method is not implemented.")},o}()}).call(ee)),jr.exports}var $r={exports:{}},qr={exports:{}},kr={exports:{}},lo;function hc(){return lo||(lo=1,(function(){kr.exports=function(){function o(){}return o.prototype.handleError=function(e){throw new Error(e)},o}()}).call(ee)),kr.exports}var Br={exports:{}},fo;function dc(){return fo||(fo=1,(function(){Br.exports=function(){function o(e){this.arr=e||[]}return Object.defineProperty(o.prototype,"length",{get:function(){return this.arr.length}}),o.prototype.item=function(e){return this.arr[e]||null},o.prototype.contains=function(e){return this.arr.indexOf(e)!==-1},o}()}).call(ee)),Br.exports}var po;function mc(){return po||(po=1,(function(){var o,e;o=hc(),e=dc(),qr.exports=function(){function n(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new o,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(n.prototype,"parameterNames",{get:function(){return new e(Object.keys(this.defaultParams))}}),n.prototype.getParameter=function(i){return this.params.hasOwnProperty(i)?this.params[i]:null},n.prototype.canSetParameter=function(i,a){return!0},n.prototype.setParameter=function(i,a){return a!=null?this.params[i]=a:delete this.params[i]},n}()}).call(ee)),qr.exports}var Ur={exports:{}},Xr={exports:{}},Vr={exports:{}},ho;function le(){return ho||(ho=1,(function(){Vr.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(ee)),Vr.exports}var zr={exports:{}},mo;function Ms(){return mo||(mo=1,(function(){var o;o=le(),Ae(),zr.exports=function(){function e(n,i,a){if(this.parent=n,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),i==null)throw new Error("Missing attribute name. "+this.debugInfo(i));this.name=this.stringify.name(i),this.value=this.stringify.attValue(a),this.type=o.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(n){return this.value=n||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(n){return this.options.writer.attribute(this,this.options.writer.filterOptions(n))},e.prototype.debugInfo=function(n){return n=n||this.name,n==null?"parent: <"+this.parent.name+">":"attribute: {"+n+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(n){return!(n.namespaceURI!==this.namespaceURI||n.prefix!==this.prefix||n.localName!==this.localName||n.value!==this.value)},e}()}).call(ee)),zr.exports}var Wr={exports:{}},go;function Mn(){return go||(go=1,(function(){Wr.exports=function(){function o(e){this.nodes=e}return Object.defineProperty(o.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),o.prototype.clone=function(){return this.nodes=null},o.prototype.getNamedItem=function(e){return this.nodes[e]},o.prototype.setNamedItem=function(e){var n;return n=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,n||null},o.prototype.removeNamedItem=function(e){var n;return n=this.nodes[e],delete this.nodes[e],n||null},o.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},o.prototype.getNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},o.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},o.prototype.removeNamedItemNS=function(e,n){throw new Error("This DOM method is not implemented.")},o}()}).call(ee)),Wr.exports}var yo;function Rn(){return yo||(yo=1,(function(){var o,e,n,i,a,t,r,s,u=function(l,h){for(var c in h)f.call(h,c)&&(l[c]=h[c]);function g(){this.constructor=l}return g.prototype=h.prototype,l.prototype=new g,l.__super__=h.prototype,l},f={}.hasOwnProperty;s=Pe(),r=s.isObject,t=s.isFunction,a=s.getValue,i=Ae(),o=le(),e=Ms(),n=Mn(),Xr.exports=function(l){u(h,l);function h(c,g,w){var b,C,F,y;if(h.__super__.constructor.call(this,c),g==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(g),this.type=o.Element,this.attribs={},this.schemaTypeInfo=null,w!=null&&this.attribute(w),c.type===o.Document&&(this.isRoot=!0,this.documentObject=c,c.rootObject=this,c.children)){for(y=c.children,C=0,F=y.length;C<F;C++)if(b=y[C],b.type===o.DocType){b.name=this.name;break}}}return Object.defineProperty(h.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(h.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(h.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(h.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(h.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(h.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new n(this.attribs)),this.attributeMap}}),h.prototype.clone=function(){var c,g,w,b;w=Object.create(this),w.isRoot&&(w.documentObject=null),w.attribs={},b=this.attribs;for(g in b)f.call(b,g)&&(c=b[g],w.attribs[g]=c.clone());return w.children=[],this.children.forEach(function(C){var F;return F=C.clone(),F.parent=w,w.children.push(F)}),w},h.prototype.attribute=function(c,g){var w,b;if(c!=null&&(c=a(c)),r(c))for(w in c)f.call(c,w)&&(b=c[w],this.attribute(w,b));else t(g)&&(g=g.apply()),this.options.keepNullAttributes&&g==null?this.attribs[c]=new e(this,c,""):g!=null&&(this.attribs[c]=new e(this,c,g));return this},h.prototype.removeAttribute=function(c){var g,w,b;if(c==null)throw new Error("Missing attribute name. "+this.debugInfo());if(c=a(c),Array.isArray(c))for(w=0,b=c.length;w<b;w++)g=c[w],delete this.attribs[g];else delete this.attribs[c];return this},h.prototype.toString=function(c){return this.options.writer.element(this,this.options.writer.filterOptions(c))},h.prototype.att=function(c,g){return this.attribute(c,g)},h.prototype.a=function(c,g){return this.attribute(c,g)},h.prototype.getAttribute=function(c){return this.attribs.hasOwnProperty(c)?this.attribs[c].value:null},h.prototype.setAttribute=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNode=function(c){return this.attribs.hasOwnProperty(c)?this.attribs[c]:null},h.prototype.setAttributeNode=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.removeAttributeNode=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagName=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNS=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setAttributeNS=function(c,g,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.removeAttributeNS=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getAttributeNodeNS=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setAttributeNodeNS=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagNameNS=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.hasAttribute=function(c){return this.attribs.hasOwnProperty(c)},h.prototype.hasAttributeNS=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setIdAttribute=function(c,g){return this.attribs.hasOwnProperty(c)?this.attribs[c].isId:g},h.prototype.setIdAttributeNS=function(c,g,w){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.setIdAttributeNode=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagName=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByTagNameNS=function(c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.getElementsByClassName=function(c){throw new Error("This DOM method is not implemented."+this.debugInfo())},h.prototype.isEqualNode=function(c){var g,w,b;if(!h.__super__.isEqualNode.apply(this,arguments).isEqualNode(c)||c.namespaceURI!==this.namespaceURI||c.prefix!==this.prefix||c.localName!==this.localName||c.attribs.length!==this.attribs.length)return!1;for(g=w=0,b=this.attribs.length-1;0<=b?w<=b:w>=b;g=0<=b?++w:--w)if(!this.attribs[g].isEqualNode(c.attribs[g]))return!1;return!0},h}(i)}).call(ee)),Xr.exports}var Hr={exports:{}},Gr={exports:{}},vo;function It(){return vo||(vo=1,(function(){var o,e=function(i,a){for(var t in a)n.call(a,t)&&(i[t]=a[t]);function r(){this.constructor=i}return r.prototype=a.prototype,i.prototype=new r,i.__super__=a.prototype,i},n={}.hasOwnProperty;o=Ae(),Gr.exports=function(i){e(a,i);function a(t){a.__super__.constructor.call(this,t),this.value=""}return Object.defineProperty(a.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(a.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(a.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),a.prototype.clone=function(){return Object.create(this)},a.prototype.substringData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.insertData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.deleteData=function(t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.replaceData=function(t,r,s){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.isEqualNode=function(t){return!(!a.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)||t.data!==this.data)},a}(o)}).call(ee)),Gr.exports}var wo;function jn(){return wo||(wo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),Hr.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=o.CData,this.value=this.stringify.cdata(s)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.cdata(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Hr.exports}var Kr={exports:{}},Eo;function $n(){return Eo||(Eo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),Kr.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=o.Comment,this.value=this.stringify.comment(s)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.comment(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Kr.exports}var Yr={exports:{}},bo;function qn(){return bo||(bo=1,(function(){var o,e,n,i=function(t,r){for(var s in r)a.call(r,s)&&(t[s]=r[s]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;n=Pe().isObject,e=Ae(),o=le(),Yr.exports=function(t){i(r,t);function r(s,u,f,l){var h;r.__super__.constructor.call(this,s),n(u)&&(h=u,u=h.version,f=h.encoding,l=h.standalone),u||(u="1.0"),this.type=o.Declaration,this.version=this.stringify.xmlVersion(u),f!=null&&(this.encoding=this.stringify.xmlEncoding(f)),l!=null&&(this.standalone=this.stringify.xmlStandalone(l))}return r.prototype.toString=function(s){return this.options.writer.declaration(this,this.options.writer.filterOptions(s))},r}(e)}).call(ee)),Yr.exports}var Jr={exports:{}},Qr={exports:{}},To;function kn(){return To||(To=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),o=le(),Qr.exports=function(a){n(t,a);function t(r,s,u,f,l,h){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(u==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(s));if(!f)throw new Error("Missing DTD attribute type. "+this.debugInfo(s));if(!l)throw new Error("Missing DTD attribute default. "+this.debugInfo(s));if(l.indexOf("#")!==0&&(l="#"+l),!l.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(s));if(h&&!l.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(s));this.elementName=this.stringify.name(s),this.type=o.AttributeDeclaration,this.attributeName=this.stringify.name(u),this.attributeType=this.stringify.dtdAttType(f),h&&(this.defaultValue=this.stringify.dtdAttDefault(h)),this.defaultValueType=l}return t.prototype.toString=function(r){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),Qr.exports}var Zr={exports:{}},Co;function Bn(){return Co||(Co=1,(function(){var o,e,n,i=function(t,r){for(var s in r)a.call(r,s)&&(t[s]=r[s]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;n=Pe().isObject,e=Ae(),o=le(),Zr.exports=function(t){i(r,t);function r(s,u,f,l){if(r.__super__.constructor.call(this,s),f==null)throw new Error("Missing DTD entity name. "+this.debugInfo(f));if(l==null)throw new Error("Missing DTD entity value. "+this.debugInfo(f));if(this.pe=!!u,this.name=this.stringify.name(f),this.type=o.EntityDeclaration,!n(l))this.value=this.stringify.dtdEntityValue(l),this.internal=!0;else{if(!l.pubID&&!l.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(f));if(l.pubID&&!l.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(f));if(this.internal=!1,l.pubID!=null&&(this.pubID=this.stringify.dtdPubID(l.pubID)),l.sysID!=null&&(this.sysID=this.stringify.dtdSysID(l.sysID)),l.nData!=null&&(this.nData=this.stringify.dtdNData(l.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(f))}}return Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(s){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(s))},r}(e)}).call(ee)),Zr.exports}var en={exports:{}},Oo;function Un(){return Oo||(Oo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),o=le(),en.exports=function(a){n(t,a);function t(r,s,u){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());u||(u="(#PCDATA)"),Array.isArray(u)&&(u="("+u.join(",")+")"),this.name=this.stringify.name(s),this.type=o.ElementDeclaration,this.value=this.stringify.dtdElementValue(u)}return t.prototype.toString=function(r){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),en.exports}var tn={exports:{}},Ao;function Xn(){return Ao||(Ao=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),o=le(),tn.exports=function(a){n(t,a);function t(r,s,u){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing DTD notation name. "+this.debugInfo(s));if(!u.pubID&&!u.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(s));this.name=this.stringify.name(s),this.type=o.NotationDeclaration,u.pubID!=null&&(this.pubID=this.stringify.dtdPubID(u.pubID)),u.sysID!=null&&(this.sysID=this.stringify.dtdSysID(u.sysID))}return Object.defineProperty(t.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(t.prototype,"systemId",{get:function(){return this.sysID}}),t.prototype.toString=function(r){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),tn.exports}var Do;function Vn(){return Do||(Do=1,(function(){var o,e,n,i,a,t,r,s,u=function(l,h){for(var c in h)f.call(h,c)&&(l[c]=h[c]);function g(){this.constructor=l}return g.prototype=h.prototype,l.prototype=new g,l.__super__=h.prototype,l},f={}.hasOwnProperty;s=Pe().isObject,r=Ae(),o=le(),e=kn(),i=Bn(),n=Un(),a=Xn(),t=Mn(),Jr.exports=function(l){u(h,l);function h(c,g,w){var b,C,F,y,m,D;if(h.__super__.constructor.call(this,c),this.type=o.DocType,c.children){for(y=c.children,C=0,F=y.length;C<F;C++)if(b=y[C],b.type===o.Element){this.name=b.name;break}}this.documentObject=c,s(g)&&(m=g,g=m.pubID,w=m.sysID),w==null&&(D=[g,w],w=D[0],g=D[1]),g!=null&&(this.pubID=this.stringify.dtdPubID(g)),w!=null&&(this.sysID=this.stringify.dtdSysID(w))}return Object.defineProperty(h.prototype,"entities",{get:function(){var c,g,w,b,C;for(b={},C=this.children,g=0,w=C.length;g<w;g++)c=C[g],c.type===o.EntityDeclaration&&!c.pe&&(b[c.name]=c);return new t(b)}}),Object.defineProperty(h.prototype,"notations",{get:function(){var c,g,w,b,C;for(b={},C=this.children,g=0,w=C.length;g<w;g++)c=C[g],c.type===o.NotationDeclaration&&(b[c.name]=c);return new t(b)}}),Object.defineProperty(h.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(h.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(h.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),h.prototype.element=function(c,g){var w;return w=new n(this,c,g),this.children.push(w),this},h.prototype.attList=function(c,g,w,b,C){var F;return F=new e(this,c,g,w,b,C),this.children.push(F),this},h.prototype.entity=function(c,g){var w;return w=new i(this,!1,c,g),this.children.push(w),this},h.prototype.pEntity=function(c,g){var w;return w=new i(this,!0,c,g),this.children.push(w),this},h.prototype.notation=function(c,g){var w;return w=new a(this,c,g),this.children.push(w),this},h.prototype.toString=function(c){return this.options.writer.docType(this,this.options.writer.filterOptions(c))},h.prototype.ele=function(c,g){return this.element(c,g)},h.prototype.att=function(c,g,w,b,C){return this.attList(c,g,w,b,C)},h.prototype.ent=function(c,g){return this.entity(c,g)},h.prototype.pent=function(c,g){return this.pEntity(c,g)},h.prototype.not=function(c,g){return this.notation(c,g)},h.prototype.up=function(){return this.root()||this.documentObject},h.prototype.isEqualNode=function(c){return!(!h.__super__.isEqualNode.apply(this,arguments).isEqualNode(c)||c.name!==this.name||c.publicId!==this.publicId||c.systemId!==this.systemId)},h}(r)}).call(ee)),Jr.exports}var rn={exports:{}},_o;function zn(){return _o||(_o=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=Ae(),rn.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=o.Raw,this.value=this.stringify.raw(s)}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.raw(this,this.options.writer.filterOptions(r))},t}(e)}).call(ee)),rn.exports}var nn={exports:{}},No;function Wn(){return No||(No=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),nn.exports=function(a){n(t,a);function t(r,s){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=o.Text,this.value=this.stringify.text(s)}return Object.defineProperty(t.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(t.prototype,"wholeText",{get:function(){var r,s,u;for(u="",s=this.previousSibling;s;)u=s.data+u,s=s.previousSibling;for(u+=this.data,r=this.nextSibling;r;)u=u+r.data,r=r.nextSibling;return u}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.text(this,this.options.writer.filterOptions(r))},t.prototype.splitText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceWholeText=function(r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t}(e)}).call(ee)),nn.exports}var on={exports:{}},xo;function Hn(){return xo||(xo=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;o=le(),e=It(),on.exports=function(a){n(t,a);function t(r,s,u){if(t.__super__.constructor.call(this,r),s==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=o.ProcessingInstruction,this.target=this.stringify.insTarget(s),this.name=this.target,u&&(this.value=this.stringify.insValue(u))}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(r))},t.prototype.isEqualNode=function(r){return!(!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(r)||r.target!==this.target)},t}(e)}).call(ee)),on.exports}var sn={exports:{}},Io;function Rs(){return Io||(Io=1,(function(){var o,e,n=function(a,t){for(var r in t)i.call(t,r)&&(a[r]=t[r]);function s(){this.constructor=a}return s.prototype=t.prototype,a.prototype=new s,a.__super__=t.prototype,a},i={}.hasOwnProperty;e=Ae(),o=le(),sn.exports=function(a){n(t,a);function t(r){t.__super__.constructor.call(this,r),this.type=o.Dummy}return t.prototype.clone=function(){return Object.create(this)},t.prototype.toString=function(r){return""},t}(e)}).call(ee)),sn.exports}var an={exports:{}},Fo;function gc(){return Fo||(Fo=1,(function(){an.exports=function(){function o(e){this.nodes=e}return Object.defineProperty(o.prototype,"length",{get:function(){return this.nodes.length||0}}),o.prototype.clone=function(){return this.nodes=null},o.prototype.item=function(e){return this.nodes[e]||null},o}()}).call(ee)),an.exports}var un={exports:{}},So;function yc(){return So||(So=1,(function(){un.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(ee)),un.exports}var Po;function Ae(){return Po||(Po=1,(function(){var o,e,n,i,a,t,r,s,u,f,l,h,c,g,w,b,C,F={}.hasOwnProperty;C=Pe(),b=C.isObject,w=C.isFunction,g=C.isEmpty,c=C.getValue,s=null,n=null,i=null,a=null,t=null,l=null,h=null,f=null,r=null,e=null,u=null,o=null,Ur.exports=function(){function y(m){this.parent=m,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,s||(s=Rn(),n=jn(),i=$n(),a=qn(),t=Vn(),l=zn(),h=Wn(),f=Hn(),r=Rs(),e=le(),u=gc(),Mn(),o=yc())}return Object.defineProperty(y.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(y.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(y.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(y.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(y.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new u(this.children)),this.childNodeList}}),Object.defineProperty(y.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(y.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(y.prototype,"previousSibling",{get:function(){var m;return m=this.parent.children.indexOf(this),this.parent.children[m-1]||null}}),Object.defineProperty(y.prototype,"nextSibling",{get:function(){var m;return m=this.parent.children.indexOf(this),this.parent.children[m+1]||null}}),Object.defineProperty(y.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(y.prototype,"textContent",{get:function(){var m,D,_,v,A;if(this.nodeType===e.Element||this.nodeType===e.DocumentFragment){for(A="",v=this.children,D=0,_=v.length;D<_;D++)m=v[D],m.textContent&&(A+=m.textContent);return A}else return null},set:function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),y.prototype.setParent=function(m){var D,_,v,A,T;for(this.parent=m,m&&(this.options=m.options,this.stringify=m.stringify),A=this.children,T=[],_=0,v=A.length;_<v;_++)D=A[_],T.push(D.setParent(this));return T},y.prototype.element=function(m,D,_){var v,A,T,p,O,I,M,U,W,H,J;if(I=null,D===null&&_==null&&(W=[{},null],D=W[0],_=W[1]),D==null&&(D={}),D=c(D),b(D)||(H=[D,_],_=H[0],D=H[1]),m!=null&&(m=c(m)),Array.isArray(m))for(T=0,M=m.length;T<M;T++)A=m[T],I=this.element(A);else if(w(m))I=this.element(m.apply());else if(b(m)){for(O in m)if(F.call(m,O))if(J=m[O],w(J)&&(J=J.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&O.indexOf(this.stringify.convertAttKey)===0)I=this.attribute(O.substr(this.stringify.convertAttKey.length),J);else if(!this.options.separateArrayItems&&Array.isArray(J)&&g(J))I=this.dummy();else if(b(J)&&g(J))I=this.element(O);else if(!this.options.keepNullNodes&&J==null)I=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(J))for(p=0,U=J.length;p<U;p++)A=J[p],v={},v[O]=A,I=this.element(v);else b(J)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&O.indexOf(this.stringify.convertTextKey)===0?I=this.element(J):(I=this.element(O),I.element(J)):I=this.element(O,J)}else!this.options.keepNullNodes&&_===null?I=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&m.indexOf(this.stringify.convertTextKey)===0?I=this.text(_):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&m.indexOf(this.stringify.convertCDataKey)===0?I=this.cdata(_):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&m.indexOf(this.stringify.convertCommentKey)===0?I=this.comment(_):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&m.indexOf(this.stringify.convertRawKey)===0?I=this.raw(_):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&m.indexOf(this.stringify.convertPIKey)===0?I=this.instruction(m.substr(this.stringify.convertPIKey.length),_):I=this.node(m,D,_);if(I==null)throw new Error("Could not create any elements with: "+m+". "+this.debugInfo());return I},y.prototype.insertBefore=function(m,D,_){var v,A,T,p,O;if(m!=null&&m.type)return T=m,p=D,T.setParent(this),p?(A=children.indexOf(p),O=children.splice(A),children.push(T),Array.prototype.push.apply(children,O)):children.push(T),T;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(m));return A=this.parent.children.indexOf(this),O=this.parent.children.splice(A),v=this.parent.element(m,D,_),Array.prototype.push.apply(this.parent.children,O),v},y.prototype.insertAfter=function(m,D,_){var v,A,T;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(m));return A=this.parent.children.indexOf(this),T=this.parent.children.splice(A+1),v=this.parent.element(m,D,_),Array.prototype.push.apply(this.parent.children,T),v},y.prototype.remove=function(){var m;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return m=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[m,m-m+1].concat([])),this.parent},y.prototype.node=function(m,D,_){var v,A;return m!=null&&(m=c(m)),D||(D={}),D=c(D),b(D)||(A=[D,_],_=A[0],D=A[1]),v=new s(this,m,D),_!=null&&v.text(_),this.children.push(v),v},y.prototype.text=function(m){var D;return b(m)&&this.element(m),D=new h(this,m),this.children.push(D),this},y.prototype.cdata=function(m){var D;return D=new n(this,m),this.children.push(D),this},y.prototype.comment=function(m){var D;return D=new i(this,m),this.children.push(D),this},y.prototype.commentBefore=function(m){var D,_;return D=this.parent.children.indexOf(this),_=this.parent.children.splice(D),this.parent.comment(m),Array.prototype.push.apply(this.parent.children,_),this},y.prototype.commentAfter=function(m){var D,_;return D=this.parent.children.indexOf(this),_=this.parent.children.splice(D+1),this.parent.comment(m),Array.prototype.push.apply(this.parent.children,_),this},y.prototype.raw=function(m){var D;return D=new l(this,m),this.children.push(D),this},y.prototype.dummy=function(){var m;return m=new r(this),m},y.prototype.instruction=function(m,D){var _,v,A,T,p;if(m!=null&&(m=c(m)),D!=null&&(D=c(D)),Array.isArray(m))for(T=0,p=m.length;T<p;T++)_=m[T],this.instruction(_);else if(b(m))for(_ in m)F.call(m,_)&&(v=m[_],this.instruction(_,v));else w(D)&&(D=D.apply()),A=new f(this,m,D),this.children.push(A);return this},y.prototype.instructionBefore=function(m,D){var _,v;return _=this.parent.children.indexOf(this),v=this.parent.children.splice(_),this.parent.instruction(m,D),Array.prototype.push.apply(this.parent.children,v),this},y.prototype.instructionAfter=function(m,D){var _,v;return _=this.parent.children.indexOf(this),v=this.parent.children.splice(_+1),this.parent.instruction(m,D),Array.prototype.push.apply(this.parent.children,v),this},y.prototype.declaration=function(m,D,_){var v,A;return v=this.document(),A=new a(v,m,D,_),v.children.length===0?v.children.unshift(A):v.children[0].type===e.Declaration?v.children[0]=A:v.children.unshift(A),v.root()||v},y.prototype.dtd=function(m,D){var _,v,A,T,p,O,I,M,U,W;for(v=this.document(),A=new t(v,m,D),U=v.children,T=p=0,I=U.length;p<I;T=++p)if(_=U[T],_.type===e.DocType)return v.children[T]=A,A;for(W=v.children,T=O=0,M=W.length;O<M;T=++O)if(_=W[T],_.isRoot)return v.children.splice(T,0,A),A;return v.children.push(A),A},y.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},y.prototype.root=function(){var m;for(m=this;m;){if(m.type===e.Document)return m.rootObject;if(m.isRoot)return m;m=m.parent}},y.prototype.document=function(){var m;for(m=this;m;){if(m.type===e.Document)return m;m=m.parent}},y.prototype.end=function(m){return this.document().end(m)},y.prototype.prev=function(){var m;if(m=this.parent.children.indexOf(this),m<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[m-1]},y.prototype.next=function(){var m;if(m=this.parent.children.indexOf(this),m===-1||m===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[m+1]},y.prototype.importDocument=function(m){var D;return D=m.root().clone(),D.parent=this,D.isRoot=!1,this.children.push(D),this},y.prototype.debugInfo=function(m){var D,_;return m=m||this.name,m==null&&!((D=this.parent)!=null&&D.name)?"":m==null?"parent: <"+this.parent.name+">":(_=this.parent)!=null&&_.name?"node: <"+m+">, parent: <"+this.parent.name+">":"node: <"+m+">"},y.prototype.ele=function(m,D,_){return this.element(m,D,_)},y.prototype.nod=function(m,D,_){return this.node(m,D,_)},y.prototype.txt=function(m){return this.text(m)},y.prototype.dat=function(m){return this.cdata(m)},y.prototype.com=function(m){return this.comment(m)},y.prototype.ins=function(m,D){return this.instruction(m,D)},y.prototype.doc=function(){return this.document()},y.prototype.dec=function(m,D,_){return this.declaration(m,D,_)},y.prototype.e=function(m,D,_){return this.element(m,D,_)},y.prototype.n=function(m,D,_){return this.node(m,D,_)},y.prototype.t=function(m){return this.text(m)},y.prototype.d=function(m){return this.cdata(m)},y.prototype.c=function(m){return this.comment(m)},y.prototype.r=function(m){return this.raw(m)},y.prototype.i=function(m,D){return this.instruction(m,D)},y.prototype.u=function(){return this.up()},y.prototype.importXMLBuilder=function(m){return this.importDocument(m)},y.prototype.replaceChild=function(m,D){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.removeChild=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.appendChild=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.hasChildNodes=function(){return this.children.length!==0},y.prototype.cloneNode=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.isSupported=function(m,D){return!0},y.prototype.hasAttributes=function(){return this.attribs.length!==0},y.prototype.compareDocumentPosition=function(m){var D,_;return D=this,D===m?0:this.document()!==m.document()?(_=o.Disconnected|o.ImplementationSpecific,Math.random()<.5?_|=o.Preceding:_|=o.Following,_):D.isAncestor(m)?o.Contains|o.Preceding:D.isDescendant(m)?o.Contains|o.Following:D.isPreceding(m)?o.Preceding:o.Following},y.prototype.isSameNode=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.lookupPrefix=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.isDefaultNamespace=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.lookupNamespaceURI=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.isEqualNode=function(m){var D,_,v;if(m.nodeType!==this.nodeType||m.children.length!==this.children.length)return!1;for(D=_=0,v=this.children.length-1;0<=v?_<=v:_>=v;D=0<=v?++_:--_)if(!this.children[D].isEqualNode(m.children[D]))return!1;return!0},y.prototype.getFeature=function(m,D){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.setUserData=function(m,D,_){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.getUserData=function(m){throw new Error("This DOM method is not implemented."+this.debugInfo())},y.prototype.contains=function(m){return m?m===this||this.isDescendant(m):!1},y.prototype.isDescendant=function(m){var D,_,v,A,T;for(T=this.children,v=0,A=T.length;v<A;v++)if(D=T[v],m===D||(_=D.isDescendant(m),_))return!0;return!1},y.prototype.isAncestor=function(m){return m.isDescendant(this)},y.prototype.isPreceding=function(m){var D,_;return D=this.treePosition(m),_=this.treePosition(this),D===-1||_===-1?!1:D<_},y.prototype.isFollowing=function(m){var D,_;return D=this.treePosition(m),_=this.treePosition(this),D===-1||_===-1?!1:D>_},y.prototype.treePosition=function(m){var D,_;return _=0,D=!1,this.foreachTreeNode(this.document(),function(v){if(_++,!D&&v===m)return D=!0}),D?_:-1},y.prototype.foreachTreeNode=function(m,D){var _,v,A,T,p;for(m||(m=this.document()),T=m.children,v=0,A=T.length;v<A;v++){if(_=T[v],p=D(_))return p;if(p=this.foreachTreeNode(_,D),p)return p}},y}()}).call(ee)),Ur.exports}var cn={exports:{}},Lo;function js(){return Lo||(Lo=1,(function(){var o=function(n,i){return function(){return n.apply(i,arguments)}},e={}.hasOwnProperty;cn.exports=function(){function n(i){this.assertLegalName=o(this.assertLegalName,this),this.assertLegalChar=o(this.assertLegalChar,this);var a,t,r;i||(i={}),this.options=i,this.options.version||(this.options.version="1.0"),t=i.stringify||{};for(a in t)e.call(t,a)&&(r=t[a],this[a]=r)}return n.prototype.name=function(i){return this.options.noValidation?i:this.assertLegalName(""+i||"")},n.prototype.text=function(i){return this.options.noValidation?i:this.assertLegalChar(this.textEscape(""+i||""))},n.prototype.cdata=function(i){return this.options.noValidation?i:(i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i))},n.prototype.comment=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},n.prototype.raw=function(i){return this.options.noValidation?i:""+i||""},n.prototype.attValue=function(i){return this.options.noValidation?i:this.assertLegalChar(this.attEscape(i=""+i||""))},n.prototype.insTarget=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.insValue=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return this.assertLegalChar(i)},n.prototype.xmlVersion=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},n.prototype.xmlEncoding=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return this.assertLegalChar(i)},n.prototype.xmlStandalone=function(i){return this.options.noValidation?i:i?"yes":"no"},n.prototype.dtdPubID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdSysID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdElementValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttType=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttDefault=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdEntityValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdNData=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.convertAttKey="@",n.prototype.convertPIKey="?",n.prototype.convertTextKey="#text",n.prototype.convertCDataKey="#cdata",n.prototype.convertCommentKey="#comment",n.prototype.convertRawKey="#raw",n.prototype.assertLegalChar=function(i){var a,t;if(this.options.noValidation)return i;if(a="",this.options.version==="1.0"){if(a=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,t=i.match(a))throw new Error("Invalid character in string: "+i+" at index "+t.index)}else if(this.options.version==="1.1"&&(a=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,t=i.match(a)))throw new Error("Invalid character in string: "+i+" at index "+t.index);return i},n.prototype.assertLegalName=function(i){var a;if(this.options.noValidation)return i;if(this.assertLegalChar(i),a=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!i.match(a))throw new Error("Invalid character in name");return i},n.prototype.textEscape=function(i){var a;return this.options.noValidation?i:(a=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(a,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},n.prototype.attEscape=function(i){var a;return this.options.noValidation?i:(a=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(a,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},n}()}).call(ee)),cn.exports}var ln={exports:{}},fn={exports:{}},pn={exports:{}},Mo;function Ft(){return Mo||(Mo=1,(function(){pn.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(ee)),pn.exports}var Ro;function $s(){return Ro||(Ro=1,(function(){var o,e,n,i={}.hasOwnProperty;n=Pe().assign,o=le(),qn(),Vn(),jn(),$n(),Rn(),zn(),Wn(),Hn(),Rs(),kn(),Un(),Bn(),Xn(),e=Ft(),fn.exports=function(){function a(t){var r,s,u;t||(t={}),this.options=t,s=t.writer||{};for(r in s)i.call(s,r)&&(u=s[r],this["_"+r]=this[r],this[r]=u)}return a.prototype.filterOptions=function(t){var r,s,u,f,l,h,c,g;return t||(t={}),t=n({},this.options,t),r={writer:this},r.pretty=t.pretty||!1,r.allowEmpty=t.allowEmpty||!1,r.indent=(s=t.indent)!=null?s:"  ",r.newline=(u=t.newline)!=null?u:`
`,r.offset=(f=t.offset)!=null?f:0,r.dontPrettyTextNodes=(l=(h=t.dontPrettyTextNodes)!=null?h:t.dontprettytextnodes)!=null?l:0,r.spaceBeforeSlash=(c=(g=t.spaceBeforeSlash)!=null?g:t.spacebeforeslash)!=null?c:"",r.spaceBeforeSlash===!0&&(r.spaceBeforeSlash=" "),r.suppressPrettyCount=0,r.user={},r.state=e.None,r},a.prototype.indent=function(t,r,s){var u;return!r.pretty||r.suppressPrettyCount?"":r.pretty&&(u=(s||0)+r.offset+1,u>0)?new Array(u).join(r.indent):""},a.prototype.endline=function(t,r,s){return!r.pretty||r.suppressPrettyCount?"":r.newline},a.prototype.attribute=function(t,r,s){var u;return this.openAttribute(t,r,s),u=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,r,s),u},a.prototype.cdata=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<![CDATA[",r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+="]]>"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.comment=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!-- ",r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=" -->"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.declaration=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<?xml",r.state=e.InsideTag,u+=' version="'+t.version+'"',t.encoding!=null&&(u+=' encoding="'+t.encoding+'"'),t.standalone!=null&&(u+=' standalone="'+t.standalone+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+"?>",u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.docType=function(t,r,s){var u,f,l,h,c;if(s||(s=0),this.openNode(t,r,s),r.state=e.OpenTag,h=this.indent(t,r,s),h+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?h+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(h+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(h+=" [",h+=this.endline(t,r,s),r.state=e.InsideTag,c=t.children,f=0,l=c.length;f<l;f++)u=c[f],h+=this.writeChildNode(u,r,s+1);r.state=e.CloseTag,h+="]"}return r.state=e.CloseTag,h+=r.spaceBeforeSlash+">",h+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),h},a.prototype.element=function(t,r,s){var u,f,l,h,c,g,w,b,C,F,y,m,D,_;s||(s=0),F=!1,y="",this.openNode(t,r,s),r.state=e.OpenTag,y+=this.indent(t,r,s)+"<"+t.name,m=t.attribs;for(C in m)i.call(m,C)&&(u=m[C],y+=this.attribute(u,r,s));if(l=t.children.length,h=l===0?null:t.children[0],l===0||t.children.every(function(v){return(v.type===o.Text||v.type===o.Raw)&&v.value===""}))r.allowEmpty?(y+=">",r.state=e.CloseTag,y+="</"+t.name+">"+this.endline(t,r,s)):(r.state=e.CloseTag,y+=r.spaceBeforeSlash+"/>"+this.endline(t,r,s));else if(r.pretty&&l===1&&(h.type===o.Text||h.type===o.Raw)&&h.value!=null)y+=">",r.state=e.InsideTag,r.suppressPrettyCount++,F=!0,y+=this.writeChildNode(h,r,s+1),r.suppressPrettyCount--,F=!1,r.state=e.CloseTag,y+="</"+t.name+">"+this.endline(t,r,s);else{if(r.dontPrettyTextNodes){for(D=t.children,c=0,w=D.length;c<w;c++)if(f=D[c],(f.type===o.Text||f.type===o.Raw)&&f.value!=null){r.suppressPrettyCount++,F=!0;break}}for(y+=">"+this.endline(t,r,s),r.state=e.InsideTag,_=t.children,g=0,b=_.length;g<b;g++)f=_[g],y+=this.writeChildNode(f,r,s+1);r.state=e.CloseTag,y+=this.indent(t,r,s)+"</"+t.name+">",F&&r.suppressPrettyCount--,y+=this.endline(t,r,s),r.state=e.None}return this.closeNode(t,r,s),y},a.prototype.writeChildNode=function(t,r,s){switch(t.type){case o.CData:return this.cdata(t,r,s);case o.Comment:return this.comment(t,r,s);case o.Element:return this.element(t,r,s);case o.Raw:return this.raw(t,r,s);case o.Text:return this.text(t,r,s);case o.ProcessingInstruction:return this.processingInstruction(t,r,s);case o.Dummy:return"";case o.Declaration:return this.declaration(t,r,s);case o.DocType:return this.docType(t,r,s);case o.AttributeDeclaration:return this.dtdAttList(t,r,s);case o.ElementDeclaration:return this.dtdElement(t,r,s);case o.EntityDeclaration:return this.dtdEntity(t,r,s);case o.NotationDeclaration:return this.dtdNotation(t,r,s);default:throw new Error("Unknown XML node type: "+t.constructor.name)}},a.prototype.processingInstruction=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<?",r.state=e.InsideTag,u+=t.target,t.value&&(u+=" "+t.value),r.state=e.CloseTag,u+=r.spaceBeforeSlash+"?>",u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.raw=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s),r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.text=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s),r.state=e.InsideTag,u+=t.value,r.state=e.CloseTag,u+=this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdAttList=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!ATTLIST",r.state=e.InsideTag,u+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,t.defaultValueType!=="#DEFAULT"&&(u+=" "+t.defaultValueType),t.defaultValue&&(u+=' "'+t.defaultValue+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdElement=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!ELEMENT",r.state=e.InsideTag,u+=" "+t.name+" "+t.value,r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdEntity=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!ENTITY",r.state=e.InsideTag,t.pe&&(u+=" %"),u+=" "+t.name,t.value?u+=' "'+t.value+'"':(t.pubID&&t.sysID?u+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(u+=' SYSTEM "'+t.sysID+'"'),t.nData&&(u+=" NDATA "+t.nData)),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.dtdNotation=function(t,r,s){var u;return this.openNode(t,r,s),r.state=e.OpenTag,u=this.indent(t,r,s)+"<!NOTATION",r.state=e.InsideTag,u+=" "+t.name,t.pubID&&t.sysID?u+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?u+=' PUBLIC "'+t.pubID+'"':t.sysID&&(u+=' SYSTEM "'+t.sysID+'"'),r.state=e.CloseTag,u+=r.spaceBeforeSlash+">"+this.endline(t,r,s),r.state=e.None,this.closeNode(t,r,s),u},a.prototype.openNode=function(t,r,s){},a.prototype.closeNode=function(t,r,s){},a.prototype.openAttribute=function(t,r,s){},a.prototype.closeAttribute=function(t,r,s){},a}()}).call(ee)),fn.exports}var jo;function Gn(){return jo||(jo=1,(function(){var o,e=function(i,a){for(var t in a)n.call(a,t)&&(i[t]=a[t]);function r(){this.constructor=i}return r.prototype=a.prototype,i.prototype=new r,i.__super__=a.prototype,i},n={}.hasOwnProperty;o=$s(),ln.exports=function(i){e(a,i);function a(t){a.__super__.constructor.call(this,t)}return a.prototype.document=function(t,r){var s,u,f,l,h;for(r=this.filterOptions(r),l="",h=t.children,u=0,f=h.length;u<f;u++)s=h[u],l+=this.writeChildNode(s,r,0);return r.pretty&&l.slice(-r.newline.length)===r.newline&&(l=l.slice(0,-r.newline.length)),l},a}(o)}).call(ee)),ln.exports}var $o;function qs(){return $o||($o=1,(function(){var o,e,n,i,a,t,r,s=function(f,l){for(var h in l)u.call(l,h)&&(f[h]=l[h]);function c(){this.constructor=f}return c.prototype=l.prototype,f.prototype=new c,f.__super__=l.prototype,f},u={}.hasOwnProperty;r=Pe().isPlainObject,n=Ls(),e=mc(),i=Ae(),o=le(),t=js(),a=Gn(),$r.exports=function(f){s(l,f);function l(h){l.__super__.constructor.call(this,null),this.name="#document",this.type=o.Document,this.documentURI=null,this.domConfig=new e,h||(h={}),h.writer||(h.writer=new a),this.options=h,this.stringify=new t(h)}return Object.defineProperty(l.prototype,"implementation",{value:new n}),Object.defineProperty(l.prototype,"doctype",{get:function(){var h,c,g,w;for(w=this.children,c=0,g=w.length;c<g;c++)if(h=w[c],h.type===o.DocType)return h;return null}}),Object.defineProperty(l.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(l.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(l.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(l.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===o.Declaration?this.children[0].encoding:null}}),Object.defineProperty(l.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===o.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(l.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===o.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(l.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(l.prototype,"origin",{get:function(){return null}}),Object.defineProperty(l.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(l.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(l.prototype,"contentType",{get:function(){return null}}),l.prototype.end=function(h){var c;return c={},h?r(h)&&(c=h,h=this.options.writer):h=this.options.writer,h.document(this,h.filterOptions(c))},l.prototype.toString=function(h){return this.options.writer.document(this,this.options.writer.filterOptions(h))},l.prototype.createElement=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createTextNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createComment=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createCDATASection=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createProcessingInstruction=function(h,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createAttribute=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createEntityReference=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.importNode=function(h,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createElementNS=function(h,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createAttributeNS=function(h,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementsByTagNameNS=function(h,c){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementById=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.adoptNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.renameNode=function(h,c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.getElementsByClassName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createEvent=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createNodeIterator=function(h,c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},l.prototype.createTreeWalker=function(h,c,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},l}(i)}).call(ee)),$r.exports}var hn={exports:{}},qo;function vc(){return qo||(qo=1,(function(){var o,e,n,i,a,t,r,s,u,f,l,h,c,g,w,b,C,F,y,m,D,_,v,A={}.hasOwnProperty;v=Pe(),D=v.isObject,m=v.isFunction,_=v.isPlainObject,y=v.getValue,o=le(),h=qs(),c=Rn(),i=jn(),a=$n(),w=zn(),F=Wn(),g=Hn(),f=qn(),l=Vn(),t=kn(),s=Bn(),r=Un(),u=Xn(),n=Ms(),C=js(),b=Gn(),e=Ft(),hn.exports=function(){function T(p,O,I){var M;this.name="?xml",this.type=o.Document,p||(p={}),M={},p.writer?_(p.writer)&&(M=p.writer,p.writer=new b):p.writer=new b,this.options=p,this.writer=p.writer,this.writerOptions=this.writer.filterOptions(M),this.stringify=new C(p),this.onDataCallback=O||function(){},this.onEndCallback=I||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return T.prototype.createChildNode=function(p){var O,I,M,U,W,H,J,Y;switch(p.type){case o.CData:this.cdata(p.value);break;case o.Comment:this.comment(p.value);break;case o.Element:M={},J=p.attribs;for(I in J)A.call(J,I)&&(O=J[I],M[I]=O.value);this.node(p.name,M);break;case o.Dummy:this.dummy();break;case o.Raw:this.raw(p.value);break;case o.Text:this.text(p.value);break;case o.ProcessingInstruction:this.instruction(p.target,p.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+p.constructor.name)}for(Y=p.children,W=0,H=Y.length;W<H;W++)U=Y[W],this.createChildNode(U),U.type===o.Element&&this.up();return this},T.prototype.dummy=function(){return this},T.prototype.node=function(p,O,I){var M;if(p==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(p));return this.openCurrent(),p=y(p),O==null&&(O={}),O=y(O),D(O)||(M=[O,I],I=M[0],O=M[1]),this.currentNode=new c(this,p,O),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,I!=null&&this.text(I),this},T.prototype.element=function(p,O,I){var M,U,W,H,J,Y;if(this.currentNode&&this.currentNode.type===o.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(p)||D(p)||m(p))for(H=this.options.noValidation,this.options.noValidation=!0,Y=new h(this.options).element("TEMP_ROOT"),Y.element(p),this.options.noValidation=H,J=Y.children,U=0,W=J.length;U<W;U++)M=J[U],this.createChildNode(M),M.type===o.Element&&this.up();else this.node(p,O,I);return this},T.prototype.attribute=function(p,O){var I,M;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(p));if(p!=null&&(p=y(p)),D(p))for(I in p)A.call(p,I)&&(M=p[I],this.attribute(I,M));else m(O)&&(O=O.apply()),this.options.keepNullAttributes&&O==null?this.currentNode.attribs[p]=new n(this,p,""):O!=null&&(this.currentNode.attribs[p]=new n(this,p,O));return this},T.prototype.text=function(p){var O;return this.openCurrent(),O=new F(this,p),this.onData(this.writer.text(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.cdata=function(p){var O;return this.openCurrent(),O=new i(this,p),this.onData(this.writer.cdata(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.comment=function(p){var O;return this.openCurrent(),O=new a(this,p),this.onData(this.writer.comment(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.raw=function(p){var O;return this.openCurrent(),O=new w(this,p),this.onData(this.writer.raw(O,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.instruction=function(p,O){var I,M,U,W,H;if(this.openCurrent(),p!=null&&(p=y(p)),O!=null&&(O=y(O)),Array.isArray(p))for(I=0,W=p.length;I<W;I++)M=p[I],this.instruction(M);else if(D(p))for(M in p)A.call(p,M)&&(U=p[M],this.instruction(M,U));else m(O)&&(O=O.apply()),H=new g(this,p,O),this.onData(this.writer.processingInstruction(H,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},T.prototype.declaration=function(p,O,I){var M;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return M=new f(this,p,O,I),this.onData(this.writer.declaration(M,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.doctype=function(p,O,I){if(this.openCurrent(),p==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,O,I),this.currentNode.rootNodeName=p,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},T.prototype.dtdElement=function(p,O){var I;return this.openCurrent(),I=new r(this,p,O),this.onData(this.writer.dtdElement(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.attList=function(p,O,I,M,U){var W;return this.openCurrent(),W=new t(this,p,O,I,M,U),this.onData(this.writer.dtdAttList(W,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.entity=function(p,O){var I;return this.openCurrent(),I=new s(this,!1,p,O),this.onData(this.writer.dtdEntity(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.pEntity=function(p,O){var I;return this.openCurrent(),I=new s(this,!0,p,O),this.onData(this.writer.dtdEntity(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.notation=function(p,O){var I;return this.openCurrent(),I=new u(this,p,O),this.onData(this.writer.dtdNotation(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},T.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},T.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},T.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},T.prototype.openNode=function(p){var O,I,M,U;if(!p.isOpen){if(!this.root&&this.currentLevel===0&&p.type===o.Element&&(this.root=p),I="",p.type===o.Element){this.writerOptions.state=e.OpenTag,I=this.writer.indent(p,this.writerOptions,this.currentLevel)+"<"+p.name,U=p.attribs;for(M in U)A.call(U,M)&&(O=U[M],I+=this.writer.attribute(O,this.writerOptions,this.currentLevel));I+=(p.children?">":"/>")+this.writer.endline(p,this.writerOptions,this.currentLevel),this.writerOptions.state=e.InsideTag}else this.writerOptions.state=e.OpenTag,I=this.writer.indent(p,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+p.rootNodeName,p.pubID&&p.sysID?I+=' PUBLIC "'+p.pubID+'" "'+p.sysID+'"':p.sysID&&(I+=' SYSTEM "'+p.sysID+'"'),p.children?(I+=" [",this.writerOptions.state=e.InsideTag):(this.writerOptions.state=e.CloseTag,I+=">"),I+=this.writer.endline(p,this.writerOptions,this.currentLevel);return this.onData(I,this.currentLevel),p.isOpen=!0}},T.prototype.closeNode=function(p){var O;if(!p.isClosed)return O="",this.writerOptions.state=e.CloseTag,p.type===o.Element?O=this.writer.indent(p,this.writerOptions,this.currentLevel)+"</"+p.name+">"+this.writer.endline(p,this.writerOptions,this.currentLevel):O=this.writer.indent(p,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(p,this.writerOptions,this.currentLevel),this.writerOptions.state=e.None,this.onData(O,this.currentLevel),p.isClosed=!0},T.prototype.onData=function(p,O){return this.documentStarted=!0,this.onDataCallback(p,O+1)},T.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},T.prototype.debugInfo=function(p){return p==null?"":"node: <"+p+">"},T.prototype.ele=function(){return this.element.apply(this,arguments)},T.prototype.nod=function(p,O,I){return this.node(p,O,I)},T.prototype.txt=function(p){return this.text(p)},T.prototype.dat=function(p){return this.cdata(p)},T.prototype.com=function(p){return this.comment(p)},T.prototype.ins=function(p,O){return this.instruction(p,O)},T.prototype.dec=function(p,O,I){return this.declaration(p,O,I)},T.prototype.dtd=function(p,O,I){return this.doctype(p,O,I)},T.prototype.e=function(p,O,I){return this.element(p,O,I)},T.prototype.n=function(p,O,I){return this.node(p,O,I)},T.prototype.t=function(p){return this.text(p)},T.prototype.d=function(p){return this.cdata(p)},T.prototype.c=function(p){return this.comment(p)},T.prototype.r=function(p){return this.raw(p)},T.prototype.i=function(p,O){return this.instruction(p,O)},T.prototype.att=function(){return this.currentNode&&this.currentNode.type===o.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},T.prototype.a=function(){return this.currentNode&&this.currentNode.type===o.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},T.prototype.ent=function(p,O){return this.entity(p,O)},T.prototype.pent=function(p,O){return this.pEntity(p,O)},T.prototype.not=function(p,O){return this.notation(p,O)},T}()}).call(ee)),hn.exports}var dn={exports:{}},ko;function wc(){return ko||(ko=1,(function(){var o,e,n,i=function(t,r){for(var s in r)a.call(r,s)&&(t[s]=r[s]);function u(){this.constructor=t}return u.prototype=r.prototype,t.prototype=new u,t.__super__=r.prototype,t},a={}.hasOwnProperty;o=le(),n=$s(),e=Ft(),dn.exports=function(t){i(r,t);function r(s,u){this.stream=s,r.__super__.constructor.call(this,u)}return r.prototype.endline=function(s,u,f){return s.isLastRootNode&&u.state===e.CloseTag?"":r.__super__.endline.call(this,s,u,f)},r.prototype.document=function(s,u){var f,l,h,c,g,w,b,C,F;for(b=s.children,l=h=0,g=b.length;h<g;l=++h)f=b[l],f.isLastRootNode=l===s.children.length-1;for(u=this.filterOptions(u),C=s.children,F=[],c=0,w=C.length;c<w;c++)f=C[c],F.push(this.writeChildNode(f,u,0));return F},r.prototype.attribute=function(s,u,f){return this.stream.write(r.__super__.attribute.call(this,s,u,f))},r.prototype.cdata=function(s,u,f){return this.stream.write(r.__super__.cdata.call(this,s,u,f))},r.prototype.comment=function(s,u,f){return this.stream.write(r.__super__.comment.call(this,s,u,f))},r.prototype.declaration=function(s,u,f){return this.stream.write(r.__super__.declaration.call(this,s,u,f))},r.prototype.docType=function(s,u,f){var l,h,c,g;if(f||(f=0),this.openNode(s,u,f),u.state=e.OpenTag,this.stream.write(this.indent(s,u,f)),this.stream.write("<!DOCTYPE "+s.root().name),s.pubID&&s.sysID?this.stream.write(' PUBLIC "'+s.pubID+'" "'+s.sysID+'"'):s.sysID&&this.stream.write(' SYSTEM "'+s.sysID+'"'),s.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(s,u,f)),u.state=e.InsideTag,g=s.children,h=0,c=g.length;h<c;h++)l=g[h],this.writeChildNode(l,u,f+1);u.state=e.CloseTag,this.stream.write("]")}return u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+">"),this.stream.write(this.endline(s,u,f)),u.state=e.None,this.closeNode(s,u,f)},r.prototype.element=function(s,u,f){var l,h,c,g,w,b,C,F,y;f||(f=0),this.openNode(s,u,f),u.state=e.OpenTag,this.stream.write(this.indent(s,u,f)+"<"+s.name),F=s.attribs;for(C in F)a.call(F,C)&&(l=F[C],this.attribute(l,u,f));if(c=s.children.length,g=c===0?null:s.children[0],c===0||s.children.every(function(m){return(m.type===o.Text||m.type===o.Raw)&&m.value===""}))u.allowEmpty?(this.stream.write(">"),u.state=e.CloseTag,this.stream.write("</"+s.name+">")):(u.state=e.CloseTag,this.stream.write(u.spaceBeforeSlash+"/>"));else if(u.pretty&&c===1&&(g.type===o.Text||g.type===o.Raw)&&g.value!=null)this.stream.write(">"),u.state=e.InsideTag,u.suppressPrettyCount++,this.writeChildNode(g,u,f+1),u.suppressPrettyCount--,u.state=e.CloseTag,this.stream.write("</"+s.name+">");else{for(this.stream.write(">"+this.endline(s,u,f)),u.state=e.InsideTag,y=s.children,w=0,b=y.length;w<b;w++)h=y[w],this.writeChildNode(h,u,f+1);u.state=e.CloseTag,this.stream.write(this.indent(s,u,f)+"</"+s.name+">")}return this.stream.write(this.endline(s,u,f)),u.state=e.None,this.closeNode(s,u,f)},r.prototype.processingInstruction=function(s,u,f){return this.stream.write(r.__super__.processingInstruction.call(this,s,u,f))},r.prototype.raw=function(s,u,f){return this.stream.write(r.__super__.raw.call(this,s,u,f))},r.prototype.text=function(s,u,f){return this.stream.write(r.__super__.text.call(this,s,u,f))},r.prototype.dtdAttList=function(s,u,f){return this.stream.write(r.__super__.dtdAttList.call(this,s,u,f))},r.prototype.dtdElement=function(s,u,f){return this.stream.write(r.__super__.dtdElement.call(this,s,u,f))},r.prototype.dtdEntity=function(s,u,f){return this.stream.write(r.__super__.dtdEntity.call(this,s,u,f))},r.prototype.dtdNotation=function(s,u,f){return this.stream.write(r.__super__.dtdNotation.call(this,s,u,f))},r}(n)}).call(ee)),dn.exports}var Bo;function Ec(){return Bo||(Bo=1,(function(){var o,e,n,i,a,t,r,s,u,f;f=Pe(),s=f.assign,u=f.isFunction,n=Ls(),i=qs(),a=vc(),r=Gn(),t=wc(),o=le(),e=Ft(),Ie.create=function(l,h,c,g){var w,b;if(l==null)throw new Error("Root element needs a name.");return g=s({},h,c,g),w=new i(g),b=w.element(l),g.headless||(w.declaration(g),(g.pubID!=null||g.sysID!=null)&&w.dtd(g)),b},Ie.begin=function(l,h,c){var g;return u(l)&&(g=[l,h],h=g[0],c=g[1],l={}),h?new a(l,h,c):new i(l)},Ie.stringWriter=function(l){return new r(l)},Ie.streamWriter=function(l,h){return new t(l,h)},Ie.implementation=new n,Ie.nodeType=o,Ie.writerState=e}).call(ee)),Ie}var Uo;function bc(){return Uo||(Uo=1,(function(){var o,e,n,i,a,t={}.hasOwnProperty;o=Ec(),e=Ln().defaults,i=function(r){return typeof r=="string"&&(r.indexOf("&")>=0||r.indexOf(">")>=0||r.indexOf("<")>=0)},a=function(r){return"<![CDATA["+n(r)+"]]>"},n=function(r){return r.replace("]]>","]]]]><![CDATA[>")},Rr.Builder=function(){function r(s){var u,f,l;this.options={},f=e["0.2"];for(u in f)t.call(f,u)&&(l=f[u],this.options[u]=l);for(u in s)t.call(s,u)&&(l=s[u],this.options[u]=l)}return r.prototype.buildObject=function(s){var u,f,l,h,c;return u=this.options.attrkey,f=this.options.charkey,Object.keys(s).length===1&&this.options.rootName===e["0.2"].rootName?(c=Object.keys(s)[0],s=s[c]):c=this.options.rootName,l=function(g){return function(w,b){var C,F,y,m,D,_;if(typeof b!="object")g.options.cdata&&i(b)?w.raw(a(b)):w.txt(b);else if(Array.isArray(b)){for(m in b)if(t.call(b,m)){F=b[m];for(D in F)y=F[D],w=l(w.ele(D),y).up()}}else for(D in b)if(t.call(b,D))if(F=b[D],D===u){if(typeof F=="object")for(C in F)_=F[C],w=w.att(C,_)}else if(D===f)g.options.cdata&&i(F)?w=w.raw(a(F)):w=w.txt(F);else if(Array.isArray(F))for(m in F)t.call(F,m)&&(y=F[m],typeof y=="string"?g.options.cdata&&i(y)?w=w.ele(D).raw(a(y)).up():w=w.ele(D,y).up():w=l(w.ele(D),y).up());else typeof F=="object"?w=l(w.ele(D),F).up():typeof F=="string"&&g.options.cdata&&i(F)?w=w.ele(D).raw(a(F)).up():(F==null&&(F=""),w=w.ele(D,F.toString()).up());return w}}(this),h=o.create(c,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),l(h,s).end(this.options.renderOpts)},r}()}).call(ee)),Rr}var mn={},gn={},Xo;function Tc(){return Xo||(Xo=1,function(o){(function(e){e.parser=function(N,E){return new i(N,E)},e.SAXParser=i,e.SAXStream=l,e.createStream=f,e.MAX_BUFFER_LENGTH=64*1024;var n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function i(N,E){if(!(this instanceof i))return new i(N,E);var X=this;t(X),X.q=X.c="",X.bufferCheckPosition=e.MAX_BUFFER_LENGTH,X.opt=E||{},X.opt.lowercase=X.opt.lowercase||X.opt.lowercasetags,X.looseCase=X.opt.lowercase?"toLowerCase":"toUpperCase",X.tags=[],X.closed=X.closedRoot=X.sawRoot=!1,X.tag=X.error=null,X.strict=!!N,X.noscript=!!(N||X.opt.noscript),X.state=p.BEGIN,X.strictEntities=X.opt.strictEntities,X.ENTITIES=X.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),X.attribList=[],X.opt.xmlns&&(X.ns=Object.create(b)),X.opt.unquotedAttributeValues===void 0&&(X.opt.unquotedAttributeValues=!N),X.trackPosition=X.opt.position!==!1,X.trackPosition&&(X.position=X.line=X.column=0),I(X,"onready")}Object.create||(Object.create=function(N){function E(){}E.prototype=N;var X=new E;return X}),Object.keys||(Object.keys=function(N){var E=[];for(var X in N)N.hasOwnProperty(X)&&E.push(X);return E});function a(N){for(var E=Math.max(e.MAX_BUFFER_LENGTH,10),X=0,d=0,x=n.length;d<x;d++){var S=N[n[d]].length;if(S>E)switch(n[d]){case"textNode":U(N);break;case"cdata":M(N,"oncdata",N.cdata),N.cdata="";break;case"script":M(N,"onscript",N.script),N.script="";break;default:H(N,"Max buffer length exceeded: "+n[d])}X=Math.max(X,S)}var $=e.MAX_BUFFER_LENGTH-X;N.bufferCheckPosition=$+N.position}function t(N){for(var E=0,X=n.length;E<X;E++)N[n[E]]=""}function r(N){U(N),N.cdata!==""&&(M(N,"oncdata",N.cdata),N.cdata=""),N.script!==""&&(M(N,"onscript",N.script),N.script="")}i.prototype={end:function(){J(this)},write:it,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){r(this)}};var s;try{s=require("stream").Stream}catch{s=function(){}}s||(s=function(){});var u=e.EVENTS.filter(function(N){return N!=="error"&&N!=="end"});function f(N,E){return new l(N,E)}function l(N,E){if(!(this instanceof l))return new l(N,E);s.apply(this),this._parser=new i(N,E),this.writable=!0,this.readable=!0;var X=this;this._parser.onend=function(){X.emit("end")},this._parser.onerror=function(d){X.emit("error",d),X._parser.error=null},this._decoder=null,u.forEach(function(d){Object.defineProperty(X,"on"+d,{get:function(){return X._parser["on"+d]},set:function(x){if(!x)return X.removeAllListeners(d),X._parser["on"+d]=x,x;X.on(d,x)},enumerable:!0,configurable:!1})})}l.prototype=Object.create(s.prototype,{constructor:{value:l}}),l.prototype.write=function(N){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(N)){if(!this._decoder){var E=Ys.StringDecoder;this._decoder=new E("utf8")}N=this._decoder.write(N)}return this._parser.write(N.toString()),this.emit("data",N),!0},l.prototype.end=function(N){return N&&N.length&&this.write(N),this._parser.end(),!0},l.prototype.on=function(N,E){var X=this;return!X._parser["on"+N]&&u.indexOf(N)!==-1&&(X._parser["on"+N]=function(){var d=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);d.splice(0,0,N),X.emit.apply(X,d)}),s.prototype.on.call(X,N,E)};var h="[CDATA[",c="DOCTYPE",g="http://www.w3.org/XML/1998/namespace",w="http://www.w3.org/2000/xmlns/",b={xml:g,xmlns:w},C=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,F=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,y=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function D(N){return N===" "||N===`
`||N==="\r"||N==="	"}function _(N){return N==='"'||N==="'"}function v(N){return N===">"||D(N)}function A(N,E){return N.test(E)}function T(N,E){return!A(N,E)}var p=0;e.STATE={BEGIN:p++,BEGIN_WHITESPACE:p++,TEXT:p++,TEXT_ENTITY:p++,OPEN_WAKA:p++,SGML_DECL:p++,SGML_DECL_QUOTED:p++,DOCTYPE:p++,DOCTYPE_QUOTED:p++,DOCTYPE_DTD:p++,DOCTYPE_DTD_QUOTED:p++,COMMENT_STARTING:p++,COMMENT:p++,COMMENT_ENDING:p++,COMMENT_ENDED:p++,CDATA:p++,CDATA_ENDING:p++,CDATA_ENDING_2:p++,PROC_INST:p++,PROC_INST_BODY:p++,PROC_INST_ENDING:p++,OPEN_TAG:p++,OPEN_TAG_SLASH:p++,ATTRIB:p++,ATTRIB_NAME:p++,ATTRIB_NAME_SAW_WHITE:p++,ATTRIB_VALUE:p++,ATTRIB_VALUE_QUOTED:p++,ATTRIB_VALUE_CLOSED:p++,ATTRIB_VALUE_UNQUOTED:p++,ATTRIB_VALUE_ENTITY_Q:p++,ATTRIB_VALUE_ENTITY_U:p++,CLOSE_TAG:p++,CLOSE_TAG_SAW_WHITE:p++,SCRIPT:p++,SCRIPT_ENDING:p++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(N){var E=e.ENTITIES[N],X=typeof E=="number"?String.fromCharCode(E):E;e.ENTITIES[N]=X});for(var O in e.STATE)e.STATE[e.STATE[O]]=O;p=e.STATE;function I(N,E,X){N[E]&&N[E](X)}function M(N,E,X){N.textNode&&U(N),I(N,E,X)}function U(N){N.textNode=W(N.opt,N.textNode),N.textNode&&I(N,"ontext",N.textNode),N.textNode=""}function W(N,E){return N.trim&&(E=E.trim()),N.normalize&&(E=E.replace(/\s+/g," ")),E}function H(N,E){return U(N),N.trackPosition&&(E+=`
Line: `+N.line+`
Column: `+N.column+`
Char: `+N.c),E=new Error(E),N.error=E,I(N,"onerror",E),N}function J(N){return N.sawRoot&&!N.closedRoot&&Y(N,"Unclosed root tag"),N.state!==p.BEGIN&&N.state!==p.BEGIN_WHITESPACE&&N.state!==p.TEXT&&H(N,"Unexpected end"),U(N),N.c="",N.closed=!0,I(N,"onend"),i.call(N,N.strict,N.opt),N}function Y(N,E){if(typeof N!="object"||!(N instanceof i))throw new Error("bad call to strictFail");N.strict&&H(N,E)}function Te(N){N.strict||(N.tagName=N.tagName[N.looseCase]());var E=N.tags[N.tags.length-1]||N,X=N.tag={name:N.tagName,attributes:{}};N.opt.xmlns&&(X.ns=E.ns),N.attribList.length=0,M(N,"onopentagstart",X)}function Ce(N,E){var X=N.indexOf(":"),d=X<0?["",N]:N.split(":"),x=d[0],S=d[1];return E&&N==="xmlns"&&(x="xmlns",S=""),{prefix:x,local:S}}function he(N){if(N.strict||(N.attribName=N.attribName[N.looseCase]()),N.attribList.indexOf(N.attribName)!==-1||N.tag.attributes.hasOwnProperty(N.attribName)){N.attribName=N.attribValue="";return}if(N.opt.xmlns){var E=Ce(N.attribName,!0),X=E.prefix,d=E.local;if(X==="xmlns")if(d==="xml"&&N.attribValue!==g)Y(N,"xml: prefix must be bound to "+g+`
Actual: `+N.attribValue);else if(d==="xmlns"&&N.attribValue!==w)Y(N,"xmlns: prefix must be bound to "+w+`
Actual: `+N.attribValue);else{var x=N.tag,S=N.tags[N.tags.length-1]||N;x.ns===S.ns&&(x.ns=Object.create(S.ns)),x.ns[d]=N.attribValue}N.attribList.push([N.attribName,N.attribValue])}else N.tag.attributes[N.attribName]=N.attribValue,M(N,"onattribute",{name:N.attribName,value:N.attribValue});N.attribName=N.attribValue=""}function fe(N,E){if(N.opt.xmlns){var X=N.tag,d=Ce(N.tagName);X.prefix=d.prefix,X.local=d.local,X.uri=X.ns[d.prefix]||"",X.prefix&&!X.uri&&(Y(N,"Unbound namespace prefix: "+JSON.stringify(N.tagName)),X.uri=d.prefix);var x=N.tags[N.tags.length-1]||N;X.ns&&x.ns!==X.ns&&Object.keys(X.ns).forEach(function(G){M(N,"onopennamespace",{prefix:G,uri:X.ns[G]})});for(var S=0,$=N.attribList.length;S<$;S++){var L=N.attribList[S],R=L[0],B=L[1],P=Ce(R,!0),j=P.prefix,k=P.local,q=j===""?"":X.ns[j]||"",V={name:R,value:B,prefix:j,local:k,uri:q};j&&j!=="xmlns"&&!q&&(Y(N,"Unbound namespace prefix: "+JSON.stringify(j)),V.uri=j),N.tag.attributes[R]=V,M(N,"onattribute",V)}N.attribList.length=0}N.tag.isSelfClosing=!!E,N.sawRoot=!0,N.tags.push(N.tag),M(N,"onopentag",N.tag),E||(!N.noscript&&N.tagName.toLowerCase()==="script"?N.state=p.SCRIPT:N.state=p.TEXT,N.tag=null,N.tagName=""),N.attribName=N.attribValue="",N.attribList.length=0}function Ee(N){if(!N.tagName){Y(N,"Weird empty close tag."),N.textNode+="</>",N.state=p.TEXT;return}if(N.script){if(N.tagName!=="script"){N.script+="</"+N.tagName+">",N.tagName="",N.state=p.SCRIPT;return}M(N,"onscript",N.script),N.script=""}var E=N.tags.length,X=N.tagName;N.strict||(X=X[N.looseCase]());for(var d=X;E--;){var x=N.tags[E];if(x.name!==d)Y(N,"Unexpected close tag");else break}if(E<0){Y(N,"Unmatched closing tag: "+N.tagName),N.textNode+="</"+N.tagName+">",N.state=p.TEXT;return}N.tagName=X;for(var S=N.tags.length;S-- >E;){var $=N.tag=N.tags.pop();N.tagName=N.tag.name,M(N,"onclosetag",N.tagName);var L={};for(var R in $.ns)L[R]=$.ns[R];var B=N.tags[N.tags.length-1]||N;N.opt.xmlns&&$.ns!==B.ns&&Object.keys($.ns).forEach(function(P){var j=$.ns[P];M(N,"onclosenamespace",{prefix:P,uri:j})})}E===0&&(N.closedRoot=!0),N.tagName=N.attribValue=N.attribName="",N.attribList.length=0,N.state=p.TEXT}function Le(N){var E=N.entity,X=E.toLowerCase(),d,x="";return N.ENTITIES[E]?N.ENTITIES[E]:N.ENTITIES[X]?N.ENTITIES[X]:(E=X,E.charAt(0)==="#"&&(E.charAt(1)==="x"?(E=E.slice(2),d=parseInt(E,16),x=d.toString(16)):(E=E.slice(1),d=parseInt(E,10),x=d.toString(10))),E=E.replace(/^0+/,""),isNaN(d)||x.toLowerCase()!==E?(Y(N,"Invalid character entity"),"&"+N.entity+";"):String.fromCodePoint(d))}function z(N,E){E==="<"?(N.state=p.OPEN_WAKA,N.startTagPosition=N.position):D(E)||(Y(N,"Non-whitespace before first tag."),N.textNode=E,N.state=p.TEXT)}function Ve(N,E){var X="";return E<N.length&&(X=N.charAt(E)),X}function it(N){var E=this;if(this.error)throw this.error;if(E.closed)return H(E,"Cannot write after close. Assign an onready handler.");if(N===null)return J(E);typeof N=="object"&&(N=N.toString());for(var X=0,d="";d=Ve(N,X++),E.c=d,!!d;)switch(E.trackPosition&&(E.position++,d===`
`?(E.line++,E.column=0):E.column++),E.state){case p.BEGIN:if(E.state=p.BEGIN_WHITESPACE,d==="\uFEFF")continue;z(E,d);continue;case p.BEGIN_WHITESPACE:z(E,d);continue;case p.TEXT:if(E.sawRoot&&!E.closedRoot){for(var x=X-1;d&&d!=="<"&&d!=="&";)d=Ve(N,X++),d&&E.trackPosition&&(E.position++,d===`
`?(E.line++,E.column=0):E.column++);E.textNode+=N.substring(x,X-1)}d==="<"&&!(E.sawRoot&&E.closedRoot&&!E.strict)?(E.state=p.OPEN_WAKA,E.startTagPosition=E.position):(!D(d)&&(!E.sawRoot||E.closedRoot)&&Y(E,"Text data outside of root node."),d==="&"?E.state=p.TEXT_ENTITY:E.textNode+=d);continue;case p.SCRIPT:d==="<"?E.state=p.SCRIPT_ENDING:E.script+=d;continue;case p.SCRIPT_ENDING:d==="/"?E.state=p.CLOSE_TAG:(E.script+="<"+d,E.state=p.SCRIPT);continue;case p.OPEN_WAKA:if(d==="!")E.state=p.SGML_DECL,E.sgmlDecl="";else if(!D(d))if(A(C,d))E.state=p.OPEN_TAG,E.tagName=d;else if(d==="/")E.state=p.CLOSE_TAG,E.tagName="";else if(d==="?")E.state=p.PROC_INST,E.procInstName=E.procInstBody="";else{if(Y(E,"Unencoded <"),E.startTagPosition+1<E.position){var S=E.position-E.startTagPosition;d=new Array(S).join(" ")+d}E.textNode+="<"+d,E.state=p.TEXT}continue;case p.SGML_DECL:if(E.sgmlDecl+d==="--"){E.state=p.COMMENT,E.comment="",E.sgmlDecl="";continue}E.doctype&&E.doctype!==!0&&E.sgmlDecl?(E.state=p.DOCTYPE_DTD,E.doctype+="<!"+E.sgmlDecl+d,E.sgmlDecl=""):(E.sgmlDecl+d).toUpperCase()===h?(M(E,"onopencdata"),E.state=p.CDATA,E.sgmlDecl="",E.cdata=""):(E.sgmlDecl+d).toUpperCase()===c?(E.state=p.DOCTYPE,(E.doctype||E.sawRoot)&&Y(E,"Inappropriately located doctype declaration"),E.doctype="",E.sgmlDecl=""):d===">"?(M(E,"onsgmldeclaration",E.sgmlDecl),E.sgmlDecl="",E.state=p.TEXT):(_(d)&&(E.state=p.SGML_DECL_QUOTED),E.sgmlDecl+=d);continue;case p.SGML_DECL_QUOTED:d===E.q&&(E.state=p.SGML_DECL,E.q=""),E.sgmlDecl+=d;continue;case p.DOCTYPE:d===">"?(E.state=p.TEXT,M(E,"ondoctype",E.doctype),E.doctype=!0):(E.doctype+=d,d==="["?E.state=p.DOCTYPE_DTD:_(d)&&(E.state=p.DOCTYPE_QUOTED,E.q=d));continue;case p.DOCTYPE_QUOTED:E.doctype+=d,d===E.q&&(E.q="",E.state=p.DOCTYPE);continue;case p.DOCTYPE_DTD:d==="]"?(E.doctype+=d,E.state=p.DOCTYPE):d==="<"?(E.state=p.OPEN_WAKA,E.startTagPosition=E.position):_(d)?(E.doctype+=d,E.state=p.DOCTYPE_DTD_QUOTED,E.q=d):E.doctype+=d;continue;case p.DOCTYPE_DTD_QUOTED:E.doctype+=d,d===E.q&&(E.state=p.DOCTYPE_DTD,E.q="");continue;case p.COMMENT:d==="-"?E.state=p.COMMENT_ENDING:E.comment+=d;continue;case p.COMMENT_ENDING:d==="-"?(E.state=p.COMMENT_ENDED,E.comment=W(E.opt,E.comment),E.comment&&M(E,"oncomment",E.comment),E.comment=""):(E.comment+="-"+d,E.state=p.COMMENT);continue;case p.COMMENT_ENDED:d!==">"?(Y(E,"Malformed comment"),E.comment+="--"+d,E.state=p.COMMENT):E.doctype&&E.doctype!==!0?E.state=p.DOCTYPE_DTD:E.state=p.TEXT;continue;case p.CDATA:d==="]"?E.state=p.CDATA_ENDING:E.cdata+=d;continue;case p.CDATA_ENDING:d==="]"?E.state=p.CDATA_ENDING_2:(E.cdata+="]"+d,E.state=p.CDATA);continue;case p.CDATA_ENDING_2:d===">"?(E.cdata&&M(E,"oncdata",E.cdata),M(E,"onclosecdata"),E.cdata="",E.state=p.TEXT):d==="]"?E.cdata+="]":(E.cdata+="]]"+d,E.state=p.CDATA);continue;case p.PROC_INST:d==="?"?E.state=p.PROC_INST_ENDING:D(d)?E.state=p.PROC_INST_BODY:E.procInstName+=d;continue;case p.PROC_INST_BODY:if(!E.procInstBody&&D(d))continue;d==="?"?E.state=p.PROC_INST_ENDING:E.procInstBody+=d;continue;case p.PROC_INST_ENDING:d===">"?(M(E,"onprocessinginstruction",{name:E.procInstName,body:E.procInstBody}),E.procInstName=E.procInstBody="",E.state=p.TEXT):(E.procInstBody+="?"+d,E.state=p.PROC_INST_BODY);continue;case p.OPEN_TAG:A(F,d)?E.tagName+=d:(Te(E),d===">"?fe(E):d==="/"?E.state=p.OPEN_TAG_SLASH:(D(d)||Y(E,"Invalid character in tag name"),E.state=p.ATTRIB));continue;case p.OPEN_TAG_SLASH:d===">"?(fe(E,!0),Ee(E)):(Y(E,"Forward-slash in opening tag not followed by >"),E.state=p.ATTRIB);continue;case p.ATTRIB:if(D(d))continue;d===">"?fe(E):d==="/"?E.state=p.OPEN_TAG_SLASH:A(C,d)?(E.attribName=d,E.attribValue="",E.state=p.ATTRIB_NAME):Y(E,"Invalid attribute name");continue;case p.ATTRIB_NAME:d==="="?E.state=p.ATTRIB_VALUE:d===">"?(Y(E,"Attribute without value"),E.attribValue=E.attribName,he(E),fe(E)):D(d)?E.state=p.ATTRIB_NAME_SAW_WHITE:A(F,d)?E.attribName+=d:Y(E,"Invalid attribute name");continue;case p.ATTRIB_NAME_SAW_WHITE:if(d==="=")E.state=p.ATTRIB_VALUE;else{if(D(d))continue;Y(E,"Attribute without value"),E.tag.attributes[E.attribName]="",E.attribValue="",M(E,"onattribute",{name:E.attribName,value:""}),E.attribName="",d===">"?fe(E):A(C,d)?(E.attribName=d,E.state=p.ATTRIB_NAME):(Y(E,"Invalid attribute name"),E.state=p.ATTRIB)}continue;case p.ATTRIB_VALUE:if(D(d))continue;_(d)?(E.q=d,E.state=p.ATTRIB_VALUE_QUOTED):(E.opt.unquotedAttributeValues||H(E,"Unquoted attribute value"),E.state=p.ATTRIB_VALUE_UNQUOTED,E.attribValue=d);continue;case p.ATTRIB_VALUE_QUOTED:if(d!==E.q){d==="&"?E.state=p.ATTRIB_VALUE_ENTITY_Q:E.attribValue+=d;continue}he(E),E.q="",E.state=p.ATTRIB_VALUE_CLOSED;continue;case p.ATTRIB_VALUE_CLOSED:D(d)?E.state=p.ATTRIB:d===">"?fe(E):d==="/"?E.state=p.OPEN_TAG_SLASH:A(C,d)?(Y(E,"No whitespace between attributes"),E.attribName=d,E.attribValue="",E.state=p.ATTRIB_NAME):Y(E,"Invalid attribute name");continue;case p.ATTRIB_VALUE_UNQUOTED:if(!v(d)){d==="&"?E.state=p.ATTRIB_VALUE_ENTITY_U:E.attribValue+=d;continue}he(E),d===">"?fe(E):E.state=p.ATTRIB;continue;case p.CLOSE_TAG:if(E.tagName)d===">"?Ee(E):A(F,d)?E.tagName+=d:E.script?(E.script+="</"+E.tagName,E.tagName="",E.state=p.SCRIPT):(D(d)||Y(E,"Invalid tagname in closing tag"),E.state=p.CLOSE_TAG_SAW_WHITE);else{if(D(d))continue;T(C,d)?E.script?(E.script+="</"+d,E.state=p.SCRIPT):Y(E,"Invalid tagname in closing tag."):E.tagName=d}continue;case p.CLOSE_TAG_SAW_WHITE:if(D(d))continue;d===">"?Ee(E):Y(E,"Invalid characters in closing tag");continue;case p.TEXT_ENTITY:case p.ATTRIB_VALUE_ENTITY_Q:case p.ATTRIB_VALUE_ENTITY_U:var $,L;switch(E.state){case p.TEXT_ENTITY:$=p.TEXT,L="textNode";break;case p.ATTRIB_VALUE_ENTITY_Q:$=p.ATTRIB_VALUE_QUOTED,L="attribValue";break;case p.ATTRIB_VALUE_ENTITY_U:$=p.ATTRIB_VALUE_UNQUOTED,L="attribValue";break}if(d===";"){var R=Le(E);E.opt.unparsedEntities&&!Object.values(e.XML_ENTITIES).includes(R)?(E.entity="",E.state=$,E.write(R)):(E[L]+=R,E.entity="",E.state=$)}else A(E.entity.length?m:y,d)?E.entity+=d:(Y(E,"Invalid character in entity name"),E[L]+="&"+E.entity+d,E.entity="",E.state=$);continue;default:throw new Error(E,"Unknown state: "+E.state)}return E.position>=E.bufferCheckPosition&&a(E),E}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var N=String.fromCharCode,E=Math.floor,X=function(){var d=16384,x=[],S,$,L=-1,R=arguments.length;if(!R)return"";for(var B="";++L<R;){var P=Number(arguments[L]);if(!isFinite(P)||P<0||P>1114111||E(P)!==P)throw RangeError("Invalid code point: "+P);P<=65535?x.push(P):(P-=65536,S=(P>>10)+55296,$=P%1024+56320,x.push(S,$)),(L+1===R||x.length>d)&&(B+=N.apply(null,x),x.length=0)}return B};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:X,configurable:!0,writable:!0}):String.fromCodePoint=X}()})(o)}(gn)),gn}var yn={},Vo;function Cc(){return Vo||(Vo=1,(function(){yn.stripBOM=function(o){return o[0]==="\uFEFF"?o.substring(1):o}}).call(ee)),yn}var Be={},zo;function ks(){return zo||(zo=1,(function(){var o;o=new RegExp(/(?!xmlns)^.*:/),Be.normalize=function(e){return e.toLowerCase()},Be.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},Be.stripPrefix=function(e){return e.replace(o,"")},Be.parseNumbers=function(e){return isNaN(e)||(e=e%1===0?parseInt(e,10):parseFloat(e)),e},Be.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e=e.toLowerCase()==="true"),e}}).call(ee)),Be}var Wo;function Oc(){return Wo||(Wo=1,function(o){(function(){var e,n,i,a,t,r,s,u,f=function(c,g){return function(){return c.apply(g,arguments)}},l=function(c,g){for(var w in g)h.call(g,w)&&(c[w]=g[w]);function b(){this.constructor=c}return b.prototype=g.prototype,c.prototype=new b,c.__super__=g.prototype,c},h={}.hasOwnProperty;s=Tc(),i=Ue,e=Cc(),r=ks(),u=Js.setImmediate,n=Ln().defaults,a=function(c){return typeof c=="object"&&c!=null&&Object.keys(c).length===0},t=function(c,g,w){var b,C,F;for(b=0,C=c.length;b<C;b++)F=c[b],g=F(g,w);return g},o.Parser=function(c){l(g,c);function g(w){this.parseStringPromise=f(this.parseStringPromise,this),this.parseString=f(this.parseString,this),this.reset=f(this.reset,this),this.assignOrPush=f(this.assignOrPush,this),this.processAsync=f(this.processAsync,this);var b,C,F;if(!(this instanceof o.Parser))return new o.Parser(w);this.options={},C=n["0.2"];for(b in C)h.call(C,b)&&(F=C[b],this.options[b]=F);for(b in w)h.call(w,b)&&(F=w[b],this.options[b]=F);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(r.normalize)),this.reset()}return g.prototype.processAsync=function(){var w,b;try{return this.remaining.length<=this.options.chunkSize?(w=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(w),this.saxParser.close()):(w=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(w),u(this.processAsync))}catch(C){if(b=C,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(b)}},g.prototype.assignOrPush=function(w,b,C){return b in w?(w[b]instanceof Array||(w[b]=[w[b]]),w[b].push(C)):this.options.explicitArray?w[b]=[C]:w[b]=C},g.prototype.reset=function(){var w,b,C,F;return this.removeAllListeners(),this.saxParser=s.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(y){return function(m){if(y.saxParser.resume(),!y.saxParser.errThrown)return y.saxParser.errThrown=!0,y.emit("error",m)}}(this),this.saxParser.onend=function(y){return function(){if(!y.saxParser.ended)return y.saxParser.ended=!0,y.emit("end",y.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,F=[],w=this.options.attrkey,b=this.options.charkey,this.saxParser.onopentag=function(y){return function(m){var D,_,v,A,T;if(v=Object.create(null),v[b]="",!y.options.ignoreAttrs){T=m.attributes;for(D in T)h.call(T,D)&&(!(w in v)&&!y.options.mergeAttrs&&(v[w]=Object.create(null)),_=y.options.attrValueProcessors?t(y.options.attrValueProcessors,m.attributes[D],D):m.attributes[D],A=y.options.attrNameProcessors?t(y.options.attrNameProcessors,D):D,y.options.mergeAttrs?y.assignOrPush(v,A,_):v[w][A]=_)}return v["#name"]=y.options.tagNameProcessors?t(y.options.tagNameProcessors,m.name):m.name,y.options.xmlns&&(v[y.options.xmlnskey]={uri:m.uri,local:m.local}),F.push(v)}}(this),this.saxParser.onclosetag=function(y){return function(){var m,D,_,v,A,T,p,O,I,M;if(T=F.pop(),A=T["#name"],(!y.options.explicitChildren||!y.options.preserveChildrenOrder)&&delete T["#name"],T.cdata===!0&&(m=T.cdata,delete T.cdata),I=F[F.length-1],T[b].match(/^\s*$/)&&!m?(D=T[b],delete T[b]):(y.options.trim&&(T[b]=T[b].trim()),y.options.normalize&&(T[b]=T[b].replace(/\s{2,}/g," ").trim()),T[b]=y.options.valueProcessors?t(y.options.valueProcessors,T[b],A):T[b],Object.keys(T).length===1&&b in T&&!y.EXPLICIT_CHARKEY&&(T=T[b])),a(T)&&(typeof y.options.emptyTag=="function"?T=y.options.emptyTag():T=y.options.emptyTag!==""?y.options.emptyTag:D),y.options.validator!=null&&(M="/"+function(){var U,W,H;for(H=[],U=0,W=F.length;U<W;U++)v=F[U],H.push(v["#name"]);return H}().concat(A).join("/"),function(){var U;try{return T=y.options.validator(M,I&&I[A],T)}catch(W){return U=W,y.emit("error",U)}}()),y.options.explicitChildren&&!y.options.mergeAttrs&&typeof T=="object"){if(!y.options.preserveChildrenOrder)v=Object.create(null),y.options.attrkey in T&&(v[y.options.attrkey]=T[y.options.attrkey],delete T[y.options.attrkey]),!y.options.charsAsChildren&&y.options.charkey in T&&(v[y.options.charkey]=T[y.options.charkey],delete T[y.options.charkey]),Object.getOwnPropertyNames(T).length>0&&(v[y.options.childkey]=T),T=v;else if(I){I[y.options.childkey]=I[y.options.childkey]||[],p=Object.create(null);for(_ in T)h.call(T,_)&&(p[_]=T[_]);I[y.options.childkey].push(p),delete T["#name"],Object.keys(T).length===1&&b in T&&!y.EXPLICIT_CHARKEY&&(T=T[b])}}return F.length>0?y.assignOrPush(I,A,T):(y.options.explicitRoot&&(O=T,T=Object.create(null),T[A]=O),y.resultObject=T,y.saxParser.ended=!0,y.emit("end",y.resultObject))}}(this),C=function(y){return function(m){var D,_;if(_=F[F.length-1],_)return _[b]+=m,y.options.explicitChildren&&y.options.preserveChildrenOrder&&y.options.charsAsChildren&&(y.options.includeWhiteChars||m.replace(/\\n/g,"").trim()!=="")&&(_[y.options.childkey]=_[y.options.childkey]||[],D={"#name":"__text__"},D[b]=m,y.options.normalize&&(D[b]=D[b].replace(/\s{2,}/g," ").trim()),_[y.options.childkey].push(D)),_}}(this),this.saxParser.ontext=C,this.saxParser.oncdata=function(y){return function(m){var D;if(D=C(m),D)return D.cdata=!0}}()},g.prototype.parseString=function(w,b){var C;b!=null&&typeof b=="function"&&(this.on("end",function(F){return this.reset(),b(null,F)}),this.on("error",function(F){return this.reset(),b(F)}));try{return w=w.toString(),w.trim()===""?(this.emit("end",null),!0):(w=e.stripBOM(w),this.options.async?(this.remaining=w,u(this.processAsync),this.saxParser):this.saxParser.write(w).close())}catch(F){if(C=F,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw C}else return this.emit("error",C),this.saxParser.errThrown=!0}},g.prototype.parseStringPromise=function(w){return new Promise(function(b){return function(C,F){return b.parseString(w,function(y,m){return y?F(y):C(m)})}}(this))},g}(i),o.parseString=function(c,g,w){var b,C,F;return w!=null?(typeof w=="function"&&(b=w),typeof g=="object"&&(C=g)):(typeof g=="function"&&(b=g),C={}),F=new o.Parser(C),F.parseString(c,b)},o.parseStringPromise=function(c,g){var w,b;return typeof g=="object"&&(w=g),b=new o.Parser(w),b.parseStringPromise(c)}}).call(ee)}(mn)),mn}(function(){var o,e,n,i,a=function(r,s){for(var u in s)t.call(s,u)&&(r[u]=s[u]);function f(){this.constructor=r}return f.prototype=s.prototype,r.prototype=new f,r.__super__=s.prototype,r},t={}.hasOwnProperty;e=Ln(),o=bc(),n=Oc(),i=ks(),Re.defaults=e.defaults,Re.processors=i,Re.ValidationError=function(r){a(s,r);function s(u){this.message=u}return s}(Error),Re.Builder=o.Builder,Re.Parser=n.Parser,Re.parseString=n.parseString,Re.parseStringPromise=n.parseStringPromise}).call(ee);var Dn={exports:{}},ht={exports:{}},vn,Ho;function Bs(){if(Ho)return vn;Ho=1;function o(e){i.debug=i,i.default=i,i.coerce=f,i.disable=s,i.enable=r,i.enabled=u,i.humanize=ys(),Object.keys(e).forEach(function(l){i[l]=e[l]}),i.instances=[],i.names=[],i.skips=[],i.formatters={};function n(l){for(var h=0,c=0;c<l.length;c++)h=(h<<5)-h+l.charCodeAt(c),h|=0;return i.colors[Math.abs(h)%i.colors.length]}i.selectColor=n;function i(l){var h;function c(){if(c.enabled){for(var g=arguments.length,w=new Array(g),b=0;b<g;b++)w[b]=arguments[b];var C=c,F=Number(new Date),y=F-(h||F);C.diff=y,C.prev=h,C.curr=F,h=F,w[0]=i.coerce(w[0]),typeof w[0]!="string"&&w.unshift("%O");var m=0;w[0]=w[0].replace(/%([a-zA-Z%])/g,function(_,v){if(_==="%%")return _;m++;var A=i.formatters[v];if(typeof A=="function"){var T=w[m];_=A.call(C,T),w.splice(m,1),m--}return _}),i.formatArgs.call(C,w);var D=C.log||i.log;D.apply(C,w)}}return c.namespace=l,c.enabled=i.enabled(l),c.useColors=i.useColors(),c.color=n(l),c.destroy=a,c.extend=t,typeof i.init=="function"&&i.init(c),i.instances.push(c),c}function a(){var l=i.instances.indexOf(this);return l!==-1?(i.instances.splice(l,1),!0):!1}function t(l,h){return i(this.namespace+(typeof h>"u"?":":h)+l)}function r(l){i.save(l),i.names=[],i.skips=[];var h,c=(typeof l=="string"?l:"").split(/[\s,]+/),g=c.length;for(h=0;h<g;h++)c[h]&&(l=c[h].replace(/\*/g,".*?"),l[0]==="-"?i.skips.push(new RegExp("^"+l.substr(1)+"$")):i.names.push(new RegExp("^"+l+"$")));for(h=0;h<i.instances.length;h++){var w=i.instances[h];w.enabled=i.enabled(w.namespace)}}function s(){i.enable("")}function u(l){if(l[l.length-1]==="*")return!0;var h,c;for(h=0,c=i.skips.length;h<c;h++)if(i.skips[h].test(l))return!1;for(h=0,c=i.names.length;h<c;h++)if(i.names[h].test(l))return!0;return!1}function f(l){return l instanceof Error?l.stack||l.message:l}return i.enable(i.load()),i}return vn=o,vn}var Go;function Ac(){return Go||(Go=1,function(o,e){function n(l){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(c){return typeof c}:n=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},n(l)}e.log=t,e.formatArgs=a,e.save=r,e.load=s,e.useColors=i,e.storage=u(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function a(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),!!this.useColors){var h="color: "+this.color;l.splice(1,0,h,"color: inherit");var c=0,g=0;l[0].replace(/%[a-zA-Z%]/g,function(w){w!=="%%"&&(c++,w==="%c"&&(g=c))}),l.splice(g,0,h)}}function t(){var l;return(typeof console>"u"?"undefined":n(console))==="object"&&console.log&&(l=console).log.apply(l,arguments)}function r(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function s(){var l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof process<"u"&&"env"in process&&(l=process.env.DEBUG),l}function u(){try{return localStorage}catch{}}o.exports=Bs()(e);var f=o.exports.formatters;f.j=function(l){try{return JSON.stringify(l)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}}(ht,ht.exports)),ht.exports}var dt={exports:{}},Ko;function Dc(){return Ko||(Ko=1,function(o,e){var n=xn,i=rt;e.init=h,e.log=u,e.formatArgs=r,e.save=f,e.load=l,e.useColors=t,e.colors=[6,2,3,4,5,1];try{var a=ws();a&&(a.stderr||a).level>=2&&(e.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}e.inspectOpts=Object.keys(process.env).filter(function(g){return/^debug_/i.test(g)}).reduce(function(g,w){var b=w.substring(6).toLowerCase().replace(/_([a-z])/g,function(F,y){return y.toUpperCase()}),C=process.env[w];return/^(yes|on|true|enabled)$/i.test(C)?C=!0:/^(no|off|false|disabled)$/i.test(C)?C=!1:C==="null"?C=null:C=Number(C),g[b]=C,g},{});function t(){return"colors"in e.inspectOpts?!!e.inspectOpts.colors:n.isatty(process.stderr.fd)}function r(g){var w=this.namespace,b=this.useColors;if(b){var C=this.color,F="\x1B[3"+(C<8?C:"8;5;"+C),y="  ".concat(F,";1m").concat(w," \x1B[0m");g[0]=y+g[0].split(`
`).join(`
`+y),g.push(F+"m+"+o.exports.humanize(this.diff)+"\x1B[0m")}else g[0]=s()+w+" "+g[0]}function s(){return e.inspectOpts.hideDate?"":new Date().toISOString()+" "}function u(){return process.stderr.write(i.format.apply(i,arguments)+`
`)}function f(g){g?process.env.DEBUG=g:delete process.env.DEBUG}function l(){return process.env.DEBUG}function h(g){g.inspectOpts={};for(var w=Object.keys(e.inspectOpts),b=0;b<w.length;b++)g.inspectOpts[w[b]]=e.inspectOpts[w[b]]}o.exports=Bs()(e);var c=o.exports.formatters;c.o=function(g){return this.inspectOpts.colors=this.useColors,i.inspect(g,this.inspectOpts).split(`
`).map(function(w){return w.trim()}).join(" ")},c.O=function(g){return this.inspectOpts.colors=this.useColors,i.inspect(g,this.inspectOpts)}}(dt,dt.exports)),dt.exports}typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?Dn.exports=Ac():Dn.exports=Dc();var _c=Dn.exports;const Je=_n,Nc=Nn,xc=Ks,Qe=Pn,Yo=We,Ic=Re,Fc=Fs,Sc=_c("roa"),mt=xt;function Pc(o){return o.replace(/[\t\n\r\f]/g," ")}function Lc(o){const e=Object.keys(o),n={};for(let i=0;i<e.length;i++){const a=e[i];n[a.toLowerCase()]=o[a]}return n}function Mc(o){const e="x-acs-",n=Object.keys(o),i=[];for(let t=0;t<n.length;t++){const r=n[t];r.startsWith(e)&&i.push(r)}i.sort();var a="";for(let t=0;t<i.length;t++){const r=i[t];a+=`${r}:${Pc(o[r]).trim()}
`}return a}function Rc(o,e){const n=Object.keys(e).sort();if(n.length===0)return o;for(var i=[],a=0;a<n.length;a++){const t=n[a];i.push(`${t}=${e[t]}`)}return`${o}?${i.join("&")}`}function jc(o,e,n,i){const a=n.accept,t=n["content-md5"]||"",r=n["content-type"]||"",s=n.date||"",u=`${o}
${a}
${t}
${r}
${s}
`,f=Mc(n),l=Rc(e,i);return`${u}${f}${l}`}function $c(o){const e=new Ic.Parser({});return new Promise((n,i)=>{e.parseString(o,(a,t)=>{if(a)return i(a);n(t)})})}class qc extends Error{constructor(e){const n=e.Message[0],i=e.Code[0],a=e.HostId[0],t=e.RequestId[0];super(`${n} hostid: ${a}, requestid: ${t}`),this.code=i}}class kc{constructor(e){if(Je(e,'must pass "config"'),Je(e.endpoint,'must pass "config.endpoint"'),!e.endpoint.startsWith("https://")&&!e.endpoint.startsWith("http://"))throw new Error(`"config.endpoint" must starts with 'https://' or 'http://'.`);if(Je(e.apiVersion,'must pass "config.apiVersion"'),e.credentialsProvider){if(typeof e.credentialsProvider.getCredentials!="function")throw new Error('must pass "config.credentialsProvider" with function "getCredentials()"');this.credentialsProvider=e.credentialsProvider}else Je(e.accessKeyId,'must pass "config.accessKeyId"'),Je(e.accessKeySecret,'must pass "config.accessKeySecret"'),this.accessKeyId=e.accessKeyId,this.accessKeySecret=e.accessKeySecret,this.securityToken=e.securityToken,this.credentialsProvider={getCredentials:async()=>({accessKeyId:e.accessKeyId,accessKeySecret:e.accessKeySecret,securityToken:e.securityToken})};this.endpoint=e.endpoint,this.apiVersion=e.apiVersion,this.host=Nc.parse(this.endpoint).hostname,this.opts=e.opts;var n=this.endpoint.startsWith("https://")?bt:Et;this.keepAliveAgent=new n.Agent({keepAlive:!0,keepAliveMsecs:3e3})}buildHeaders(){var n={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Qe.makeNonce(),"x-acs-signature-method":"HMAC-SHA1","x-acs-signature-version":"1.0","x-acs-version":this.apiVersion,"user-agent":mt.DEFAULT_UA,"x-sdk-client":mt.DEFAULT_CLIENT};return this.securityToken&&(n["x-acs-accesskey-id"]=this.accessKeyId,n["x-acs-security-token"]=this.securityToken),n}signature(e){const n=Buffer.from(e,"utf8");return Qe.sha1(n,this.accessKeySecret,"base64")}buildAuthorization(e){return`acs ${this.accessKeyId}:${this.signature(e)}`}async request(e,n,i={},a="",t={},r={}){const s=await this.credentialsProvider.getCredentials();var f={accept:"application/json",date:new Date().toGMTString(),host:this.host,"x-acs-signature-nonce":Qe.makeNonce(),"x-acs-version":this.apiVersion,"user-agent":mt.DEFAULT_UA,"x-sdk-client":mt.DEFAULT_CLIENT};s&&s.accessKeyId&&s.accessKeySecret&&(f["x-acs-signature-method"]="HMAC-SHA1",f["x-acs-signature-version"]="1.0",s.securityToken&&(f["x-acs-accesskey-id"]=s.accessKeyId,f["x-acs-security-token"]=s.securityToken));var l=Object.assign(f,Lc(t)),h=null;h=Buffer.from(a,"utf8"),l["content-md5"]=Qe.md5(h,"base64"),l["content-length"]=h.length;var c=`${this.endpoint}${n}`;if(Object.keys(i).length&&(c+=`?${xc.stringify(i)}`),s&&s.accessKeyId&&s.accessKeySecret){const m=jc(e,n,l,i);Sc("stringToSign: %s",m);const D=Buffer.from(m,"utf8"),_=Qe.sha1(D,s.accessKeySecret,"base64");l.authorization=`acs ${s.accessKeyId}:${_}`}const g=Object.assign({method:e,agent:this.keepAliveAgent,headers:l,data:h},this.opts,r),w=await Yo.request(c,g),b=await Yo.read(w,"utf8");if(r.rawBody)return b;const C=w.headers["content-type"]||"";if(C.startsWith("application/json")){const m=w.statusCode;if(m===204)return b;var F;try{F=Fc.parse(b)}catch(D){throw D.name="FormatError",D.message="parse response to json error",D.body=b,D}if(m>=400){const D=F.Message||F.errorMsg||"",_=F.Code||F.errorCode||"",v=F.RequestId||"";var y=new Error(`code: ${m}, ${D}, requestid: ${v}`);throw y.name=`${_}Error`,y.statusCode=m,y.result=F,y.code=_,y}return F}if(C.startsWith("text/xml")){const m=await $c(b);if(m.Error)throw new qc(m.Error);return m}return b}put(e,n,i,a,t){return this.request("PUT",e,n,i,a,t)}post(e,n,i,a,t){return this.request("POST",e,n,i,a,t)}get(e,n,i,a){return this.request("GET",e,n,"",i,a)}delete(e,n,i,a){return this.request("DELETE",e,n,"",i,a)}}var Bc=kc;_t.exports=Ps;_t.exports.ROAClient=Bc;_t.exports.RPCClient=Ps;var Uc=_t.exports;const Xc=Tt(Uc);async function Vc(){const o=new Xc({accessKeyId:wt.accessKeyId,accessKeySecret:wt.accessKeySecret,endpoint:"http://nls-meta.cn-shanghai.aliyuncs.com",apiVersion:"2019-02-28"});try{return(await o.request("CreateToken")).Token.Id}catch(e){return console.error("Error creating token:",e),null}}function tt(o){return new Promise((e,n)=>{ss.ffprobe(o,(i,a)=>{if(i)return n(i);e(a.format.duration||0)})})}async function zc(o){try{const e=rt.promisify(nt.exec),{stdout:n}=await e(`ffprobe -v error -show_streams -select_streams a "${o}"`);return n.includes("codec_type=audio")}catch(e){return console.error(`hasAudio error: ${e}`),!1}}function Wc(o,e){let n="";e.forEach((i,a)=>{const t=Jo(i.start),r=Jo(i.start+i.duration);n+=`${a+1}
${t} --> ${r}
${i.text}

`}),ae.writeFileSync(o,n)}function Jo(o){const e=new Date(0);return e.setSeconds(o),e.toISOString().slice(11,23).replace(".",",")}async function Hc(o){const e={win32:"C:/Windows/Fonts/",darwin:"/System/Library/Fonts/",linux:"/usr/share/fonts/"},n=process.platform,i=Q.join(e[n]||"",o);try{return await ae.promises.access(i),i}catch{return o}}const ze="zhushou";function St(){switch(process.platform){case"win32":return Q.join(re.app.getPath("appData"),ze);case"darwin":return Q.join(re.app.getPath("appData"),ze);case"linux":return Q.join(re.app.getPath("appData"),ze);default:return Q.join(re.app.getPath("documents"),ze)}}function Kn(){try{const o=St();ae.existsSync(o)||(ae.mkdirSync(o),console.log("Created zhushou directory at:",o));try{ae.accessSync(o,ae.constants.W_OK)}catch{return console.error("No write permission for zhushou directory, falling back to documents"),Q.join(re.app.getPath("documents"),ze)}return o}catch(o){return console.error("Failed to create zhushou directory:",o),Q.join(re.app.getPath("documents"),ze)}}function Gc(){re.ipcMain.handle("get-default-save-path",()=>Kn())}function Kc(){re.ipcMain.handle("text2voice",async(o,e)=>{try{const n=JSON.parse(bn(e));oe.log("accept params:"),oe.log(JSON.stringify(n));const i={text:n.text,voice:n.voice||"xiaoyun",format:n.format||"mp3",sample_rate:n.sample_rate||16e3,volume:n.volume||50,speech_rate:n.speech_rate||0,pitch_rate:n.pitch_rate||0},a=n.output_dir||St(),t=n.output_file_name||`tts_${Date.now()}`,r=await Vc();Mt.existsSync(a)||Mt.mkdirSync(a,{recursive:!0});const s=new Nu({url:wt.ttsUrl,appkey:wt.appkey,token:r}),u=Q.join(a,`${t}.${i.format||"mp3"}`),f=Mt.createWriteStream(u);return oe.log(u),new Promise((l,h)=>{s.on("meta",c=>{oe.info("接收到元信息:",c)}),s.on("data",c=>{try{f.write(c),oe.debug(`接收到数据块，大小: ${c.length} bytes`)}catch(g){oe.error("写入文件失败:",g),h(g)}}),s.on("completed",async()=>{f.end(),oe.info("语音合成完成");const c=await tt(u);oe.info(`语音合成完成，时长: ${c}秒`),l({success:!0,outputFile:u,duration:c})}),s.on("closed",()=>{oe.info("连接已关闭")}),s.on("failed",c=>{f.end(),oe.error("语音合成失败:",c),h(c)}),s.start(i,!0,6e3)})}catch(n){throw oe.error("语音合成初始化失败:",n),n}})}const Yc={...De.webcrypto.subtle,generateKey:async(o,e,n)=>De.webcrypto.subtle.generateKey(o,e,n)},Jc={getRandomValues:o=>{if(!o)return o;switch(!0){case o instanceof Int8Array:return De.webcrypto.getRandomValues(o);case o instanceof Uint8Array:return De.webcrypto.getRandomValues(o);case o instanceof Uint8ClampedArray:return De.webcrypto.getRandomValues(o);case o instanceof Int16Array:return De.webcrypto.getRandomValues(o);case o instanceof Uint16Array:return De.webcrypto.getRandomValues(o);case o instanceof Int32Array:return De.webcrypto.getRandomValues(o);case o instanceof Uint32Array:return De.webcrypto.getRandomValues(o);default:throw new Error("Unsupported ArrayBufferView type")}},randomUUID:()=>De.webcrypto.randomUUID(),subtle:Yc};function Us(){oe.transports.file.encoding="utf8",oe.transports.file.level="info",oe.transports.file.maxSize=5*1024*1024,oe.transports.file.format="[{y}-{m}-{d} {h}:{i}:{s}.{ms}] [{level}] {text}";const o=oe.transports.file.getFile().path;if(oe.transports.file.stream=ae.createWriteStream(o,{flags:"a",encoding:"utf8"}),process.platform==="win32"){process.env.CHCP="65001";try{require("child_process").execSync("chcp 65001")}catch{}}const e=global.console;return global.console=oe,{restore:()=>{global.console=e}}}Us();function Qc(o){return Object.entries(o).map(([e,n])=>`${e}=${n}`).join(",")}const Me={Fontname:"Microsoft YaHei",Fontsize:36,PrimaryColour:"&H00FFFFFF&",OutlineColour:"&H00000000&",BackColour:"&H80000000&",Bold:0,Italic:0,BorderStyle:3,Outline:1,Shadow:2,Alignment:2,MarginL:20,MarginR:20,MarginV:30};async function Zc(o){const{videoPath:e,audioPath:n,isOpenOriginAudio:i,startTime:a,currentDuration:t,outputPath:r,subtitles:s,subtitlePath:u,titleConfig:f,videoWidth:l,videoHeight:h,zimuConfig:c}=o;return new Promise(async(g,w)=>{const b=u;Wc(b,s);const C=et().input(e).input(n);e.replace(/\\/g,"/").replace(/:/g,"\\:"),n.replace(/\\/g,"/").replace(/:/g,"\\:");const F=b.replace(/\\/g,"/").replace(/:/g,"\\:");r.replace(/\\/g,"/").replace(/:/g,"\\:");const y=[{filter:"trim",options:{start:a,duration:t},inputs:"0:v",outputs:"trimmed_video"},{filter:"setpts",options:"PTS-STARTPTS",inputs:"trimmed_video",outputs:"video_pts"},{filter:"scale",options:{w:l,h,force_original_aspect_ratio:"decrease",eval:"frame"},inputs:"video_pts",outputs:"scaled_video"},{filter:"pad",options:{width:l,height:h,x:"(ow-iw)/2",y:"(oh-ih)/2",color:"black"},inputs:"scaled_video",outputs:"padded_video"}];if(f){const A=f.duration||t,T={top:"10",middle:"(h-text_h)/2",bottom:"h-text_h-10"},p={left:"10",center:"(w-text_w)/2",right:"w-text_w-10"},O=await Hc("arial.ttf"),I=f.textConfig;y.push({filter:"drawtext",options:{text:f.text,fontfile:O,fontsize:I.fontSize||36,fontcolor:I.fontColor||"white",x:p[I.textAlign||"center"],y:T[I.position||"top"],backgroundColor:I.backgroundColor||void 0,shadowcolor:"black",shadowx:2,shadowy:2,enable:`between(t,${f.start},${f.start+A})`},inputs:"padded_video",outputs:"video_with_title"})}else y.push({filter:"null",inputs:"padded_video",outputs:"video_with_title"});const m=Qc({...Me,Fontname:c.textConfig.fontFamily||Me.Fontname,Fontsize:c.textConfig.fontSize||Me.Fontsize,PrimaryColour:c.textConfig.color&&`&H${c.textConfig.color.replace("#","").toUpperCase()}&`||Me.PrimaryColour,BackColour:c.textConfig.backgroundColor&&`&H${c.textConfig.backgroundColor.replace("#","").toUpperCase()}&`||Me.BackColour,BorderStyle:c.textConfig.borderStyle||Me.BorderStyle,Outline:c.textConfig.outline||Me.Outline,Alignment:c.textConfig.alignment||Me.Alignment}),D=f?`[video_with_title]subtitles='${F}':force_style='${m}'[video_with_subtitles]`:`[padded_video]subtitles='${F}':force_style='${m}'[video_with_subtitles]`;y.push(D);const _=[];let v="";i&&await zc(e)?(_.push({filter:"atrim",options:{start:a,duration:t},inputs:"0:a",outputs:"trimmed_original"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_original",outputs:"original_pts"},{filter:"volume",options:"1.0",inputs:"original_pts",outputs:"original_audio"},{filter:"atrim",options:{start:0,duration:t},inputs:"1:a",outputs:"trimmed_new"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_new",outputs:"new_pts"},{filter:"volume",options:"1.0",inputs:"new_pts",outputs:"new_audio"},{filter:"amix",options:{inputs:2,duration:"longest"},inputs:["original_audio","new_audio"],outputs:"mixed_audio"}),v="mixed_audio"):(_.push({filter:"atrim",options:{start:0,duration:t},inputs:"1:a",outputs:"trimmed_new"},{filter:"asetpts",options:"PTS-STARTPTS",inputs:"trimmed_new",outputs:"new_pts"},{filter:"volume",options:"1.0",inputs:"new_pts",outputs:"new_audio"}),v="new_audio"),C.complexFilter([...y,..._]).outputOptions(["-map [video_with_subtitles]",`-map [${v}]`,"-c:v libx264","-c:a aac","-preset fast"]),C.on("start",A=>{console.log("start to execute command: "+A)}).on("progress",A=>{console.log(`processing: ${Math.round(A.percent)}%`)}).on("end",()=>{console.log(`segment process done: ${r}`),g()}).on("error",A=>{console.error(`segment process error: ${A.message}`),w(A)}).save(r)})}async function el(o,e,n,i){const a=i.videoRatio,r=i.videoResolution.split("x").map(m=>parseInt(m)),s=a==="9:16"?r[0]:r[1],u=a==="9:16"?r[1]:r[0],f=o.zimuConfig.datas[0],l=f.path;let h=f.duration??await tt(l);h=Math.ceil(h*100)/100;const c=o.videoList,g=o.isOpenOriginAudio??!0,w=[],b=`${n}_${o.name}_`,C=o.zimuConfig.datas.map(m=>({text:m.text,start:0,duration:h})),F=Q.join(e,`${n}_${o.name}_subtitles.srt`),y=o.videoTitleConfig.datas[0];for(const m of c){const D=m.path,_=m.duration??await tt(D),v=h,A=Math.ceil(_/v),T=b+Q.basename(D,Q.extname(D));for(let p=0;p<A;p++){const O=p*v,I=m.duration-O,M=Math.min(v,I),U=Q.join(e,`${T}_part${p+1}_${O}-${O+M}.mp4`);w.push({videoPath:D,audioPath:l,outputPath:U,startTime:O,currentDuration:M,isOpenOriginAudio:g,subtitles:C,subtitlePath:F,titleConfig:y,videoWidth:s,videoHeight:u,zimuConfig:o.zimuConfig})}}return w}async function tl(o,e){return new Promise((n,i)=>{const a=et();o.forEach(s=>{a.input(s)});const t=[];for(let s=0;s<o.length;s++)t.push(`[${s}:v]scale=1280:720:force_original_aspect_ratio=decrease,pad=1280:720:(ow-iw)/2:(oh-ih)/2,setsar=1[v${s}]`),t.push(`[${s}:a]aformat=sample_fmts=fltp:sample_rates=44100:channel_layouts=stereo[a${s}]`);const r=o.map((s,u)=>`[v${u}][a${u}]`).join("");t.push(`${r} concat=n=${o.length}:v=1:a=1[v][a]`),a.complexFilter(t).outputOptions(["-map [v]","-map [a]","-c:v libx264","-preset fast","-crf 23","-c:a aac","-b:a 128k","-movflags +faststart"]).on("start",s=>console.log("执行命令:",s)).on("progress",s=>console.log(`处理进度: ${Math.round(s.percent)}%`)).on("end",n).on("error",i).save(e)})}async function rl(o){oe.log("accept params："),oe.log(JSON.stringify(o));const e=o.clips,n=o.outputFileName,i=o.outputDir??Kn(),a=o.globalConfig;for(const l of e)l.segments=await el(l,i,n,a);oe.log("split clip to segments done："),oe.log(JSON.stringify(e));const t=[];for(const l of e)t.push(...l.segments);oe.info("segments:"),oe.info(JSON.stringify(t));const r=t.map(l=>Zc(l));await Promise.all(r),oe.log("segment process done："),oe.log(JSON.stringify(t));let s=1;for(const l of e)(s===1||l.segments.length>1&&l.segments.length<s)&&(s=l.segments.length);oe.log(`we can generate ${s} videos`);const u=[];for(let l=0;l<s;l++){const h=[];let c=0;for(const g of e){const w=g.segments;let b;w.length===1?b=w[0]:b=w[l],h.push(b.outputPath),c+=b.currentDuration}u.push({videos:h,outputPath:Q.join(i,`${n}_${l+1}.mp4`),duration:c})}oe.log("concat videos start"),oe.log(JSON.stringify(u));const f=u.map(l=>tl(l.videos,l.outputPath));return await Promise.all(f),oe.log("concat videos done："),oe.log(JSON.stringify(u)),u.map(l=>({outputPath:l.outputPath,duration:l.duration}))}function nl(){re.ipcMain.handle("video-mix-and-cut",async(o,e)=>{const n=JSON.parse(bn(e));return rl(n)}),re.ipcMain.handle("get-media-duration",async(o,e)=>{const n=JSON.parse(bn(e));return tt(n.path)})}function il(o){re.ipcMain.handle("open-file-dialog",async(e,n)=>{if(!o)return null;const i=(n==null?void 0:n.defaultPath)||St(),a=(n==null?void 0:n.properties)||["openFile"],t=(n==null?void 0:n.title)||"选择文件",r=(n==null?void 0:n.buttonLabel)||"选择",s=(n==null?void 0:n.filters)||[{name:"All Files",extensions:["*"]}];n!=null&&n.multiple&&!a.includes("multiSelections")&&a.push("multiSelections");const u=await re.dialog.showOpenDialog(o,{title:t,defaultPath:i,buttonLabel:r,filters:s,properties:a});if(u.canceled)return[];{const f=u.filePaths.map(async l=>{const h=await tt(l),c=`media://${encodeURIComponent(l)}`;return{path:Q.normalize(l),name:Q.basename(l),ext:Q.extname(l),mimeType:yt(l),duration:h,url:c}});return await Promise.all(f)}})}async function ol(o){const e=Q.normalize(o);if(e!==o||e.includes("..")||![re.app.getPath("documents"),re.app.getPath("downloads"),re.app.getPath("videos"),St()].map(a=>Q.normalize(a)).some(a=>e.startsWith(a+Q.sep)))return!1;try{return await ae.promises.access(e,ae.constants.R_OK),!0}catch{return!1}}function sl(){re.protocol.handle("media",async o=>{try{const e=o.url.slice(8),n=decodeURIComponent(e).replace(/\//g,"\\").replace(/^\\/,""),i=Q.normalize(n);if(!await ol(i))return new Response("Access Denied",{status:403});const a=await ae.promises.stat(i);if(!a.isFile())return new Response("Not a file",{status:400});const t=o.headers.get("range"),r=a.size,s={"Content-Type":yt(i),"Cache-Control":"public, max-age=31536000"};if(t){const u=t.replace(/bytes=/,"").split("-"),f=parseInt(u[0],10),l=u[1]?parseInt(u[1],10):r-1,h=l-f+1,c=ae.createReadStream(i,{start:f,end:l}),g=Xi(c);return new Response(g,{status:206,headers:{"Content-Range":`bytes ${f}-${l}/${r}`,"Accept-Ranges":"bytes","Content-Length":h.toString(),"Content-Type":await yt(i),"Cache-Control":"public, max-age=31536000"}})}else{const u=ae.createReadStream(i),f=Xi(u);return new Response(f,{headers:{"Content-Length":r.toString(),"Content-Type":await yt(i),"Cache-Control":"public, max-age=31536000"}})}}catch{return new Response("Not Found",{status:404})}})}function al(o){re.globalShortcut.register("CommandOrControl+R",()=>{o&&o.reload()})}global.crypto=Jc;process.env.LANG="zh_CN.UTF-8";process.env.LC_ALL="zh_CN.UTF-8";process.platform==="win32"&&(process.env.CHCP="65001");process.env.DIST=Q.join(__dirname,"../dist");process.env.VITE_PUBLIC=re.app.isPackaged?process.env.DIST:Q.join(process.env.DIST,"../public");let Ne;const Qo=process.env.VITE_DEV_SERVER_URL;function Xs(){Ne=new re.BrowserWindow({icon:Q.join(process.env.VITE_PUBLIC,"electron-vite.svg"),webPreferences:{nodeIntegration:!0,contextIsolation:!0,preload:Q.join(__dirname,"preload.js")}}),Ne.webContents.on("did-finish-load",()=>{Ne==null||Ne.webContents.send("main-process-message",new Date().toLocaleString())}),Qo?Ne.loadURL(Qo):Ne.loadFile(Q.join(process.env.DIST,"index.html"))}Us();Ya();Zs();Ja();Kc();Gc();nl();re.app.whenReady().then(()=>{Kn(),Ka(),sl(),Xs(),il(Ne),al(Ne)});re.app.on("window-all-closed",()=>{process.platform!=="darwin"&&(re.app.quit(),Ne=null)});re.app.on("activate",()=>{re.BrowserWindow.getAllWindows().length===0&&Xs()});re.app.on("will-quit",()=>{re.globalShortcut.unregisterAll()});
//# sourceMappingURL=main.js.map
